<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="咦？浏览器都能做人脸检测了？"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>咦？浏览器都能做人脸检测了？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/xszwlpe5w5/",
				"appid": "1613049289050283", 
				"title": "咦？浏览器都能做人脸检测了？ | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-05T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ffvlhoxjisd/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/xhu6gng0e9/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f&text=%e5%92%a6%ef%bc%9f%e6%b5%8f%e8%a7%88%e5%99%a8%e9%83%bd%e8%83%bd%e5%81%9a%e4%ba%ba%e8%84%b8%e6%a3%80%e6%b5%8b%e4%ba%86%ef%bc%9f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f&text=%e5%92%a6%ef%bc%9f%e6%b5%8f%e8%a7%88%e5%99%a8%e9%83%bd%e8%83%bd%e5%81%9a%e4%ba%ba%e8%84%b8%e6%a3%80%e6%b5%8b%e4%ba%86%ef%bc%9f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f&title=%e5%92%a6%ef%bc%9f%e6%b5%8f%e8%a7%88%e5%99%a8%e9%83%bd%e8%83%bd%e5%81%9a%e4%ba%ba%e8%84%b8%e6%a3%80%e6%b5%8b%e4%ba%86%ef%bc%9f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f&is_video=false&description=%e5%92%a6%ef%bc%9f%e6%b5%8f%e8%a7%88%e5%99%a8%e9%83%bd%e8%83%bd%e5%81%9a%e4%ba%ba%e8%84%b8%e6%a3%80%e6%b5%8b%e4%ba%86%ef%bc%9f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%92%a6%ef%bc%9f%e6%b5%8f%e8%a7%88%e5%99%a8%e9%83%bd%e8%83%bd%e5%81%9a%e4%ba%ba%e8%84%b8%e6%a3%80%e6%b5%8b%e4%ba%86%ef%bc%9f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f&title=%e5%92%a6%ef%bc%9f%e6%b5%8f%e8%a7%88%e5%99%a8%e9%83%bd%e8%83%bd%e5%81%9a%e4%ba%ba%e8%84%b8%e6%a3%80%e6%b5%8b%e4%ba%86%ef%bc%9f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f&title=%e5%92%a6%ef%bc%9f%e6%b5%8f%e8%a7%88%e5%99%a8%e9%83%bd%e8%83%bd%e5%81%9a%e4%ba%ba%e8%84%b8%e6%a3%80%e6%b5%8b%e4%ba%86%ef%bc%9f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f&title=%e5%92%a6%ef%bc%9f%e6%b5%8f%e8%a7%88%e5%99%a8%e9%83%bd%e8%83%bd%e5%81%9a%e4%ba%ba%e8%84%b8%e6%a3%80%e6%b5%8b%e4%ba%86%ef%bc%9f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxszwlpe5w5%2f&title=%e5%92%a6%ef%bc%9f%e6%b5%8f%e8%a7%88%e5%99%a8%e9%83%bd%e8%83%bd%e5%81%9a%e4%ba%ba%e8%84%b8%e6%a3%80%e6%b5%8b%e4%ba%86%ef%bc%9f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">咦？浏览器都能做人脸检测了？</h1><div class="meta"><div class="postdate"><time datetime="2019-01-05" itemprop="datePublished">2019-01-05</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3eShape Detection API 的发布已经有一些时日，其主要的提供的能力是给予前端直接可用的特征检测的接口（包括条形码、人脸、文本检测）。本文将简单的对其进行介绍，对前端进行人脸检测进行普适性的讲解。（本文不讲算法～望轻拍）\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e1 背景与场景\x3c\/h1\x3e\n\x3cp\x3e人脸检测（Face Detection）算是老生常谈的课题了，在诸多行业应用广泛，例如金融、安防、电子商务、智能手机、娱乐图片等行业。其中涉及的技术也在不断的演变，下面简要介绍几种思路：\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e基于特征的人脸检测\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3e例如opencv中内置了基于Viola-Jones目标检测框架的Harr分类器，只需要载入一个配置文件（haarcascade_frontalface_alt.xml）就能直接调用detectObject去完成检测过程，同时也支持其他特征的检测（如鼻子、嘴巴等）。\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e基于学习的人脸检测，其实也是需要通过算子提取的图像中的局部特征，通过对其进行分类、统计、回归等方式得到的具备更精确和快响应的分类器。\x3c\/li\x3e\x3c\/ol\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e2 套路集锦\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e2.1 后端处理\x3c\/h2\x3e\n\x3cp\x3e前端通过网络将资源传输到后端，后端统一处理需要检测的图像或视频流，对后端的架构有一定的挑战，同时网络的延时往往不能给用户带来实时的交互效果。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e2.2 客户端处理\x3c\/h2\x3e\n\x3cp\x3e得益于OpenCV在跨语言和跨平台的优势，客户端也能以较低的开发成本的提供人脸检测的能力，并且可以通过JsBridge等方式向web容器提供服务，然而一旦脱离这个容器，孤立的页面将失去这种能力。直到有一天……\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e2.3 开放服务\x3c\/h2\x3e\n\x3cp\x3e不知道从啥时候开始，云计算等概念拔地而起，计算的成本日益降低。各大研发团队（如阿里云、Face\x2b\x2b）都蠢蠢欲动又不紧不慢的上架了人脸检测服务，甚至还带上了各种特！殊！服！务！，人脸识别、活体识别、证件OCR及人脸对比等等等。\x3c\/p\x3e\n\x3cp\x3e尽管不仅提供了客户端的SDK以及前后端的API，但是，怎么说也要讲讲我纯前端的方案吧。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e3 时代带来了什么\x3c\/h1\x3e\n\x3cp\x3e好吧，人脸识别在前端依然是在刀耕火种的远古时代，然而，我们的基础建设已经起步，希望后续的一些相关介绍能为各位看官带来一定的启发。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e\x3ca href=\x22https:\/\/wicg.github.io\/shape-detection-api\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e3.1 Shape Detection API\x3c\/a\x3e\x3c\/h2\x3e\n\x3cp\x3e随着客户端硬件的计算能力逐渐提高，浏览器层面得到的权限也越来越多，由于图像处理需要耗费大量的计算资源，实际上浏览器上也能承担图像检测的一些工作，因此就搞出了个Shape Detection API。\x3c\/p\x3e\n\x3cp\x3e以下几个简单的例子介绍了基本的用法，在尝试编辑并运行这些代码之前，请确保在你的Chrome版本以及该新特性已经被激活，另外该API受同源策略所限制：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3echrome:\/\/flags\/#enable-experimental-web-platform-features\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cul\x3e\x3cli\x3e条形码：Barcode Detection (For Chrome 56\x2b)\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var barcodeDetector = new BarcodeDetector();\nbarcodeDetector.detect(image)\n  .then(barcodes =\x3e {\n    barcodes.forEach(barcode =\x3e console.log(barcodes.rawValue))\n  })\n  .catch(err =\x3e console.error(err));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e barcodeDetector = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e BarcodeDetector();\nbarcodeDetector.detect(image)\n  .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ebarcodes\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    barcodes.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ebarcode\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(barcodes.rawValue))\n  })\n  .catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(err));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e人脸：Face Detection (For Chrome 56\x2b)\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var faceDetector = new FaceDetector();\nfaceDetector.detect(image)\n  .then(faces =\x3e faces.forEach(face =\x3e console.log(face)))\n  .catch(err =\x3e console.error(err));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e faceDetector = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FaceDetector();\nfaceDetector.detect(image)\n  .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3efaces\x3c\/span\x3e =\x26gt;\x3c\/span\x3e faces.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eface\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(face)))\n  .catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(err));\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e文本：Text Detection (For Chrome 58\x2b)\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var textDetector = new TextDetector();\ntextDetector.detect(image)\n  .then(boundingBoxes =\x3e {\n    for(let box of boundingBoxes) {\n      speechSynthesis.speak(new SpeechSynthesisUtterance(box.rawValue));\n    }\n  })\n  .catch(err =\x3e console.error(err));\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e textDetector = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e TextDetector();\ntextDetector.detect(image)\n  .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eboundingBoxes\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e box \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e boundingBoxes) {\n      speechSynthesis.speak(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e SpeechSynthesisUtterance(box.rawValue));\n    }\n  })\n  .catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(err));\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e3.2 图像中的人脸检测\x3c\/h2\x3e\n\x3cp\x3e图像的人脸检测比较简单，只需要传入一个图片的元素，就能直接调起该API进行人脸识别了。然后接住canvas我们可以将检测的结果展示出来。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010604281\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010604281\x22 alt=\x22DingTalk20170807214620.png\x22 title=\x22DingTalk20170807214620.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e核心代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var image = document.querySelector(\x27#image\x27);\nvar canvas = document.querySelector(\x27#canvas\x27);\n\nvar ctx = canvas.getContext(\x26quot;2d\x26quot;);\nvar scale = 1;\n\nimage.onload = function () {\n  ctx.drawImage(image,\n    0, 0, image.width, image.height,\n    0, 0, canvas.width, canvas.height);\n\n  scale = canvas.width \/ image.width;\n};\nfunction detect() {\n  if (window.FaceDetector == undefined) {\n    console.error(\x27Face Detection not supported\x27);\n    return;\n  }\n\n  var faceDetector = new FaceDetector();\n  console.time(\x27detect\x27);\n  return faceDetector.detect(image)\n    .then(faces =\x3e {\n      console.log(faces)\n      \/\/ Draw the faces on the \x3ccanvas\x3e.\n      var ctx = canvas.getContext(\x26quot;2d\x26quot;);\n      ctx.lineWidth = 2;\n      ctx.strokeStyle = \x26quot;red\x26quot;;\n      for (var i = 0; i \x3c faces.length; i\x2b\x2b) {\n        var item = faces[i].boundingBox;\n        ctx.rect(Math.floor(item.x * scale),\n          Math.floor(item.y * scale),\n          Math.floor(item.width * scale),\n          Math.floor(item.height * scale));\n        ctx.stroke();\n      }\n      console.timeEnd(\x27detect\x27);\n    })\n    .catch((e) =\x3e {\n      console.error(\x26quot;Boo, Face Detection failed: \x26quot; \x2b e);\n    });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e image = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27#image\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e canvas = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27#canvas\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ctx = canvas.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x222d\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e scale = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n\nimage.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  ctx.drawImage(image,\n    \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, image.width, image.height,\n    \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, canvas.width, canvas.height);\n\n  scale = canvas.width \/ image.width;\n};\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edetect\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.FaceDetector == \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(\x3cspan class=\x22hljs-string\x22\x3e\x27Face Detection not supported\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e faceDetector = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FaceDetector();\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.time(\x3cspan class=\x22hljs-string\x22\x3e\x27detect\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e faceDetector.detect(image)\n    .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3efaces\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(faces)\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Draw the faces on the \x26lt;canvas\x26gt;.\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ctx = canvas.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x222d\x22\x3c\/span\x3e);\n      ctx.lineWidth = \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n      ctx.strokeStyle = \x3cspan class=\x22hljs-string\x22\x3e\x22red\x22\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; faces.length; i\x2b\x2b) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e item = faces[i].boundingBox;\n        ctx.rect(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(item.x * scale),\n          \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(item.y * scale),\n          \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(item.width * scale),\n          \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(item.height * scale));\n        ctx.stroke();\n      }\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.timeEnd(\x3cspan class=\x22hljs-string\x22\x3e\x27detect\x27\x3c\/span\x3e);\n    })\n    .catch(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(\x3cspan class=\x22hljs-string\x22\x3e\x22Boo, Face Detection failed: \x22\x3c\/span\x3e \x2b e);\n    });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e3.3 视频中的人脸检测\x3c\/h2\x3e\n\x3cp\x3e视频中的人脸检测跟图像相差不大，通过\x3ccode\x3egetUserMedia\x3c\/code\x3e 可以打开摄像头获取视频\/麦克风的信息，通过将视频帧进行检测和展示，即可实现视频中的人脸检测。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010604282\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010604282\x22 alt=\x22animation.gif\x22 title=\x22animation.gif\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e核心代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22navigator.mediaDevices.getUserMedia({\n    video: true,\n    \/\/ audio: true\n  })\n    .then(function (mediaStream) {\n      video.src = window.URL.createObjectURL(mediaStream);\n      video.onloadedmetadata = function (e) {\n        \/\/ Do something with the video here.\n      };\n    })\n    .catch(function (error) {\n      console.log(error.name);\n    });\n\n  setInterval(function () {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.drawImage(video, 0, 0);\n    image.src = canvas.toDataURL(\x27image\/png\x27);\n    image.onload = function() {\n      detect();\n    }\n  }, 60);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3enavigator.mediaDevices.getUserMedia({\n    \x3cspan class=\x22hljs-attr\x22\x3evideo\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ audio: true\x3c\/span\x3e\n  })\n    .then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3emediaStream\x3c\/span\x3e) \x3c\/span\x3e{\n      video.src = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.URL.createObjectURL(mediaStream);\n      video.onloadedmetadata = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Do something with the video here.\x3c\/span\x3e\n      };\n    })\n    .catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eerror\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(error.name);\n    });\n\n  setInterval(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    ctx.clearRect(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, canvas.width, canvas.height);\n    ctx.drawImage(video, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n    image.src = canvas.toDataURL(\x3cspan class=\x22hljs-string\x22\x3e\x27image\/png\x27\x3c\/span\x3e);\n    image.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      detect();\n    }\n  }, \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e3.4 时光倒流到没有API的日子\x3c\/h2\x3e\n\x3cp\x3e实际上，在很久很久以前，也有不少解决方案存在。由于硬件条件以及没有硬件加速等限制的情况，一直没有被广泛地投入生产。\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/eduardolundgren\/tracking.js\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etracking.js\x3c\/a\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3etracking.js 是一款js封装的图像处理的库，为浏览器带来丰富的计算视觉相关的算法和技术，通过它可以实现颜色追踪、人脸检测等功能，具体特性如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010604283\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010604283\x22 alt=\x22DingTalk20170807003805.png\x22 title=\x22DingTalk20170807003805.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/jaysalvat\/jquery.facedetection\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejquery.facedetection\x3c\/a\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3ejquery.facedetection 是一款jquery \/ zepto 人脸检测插件，基于跨终端能力超强的\x3ca href=\x22https:\/\/github.com\/liuliu\/ccv\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eccv\x3c\/a\x3e中的图像分类器和检测器。\x3c\/p\x3e\n\x3cp\x3e2.5 Node.js \x26amp; OpenCv\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/peterbraden\/node-opencv\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3enode-opencv\x3c\/a\x3e 模块已经发布了有些年头，尽管目前还不能完美兼容v3.x，提供的API也比较有限，但能完美兼容opencv v2.4.x。N-API的到来可能会带来更多的惊喜。\x3c\/p\x3e\n\x3cp\x3e设想一下在一个Electron或者Node-Webkit容器中，我们是否可以通过本地开启websocket服务来实现实时的人脸检测呢？实现的思路代码如下：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e后端处理逻辑\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import cv from \x27opencv\x27;\n\nconst detectConfigFile = \x27.\/node_modules\/opencv\/data\/haarcascade_frontalface_alt2.xml\x27;\n\n\/\/ camera properties\nconst camWidth = 320;\nconst camHeight = 240;\nconst camFps = 10;\nconst camInterval = 1000 \/ camFps;\n\n\/\/ face detection properties\nconst rectColor = [0, 255, 0];\nconst rectThickness = 2;\n\n\/\/ initialize camera\nconst camera = new cv.VideoCapture(0);\n\ncamera.setWidth(camWidth);\ncamera.setHeight(camHeight);\n\nconst frameHandler = (err, im) =\x3e {\n  return new Promise((resolve, reject) =\x3e {\n    if (err) {\n      return reject(err);\n    }\n    im.detectObject(detectConfigFile, {}, (error, faces) =\x3e {\n      if (error) {\n        return reject(error);\n      }\n      let face;\n      for (let i = 0; i \x3c faces.length; i\x2b\x2b) {\n        face = faces[i];\n        im.rectangle([face.x, face.y], [face.width, face.height], rectColor, rectThickness);\n      }\n      return resolve(im);\n    });\n  });\n};\n\nmodule.exports = function (socket) {\n  const frameSocketHanlder = (err, im) =\x3e {\n    return frameHandler(err, im)\n      .then((img) =\x3e {\n        socket.emit(\x27frame\x27, {\n          buffer: img.toBuffer(),\n        });\n      });\n  };\n  const handler = () =\x3e {\n    camera.read(frameSocketHanlder);\n  };\n  setInterval(handler, camInterval);\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e cv \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27opencv\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e detectConfigFile = \x3cspan class=\x22hljs-string\x22\x3e\x27.\/node_modules\/opencv\/data\/haarcascade_frontalface_alt2.xml\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ camera properties\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e camWidth = \x3cspan class=\x22hljs-number\x22\x3e320\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e camHeight = \x3cspan class=\x22hljs-number\x22\x3e240\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e camFps = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e camInterval = \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e \/ camFps;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ face detection properties\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rectColor = [\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e255\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rectThickness = \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ initialize camera\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e camera = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e cv.VideoCapture(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n\ncamera.setWidth(camWidth);\ncamera.setHeight(camHeight);\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e frameHandler = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr, im\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e reject(err);\n    }\n    im.detectObject(detectConfigFile, {}, (error, faces) =\x26gt; {\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (error) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e reject(error);\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e face;\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; faces.length; i\x2b\x2b) {\n        face = faces[i];\n        im.rectangle([face.x, face.y], [face.width, face.height], rectColor, rectThickness);\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e resolve(im);\n    });\n  });\n};\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3esocket\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e frameSocketHanlder = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr, im\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e frameHandler(err, im)\n      .then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eimg\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        socket.emit(\x3cspan class=\x22hljs-string\x22\x3e\x27frame\x27\x3c\/span\x3e, {\n          \x3cspan class=\x22hljs-attr\x22\x3ebuffer\x3c\/span\x3e: img.toBuffer(),\n        });\n      });\n  };\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e handler = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    camera.read(frameSocketHanlder);\n  };\n  setInterval(handler, camInterval);\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e前端调用接口\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22socket.on(\x27frame\x27, function (data) {\n  var unit8Arr = new Uint8Array(data.buffer);\n  var str = String.fromCharCode.apply(null, unit8Arr);\n  var base64String = btoa(str);\n\n  img.onload = function () {\n    ctx.drawImage(this, 0, 0, canvas.width, canvas.height);\n  }\n  img.src = \x27data:image\/png;base64,\x27 \x2b base64String;\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3esocket.on(\x3cspan class=\x22hljs-string\x22\x3e\x27frame\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e unit8Arr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eUint8Array\x3c\/span\x3e(data.buffer);\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e str = \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e.fromCharCode.apply(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, unit8Arr);\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e base64String = btoa(str);\n\n  img.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    ctx.drawImage(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, canvas.width, canvas.height);\n  }\n  img.src = \x3cspan class=\x22hljs-string\x22\x3e\x27data:image\/png;base64,\x27\x3c\/span\x3e \x2b base64String;\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader10\x22\x3e4 总结\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e4.1 未来的发展\x3c\/h2\x3e\n\x3cp\x3e这些前沿的技术将会在前端得到更为广泛的应用和支持是毋庸置疑的，未来的图像在前端也会随着传统图像处理-\x26gt;学习\x2b图像处理的方式前进，这一切的功劳离不开基础设施(硬件、浏览器、工具、库等)的逐渐增强和完善，其中包括但不仅限于：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3egetUserMedia\/Canvas   =\x26gt;  图像 \/ 视频的操作\x3c\/li\x3e\n\x3cli\x3eShape Detection API   =\x26gt;  图像检测\x3c\/li\x3e\n\x3cli\x3eWeb Workers           =\x26gt;  并行计算能力\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22http:\/\/cs.stanford.edu\/people\/karpathy\/convnetjs\/demo\/mnist.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eConvNetJS\x3c\/a\x3e             =\x26gt;  深度学习框架\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3e4.2 实际上并没有那么乐观\x3c\/h2\x3e\n\x3cp\x3e4.2.1 准确率\x3c\/p\x3e\n\x3cp\x3e对于正脸(多个)的识别率还是比较高的，但是在侧脸已经有障碍物的情况下，检测的效果并不理想。\x3c\/p\x3e\n\x3cp\x3e4.2.2 处理速度\x3c\/p\x3e\n\x3cp\x3e对于图像中人脸检测的例子2.2，耗费时间300ms\x2b（实际上无法满足大分辨率视频实时处理），是调用Opencv的检测速度100ms的三倍之多。\x3c\/p\x3e\n\x3cp\x3e4.2.3 特性\x3c\/p\x3e\n\x3cp\x3e还有很多需要完善的地方：如不支持眼镜状态、性别、年龄估计、表情识别、人种、笑容、模糊检测等主流服务提供商提供的服务。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader13\x22\x3e4.3 想说又说不完的\x3c\/h2\x3e\n\x3col\x3e\x3cli\x3eDemo：\x3c\/li\x3e\x3c\/ol\x3e\n\x3cblockquote\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/x-cold\/face-detection-browser\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/x-cold\/fac...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/x-cold\/face-detection-nodejs\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/x-cold\/fac...\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3col\x3e\n\x3cli\x3e关于人脸检测在不同场景的适应性，以及检测消耗的时间暂时没有数据支撑，后面考虑引入PASCAL VOC、AT\x26amp;T提供的样本进行小规模的测试。\x3c\/li\x3e\n\x3cli\x3e招资深前端安卓IOS视觉交互：ais-ued-jobs@list.alibaba-inc.com\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch1 id=\x22articleHeader14\x22\x3e5 参考\x3c\/h1\x3e\n\x3col\x3e\n\x3cli\x3e人脸识别技术大总结(1)：Face Detection \x26amp; Alignment: \x3ca href=\x22http:\/\/blog.jobbole.com\/85783\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/blog.jobbole.com\/85783\/\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3e阿里巴巴直播防控中的实人认证技术: \x3ca href=\x22https:\/\/xianzhi.aliyun.com\/forum\/mobile\/read\/635.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/xianzhi.aliyun.com\/fo...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3e前端在人工智能时代能做些什么？：\x3ca href=\x22https:\/\/yq.aliyun.com\/articles\/153198\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/yq.aliyun.com\/article...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3eConvNetJS Deep Learning in your browser：\x3ca href=\x22http:\/\/cs.stanford.edu\/people\/karpathy\/convnetjs\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/cs.stanford.edu\/people...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3cli\x3eFace detection using Shape Detection API：\x3ca href=\x22https:\/\/paul.kinlan.me\/face-detection\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/paul.kinlan.me\/face-d...\x3c\/a\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>咦？浏览器都能做人脸检测了？</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010604276">https://segmentfault.com/a/1190000010604276</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/xszwlpe5w5/" target="_blank">https://alili.tech/archive/xszwlpe5w5/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/z09muaar7j/">2年前端应该会哪些技能<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/ke982v6qrfg/">CSS 性能优化笔记<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/if1i2hs28ah/">H5打造3d场景不完全攻略（二）: Amazing CSS3D<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/s4apghsr7o/">JS原生一步步实现前端路由和单页面应用<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/hjgkntbgqek/">JavaScript 中对大量数据的多重过滤<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/h1hfvr2a2nj/">JavaScript 中的错误处理机制<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/a0ukpm125gm/">JavaScript 数组分组的实现<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/fwosouhbhmj/">JavaScript 类型转换深度学习<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/z193p9xv2p/">JavaScript设计模式之发布-订阅模式（观察者模式）-Part1<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/6i7sr0vgkxm/">Javascript中的时间<aside class="dates">2019-02-01</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>