<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Vue 组件通信的解决方案"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Vue 组件通信的解决方案 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/890j1ohj2dv/",
				"appid": "1613049289050283", 
				"title": "Vue 组件通信的解决方案 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-09T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/banbf7eb3m/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/yhm11tnxae/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f&text=Vue%20%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f&text=Vue%20%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f&title=Vue%20%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f&is_video=false&description=Vue%20%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Vue%20%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f&title=Vue%20%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f&title=Vue%20%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f&title=Vue%20%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f890j1ohj2dv%2f&title=Vue%20%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%a1%88"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Vue 组件通信的解决方案</h1><div class="meta"><div class="postdate"><time datetime="2019-01-09" itemprop="datePublished">2019-01-09</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e数据通信\x3c\/h2\x3e\n\x3cp\x3e首先, 我们通常说数据传递, 组件通信什么什么的, 我认为可以分成两种场景:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e页面和页面之间\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e组件和组件之间\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e通信方案\x3c\/h2\x3e\n\x3cp\x3e不管什么场景, 在使用 Vue 的时候, 一般我们有下面 5 种选择去实现数据通信.\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3evuex\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3estorage\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eprops\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eevent\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eURL queryString\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e选择通信方案\x3c\/h2\x3e\n\x3cp\x3e我们在选择通信方案的时候, 比如说确定 列表页如何把每一项的 id 传递给 详情页的时候, \x3cbr\x3e一般要考虑什么问题? 你是直接全套都是 vuex, 还是说喜欢使用 sessionStorage?\x3c\/p\x3e\n\x3cp\x3e一般我们要考虑下面的几个问题:\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e页面是否可以刷新\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e页面是否可以分享 (或者说URL 是否要求 RESTful)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e数据更新之后, 所有使用此数据的组件是否都需要响应更新\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e分析\x3c\/h2\x3e\n\x3cp\x3e先说 \x27页面和页面之间的通信场景\x27, 首先上面的 5 种方案, 我们可选的有:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22vuex, storage, URL queryString.\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs erlang\x22\x3e\x3ccode\x3evuex, storage, URL \x3cspan class=\x22hljs-keyword\x22\x3equery\x3c\/span\x3eString.\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后分析一下, 每一种方案, 它对上面的 3个问题, 是不是很好的解决掉了:\x3cbr\x3e备注:\x3cbr\x3e页面通信场景不会要求实时响应, 因为就算下个页面的确是实时响应, 你也看不见, \x3cbr\x3e所以主要看 \x27刷新\x27 和 \x27分享\x27\x3c\/p\x3e\n\x3cp\x3evuex: 不能刷新, 不能分享\x3cbr\x3estorage: 不能分享\x3cbr\x3eurl: 能刷新, 能分享\x3c\/p\x3e\n\x3cp\x3e这样看来, url queryString 的方式是 \x27页面通信场景\x27 中的最佳选择, 但是我依旧有疑虑:\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e我始终觉得把跳转信息, 暴露给用户, 是很不好的事情; (心理问题, 可以克服)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eurl 的长度限制;  这个无所谓的, 2k, 你再怎么传递, 我都不会觉得你会出现超过 2k 的情况\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eurl 需要拼接, 这个拼接是否麻烦?   也不麻烦, 只是对象转字符串.\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e这样每个页面都需要在进入的时候先解析一下 queryString, 这样是不是增加了麻烦的程度\x3cbr\x3e   也可以通过 mixins 来操作. 聚合到 mixins, 况且也不一定很多.\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e所以我们可以选择 \x27url queryString\x27 作为 \x27页面和页面通信场景\x27 中的通信方案. \x3cbr\x3e以后你就可以这样用了:\x3c\/p\x3e\n\x3cp\x3e比如列表页面跳转到详情页要带一个 id\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    this.$router.push({\n        path: \x27detail\x27,\n        query: {\n            id\n        }\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$router.push({\n        \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27detail\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3equery\x3c\/span\x3e: {\n            id\n        }\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e你的 url 会始终长这样:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22https:\/\/abc.com\/#\/?id=123\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vim\x22\x3e\x3ccode\x3ehttp\x3cspan class=\x22hljs-variable\x22\x3es:\x3c\/span\x3e\/\/\x3cspan class=\x22hljs-keyword\x22\x3eabc\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3ecom\x3c\/span\x3e\/#\/?id=\x3cspan class=\x22hljs-number\x22\x3e123\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e备注: 如果你的页面不能刷新和分享, 你完全可以三种方案随便选, 爱谁谁. \x3c\/p\x3e\n\x3cp\x3e重点: url queryString 的方式, 有一个问题解决不了:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22从详情页到订单页, 通过 queryString 带了商品信息过来, 假设此时 url 长这样:\n    order\/?goods=xxx\n订单页面有一个收货地址栏, 点击可以进入地址编辑页面, 此时的 url 不会带参数的(你可以试试带一下看多麻烦)\n    address-edit\/\n地址编辑页面有一个保存按钮, 点击会返回到订单页面\n    order\/\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs axapta\x22\x3e\x3ccode\x3e从详情页到订单页, 通过 queryString 带了商品信息过来, 假设此时 url 长这样:\n    \x3cspan class=\x22hljs-keyword\x22\x3eorder\x3c\/span\x3e\/?goods=xxx\n订单页面有一个收货地址栏, 点击可以进入地址编辑页面, 此时的 url 不会带参数的(你可以试试带一下看多麻烦)\n    address-\x3cspan class=\x22hljs-keyword\x22\x3eedit\x3c\/span\x3e\/\n地址编辑页面有一个保存按钮, 点击会返回到订单页面\n    \x3cspan class=\x22hljs-keyword\x22\x3eorder\x3c\/span\x3e\/\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eso, url queryString 丢了. \x3c\/p\x3e\n\x3cp\x3e我目前的解决方案: \x3cbr\x3e针对这种存在多入口的页面, 一定要在进入它的第一时间, 先把 queryString 存起来. \x3cbr\x3e并且做如下判断:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (\/\/ 存在 queryString) {\n    \/\/ use queryString\n} else {\n    \/\/ use storage\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 存在 queryString) {\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ use queryString\x3c\/span\x3e\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ use storage\x3c\/span\x3e\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但是这种方式还是搞不定 从地址编辑页返回到订单页, 用户此时分享订单页, 分享出去的玩意肯定会是错的.\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e现在来说下 \x27组件和组件之间的通信场景\x27\x3cbr\x3e上面的 5 种方案, 可以选择 vuex, event, props, storage\x3c\/p\x3e\n\x3cp\x3e先看下 刷新, 分享和实时响应\x3cbr\x3evuex, 不能刷新\x3cbr\x3eevent, props 能刷新能分享\x3cbr\x3estorage 不能分享 \x26amp; 实时. \x3c\/p\x3e\n\x3cp\x3e解释: \x3cbr\x3e为什么 vuex 在这里还是不能刷新\x3cbr\x3e因为如果使用的 state 里面的值是其他页面设置的而不是 init 就存在的, 刷新丢值.\x3cbr\x3e为什么 event, props 可以做到防刷新防分享\x3cbr\x3e因为这两个玩意是程序运行它就生效的, 它也可以做到实时更新. \x3cbr\x3estorage 虽然在存的时候有一个事件, 但是这太 trick 了. \x3c\/p\x3e\n\x3cp\x3e所以我们选择的是 event, props?\x3c\/p\x3e\n\x3cp\x3e分析一下吧. \x3cbr\x3e组件通信可以分成两种, 父子, 同辈.\x3c\/p\x3e\n\x3cp\x3e父子之间呢:\x3cbr\x3e父传子: props\x3cbr\x3e子传父: $emit(event)\x3c\/p\x3e\n\x3cp\x3e这就是 \x27props down, events up\x27;\x3c\/p\x3e\n\x3cp\x3e但是其实还有:\x3cbr\x3e父传子: this.$refs.xxx\x3cbr\x3e子传父: this.$parent.xxx\x3c\/p\x3e\n\x3cp\x3e还有: 自定义 v-model\x3c\/p\x3e\n\x3cp\x3e还有: 让 props 是一个对象. \x3c\/p\x3e\n\x3cp\x3e同辈之间: event-bus.\x3c\/p\x3e\n\x3cp\x3e所以这就完了? 啥都没有了? 嗯, 就这样.\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e思考\x3c\/h2\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cp\x3e关于 vuex 的应用场景的考虑\x3cbr\x3e不是应该所有的组件, 路由之间的数据传递都应该通过 vuex, 当同时存在两种方式可以选择的时候,选择 vuex 的唯一理由只有一个:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22需要响应式的状态\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e需要响应式的状态\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ewhy?\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22因为 vuex 虽然有辅助函数, 但是用起来还是要 引入, 定义. 而且真的是一刷新页面就挂了. \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e因为 vuex 虽然有辅助函数, 但是用起来还是要 引入, 定义. 而且真的是一刷新页面就挂了. \x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可以通过监听 beforeunload 事件, 在其中缓存 state, 然后在 onload 事件再恢复, 这样可以避免掉vuex 的丢值.\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e没有必要追求全项目统一的一种通信方式, 理论上你不考虑刷新分享, 全项目都用 vuex, 什么事情也不会有的.\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evuex 是状态管理, 不是保存常量的地方.\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Vue 组件通信的解决方案</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010162012">https://segmentfault.com/a/1190000010162012</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/890j1ohj2dv/" target="_blank">https://alili.tech/archive/890j1ohj2dv/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/sj57jxyoook/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（上）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/qsw902j95k/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（下）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/nnpmjlot58j/">IndexedDB使用与出坑指南<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/alvlbas9oai/">JS事件模型<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/u0pzym8k36o/">JS练习实例--编写经典小游戏俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/khwpyk5yz8q/">JavaScript 事件代理和委托<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/kuocl6lc3n/">JavaScript 版俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/n8bk54lyrf/">Promise学习:基础入门<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/7bk7u30qncb/">Redux 入坑进阶 - 源码解析<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/853kqfmqmf7/">Snap.svg 基本知识入门<aside class="dates">2019-02-03</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>