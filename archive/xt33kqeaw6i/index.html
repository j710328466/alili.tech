<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="promise介绍--基础篇"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>promise介绍--基础篇 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/xt33kqeaw6i/",
				"appid": "1613049289050283", 
				"title": "promise介绍--基础篇 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-30T02:30:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/63seyo5gl84/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/1dd6p012ywq/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f&text=promise%e4%bb%8b%e7%bb%8d--%e5%9f%ba%e7%a1%80%e7%af%87"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f&text=promise%e4%bb%8b%e7%bb%8d--%e5%9f%ba%e7%a1%80%e7%af%87"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f&title=promise%e4%bb%8b%e7%bb%8d--%e5%9f%ba%e7%a1%80%e7%af%87"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f&is_video=false&description=promise%e4%bb%8b%e7%bb%8d--%e5%9f%ba%e7%a1%80%e7%af%87"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=promise%e4%bb%8b%e7%bb%8d--%e5%9f%ba%e7%a1%80%e7%af%87&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f&title=promise%e4%bb%8b%e7%bb%8d--%e5%9f%ba%e7%a1%80%e7%af%87"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f&title=promise%e4%bb%8b%e7%bb%8d--%e5%9f%ba%e7%a1%80%e7%af%87"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f&title=promise%e4%bb%8b%e7%bb%8d--%e5%9f%ba%e7%a1%80%e7%af%87"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fxt33kqeaw6i%2f&title=promise%e4%bb%8b%e7%bb%8d--%e5%9f%ba%e7%a1%80%e7%af%87"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">promise介绍--基础篇</h1><div class="meta"><div class="postdate"><time datetime="2019-01-30" itemprop="datePublished">2019-01-30</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e前言\x3c\/h1\x3e\n\x3cp\x3e\x3cstrong\x3ePromise\x3c\/strong\x3e，相信每一个前端工程师都或多或少地在项目中都是用过，毕竟它早已不是一个新名词。ES6中已经原生对它加以支持，在caniuse中搜索一下\x3ccode\x3ePromise\x3c\/code\x3e，发现新版的chrome和firefox也已经支持。但是低版本的浏览器我们可以使用\x3ccode\x3ees6-promise\x3c\/code\x3e这个\x3ccode\x3epolyfill\x3c\/code\x3e库来加以兼容。\x3c\/p\x3e\n\x3cp\x3e暂且不谈\x3ccode\x3eawait\x3c\/code\x3e、\x3ccode\x3easync\x3c\/code\x3e，在Google或百度或360搜索等搜索引擎、或者在segmentfault等社区中，我们可以搜到一大把介绍\x3ccode\x3epromise\x3c\/code\x3e的文章，毕竟它已经出现了很长时间，早已有很多大神分析讲解过。\x3c\/p\x3e\n\x3cp\x3e我也看了一些文章，但是感觉都没有达到想要的效果。所以决定自己开一个小系列文章学习讲解一下promise的原理，以及实现，最后再谈一谈与之联系密切的Deferred对象。\x3c\/p\x3e\n\x3cp\x3e本文是该系列的第一篇文章，主要先让大家对Promise有一个基本的认识。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3epromise简介\x3c\/h1\x3e\n\x3cp\x3ePromise的出现，原本是为了解决回调地狱的问题。所有人在讲解\x3ccode\x3ePromise\x3c\/code\x3e时，都会以一个ajax请求为例，此处我们也用一个简单的ajax的例子来带大家看一下\x3ccode\x3ePromise\x3c\/code\x3e是如何使用的。\x3c\/p\x3e\n\x3cp\x3eajax请求的传统写法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22getData(method, url, successFun, failFun){\n  var xmlHttp = new XMLHttpRequest();\n  xmlHttp.open(method, url);\n  xmlHttp.send();\n  xmlHttp.onload = function () {\n    if (this.status == 200 ) {\n      successFun(this.response);\n    } else {\n      failFun(this.statusText);\n    }\n  };\n  xmlHttp.onerror = function () {\n    failFun(this.statusText);\n  };\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3egetData(method, \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, successFun, failFun){\n  \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e xmlHttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n  xmlHttp.open(method, \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e);\n  xmlHttp.send();\n  xmlHttp.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e ) {\n      successFun(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.response);\n    } \x3cspan class=\x22hljs-title\x22\x3eelse\x3c\/span\x3e {\n      failFun(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.statusText);\n    }\n  };\n  xmlHttp.onerror = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    failFun(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.statusText);\n  };\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e改为\x3ccode\x3epromise\x3c\/code\x3e后的写法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22getData(method, url){\n  var promise = new Promise(function(resolve, reject){\n    var xmlHttp = new XMLHttpRequest();\n    xmlHttp.open(method, url);\n    xmlHttp.send();\n    xmlHttp.onload = function () {\n      if (this.status == 200 ) {\n        resolve(this.response);\n      } else {\n        reject(this.statusText);\n      }\n    };\n    xmlHttp.onerror = function () {\n      reject(this.statusText);\n    };\n  })\n  return promise;\n}\n\ngetData(\x27get\x27,\x27www.xxx.com\x27).then(successFun, failFun)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3egetData(method, url){\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xmlHttp = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n    xmlHttp.open(method, url);\n    xmlHttp.send();\n    xmlHttp.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.status == \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e ) {\n        resolve(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.response);\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        reject(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.statusText);\n      }\n    };\n    xmlHttp.onerror = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      reject(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.statusText);\n    };\n  })\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e promise;\n}\n\ngetData(\x3cspan class=\x22hljs-string\x22\x3e\x27get\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27www.xxx.com\x27\x3c\/span\x3e).then(successFun, failFun)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e很显然，我们把异步中使用回调函数的场景改为了\x3ccode\x3e.then()\x3c\/code\x3e、\x3ccode\x3e.catch()\x3c\/code\x3e等函数链式调用的方式。基于\x3ccode\x3epromise\x3c\/code\x3e我们可以把复杂的异步回调处理方式进行模块化。\x3c\/p\x3e\n\x3cp\x3e下面，我们就来介绍一下\x3ccode\x3ePromise\x3c\/code\x3e到底是个什么东西？它是如何做到的？\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e\n\x3ccode\x3ePromise\x3c\/code\x3e的原理分析\x3c\/h1\x3e\n\x3cp\x3e其实\x3ccode\x3epromise\x3c\/code\x3e原理说起来并不难，它内部有三个状态，分别是\x3ccode\x3epending\x3c\/code\x3e，\x3ccode\x3efulfilled\x3c\/code\x3e和\x3ccode\x3erejected \x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3epending\x3c\/code\x3e是对象创建后的初始状态，当对象\x3ccode\x3efulfill\x3c\/code\x3e（成功）时变为\x3ccode\x3efulfilled\x3c\/code\x3e，当对象\x3ccode\x3ereject\x3c\/code\x3e（失败）时变为\x3ccode\x3erejected\x3c\/code\x3e。且只能从\x3ccode\x3epengding\x3c\/code\x3e变为\x3ccode\x3efulfilled\x3c\/code\x3e或\x3ccode\x3erejected \x3c\/code\x3e，而不能逆向或从\x3ccode\x3efulfilled\x3c\/code\x3e变为\x3ccode\x3erejected \x3c\/code\x3e、从\x3ccode\x3erejected\x3c\/code\x3e变为\x3ccode\x3efulfilled\x3c\/code\x3e。如图所示：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVGo9L?w=690\x26amp;h=366\x22 src=\x22https:\/\/static.alili.tech\/img\/bVGo9L?w=690\x26amp;h=366\x22 alt=\x22状态变化\x22 title=\x22状态变化\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e\n\x3ccode\x3ePromise\x3c\/code\x3e实例方法介绍\x3c\/h1\x3e\n\x3cp\x3e\x3ccode\x3ePromise\x3c\/code\x3e对象拥有两个实例方法\x3ccode\x3ethen()\x3c\/code\x3e和\x3ccode\x3ecatch()\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e从前面的例子中可以看到，成功和失败的回调函数我们是通过\x3ccode\x3ethen()\x3c\/code\x3e添加，在\x3ccode\x3epromise\x3c\/code\x3e状态改变时分别调用。\x3ccode\x3epromise\x3c\/code\x3e构造函数中通常都是异步的，所以\x3ccode\x3ethen\x3c\/code\x3e方法往往都先于\x3ccode\x3eresolve\x3c\/code\x3e和\x3ccode\x3ereject\x3c\/code\x3e方法执行。所以\x3ccode\x3epromise\x3c\/code\x3e内部需要有一个存储\x3ccode\x3efulfill\x3c\/code\x3e时调用函数的数组和一个存储\x3ccode\x3ereject\x3c\/code\x3e时调用函数的数组。\x3c\/p\x3e\n\x3cp\x3e从上面的例子中我们还可以看到\x3ccode\x3ethen\x3c\/code\x3e方法可以接收两个参数，且通常都是函数（非函数时如何处理下一篇文章中会详细介绍）。第一个参数会添加到\x3ccode\x3efulfill\x3c\/code\x3e时调用的数组中，第二个参数添加到\x3ccode\x3ereject\x3c\/code\x3e时调用的数组中。当\x3ccode\x3epromise\x3c\/code\x3e状态\x3ccode\x3efulfill\x3c\/code\x3e时，会把\x3ccode\x3eresolve(value)\x3c\/code\x3e中的\x3ccode\x3evalue\x3c\/code\x3e值传给调用的函数中，同理，当\x3ccode\x3epromise\x3c\/code\x3e状态\x3ccode\x3ereject\x3c\/code\x3e时，会把\x3ccode\x3ereject(reason)\x3c\/code\x3e中的\x3ccode\x3ereason\x3c\/code\x3e值传给调用的函数。例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n    resolve(5)\n}).then(function(value){\n    console.log(value) \/\/5\n})\n\nvar p1 = new Promise(function(resolve, reject){\n    reject(new Error(\x27错误\x27))\n}).then(function(value){\n    console.log(value)\n}, function(reason){\n    console.log(reason) \/\/Error: 错误(…)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n}).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value) \x3cspan class=\x22hljs-comment\x22\x3e\/\/5\x3c\/span\x3e\n})\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27错误\x27\x3c\/span\x3e))\n}).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason) \x3cspan class=\x22hljs-comment\x22\x3e\/\/Error: 错误(…)\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ethen\x3c\/code\x3e方法会返回一个新的\x3ccode\x3epromise\x3c\/code\x3e，下面的例子中\x3ccode\x3ep == p1\x3c\/code\x3e将返回\x3ccode\x3efalse\x3c\/code\x3e,说明\x3ccode\x3ep1\x3c\/code\x3e是一个全新的对象。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n    resolve(5)\n})\nvar p1 = p.then(function(value){\n    console.log(value)\n})\np == p1 \/\/ false\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n})\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = p.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)\n})\np == p1 \x3cspan class=\x22hljs-comment\x22\x3e\/\/ false\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这也是为什么\x3ccode\x3ethen\x3c\/code\x3e是可以链式调用的，它是在新的对象上添加成功或失败的回调，这与\x3ccode\x3ejQuery\x3c\/code\x3e中的链式调用不同。\x3c\/p\x3e\n\x3cp\x3e那么新对象的状态是基于什么改变的呢？是不是说如果\x3ccode\x3ep\x3c\/code\x3e的状态\x3ccode\x3efulfill\x3c\/code\x3e，后面的\x3ccode\x3ethen\x3c\/code\x3e创建的新对象都会成功；或者说如果\x3ccode\x3ep\x3c\/code\x3e的状态\x3ccode\x3ereject\x3c\/code\x3e，后面的\x3ccode\x3ethen\x3c\/code\x3e创建的新对象都会失败？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n    resolve(5)\n})\nvar p1 = p.then(function(value){\n    console.log(value)   \/\/ 5\n}).then(function(value){\n    console.log(\x27fulfill \x27 \x2b value)   \/\/ fulfill undefined\n}, function(reason){\n    console.log(\x27reject \x27 \x2b reason)   \n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n})\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = p.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 5\x3c\/span\x3e\n}).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill \x27\x3c\/span\x3e \x2b value)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ fulfill undefined\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject \x27\x3c\/span\x3e \x2b reason)   \n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的例子会打印出5和\x22fulfill undefined\x22说明它的状态变为成功。那如果我们在\x3ccode\x3ep1\x3c\/code\x3e的\x3ccode\x3ethen\x3c\/code\x3e方法中抛出异常呢？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n    resolve(5)\n})\nvar p1 = p.then(function(value){\n    console.log(value)   \/\/ 5\n    throw new Error(\x27test\x27)\n}).then(function(value){\n    console.log(\x27fulfill \x27 \x2b value)\n}, function(reason){\n    console.log(\x27reject \x27 \x2b reason)   \/\/ reject Error: test\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n})\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = p.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 5\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e)\n}).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill \x27\x3c\/span\x3e \x2b value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject \x27\x3c\/span\x3e \x2b reason)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ reject Error: test\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e理所当然，新对象肯定会失败。\x3c\/p\x3e\n\x3cp\x3e反过来如果\x3ccode\x3ep\x3c\/code\x3e失败了，会是什么样的呢？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n    reject(5)\n})\nvar p1 = p.then(undefined, function(value){\n    console.log(value)   \/\/ 5\n}).then(function(value){\n    console.log(\x27fulfill \x27 \x2b value)   \/\/ fulfill undefined\n}, function(reason){\n    console.log(\x27reject \x27 \x2b reason)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    reject(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n})\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = p.then(\x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 5\x3c\/span\x3e\n}).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill \x27\x3c\/span\x3e \x2b value)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ fulfill undefined\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject \x27\x3c\/span\x3e \x2b reason)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e说明新对象状态不会受到前一个对象状态的影响。\x3c\/p\x3e\n\x3cp\x3e再来看如下代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n    reject(5)\n})\nvar p1 = p.then(function(value){\n    console.log(value) \n})\nvar p2 = p1.then(function(value){\n    console.log(\x27fulfill \x27 \x2b value)\n}, function(reason){\n    console.log(\x27reject \x27 \x2b reason)   \/\/ reject 5\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    reject(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n})\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = p.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value) \n})\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p2 = p1.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill \x27\x3c\/span\x3e \x2b value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject \x27\x3c\/span\x3e \x2b reason)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ reject 5\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们发现\x3ccode\x3ep1\x3c\/code\x3e的状态变为\x3ccode\x3erejected\x3c\/code\x3e，从而触发了\x3ccode\x3ethen\x3c\/code\x3e方法第二个参数的函数。这似乎与我们之前提到的有差异啊，\x3ccode\x3ep1\x3c\/code\x3e的状态受到了\x3ccode\x3ep\x3c\/code\x3e的状态的影响。\x3c\/p\x3e\n\x3cp\x3e再来看一个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n    resolve(5)\n})\nvar p1 = p.then(undefined, function(value){\n    console.log(value) \n})\nvar p2 = p1.then(function(value){\n    console.log(\x27fulfill \x27 \x2b value)   \/\/ fulfill 5\n}, function(reason){\n    console.log(\x27reject \x27 \x2b reason)   \n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n})\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = p.then(\x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value) \n})\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p2 = p1.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill \x27\x3c\/span\x3e \x2b value)   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ fulfill 5\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject \x27\x3c\/span\x3e \x2b reason)   \n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e细心的人可能会发现，该例子中\x3ccode\x3ethen\x3c\/code\x3e第一个参数是\x3ccode\x3eundefined\x3c\/code\x3e，且\x3ccode\x3evalue\x3c\/code\x3e值5被传到了\x3ccode\x3ep1\x3c\/code\x3e成功时的回调函数中。上面那个例子中\x3ccode\x3ethen\x3c\/code\x3e的第二个参数是\x3ccode\x3eundefined\x3c\/code\x3e，同样\x3ccode\x3ereason\x3c\/code\x3e值也传到了\x3ccode\x3ep1\x3c\/code\x3e失败时的回调函数中。这是因当对应的参数不为函数时，会将前一\x3ccode\x3epromise\x3c\/code\x3e的状态和值传递下去。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3epromise\x3c\/code\x3e含有一个实例方法\x3ccode\x3ecatch\x3c\/code\x3e，从名字上我们就看得出来，它和异常有千丝万缕的关系。其实\x3ccode\x3ecatch(onReject)\x3c\/code\x3e方法等价于\x3ccode\x3ethen(undefined, onReject)\x3c\/code\x3e，也就是说如下两种情况是等效的。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise(function(resolve, reject){\n    reject(new Error(\x27error\x27))\n}).then(undefined, function(reason){\n    console.log(reason) \/\/ Error: error(…)\n})\n\nnew Promise(function(resolve, reject){\n    reject(new Error(\x27error\x27))\n}).catch(function(reason){\n    console.log(reason) \/\/ Error: error(…)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e))\n}).then(\x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Error: error(…)\x3c\/span\x3e\n})\n\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e))\n}).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Error: error(…)\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们提到参数不为函数时会把值和状态传递下去。所以我们可以在多个\x3ccode\x3ethen\x3c\/code\x3e之后添加一个\x3ccode\x3ecatch\x3c\/code\x3e方法，这样前面只要\x3ccode\x3ereject\x3c\/code\x3e或抛出异常，都会被最后的\x3ccode\x3ecatch\x3c\/code\x3e方法处理。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new Promise(function(resolve, reject){\n    resolve(5)\n}).then(function(value){\n    taskA()\n}).then(function(value){\n    taskB()\n}).then(function(value){\n    taskC()\n}).catch(function(reason){\n    console.log(reason)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scilab\x22\x3e\x3ccode\x3enew Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve, reject)\x3c\/span\x3e{\x3c\/span\x3e\n    resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e{\x3c\/span\x3e\n    taskA()\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e{\x3c\/span\x3e\n    taskB()\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e{\x3c\/span\x3e\n    taskC()\n}).\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(reason)\x3c\/span\x3e{\x3c\/span\x3e\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(reason)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3e\n\x3ccode\x3ePromise\x3c\/code\x3e的静态方法\x3c\/h1\x3e\n\x3cp\x3e\x3ccode\x3ePromise\x3c\/code\x3e还有四个静态方法，分别是\x3ccode\x3eresolve\x3c\/code\x3e、\x3ccode\x3ereject\x3c\/code\x3e、\x3ccode\x3eall\x3c\/code\x3e、\x3ccode\x3erace\x3c\/code\x3e，下面我们一一介绍。\x3c\/p\x3e\n\x3cp\x3e除了通过\x3ccode\x3enew Promise()\x3c\/code\x3e的方式，我们还有两种创建\x3ccode\x3ePromise\x3c\/code\x3e对象的方法：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e\x3ccode\x3ePromise.resolve()\x3c\/code\x3e\x3c\/strong\x3e 它相当于创建了一个立即\x3ccode\x3eresolve\x3c\/code\x3e的对象。如下两段代码作用相同：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.resolve(5)\n\nnew Promise(function(resolve){\n    resolve(5)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e)\x3c\/span\x3e{\n    resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e它使得promise对象直接\x3ccode\x3eresolve\x3c\/code\x3e，并把5传到后面\x3ccode\x3ethen\x3c\/code\x3e添加的成功函数中。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.resolve(5).then(function(value){\n    console.log(value) \/\/ 5\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livecodeserver\x22\x3e\x3ccode\x3ePromise.\x3cspan class=\x22hljs-built_in\x22\x3eresolve\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-title\x22\x3evalue\x3c\/span\x3e){\x3c\/span\x3e\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3evalue\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e \/\/ 5\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e\x3ccode\x3ePromise.reject()\x3c\/code\x3e\x3c\/strong\x3e 很明显它相当于创建了一个立即\x3ccode\x3ereject\x3c\/code\x3e的对象。如下两段代码作用相同：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.reject(new Error(\x27error\x27))\n\nnew Promise(function(resolve, reject){\n    reject(new Error(\x27error\x27))\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e))\n\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n    reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e))\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e它使得promise对象直接\x3ccode\x3ereject\x3c\/code\x3e，并把error传到后面\x3ccode\x3ecatch\x3c\/code\x3e添加的函数中。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.reject(new Error(\x27error\x27)).catch(function(reason){\n    console.log(reason) \/\/ Error: error(…)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e)).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(reason) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Error: error(…)\x3c\/span\x3e\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e\x3ccode\x3ePromise.all()\x3c\/code\x3e\x3c\/strong\x3e 它接收一个promise对象组成的数组作为参数，并返回一个新的\x3ccode\x3epromise\x3c\/code\x3e对象。\x3c\/p\x3e\n\x3cp\x3e当数组中所有的对象都\x3ccode\x3eresolve\x3c\/code\x3e时，新对象状态变为\x3ccode\x3efulfilled\x3c\/code\x3e，所有对象的\x3ccode\x3eresolve\x3c\/code\x3e的\x3ccode\x3evalue\x3c\/code\x3e依次添加组成一个新的数组，并以新的数组作为新对象\x3ccode\x3eresolve\x3c\/code\x3e的\x3ccode\x3evalue\x3c\/code\x3e，例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.all([Promise.resolve(5), \n  Promise.resolve(6), \n  Promise.resolve(7)]).then(function(value){\n    console.log(\x27fulfill\x27, value)  \/\/ fulfill [5, 6, 7]\n}, function(reason){\n    console.log(\x27reject\x27,reason)\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.all([\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e), \n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e), \n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e)]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e, value)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ fulfill [5, 6, 7]\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e,reason)\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当数组中有一个对象\x3ccode\x3ereject\x3c\/code\x3e时，新对象状态变为\x3ccode\x3erejected\x3c\/code\x3e，并以当前对象\x3ccode\x3ereject\x3c\/code\x3e的\x3ccode\x3ereason\x3c\/code\x3e作为新对象\x3ccode\x3ereject\x3c\/code\x3e的\x3ccode\x3ereason\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.all([Promise.resolve(5), \n  Promise.reject(new Error(\x27error\x27)), \n  Promise.resolve(7),\n  Promise.reject(new Error(\x27other error\x27))\n  ]).then(function(value){\n    console.log(\x27fulfill\x27, value)\n}, function(reason){\n    console.log(\x27reject\x27, reason)  \/\/ reject Error: error(…)\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.all([\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e), \n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e)), \n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e),\n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27other error\x27\x3c\/span\x3e))\n  ]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e, value)\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e, reason)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ reject Error: error(…)\x3c\/span\x3e\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e那当数组中，传入了非promise对象会如何呢？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.all([Promise.resolve(5), \n  6,\n  true,\n  \x27test\x27,\n  undefined,\n  null,\n  {a:1},\n  function(){},\n  Promise.resolve(7)\n  ]).then(function(value){\n    console.log(\x27fulfill\x27, value)  \/\/ fulfill [5, 6, true, \x26quot;test\x26quot;, undefined, null, Object, function, 7]\n}, function(reason){\n    console.log(\x27reject\x27, reason)\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.all([\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e), \n  \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  {\x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e},\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{},\n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e)\n  ]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e, value)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ fulfill [5, 6, true, \x22test\x22, undefined, null, Object, function, 7]\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e, reason)\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们发现，当传入的值为数字、boolean、字符串、undefined、null、{a:1}、function(){}等非promise对象时，会依次把它们添加到新对象\x3ccode\x3eresolve\x3c\/code\x3e时传递的数组中。\x3c\/p\x3e\n\x3cp\x3e那数组中的多个对象是同时调用，还是一个接一个的依次调用呢？我们再看个例子\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function timeout(time) {\n    return new Promise(function (resolve) {\n        setTimeout(function () {\n            resolve(time);\n        }, time);\n    });\n}\nconsole.time(\x27promise\x27)\nPromise.all([\n    timeout(10),\n    timeout(60),\n    timeout(100)\n]).then(function (values) {\n    console.log(values); [10, 60, 100]\n    console.timeEnd(\x27promise\x27);   \/\/ 107ms \n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etimeout\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etime\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e) \x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            resolve(time);\n        }, time);\n    });\n}\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.time(\x3cspan class=\x22hljs-string\x22\x3e\x27promise\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.all([\n    timeout(\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e),\n    timeout(\x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e),\n    timeout(\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\n]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3evalues\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(values); [\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e]\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.timeEnd(\x3cspan class=\x22hljs-string\x22\x3e\x27promise\x27\x3c\/span\x3e);   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 107ms \x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e由此我们可以看出，传入的多个对象几乎是同时执行的，因为总的时间略大于用时最长的一个对象\x3ccode\x3eresolve\x3c\/code\x3e的时间。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e\x3ccode\x3ePromise.race()\x3c\/code\x3e\x3c\/strong\x3e 它同样接收一个promise对象组成的数组作为参数，并返回一个新的\x3ccode\x3epromise\x3c\/code\x3e对象。\x3c\/p\x3e\n\x3cp\x3e与\x3ccode\x3ePromise.all()\x3c\/code\x3e不同，它是在数组中有一个对象（最早改变状态）\x3ccode\x3eresolve\x3c\/code\x3e或\x3ccode\x3ereject\x3c\/code\x3e时，就改变自身的状态，并执行响应的回调。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.race([Promise.resolve(5), \n  Promise.reject(new Error(\x27error\x27)), \n  Promise.resolve(7)]).then(function(value){\n    console.log(\x27fulfill\x27, value)  \/\/ fulfill 5\n}, function(reason){\n    console.log(\x27reject\x27,reason)\n})\n\nPromise.race([Promise.reject(new Error(\x27error\x27)), \n  Promise.resolve(7)]).then(function(value){\n    console.log(\x27fulfill\x27, value) \n}, function(reason){\n    console.log(\x27reject\x27,reason) \/\/reject Error: error(…)\n})\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.race([\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e), \n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e)), \n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e)]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e, value)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ fulfill 5\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e,reason)\n})\n\n\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.race([\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e)), \n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e)]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e, value) \n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e,reason) \x3cspan class=\x22hljs-comment\x22\x3e\/\/reject Error: error(…)\x3c\/span\x3e\n})\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e且当数组中有非异步\x3ccode\x3ePromise\x3c\/code\x3e对象或有数字、boolean、字符串、undefined、null、{a:1}、function(){}等非\x3ccode\x3ePromise\x3c\/code\x3e对象时，都会直接以该值\x3ccode\x3eresolve\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.race([new Promise((resolve)=\x3e{\n    setTimeout(()=\x3e{\n        resolve(1)\n    },100)}),\n  Promise.resolve(5), \n  \x26quot;test\x26quot;,\n  Promise.reject(new Error(\x27error\x27)), \n  Promise.resolve(7)]).then(function(value){\n    console.log(\x27fulfill\x27, value)  \/\/ fulfill 5\n}, function(reason){\n    console.log(\x27reject\x27,reason)\n})\n\/\/ fulfill 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.race([\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e{\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n        resolve(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n    },\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)}),\n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e), \n  \x3cspan class=\x22hljs-string\x22\x3e\x22test\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e)), \n  \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e)]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfill\x27\x3c\/span\x3e, value)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ fulfill 5\x3c\/span\x3e\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereason\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e,reason)\n})\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ fulfill 5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e数组中第一个元素是异步的\x3ccode\x3ePromise\x3c\/code\x3e，第二个是非异步\x3ccode\x3ePromise\x3c\/code\x3e，会立即改变状态，所以新对象会立即改变状态并把\x3ccode\x3e5\x3c\/code\x3e传递给成功时的回调函数。\x3c\/p\x3e\n\x3cp\x3e那么问题又来了，既然数组中第一个元素成功或失败就会改变新对象的状态，那数组中后面的对象是否会执行呢?\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function timeout(time) {\n    return new Promise(function (resolve) {\n        setTimeout(function () {\n            console.log(time)\n            resolve(time);\n        }, time);\n    });\n}\nconsole.time(\x27promise\x27)\nPromise.race([\n    timeout(10),\n    timeout(60),\n    timeout(100)\n]).then(function (values) {\n    console.log(values); [10, 60, 100]\n    console.timeEnd(\x27promise\x27);   \/\/ 107ms\n});\n\n\/\/ 结果依次为\n\/\/ 10\n\/\/ 10\n\/\/ promise: 11.1ms\n\/\/ 60\n\/\/ 100\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etimeout\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etime\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e) \x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(time)\n            resolve(time);\n        }, time);\n    });\n}\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.time(\x3cspan class=\x22hljs-string\x22\x3e\x27promise\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.race([\n    timeout(\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e),\n    timeout(\x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e),\n    timeout(\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\n]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3evalues\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(values); [\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e]\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.timeEnd(\x3cspan class=\x22hljs-string\x22\x3e\x27promise\x27\x3c\/span\x3e);   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 107ms\x3c\/span\x3e\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 结果依次为\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 10\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 10\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ promise: 11.1ms\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 60\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 100\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e说明即使新对象的状态改变，数组中后面的promise对象还会执行完毕，其实\x3ccode\x3ePromise.all()\x3c\/code\x3e中即使前面\x3ccode\x3ereject\x3c\/code\x3e了，所有的对象也都会执行完毕。规范中，promise对象执行是不可以中断的。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e补充\x3c\/h1\x3e\n\x3cp\x3e\x3ccode\x3epromise\x3c\/code\x3e对象即使立马改变状态，它也是异步执行的。如下所示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.resolve(5).then(function(value){\n  console.log(\x27后打出来\x27, value)\n});\nconsole.log(\x27先打出来\x27)\n\n\/\/ 结果依次为\n\/\/ 先打出来\n\/\/ 后打出来 5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27后打出来\x27\x3c\/span\x3e, value)\n});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27先打出来\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 结果依次为\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 先打出来\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 后打出来 5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但还有一个有意思的例子，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22setTimeout(function(){console.log(4)},0);\nnew Promise(function(resolve){\n    console.log(1)\n    for( var i=0 ; i\x3c10000 ; i\x2b\x2b ){\n        i==9999 \x26amp;\x26amp; resolve()\n    }\n    console.log(2)\n}).then(function(){\n    console.log(5)\n});\nconsole.log(3);\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3esetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e)},\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e( \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ; i\x26lt;\x3cspan class=\x22hljs-number\x22\x3e10000\x3c\/span\x3e ; i\x2b\x2b ){\n        i==\x3cspan class=\x22hljs-number\x22\x3e9999\x3c\/span\x3e \x26amp;\x26amp; resolve()\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e)\n}).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e)\n});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e);\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e结果是 1 2 3 5 4，命名4是先添加到异步队列中的，为什么结果不是1 2 3 4 5呢？这个涉及到Event loop，后面我会单独讲一下。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>promise介绍&ndash;基础篇</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007678185">https://segmentfault.com/a/1190000007678185</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/xt33kqeaw6i/" target="_blank">https://alili.tech/archive/xt33kqeaw6i/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5fmk2pl6rab/">2016年前端开发者深度调研，看看别人使用什么技术体系<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/stp6408xnu/">Bootstrap使用模态框modal实现表单提交弹出框<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/fu7a86e9uyh/">CSS水平垂直居中总结<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/r0w29esklr/">JS 里怎么给数组填充默认值<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/i00hiszlr1/">JavaScript - EventEmitter 背后的秘密<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/u2la0cn9do/">JavaScript 精度丢失问题<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/3txhfn3ejcb/">Nodejs进阶：如何玩转子进程（child_process）<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/yr7v8e9fao/">Promise介绍--规范篇<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/9lyxyz4wc6g/">QQ音乐API整理<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/84zzlljmes4/">SegmentFault 技术周刊 Vol.14 - 进阶 Vue 2.0<aside class="dates">2019-01-30</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>