<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Angular 2 Change Detection - 1"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Angular 2 Change Detection - 1 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/2tnk4uccj5t/",
				"appid": "1613049289050283", 
				"title": "Angular 2 Change Detection - 1 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-18T02:30:35"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/4rbq2bsqelx/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/64q9xkchzh4/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f&text=Angular%202%20Change%20Detection%20-%201"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f&text=Angular%202%20Change%20Detection%20-%201"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f&title=Angular%202%20Change%20Detection%20-%201"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f&is_video=false&description=Angular%202%20Change%20Detection%20-%201"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Angular%202%20Change%20Detection%20-%201&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f&title=Angular%202%20Change%20Detection%20-%201"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f&title=Angular%202%20Change%20Detection%20-%201"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f&title=Angular%202%20Change%20Detection%20-%201"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f2tnk4uccj5t%2f&title=Angular%202%20Change%20Detection%20-%201"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Angular 2 Change Detection - 1</h1><div class="meta"><div class="postdate"><time datetime="2019-01-18" itemprop="datePublished">2019-01-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e阅读 Angular 6\/RxJS 最新教程，请访问\x3ca href=\x22http:\/\/www.semlinker.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e前端修仙之路\x3c\/a\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3eChange Detection (变化检测) 是 Angular 2 中最重要的一个特性。当组件中的数据发生变化的时候，Angular 2 能检测到数据变化并自动刷新视图反映出相应的变化。\x3c\/p\x3e\n\x3cp\x3e在介绍变化检测之前，我们要先介绍一下浏览器中渲染的概念，渲染是将模型映射到视图的过程。模型的值可以是 JavaScript 中的原始数据类型、对象、数组或其他数据对象。然而视图可以是页面中的段落、表单、按钮等其他元素，这些页面元素内部使用 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Document_Object_Model\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDOM\x3c\/a\x3e (Document Object Model) 来表示。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVKRzW?w=729\x26amp;h=207\x22 src=\x22https:\/\/static.alili.tech\/img\/bVKRzW?w=729\x26amp;h=207\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e为了更好地理解，我们来看一个具体的示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ch4 id=\x26quot;greeting\x26quot;\x3e\x3c\/h4\x3e\n\x3cscript\x3e\n    document.getElementById(\x26quot;greeting\x26quot;).innerHTML = \x26quot;Hello World!\x26quot;;\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh4\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22greeting\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh4\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22greeting\x22\x3c\/span\x3e).innerHTML = \x3cspan class=\x22hljs-string\x22\x3e\x22Hello World!\x22\x3c\/span\x3e;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个例子很简单，因为模型不会变化，所以页面只会渲染一次。如果数据模型在运行时会不断变化，那么整个过程将变得复杂。因此为了保证数据与视图的同步，页面将会进行多次渲染。接下来我们来考虑一下以下几个问题：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e什么时候模型会发生变化\x3c\/li\x3e\n\x3cli\x3e模型产生了什么变化\x3c\/li\x3e\n\x3cli\x3e变化后需要更新的视图区域在哪里\x3c\/li\x3e\n\x3cli\x3e怎么更新对应视图区域\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e而变化检测的基本目的就是解决上述问题。在 Angular 2 中当组件内的模型发生变化的时候，组件内的变化检测器就会检测到更新，然后通知视图刷新。因此变化检测器有两个主要的任务：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e检测模型的变化\x3c\/li\x3e\n\x3cli\x3e通知视图刷新\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e接下来我们来分析一下什么是变化，变化是怎么产生的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e变化和事件\x3c\/h3\x3e\n\x3cp\x3e变化是旧模型与新模型之间的区别，换句话说变化产生了一个新的模型。让我们来看一下下面的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { Component } from \x27@angular\/core\x27;\n\n@Component({\n  selector: \x27exe-counter\x27,\n  template: `\n  \x3cp\x3e当前值：\x22{{\x22 counter \x22}}\x22\x3c\/p\x3e\n  \x3cbutton (click)=\x26quot;countUp()\x26quot;\x3e \x2b \x3c\/button\x3e`\n})\nexport class CounterComponent {\n  counter = 0;\n\n  countUp() {\n    this.counter\x2b\x2b;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { Component } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@angular\/core\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-meta\x22\x3e@Component\x3c\/span\x3e({\n  selector: \x3cspan class=\x22hljs-string\x22\x3e\x27exe-counter\x27\x3c\/span\x3e,\n  template: \x3cspan class=\x22hljs-string\x22\x3e`\n  \x26lt;p\x26gt;当前值：\x22{{\x22 counter \x22}}\x22\x26lt;\/p\x26gt;\n  \x26lt;button (click)=\x22countUp()\x22\x26gt; \x2b \x26lt;\/button\x26gt;`\x3c\/span\x3e\n})\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e CounterComponent {\n  counter = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\n  countUp() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.counter\x2b\x2b;\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e页面首次渲染完后，计数器的当前值为0。当我们点击 \x3ccode\x3e\x2b\x3c\/code\x3e 按钮时，计数器的 counter 值将会自动加1，之后页面中当前值也会被更新。在这个例子中，点击事件引起了 counter 属性值的变化。\x3c\/p\x3e\n\x3cp\x3e我们继续看下一个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { Component, OnInit } from \x27@angular\/core\x27;\n\n@Component({\n  selector: \x27exe-counter\x27,\n  template: `\n    \x3cp\x3e当前值：\x22{{\x22 counter \x22}}\x22\x3c\/p\x3e\n  `\n})\nexport class CounterComponent implements OnInit {\n  counter = 0;\n\n  ngOnInit() {\n    setInterval(() =\x3e {\n      this.counter\x2b\x2b;\n    }, 1000);\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { Component, OnInit } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@angular\/core\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-meta\x22\x3e@Component\x3c\/span\x3e({\n  selector: \x3cspan class=\x22hljs-string\x22\x3e\x27exe-counter\x27\x3c\/span\x3e,\n  template: \x3cspan class=\x22hljs-string\x22\x3e`\n    \x26lt;p\x26gt;当前值：\x22{{\x22 counter \x22}}\x22\x26lt;\/p\x26gt;\n  `\x3c\/span\x3e\n})\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e CounterComponent \x3cspan class=\x22hljs-keyword\x22\x3eimplements\x3c\/span\x3e OnInit {\n  counter = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\n  ngOnInit() {\n    setInterval(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.counter\x2b\x2b;\n    }, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e该组件通过 \x3ccode\x3esetInterval\x3c\/code\x3e 定时器，实现每秒钟  \x3ccode\x3ecounter\x3c\/code\x3e  值自动加1。在这种情况下，它是定时器事件引起了属性值的变化。最后我们再来看个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { Component, OnInit } from \x27@angular\/core\x27;\nimport { Http } from \x27@angular\/http\x27;\n\n@Component({\n  selector: \x27exe-counter\x27,\n  template: `\n    \x3cp\x3e当前值：\x22{{\x22 counter \x22}}\x22\x3c\/p\x3e\n  `\n})\nexport class CounterComponent implements OnInit {\n  counter = 0;\n  constructor(private http: Http) {}\n\n  ngOnInit() {\n    this.http.get(\x27\/counter-data.json\x27)\n        .map(res =\x3e res.json())\n        .subscribe(data =\x3e {\n          this.counter = data.value;\n        });\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { Component, OnInit } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@angular\/core\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { Http } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27@angular\/http\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-meta\x22\x3e@Component\x3c\/span\x3e({\n  selector: \x3cspan class=\x22hljs-string\x22\x3e\x27exe-counter\x27\x3c\/span\x3e,\n  template: \x3cspan class=\x22hljs-string\x22\x3e`\n    \x26lt;p\x26gt;当前值：\x22{{\x22 counter \x22}}\x22\x26lt;\/p\x26gt;\n  `\x3c\/span\x3e\n})\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e CounterComponent \x3cspan class=\x22hljs-keyword\x22\x3eimplements\x3c\/span\x3e OnInit {\n  counter = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eprivate\x3c\/span\x3e http: Http\x3c\/span\x3e) {}\n\n  ngOnInit() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.http.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/counter-data.json\x27\x3c\/span\x3e)\n        .map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e res.json())\n        .subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.counter = data.value;\n        });\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e该组件在进行初始化的时候，会发送一个 \x3ccode\x3eHTTP\x3c\/code\x3e 请求去获取初始值。当请求成功返回的时候，组件的 counter 属性的值会被更新。在这种情况下，它是由 XHR 回调引起了属性值的变化。\x3c\/p\x3e\n\x3cp\x3e现在我们来总结一下，引起模型变化的三类事件源：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eEvents：click, mouseover, keyup ...\x3c\/li\x3e\n\x3cli\x3eTimers：setInterval、setTimeout\x3c\/li\x3e\n\x3cli\x3eXHRs：Ajax(GET、POST ...)\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这些事件源有一个共同的特性，即它们都是异步操作。那我们可以这样认为，所有的异步操作都有可能会引起模型的变化。\x3c\/p\x3e\n\x3cp\x3e非常好，你已经了解了引起模型变化的事件源和触发变化的时机点。但是你还不知道，是由谁来负责通知相应的变化给视图。接下来，我们将讨论一种允许 Angular 随时检测到变化的机制，它被称为 \x3ccode\x3eZone\x3c\/code\x3e 。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3eZones\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/domenic.github.io\/zones\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eZone\x3c\/a\x3e 是下一个 ECMAScript 规范的建议之一。Angular 团队实现了 JavaScript 版本的 \x3ca href=\x22https:\/\/github.com\/angular\/zone.js\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ezone.js\x3c\/a\x3e ，它是用于拦截和跟踪异步工作的机制。\x3c\/p\x3e\n\x3cp\x3eZone 是一个全局的对象，用来配置有关如何拦截和跟踪异步回调的规则。Zone 有以下能力：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e拦截异步任务调度\x3c\/li\x3e\n\x3cli\x3e提供了将数据附加到 zones 的方法\x3c\/li\x3e\n\x3cli\x3e为异常处理函数提供正确的上下文\x3c\/li\x3e\n\x3cli\x3e拦截阻塞的方法，如 alert、confirm 方法\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我们来看一个简单的示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Zone.current.fork({}).run(function () {\n    Zone.current.inTheZone = true;\n  \n    setTimeout(function () {\n        console.log(\x27in the zone: \x27 \x2b !!Zone.current.inTheZone); \n    }, 0);\n});\n\nconsole.log(\x27in the zone: \x27 \x2b !!Zone.current.inTheZone);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eZone.current.fork({}).run(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    Zone.current.inTheZone = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n  \n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27in the zone: \x27\x3c\/span\x3e \x2b !!Zone.current.inTheZone); \n    }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27in the zone: \x27\x3c\/span\x3e \x2b !!Zone.current.inTheZone);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以上代码运行后的结果是：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22in the zone: false\nin the zone: true\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode class=\x22shell\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e the \x3cspan class=\x22hljs-string\x22\x3ezone:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e the \x3cspan class=\x22hljs-string\x22\x3ezone:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e是不是感觉很神奇！在Angular 2 中，有一个 NgZone，它是专门为 Angular 2 定制的 zone。在正式介绍它之前，我们先来看一下 Angular 1.x 中的一个例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!DOCTYPE html\x3e\n\x3chtml\x3e\n\x3chead\x3e\n    \x3cmeta charset=\x26quot;UTF-8\x26quot;\x3e\n    \x3ctitle\x3eAngular 1.x Demo\x3c\/title\x3e\n    \x3cscript src=\x26quot;\/\/cdn.bootcss.com\/angular.js\/1.6.3\/angular.min.js\x26quot;\x3e\x3c\/script\x3e\n\x3c\/head\x3e\n\x3cbody ng-app=\x26quot;exeApp\x26quot;\x3e\n\x3cdiv ng-controller=\x26quot;MainCtrl\x26quot;\x3e\n    \x3ch4\x3eHello \x22{{\x22 name \x22}}\x22\x3c\/h4\x3e\n\x3c\/div\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    angular.module(\x27exeApp\x27, [])\n            .controller(\x27MainCtrl\x27, [\x27$scope\x27, function ($scope) {\n                $scope.name = \x27Angular\x27;\n\n                setTimeout(function () {\n                    $scope.name = \x27Angular 2\x27;\n                }, 2000);\n            }]);\n\x3c\/script\x3e\n\x3c\/body\x3e\n\x3c\/html\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22UTF-8\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eAngular 1.x Demo\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/\/cdn.bootcss.com\/angular.js\/1.6.3\/angular.min.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eng-app\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22exeApp\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eng-controller\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22MainCtrl\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh4\x3c\/span\x3e\x26gt;\x3c\/span\x3eHello \x22{{\x22 name \x22}}\x22\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh4\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n    angular.module(\x3cspan class=\x22hljs-string\x22\x3e\x27exeApp\x27\x3c\/span\x3e, [])\n            .controller(\x3cspan class=\x22hljs-string\x22\x3e\x27MainCtrl\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27$scope\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e($scope)\x3c\/span\x3e \x3c\/span\x3e{\n                $scope.name = \x3cspan class=\x22hljs-string\x22\x3e\x27Angular\x27\x3c\/span\x3e;\n\n                setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n                    $scope.name = \x3cspan class=\x22hljs-string\x22\x3e\x27Angular 2\x27\x3c\/span\x3e;\n                }, \x3cspan class=\x22hljs-number\x22\x3e2000\x3c\/span\x3e);\n            }]);\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以上代码运行后的输出结果：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVKRz7?w=1590\x26amp;h=424\x22 src=\x22https:\/\/static.alili.tech\/img\/bVKRz7?w=1590\x26amp;h=424\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e用过 Angular 1.x 的同学，应该很清楚可以通过 Angular 1.x 中的 \x3ccode\x3e$timeout\x3c\/code\x3e 服务或手动调用 \x3ccode\x3e$scope.$digest()\x3c\/code\x3e 方法来通知视图刷新。这对初学者来说，是很麻烦的一件事情。你们应该还记得前面计数器组件的例子，我们通过 \x3ccode\x3esetInterval\x3c\/code\x3e 定时器，实现每秒钟  \x3ccode\x3ecounter\x3c\/code\x3e  值自动加1，页面就自动刷新了。不需要再使用 Angular 1.x 中的 \x3ccode\x3e$timeout\x3c\/code\x3e 服务或手动调用 \x3ccode\x3e$scope.$digest()\x3c\/code\x3e 方法来刷新视图。\x3c\/p\x3e\n\x3cp\x3e为什么我们都是使用定时器，而在 Angular 2 中模型发生变化后，却能自动通知视图进行刷新呢 ？我们来分析一下，首先在浏览器中新开一个 Tab 页，在控制台输入：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.setTimeout.toString() \n\x26quot;function setTimeout() { [native code] }\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.setTimeout.toString() \n\x3cspan class=\x22hljs-string\x22\x3e\x22function setTimeout() { [native code] }\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后再打开一个 Angular 2 应用的页面，在控制台同样输入：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.setTimeout.toString()\n\x26quot;function setTimeout(){return f(this, arguments)}\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.setTimeout.toString()\n\x3cspan class=\x22hljs-string\x22\x3e\x22function setTimeout(){return f(this, arguments)}\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们发现在 Angular 2 中，setTimeout 方法已经被重写了，最简单的实现方式如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var originSetTimeout = window.setTimeout;\nwindow.setTimeout = function(fn, delay) {\n  console.log(\x27setTimeout has been called\x27);\n  originSetTimeout(fn, delay); \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e originSetTimeout = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.setTimeout;\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.setTimeout = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3efn, delay\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27setTimeout has been called\x27\x3c\/span\x3e);\n  originSetTimeout(fn, delay); \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其实在 Angular 2 应用程序启动之前，Zone 采用猴子补丁 (Monkey-patched) 的方式，将 JavaScript 中的异步任务都进行了包装，这使得这些异步任务都能运行在 Zone 的执行上下文中，每个异步任务在 Zone 中都是一个任务，除了提供了一些供开发者使用的钩子外，默认情况下 Zone 重写了以下方法：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3esetInterval、clearInterval、setTimeout、clearTimeout\x3c\/li\x3e\n\x3cli\x3ealert、prompt、confirm\x3c\/li\x3e\n\x3cli\x3erequestAnimationFrame、cancelAnimationFrame\x3c\/li\x3e\n\x3cli\x3eaddEventListener、removeEventListener\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3eZone 内部源码片段：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var set = \x27set\x27;\nvar clear = \x27clear\x27;\nvar blockingMethods = [\x27alert\x27, \x27prompt\x27, \x27confirm\x27];\nvar _global = typeof window === \x27object\x27 \x26amp;\x26amp; window || \n     typeof self === \x27object\x27 \x26amp;\x26amp; self || global;\npatchTimer(_global, set, clear, \x27Timeout\x27);\npatchTimer(_global, set, clear, \x27Interval\x27);\npatchTimer(_global, set, clear, \x27Immediate\x27);\npatchTimer(_global, \x27request\x27, \x27cancel\x27, \x27AnimationFrame\x27);\npatchTimer(_global, \x27mozRequest\x27, \x27mozCancel\x27, \x27AnimationFrame\x27);\npatchTimer(_global, \x27webkitRequest\x27, \x27webkitCancel\x27, \x27AnimationFrame\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e set = \x3cspan class=\x22hljs-string\x22\x3e\x27set\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e clear = \x3cspan class=\x22hljs-string\x22\x3e\x27clear\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e blockingMethods = [\x3cspan class=\x22hljs-string\x22\x3e\x27alert\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27prompt\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27confirm\x27\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _global = \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e || \n     \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e self === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e \x26amp;\x26amp; self || global;\npatchTimer(_global, set, clear, \x3cspan class=\x22hljs-string\x22\x3e\x27Timeout\x27\x3c\/span\x3e);\npatchTimer(_global, set, clear, \x3cspan class=\x22hljs-string\x22\x3e\x27Interval\x27\x3c\/span\x3e);\npatchTimer(_global, set, clear, \x3cspan class=\x22hljs-string\x22\x3e\x27Immediate\x27\x3c\/span\x3e);\npatchTimer(_global, \x3cspan class=\x22hljs-string\x22\x3e\x27request\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27cancel\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27AnimationFrame\x27\x3c\/span\x3e);\npatchTimer(_global, \x3cspan class=\x22hljs-string\x22\x3e\x27mozRequest\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27mozCancel\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27AnimationFrame\x27\x3c\/span\x3e);\npatchTimer(_global, \x3cspan class=\x22hljs-string\x22\x3e\x27webkitRequest\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27webkitCancel\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27AnimationFrame\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3eNgZone\x3c\/h3\x3e\n\x3cp\x3eNgZone 是基于 Zone 实现的，它是Zone派生出来的一个子Zone，在 Angular 环境内注册的异步事件都运行在这个子 Zone 内 (因为NgZone拥有整个运行环境的执行上下文)，它扩展了自有的一些 API 并添加了一些功能性的方法到它的执行上下文中。\x3c\/p\x3e\n\x3cp\x3e在 Angular 源码中，有一个 \x3ccode\x3eApplicationRef_\x3c\/code\x3e 类，其作用是用来监听 NgZone 中的 \x3ccode\x3eonMicrotaskEmpty\x3c\/code\x3e 事件，无论何时只要触发这个事件，那么将会执行一个 \x3ccode\x3etick\x3c\/code\x3e 方法用来告诉 Angular 去执行变化检测，简化版的代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22class ApplicationRef { \n  private _views: InternalViewRef[] = [];\n\n  constructor(private zone: NgZone) {\n        this.zone.onMicrotaskEmpty.subscribe(() =\x3e {\n            this.zone.run(() =\x3e { \n              this.tick();\n            }); \n        });\n  }\n  \n  tick() { \n    if (this._runningTick) {\n      throw new Error(\x27ApplicationRef.tick is called recursively\x27);\n    }\n    this._views.forEach((view) =\x3e view.detectChanges());\n   }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22typescript hljs\x22\x3e\x3ccode class=\x22typescript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e ApplicationRef { \n  \x3cspan class=\x22hljs-keyword\x22\x3eprivate\x3c\/span\x3e _views: InternalViewRef[] = [];\n\n  \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eprivate\x3c\/span\x3e zone: NgZone\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.zone.onMicrotaskEmpty.subscribe(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.zone.run(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e { \n              \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.tick();\n            }); \n        });\n  }\n  \n  tick() { \n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._runningTick) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eError\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27ApplicationRef.tick is called recursively\x27\x3c\/span\x3e);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._views.forEach(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eview\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e view.detectChanges());\n   }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在我们先来总结一下前面所讲的内容：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e异步操作被安排为任务\x3c\/li\x3e\n\x3cli\x3eZones 跟踪任务的执行\x3c\/li\x3e\n\x3cli\x3eAngular 处理由执行异步操作引起的事件\x3c\/li\x3e\n\x3cli\x3eAngular 对所有组件执行变化检测，若发生变化则更新视图\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e要完全理解 Zone 的工作原理是比较困难的，对我们大部分的人来说，只要知道 Angular 内部是通过它来跟踪异步任务，然后执行变化检测任务就可以了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e我有话说\x3c\/h3\x3e\n\x3cp\x3e1.在 Angular 2 项目中怎么访问 Zone 打补丁前的方法，如 setTimeout、clearTimeout 等\x3c\/p\x3e\n\x3cp\x3e因为 Zone 内部通过内建的 \x3ccode\x3e__symbol__\x3c\/code\x3e 函数来模拟 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Symbol\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSymbol\x3c\/a\x3e ：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function __symbol__(name) {\n  return \x27__zone_symbol__\x27 \x2b name;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e__symbol__\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27__zone_symbol__\x27\x3c\/span\x3e \x2b name;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e因此我们可以在浏览器的控制台中运行：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Object.keys(window).forEach((key) =\x3e {\n if(key.indexOf(\x27zone_symbol\x27) \x3e 0) {\n    console.log(key);\n }  \n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.keys(\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e).forEach(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3ekey\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(key.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27zone_symbol\x27\x3c\/span\x3e) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(key);\n }  \n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行后控制台的输出结果如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVKRIm?w=1032\x26amp;h=568\x22 src=\x22https:\/\/static.alili.tech\/img\/bVKRIm?w=1032\x26amp;h=568\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e2.前面介绍 Zone 使用的示例，为什么控制台会输出那样的结果 ？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 加载Zone.js给浏览器中的一些异步操作打上补丁\n\/\/ 创建Root Zone\n\/\/ 调用Zone.current对象上的fork方法创建新的zone，我们称之为childZone\nZone.current.fork({}).run(function () { \n      \/\/ 运行run方法，Zone.current被设置为函数被执行时所属的Zone，即childZone\n    Zone.current.inTheZone = true;\n  \n      \/\/ 这里注册了一个定时器。由于被打过了猴子补丁，这里调用的并不是\n    \/\/ 浏览器\x26quot;默认\x26quot;的setTimeout方法。因此，这里实际上是在配置代理。这里\n    \/\/ 要重点指出的是这个代理会保留一个指向创建时所属Zone的引用即childZone，\n    \/\/ 稍后会用到这个引用。\n    setTimeout(function () {\n        \/\/ 定时时间到，此时的Zone.current的值会被重置为childZone\n        console.log(\x27in the zone: \x27 \x2b !!Zone.current.inTheZone); \n    }, 0);\n  \n      \/\/ 代码执行完 Zone.current属性被重置为Root Zone\n    \/\/ Zone的生命周期里的钩子函数会被触发\n});\n\nconsole.log(\x27in the zone: \x27 \x2b !!Zone.current.inTheZone);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 加载Zone.js给浏览器中的一些异步操作打上补丁\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建Root Zone\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用Zone.current对象上的fork方法创建新的zone，我们称之为childZone\x3c\/span\x3e\nZone.current.fork({}).run(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 运行run方法，Zone.current被设置为函数被执行时所属的Zone，即childZone\x3c\/span\x3e\n    Zone.current.inTheZone = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n  \n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里注册了一个定时器。由于被打过了猴子补丁，这里调用的并不是\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 浏览器\x22默认\x22的setTimeout方法。因此，这里实际上是在配置代理。这里\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 要重点指出的是这个代理会保留一个指向创建时所属Zone的引用即childZone，\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 稍后会用到这个引用。\x3c\/span\x3e\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 定时时间到，此时的Zone.current的值会被重置为childZone\x3c\/span\x3e\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27in the zone: \x27\x3c\/span\x3e \x2b !!Zone.current.inTheZone); \n    }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n  \n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 代码执行完 Zone.current属性被重置为Root Zone\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Zone的生命周期里的钩子函数会被触发\x3c\/span\x3e\n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27in the zone: \x27\x3c\/span\x3e \x2b !!Zone.current.inTheZone);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果还是不好理解的话，我们可以想象一下同步的过程：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const rootZone = Zone.current;\n\/\/ 创建一个新的Zone\nconst childZone = Zone.current.fork({});\n\/\/ 设置当前的zone\nZone.current = zone;\n\/\/ 为当前的zone添加inTheZone属性\nZone.current.inTheZone = true;\nconsole.log(\x27in the zone: \x27 \x2b !!Zone.current.inTheZone);\n\/\/ 退出当前的zone\nZone.current = rootZone;\nconsole.log(\x27in the zone: \x27 \x2b !!Zone.current.inTheZone);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e rootZone = Zone.current;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建一个新的Zone\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e childZone = Zone.current.fork({});\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置当前的zone\x3c\/span\x3e\nZone.current = zone;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 为当前的zone添加inTheZone属性\x3c\/span\x3e\nZone.current.inTheZone = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27in the zone: \x27\x3c\/span\x3e \x2b !!Zone.current.inTheZone);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 退出当前的zone\x3c\/span\x3e\nZone.current = rootZone;\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27in the zone: \x27\x3c\/span\x3e \x2b !!Zone.current.inTheZone);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e总结\x3c\/h3\x3e\n\x3cp\x3e这篇文章我们先介绍了浏览器中渲染的概念，然后通过三个示例引出了引起模型变化的事件源并总结了它们之间的共性，此外我们还介绍了 Angular 1.x 项目中初学者容易遇到的问题，并基于该问题引入了 Zone 和 NgZone 的概念，最后我们简单介绍了 Zone.js 的内部工作原理。下一篇文章我们将详细介绍 Angular 2 组件中的变化检测器。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Angular 2 Change Detection - 1</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008747225">https://segmentfault.com/a/1190000008747225</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/2tnk4uccj5t/" target="_blank">https://alili.tech/archive/2tnk4uccj5t/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/t61hviqrk8g/">1-vuejs2.0实战：仿豆瓣app项目，创建自定义组件tabbar<aside class="dates">2019-01-26</aside></a></li><li><a href="/archive/zsxxn0n7jj/">2-vuejs2.0实战：仿豆瓣app项目，创建组件header,tabbar路由跳转<aside class="dates">2019-01-26</aside></a></li><li><a href="/archive/4ns5cwxsi05/">40 行代码内实现一个 React.js<aside class="dates">2019-01-26</aside></a></li><li><a href="/archive/imbao5um82/">50行代码搞定无限滑动幻灯片<aside class="dates">2019-01-26</aside></a></li><li><a href="/archive/kfss2f33qsh/">CSS效果篇--CSS3实现5种预载动画效果<aside class="dates">2019-01-26</aside></a></li><li><a href="/archive/4tsylfrtz8w/">ES6—类的实现原理<aside class="dates">2019-01-26</aside></a></li><li><a href="/archive/mzd8glfuhd/">H5实例教学--从AnimateCC到CreateJS入门<aside class="dates">2019-01-26</aside></a></li><li><a href="/archive/xhjgf527wvr/">H5实例教学--微信内嵌视频1（案例浅析）<aside class="dates">2019-01-26</aside></a></li><li><a href="/archive/0hqst6af5tx/">HTML&#43;CSS&#43;JAVASCRIPT 高仿低配网页版网易云音乐播放器<aside class="dates">2019-01-26</aside></a></li><li><a href="/archive/14vf08gpmnw/">HTTP验证大法(Basic Auth,Session, JWT, Oauth, Openid)<aside class="dates">2019-01-26</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>