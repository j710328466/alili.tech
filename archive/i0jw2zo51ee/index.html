<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="HTML5 活动宣传页「My Flyme 独家记忆」开发实践总结"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>HTML5 活动宣传页「My Flyme 独家记忆」开发实践总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/i0jw2zo51ee/",
				"appid": "1613049289050283", 
				"title": "HTML5 活动宣传页「My Flyme 独家记忆」开发实践总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-27T02:30:59"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/1k98mcmz3w3/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/f016r7l4fv/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f&text=HTML5%20%e6%b4%bb%e5%8a%a8%e5%ae%a3%e4%bc%a0%e9%a1%b5%e3%80%8cMy%20Flyme%20%e7%8b%ac%e5%ae%b6%e8%ae%b0%e5%bf%86%e3%80%8d%e5%bc%80%e5%8f%91%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f&text=HTML5%20%e6%b4%bb%e5%8a%a8%e5%ae%a3%e4%bc%a0%e9%a1%b5%e3%80%8cMy%20Flyme%20%e7%8b%ac%e5%ae%b6%e8%ae%b0%e5%bf%86%e3%80%8d%e5%bc%80%e5%8f%91%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f&title=HTML5%20%e6%b4%bb%e5%8a%a8%e5%ae%a3%e4%bc%a0%e9%a1%b5%e3%80%8cMy%20Flyme%20%e7%8b%ac%e5%ae%b6%e8%ae%b0%e5%bf%86%e3%80%8d%e5%bc%80%e5%8f%91%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f&is_video=false&description=HTML5%20%e6%b4%bb%e5%8a%a8%e5%ae%a3%e4%bc%a0%e9%a1%b5%e3%80%8cMy%20Flyme%20%e7%8b%ac%e5%ae%b6%e8%ae%b0%e5%bf%86%e3%80%8d%e5%bc%80%e5%8f%91%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=HTML5%20%e6%b4%bb%e5%8a%a8%e5%ae%a3%e4%bc%a0%e9%a1%b5%e3%80%8cMy%20Flyme%20%e7%8b%ac%e5%ae%b6%e8%ae%b0%e5%bf%86%e3%80%8d%e5%bc%80%e5%8f%91%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f&title=HTML5%20%e6%b4%bb%e5%8a%a8%e5%ae%a3%e4%bc%a0%e9%a1%b5%e3%80%8cMy%20Flyme%20%e7%8b%ac%e5%ae%b6%e8%ae%b0%e5%bf%86%e3%80%8d%e5%bc%80%e5%8f%91%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f&title=HTML5%20%e6%b4%bb%e5%8a%a8%e5%ae%a3%e4%bc%a0%e9%a1%b5%e3%80%8cMy%20Flyme%20%e7%8b%ac%e5%ae%b6%e8%ae%b0%e5%bf%86%e3%80%8d%e5%bc%80%e5%8f%91%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f&title=HTML5%20%e6%b4%bb%e5%8a%a8%e5%ae%a3%e4%bc%a0%e9%a1%b5%e3%80%8cMy%20Flyme%20%e7%8b%ac%e5%ae%b6%e8%ae%b0%e5%bf%86%e3%80%8d%e5%bc%80%e5%8f%91%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fi0jw2zo51ee%2f&title=HTML5%20%e6%b4%bb%e5%8a%a8%e5%ae%a3%e4%bc%a0%e9%a1%b5%e3%80%8cMy%20Flyme%20%e7%8b%ac%e5%ae%b6%e8%ae%b0%e5%bf%86%e3%80%8d%e5%bc%80%e5%8f%91%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">HTML5 活动宣传页「My Flyme 独家记忆」开发实践总结</h1><div class="meta"><div class="postdate"><time datetime="2019-01-27" itemprop="datePublished">2019-01-27</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e年前放假的最后一天，我们上线了「My Flyme 独家记忆」 H5 活动宣传页。\x3c\/p\x3e\n\x3cp\x3e因种种原因，直到放假前几天，才突然要求我们参与并开始项目的前端部分。此时大概的情况是：所有数据已计算完毕；后端接口已完成待联调；交互视觉只出了不到四分之一(一共二十多个页面)；我们平时以中后台项目为主，这种活动页从未涉及。我们真正介入时距离上线时间点只有四天，在这种背景下，已经谈不上探讨什么样的技术选型最佳，只能是越快越容易实现越好。于是拉上了所有用得上的前端成员一起努力，最终算是在要求时间点上实现了上线目标。\x3c\/p\x3e\n\x3cp\x3e这种活动宣传性质的页面虽然用不上太复杂的逻辑，但也有很多后台项目涉及不到的细节，让我们踩了不少的坑。这里针对项目开发过程中涉及的一些主要技术点作一下总结回顾。\x3c\/p\x3e\n\x3cp\x3e「My Flyme 独家记忆」(DEMO, 数据为随机制造)：\x3ca href=\x22https:\/\/lzw.me\/pages\/demo\/myflyme\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/lzw.me\/pages\/demo\/myf...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVIZaE?w=512\x26amp;h=512\x22 src=\x22https:\/\/static.alili.tech\/img\/bVIZaE?w=512\x26amp;h=512\x22 alt=\x22share.jpg\x22 title=\x22share.jpg\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e1 项目特点\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e多页滑动效果，页面多，动画元素细节多，动画效果简单\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e个人页(主页面)需 Flyme 账号登录，自有应用内要尽量实现免登录\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e将会在魅族主流应用和社区里推广\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可分享到微信、微博等主流社交媒体\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e2 Slider 实现\x3c\/h2\x3e\n\x3cp\x3e多页翻屏滑动的效果有很多开源的实现，当然希望尽量的简单自己实现也不是很复杂。我们选择的是百度开源的 \x3ca href=\x22http:\/\/be-fe.github.io\/iSlider\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eiSlider\x3c\/a\x3e，iSlider 是一款非常优秀的翻页滑动组件。除此之外，还有很多成熟的开源实现可选用：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eswiper \x3ca href=\x22http:\/\/www.swiper.com.cn\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.swiper.com.cn\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eiscroll \x3ca href=\x22https:\/\/github.com\/cubiq\/iscroll\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/cubiq\/iscroll\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3efullpage.js \x3ca href=\x22https:\/\/github.com\/alvarotrigo\/fullPage.js\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/alvarotrigo\/fullPage.js\/\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eScrollify \x3ca href=\x22https:\/\/github.com\/lukehaas\/Scrollify\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/lukehaas\/Scrollify\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eonepage-scroll \x3ca href=\x22https:\/\/github.com\/peachananr\/onepage-scroll\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/peachananr\/onepage-scroll\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e3 移动屏幕适配\x3c\/h2\x3e\n\x3cp\x3e移动端屏幕适配常用的方案有如下三种：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e固定高度，宽度自适应\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e固定宽度\/高度，viewport 缩放\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3erem 做宽度，viewport 缩放\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e3.1 高度优先、viewport 等比缩放适配方案\x3c\/h3\x3e\n\x3cp\x3e因为涉及多页大量的动画元素，只能是绝对定位来快速布局，我们采取了第二种方案：页面以 \x3ccode\x3e320x640\x3c\/code\x3e 作为基础大小布局，在移动端根据实际的页面大小等比缩放。主要适配代码参考：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x2bfunction () {\n    function isMobile() {\n        return \/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobi\/i.test(navigator.userAgent);\n    }\n\n    function setScale() {\n        var pageScale = 1;\n\n        if (window.top !== window) {\n            return pageScale;\n        }\n\n        var width = document.documentElement.clientWidth || 360;\n        var height = document.documentElement.clientHeight || 640;\n        if (width \/ height \x3e= 360 \/ 640) {\n            \/\/ 高度优先\n            pageScale = height \/ 640;\n        } else {\n            pageScale = width \/ 360;\n        }\n\n        var content = \x27width=\x27 \x2b 360 \x2b \x27, initial-scale=\x27 \x2b pageScale \n          \x2b \x27, maximum-scale=\x27 \x2b pageScale \x2b \x27, user-scalable=no\x27;\n        document.getElementById(\x27viewport\x27).setAttribute(\x27content\x27, content);\n\n        return pageScale;\n    }\n\n    if (isMobile()) {\n        setScale();\n    } else {\n        try {\n            document.getElementsByTagName(\x27html\x27)[0].classList.add(\x27pc\x27);\n        } catch (e) {}\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x2b\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eisMobile\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-regexp\x22\x3e\/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobi\/i\x3c\/span\x3e.test(navigator.userAgent);\n    }\n\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esetScale\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e pageScale = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.top !== \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e pageScale;\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e width = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.documentElement.clientWidth || \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e height = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.documentElement.clientHeight || \x3cspan class=\x22hljs-number\x22\x3e640\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (width \/ height \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e640\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 高度优先\x3c\/span\x3e\n            pageScale = height \/ \x3cspan class=\x22hljs-number\x22\x3e640\x3c\/span\x3e;\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            pageScale = width \/ \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e;\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e content = \x3cspan class=\x22hljs-string\x22\x3e\x27width=\x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27, initial-scale=\x27\x3c\/span\x3e \x2b pageScale \n          \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27, maximum-scale=\x27\x3c\/span\x3e \x2b pageScale \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27, user-scalable=no\x27\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27viewport\x27\x3c\/span\x3e).setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x27content\x27\x3c\/span\x3e, content);\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e pageScale;\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isMobile()) {\n        setScale();\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByTagName(\x3cspan class=\x22hljs-string\x22\x3e\x27html\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].classList.add(\x3cspan class=\x22hljs-string\x22\x3e\x27pc\x27\x3c\/span\x3e);\n        } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {}\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这种方案以高度优先，以使得全部内容都能够出现在可视区域。但有一个问题是，在 webview 内宽高比大于 9\/16，于是实际采用了高度的比例缩放，基础宽度缩放后会小于屏幕宽度，由于涉及动画的元素采用了绝对定位，这导致这些元素显示上偏左，右边出现较多的空白。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e3.2 绝对定位元素的微调方法\x3c\/h3\x3e\n\x3cp\x3e对于这种问题，我们的@零零柒同学想到了一种简单快速的解决方案：取得基础宽度与真实宽度的缩放比，将所有绝对定位的元素按照该缩放比重新计算 \x3ccode\x3eleft\x3c\/code\x3e 位移。主要代码参考：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import $ from \x27.\/libs\/zepto\x27;\n\nconst width = document.documentElement.clientWidth || 360;\nconst height = document.documentElement.clientHeight || 640;\nlet pageScale = 1;\n\nif (width \/ height \x3e= 360 \/ 640) {\n    pageScale = height \/ 640;\n}\n\nconst offset = (width - pageScale * 360) \/ 2;\n\/\/ 每当页面切换后调用\nexport function positionFix(dom) {\n    if (pageScale === 1 || !offset) {\n        return;\n    }\n\n    \/\/ 为一个页面\n    const $dom = $(dom);\n\n    if ($dom.hasClass(\x27position-fixed\x27)) {\n        return;\n    }\n\n    $dom.find(\x27.text-box i, img\x27).forEach((dom, i) =\x3e {\n        let $this = $(dom),\n            left;\n\n        \/\/ 只修改绝对定位的元素\n        if ($this.css(\x27position\x27) !== \x27absolute\x27) {\n            return;\n        }\n\n        left = \x2b($this.css(\x27left\x27).replace(\x27px\x27, \x27\x27));\n\n        $this.css(\x27left\x27, (left \x2b offset) \x2b \x27px\x27);\n        \/\/ console.log($(dom).css(\x27left\x27));\n    });\n\n    $dom.addClass(\x27position-fixed\x27);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e $ \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/libs\/zepto\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e width = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.documentElement.clientWidth || \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e height = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.documentElement.clientHeight || \x3cspan class=\x22hljs-number\x22\x3e640\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e pageScale = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (width \/ height \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e \/ \x3cspan class=\x22hljs-number\x22\x3e640\x3c\/span\x3e) {\n    pageScale = height \/ \x3cspan class=\x22hljs-number\x22\x3e640\x3c\/span\x3e;\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e offset = (width - pageScale * \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e) \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 每当页面切换后调用\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3epositionFix\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edom\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (pageScale === \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e || !offset) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 为一个页面\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e $dom = $(dom);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ($dom.hasClass(\x3cspan class=\x22hljs-string\x22\x3e\x27position-fixed\x27\x3c\/span\x3e)) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n    }\n\n    $dom.find(\x3cspan class=\x22hljs-string\x22\x3e\x27.text-box i, img\x27\x3c\/span\x3e).forEach(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edom, i\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e = $(dom),\n            left;\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 只修改绝对定位的元素\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ($\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.css(\x3cspan class=\x22hljs-string\x22\x3e\x27position\x27\x3c\/span\x3e) !== \x3cspan class=\x22hljs-string\x22\x3e\x27absolute\x27\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n        }\n\n        left = \x2b($\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.css(\x3cspan class=\x22hljs-string\x22\x3e\x27left\x27\x3c\/span\x3e).replace(\x3cspan class=\x22hljs-string\x22\x3e\x27px\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e));\n\n        $\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.css(\x3cspan class=\x22hljs-string\x22\x3e\x27left\x27\x3c\/span\x3e, (left \x2b offset) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27px\x27\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ console.log($(dom).css(\x27left\x27));\x3c\/span\x3e\n    });\n\n    $dom.addClass(\x3cspan class=\x22hljs-string\x22\x3e\x27position-fixed\x27\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e3.3 设计稿图片等比缩放方法\x3c\/h3\x3e\n\x3cp\x3e页面缩放解决了不同屏幕大小的布局一致性。另外涉及的一个问题是，设计稿图片大小如何进行等比缩放？\x3c\/p\x3e\n\x3cp\x3e这个问题也很简单，图片引用直接设置 width 以缩放到合适大小；雪碧图上的图片则按照 360x640 的页面大小进行缩放：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e对于绝对定位的元素，使用 \x3ccode\x3etransform: scale(0.333)\x3c\/code\x3e 进行变换缩放\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e对于流式布局的元素，使用 \x3ccode\x3ezomm(0.333)\x3c\/code\x3e 进行缩放\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e3.4 快速布局方法\x3c\/h3\x3e\n\x3cp\x3e还有一个值得一提的问题是，如何做到布局元素与设计稿完全一致？\x3c\/p\x3e\n\x3cp\x3e这个问题的解决方法是：使用静态的设计稿图片作为全屏背景，通过调整各元素到对应位置，从而实现快速定位。我们的一位同学给出了这个方法，并且给出了一个让页面元素可拖动并设置最终位置(left\/right值)的 jQuery 插件，这使得我们的页面布局变得简单而高效。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e4 HTML5 动画实现\x3c\/h2\x3e\n\x3cp\x3e动画实现方案一般来说可以选择CSS3 动画、引入游戏引擎或使用 svg\/canvas。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e4.1 CSS3 动画\x3c\/h3\x3e\n\x3cp\x3e该方案技术成本简单，任何前端开发者都能快速上手，但细节实现上工作量大。\x3c\/p\x3e\n\x3cp\x3e从简单快速开始的角度来说，CSS3 动画是我们的唯一选择。使用 CSS3 动画需要特别注意一点：修改 DOM 会导致页面重绘，在移动端容易出现卡顿现象。所以应尽可能避免使用会修改 DOM 的 css 属性，只使用 \x3ccode\x3etransform\x3c\/code\x3e 实现动画变换效果。\x3c\/p\x3e\n\x3cp\x3e我们的页面动画都是循环运动的，全部需要对照动效设计逐一还原实现，花费了大量的人力和时间成本。实现上主要使用了 \x3ccode\x3eanimation\x3c\/code\x3e、\x3ccode\x3ekeyframe\x3c\/code\x3e、\x3ccode\x3etransform\x3c\/code\x3e 属性。\x3c\/p\x3e\n\x3cp\x3e此外，对于常见的入场显示\/滑入等动画效果，只需要使用 \x3ccode\x3etransform\x3c\/code\x3e 和 \x3ccode\x3etransition\x3c\/code\x3e 即可实现需求。对于 css 动画也有很多优秀而成熟的动画库可用，一些参考：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eanimate.css \x3ca href=\x22https:\/\/github.com\/daneden\/animate.css\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/daneden\/animate.css\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emagic.css \x3ca href=\x22https:\/\/github.com\/miniMAC\/magic\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/miniMAC\/magic\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eHover.css \x3ca href=\x22http:\/\/ianlunn.github.io\/Hover\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/ianlunn.github.io\/Hover\/\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evelocity.js \x3ca href=\x22https:\/\/github.com\/julianshapiro\/velocity\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/julianshapiro\/velocity\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eanime.js \x3ca href=\x22https:\/\/github.com\/juliangarnier\/anime\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/juliangarnier\/anime\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e下面简单介绍一下另外的两种动画实现方案。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e4.2 引入游戏引擎方案\x3c\/h3\x3e\n\x3cp\x3e使用 h5 游戏引擎可大幅度降低工作量，能够相对容易地实现复杂动画效果，但需要经验避免入深坑，有较高学习成本，并且需要设计师深度配合。一些参考：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eHilo \x3ca href=\x22https:\/\/github.com\/hiloteam\/Hilo\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/hiloteam\/Hilo\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ePhaser \x3ca href=\x22https:\/\/github.com\/photonstorm\/phaser\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/photonstorm\/phaser\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3epixi.js \x3ca href=\x22https:\/\/github.com\/pixijs\/pixi.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/pixijs\/pixi.js\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emelonjs \x3ca href=\x22https:\/\/github.com\/melonjs\/melonjs\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/melonjs\/melonjs\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eplaycanvas \x3ca href=\x22https:\/\/github.com\/playcanvas\/engine\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/playcanvas\/engine\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eLayaAir \x3ca href=\x22http:\/\/www.layabox.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.layabox.com\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e白鹭引擎 \x3ca href=\x22https:\/\/www.egret.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.egret.com\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e4.3 使用 \x3ccode\x3esvg\/canvas\x3c\/code\x3e 操作库\x3c\/h3\x3e\n\x3cp\x3e使用 \x3ccode\x3esvg\/canvas\/webGL\x3c\/code\x3e 实现的动画效果会比较好，但实现工作量较大，对实践经验也有较高的要求。成熟的相关库参考：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3ecreateJs \x3ca href=\x22https:\/\/github.com\/CreateJS\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/CreateJS\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3esnap.svg \x3ca href=\x22https:\/\/github.com\/adobe-webplatform\/Snap.svg\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/adobe-webplatform\/Snap.svg\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3esvg.js \x3ca href=\x22https:\/\/github.com\/svgdotjs\/svg.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/svgdotjs\/svg.js\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ed3.js \x3ca href=\x22https:\/\/d3js.org\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/d3js.org\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ethrees.js \x3ca href=\x22https:\/\/threejs.org\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/threejs.org\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e5 微信分享\x3c\/h2\x3e\n\x3cp\x3e由于第一次做这种活动页，没有特别注意到微信内分享的问题，直到上线时才发现，分享出去的效果实在太难看，这导致几位留守到最后的同事紧急探讨协调方案，几乎整晚没睡觉。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e5.1 微信 jssdk 分享 API\x3c\/h3\x3e\n\x3cp\x3e微信内开发应注意这几点：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e下载微信开发者工具（或 TBS Studio），以调试微信内页面\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e需要通过认证的公众号或订阅号，取得微信 jssdk 分享接口所需的 appId 和 signature\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e需要后端 API 管理 signature 签名的生成与缓存\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ewindow.history.pushState\/replaceState\x3c\/code\x3e 修改了 URL 时需要重新生成 signature 签名。由于没有仔细阅读文档并意识到这一点，在这个问题上坑了比较多的时间。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我们最终协调到一个部门的订阅号，并使用他们已实现了的后端 token 签名生成 API 来实现 jssdk 的分享 API，在 nginx 层对该 API 代理转发解决跨域安全性相关问题。微信分享主要代码参考：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const isWeixinBrowser = \/micromessenger\/.test(navigator.userAgent.toLowerCase());\nconst wxJsdk = \x27\/\/res.wx.qq.com\/open\/js\/jweixin-1.1.0.js\x27;\nconst jsApiList = [\x27checkJsApi\x27, \x27onMenuShareTimeline\x27, \x27onMenuShareAppMessage\x27, \x27onMenuShareQQ\x27, \x27onMenuShareWeibo\x27];\nlet opts = {\n    title: \x27My Flyme 独家记忆\x27,\n    desc: \x27当时光凝固，当回忆定格。回首2016 ，我与 Flyme 的点点滴滴都在这里。这是属于我和 Flyme 的独家记忆。\x27,\n    link: \x27\x27,\n    imgUrl: \x27\x27\n}, loadedwx = false;\n\nfunction initShareEvent(wx) {\n    const option = {\n        ...opts,\n        trigger: function (res) {console.log(\x27trigger\x27, res)},\n        success: function (res) { console.log(\x27已分享\x27, res) },\n        cancel: function (res) { console.log(\x27已取消\x27, res) },\n        fail: function (res) { console.log(JSON.stringify(res)) } \n    };\n\n    wx.onMenuShareAppMessage(option); \/\/ 分享给朋友\n    wx.onMenuShareTimeline(option);   \/\/ 分享到朋友圈\n    wx.onMenuShareQQ(option);         \/\/ 分享到QQ\n    wx.onMenuShareWeibo(option);      \/\/ 分享到微博\n    wx.onMenuShareQZone(option);      \/\/ 分享到QZone\n}\nfunction checkJsApi(wx) {\n    wx.checkJsApi({\n        jsApiList,\n        success: () =\x3e initShareEvent(wx),\n        error: err =\x3e console.log(\x27checkJsApi error: \x27, err)\n    });\n}\nfunction initConfig(wx) {\n    \/\/ 特别注意，这里 link 必须使用当前页面的 URL 地址，否则会失败！\n    opts.link = encodeURIComponent(document.location.href.split(\x27#\x27)[0]);\n    return $.ajax({\n        url: \x27\/wechat_api\/get_js_ticket?\x26amp;url=\x27 \x2b opts.link,\n        dataType:\x27jsonp\x27, \/\/指定为jsonp类型\n        jsonp:\x27callback\x27\n    }).done((res) =\x3e {\n        wx.config({\n            debug: process.env.NODE_ENV === \x27development\x27,\n            appId: \x27wx0000000000000000\x27,\n            nonceStr: res.data.nonceStr,\n            timestamp: res.data.timestamp,\n            signature: res.data.signature,\n            jsApiList\n        });\n    });\n}\nexport default options =\x3e {\n    if (loadedwx || !isWeixinBrowser) { return }\n\n    require([wxJsdk], (wx) =\x3e {\n        loadedwx = true;\n        $.extend(true, opts, options);\n        initConfig(wx);\n        wx.ready(() =\x3e checkJsApi(wx));\n        wx.error((res) =\x3e console.error(\x27出错了：\x27, res.errMsg));\n    });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e isWeixinBrowser = \x3cspan class=\x22hljs-regexp\x22\x3e\/micromessenger\/\x3c\/span\x3e.test(navigator.userAgent.toLowerCase());\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e wxJsdk = \x3cspan class=\x22hljs-string\x22\x3e\x27\/\/res.wx.qq.com\/open\/js\/jweixin-1.1.0.js\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e jsApiList = [\x3cspan class=\x22hljs-string\x22\x3e\x27checkJsApi\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27onMenuShareTimeline\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27onMenuShareAppMessage\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27onMenuShareQQ\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27onMenuShareWeibo\x27\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e opts = {\n    \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27My Flyme 独家记忆\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3edesc\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27当时光凝固，当回忆定格。回首2016 ，我与 Flyme 的点点滴滴都在这里。这是属于我和 Flyme 的独家记忆。\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3elink\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eimgUrl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n}, loadedwx = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3einitShareEvent\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ewx\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e option = {\n        ...opts,\n        \x3cspan class=\x22hljs-attr\x22\x3etrigger\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) \x3c\/span\x3e{\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27trigger\x27\x3c\/span\x3e, res)},\n        \x3cspan class=\x22hljs-attr\x22\x3esuccess\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27已分享\x27\x3c\/span\x3e, res) },\n        \x3cspan class=\x22hljs-attr\x22\x3ecancel\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27已取消\x27\x3c\/span\x3e, res) },\n        \x3cspan class=\x22hljs-attr\x22\x3efail\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(res)) } \n    };\n\n    wx.onMenuShareAppMessage(option); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 分享给朋友\x3c\/span\x3e\n    wx.onMenuShareTimeline(option);   \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 分享到朋友圈\x3c\/span\x3e\n    wx.onMenuShareQQ(option);         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 分享到QQ\x3c\/span\x3e\n    wx.onMenuShareWeibo(option);      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 分享到微博\x3c\/span\x3e\n    wx.onMenuShareQZone(option);      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 分享到QZone\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3echeckJsApi\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ewx\x3c\/span\x3e) \x3c\/span\x3e{\n    wx.checkJsApi({\n        jsApiList,\n        \x3cspan class=\x22hljs-attr\x22\x3esuccess\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e initShareEvent(wx),\n        \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27checkJsApi error: \x27\x3c\/span\x3e, err)\n    });\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3einitConfig\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ewx\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 特别注意，这里 link 必须使用当前页面的 URL 地址，否则会失败！\x3c\/span\x3e\n    opts.link = \x3cspan class=\x22hljs-built_in\x22\x3eencodeURIComponent\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.location.href.split(\x3cspan class=\x22hljs-string\x22\x3e\x27#\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e $.ajax({\n        \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/wechat_api\/get_js_ticket?\x26amp;url=\x27\x3c\/span\x3e \x2b opts.link,\n        \x3cspan class=\x22hljs-attr\x22\x3edataType\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27jsonp\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/指定为jsonp类型\x3c\/span\x3e\n        jsonp:\x3cspan class=\x22hljs-string\x22\x3e\x27callback\x27\x3c\/span\x3e\n    }).done(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        wx.config({\n            \x3cspan class=\x22hljs-attr\x22\x3edebug\x3c\/span\x3e: process.env.NODE_ENV === \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eappId\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27wx0000000000000000\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3enonceStr\x3c\/span\x3e: res.data.nonceStr,\n            \x3cspan class=\x22hljs-attr\x22\x3etimestamp\x3c\/span\x3e: res.data.timestamp,\n            \x3cspan class=\x22hljs-attr\x22\x3esignature\x3c\/span\x3e: res.data.signature,\n            jsApiList\n        });\n    });\n}\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e options =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (loadedwx || !isWeixinBrowser) { \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e }\n\n    \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e([wxJsdk], (wx) =\x26gt; {\n        loadedwx = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n        $.extend(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, opts, options);\n        initConfig(wx);\n        wx.ready(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e checkJsApi(wx));\n        wx.error(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(\x3cspan class=\x22hljs-string\x22\x3e\x27出错了：\x27\x3c\/span\x3e, res.errMsg));\n    });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e5.2 不走微信 jssdk 的取巧方法\x3c\/h3\x3e\n\x3cp\x3e微信分享 API 需要公众号或订阅号，临时的活动开发可能来不及折腾，那么一个折中的办法是这样的：在页面头部 img 标签设置分享显示的图片，设置高度和宽度为 0。示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cimg src=\x26quot;assets\/webp\/share.webp\x26quot; style=\x26quot;width:0;height:0;overflow:hidden\x26quot; \/\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22assets\/webp\/share.webp\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22width:0;height:0;overflow:hidden\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e微信会提取页面标题和第一张图片，作为朋友圈分享的标题和缩略图。使用 jssdk 方式分享到朋友圈的效果也是只有标题和缩略图，所以效果上没有区别。比较大的区别是，“发送给好友”时没有描述，描述位置变成了页面 URL 地址。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader14\x22\x3e6 性能优化相关\x3c\/h2\x3e\n\x3cp\x3e由于时间紧而且设计稿是逐步给到的，很多细节的优化都没法去做。最终上线的版本首屏大小约 1.3M，在弱网下的加载时间会比较久一些，可优化空间还比较大。这里探讨一下我们主要考虑到的几个点。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3e6.1 页面资源异步加载\x3c\/h3\x3e\n\x3cp\x3e一共二十多个页面，我们按每页一个 \x3ccode\x3ehtml\x3c\/code\x3e 模板和一个 \x3ccode\x3eless\x3c\/code\x3e 文件的方式，按页面分工开发，在 index.html 页面以 script 模板方式引入，由 \x3ccode\x3efis3\x3c\/code\x3e 实现模板嵌入。通过 ajax 拿到数据后，根据数据替换模板中的数据占位符，并进行页面切割，然后生成 iSlider 需要的数据配置项。这样做的好处是 html 内容未写入到 DOM 时，涉及的静态资源图片不会被加载。\x3c\/p\x3e\n\x3cp\x3eiSlider 默认至少加载 3 个页面，每一时刻也最多保存三个页面实例。于是首屏加载了三个页面，这正好符合我们的目的。\x3c\/p\x3e\n\x3cp\x3e另外要提到的一点是，弱网下不同图片下载的时差较大，会使得不同位置的图片动画断断续续地出现。为了避免这种不好的效果，我们使用了一个简单的图片预加载机制，在预加载完首屏涉及的图片资源后才隐藏 loading 显示页面。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3e6.2 webp 支持\x3c\/h3\x3e\n\x3cp\x3e该项目涉及图片资源 500 多张，只有手绘文字图片做了雪碧图处理。现在的移动端基本都支持 webp，使用 webp 是必须的。实际上使用 webp 后，图片目录的大小减小了 60%。\x3c\/p\x3e\n\x3cp\x3e以前大家都是用智图这种在线工具处理少量的图片，搜索了一下，居然没有找到现成的批量生成 webp 的工具库，于是写了一个批量生成方法。这两天整理完善了一下，算是造了一个小轮子，需要的同学可以关注下，地址在这里：\x3c\/p\x3e\n\x3cp\x3e\x3cb\x3ewebp 批量转换：\x3c\/b\x3e\x3ca href=\x22https:\/\/github.com\/lzwme\/webp-batch-convert\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/lzwme\/webp-batch-convert\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader17\x22\x3e7 应用内登陆\/分享\x3c\/h2\x3e\n\x3cp\x3e由于要在 Flyme 自带的近十个主要应用内作推广入口，涉及到两个问题：应用内分享和应用内免登录。\x3c\/p\x3e\n\x3cp\x3e在协调这一块时发现，各应用都是独自制定的各不相同的 webview 内相关 js 接口和规范，同一应用不同版本的实现也可能有差异，或者根本没有相关实现；有规范的文档也不够齐全，并且都没有示例参考；没有各应用的开发测试版本来做调试。于是花了不少时间各种咨询，踩了不少的坑，效果也还是不尽人意，最终只在魅族浏览器上做到了期望的效果。\x3c\/p\x3e\n\x3cp\x3e没有统一规范，各自造轮子，于是这种跨部门跨应用的功能需求变得如此艰难。导致这种现象的存在因素很多，可知的一点是也和公司内前端人员处于边缘化地位的现实有关。过去的一年里，基础技术支撑部门技术平台做了一套 hybridApp 解决方案，@chemdemo 同学还将 \x3ccode\x3eJSBridge\x3c\/code\x3e 部分抽离开源了出来：\x3ca href=\x22https:\/\/github.com\/chemdemo\/hybrid-js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/chemdemo\/hybrid-js\x3c\/a\x3e。可能是缺少高层足够的相关意识和支持力度，并没有在各业务软件内得到广泛应用，反而主要靠内部前端圈间沟通传播。不过这套方案为了简洁只实现了很少的通用 API 和可扩展方法，并没有继续实现各种业务适用的通用性扩展功能，自然也没有我们想要的应用内分享和 Flyme 免登录这两个功能。\x3c\/p\x3e\n\x3cp\x3e对于这个问题有两点总结：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e统一的公共 SDK 的重要性：避免重复造轮子，健壮且具有一致性的 API、完善的文档。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e再好的文档不如一个 demo\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader18\x22\x3e8 工程化问题\x3c\/h2\x3e\n\x3cp\x3e项目初期使用 \x3ccode\x3ewebpack\x3c\/code\x3e 进行构建，但由于我们平时的经验以 \x3ccode\x3efis3\x3c\/code\x3e 为主，\x3ccode\x3ewebpack\x3c\/code\x3e 过于灵活的配置特性使得一些工程化需求需要花时间探索。在我们接手项目后一起讨论了一下，果断转为熟悉的 \x3ccode\x3efis3\x3c\/code\x3e 构建体系。使用 \x3ccode\x3efis3\x3c\/code\x3e 主要解决的问题有：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eless 编译\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ees6 编译\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ejs\/css 压缩合并\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e页面模板嵌入\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e发布时 CDN 单独域名的适配\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e发布时符合内部运维体系线上发布规范的目录路径修正\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e相比较为灵活的 \x3ccode\x3ewebpack\x3c\/code\x3e，\x3ccode\x3efis3\x3c\/code\x3e 更注重流程化整体解决方案，简单的数十行配置即可实现各种工程化需求。不过 \x3ccode\x3efis3\x3c\/code\x3e 的发展现在似乎进入了一个瓶颈期\/稳定期，社区中对于在 \x3ccode\x3erollup\x3c\/code\x3e 和 \x3ccode\x3ewebpack\x3c\/code\x3e 中大热的 \x3ccode\x3etree-shaking\x3c\/code\x3e 等技术几乎都没有什么反应。希望它不要没落了，能有更多的创新吧。有两点期望：走国际化路线，出英文文档与社区支持，向国际顶级项目看进；跟进参考业界最新的工程化理念，如有必要出个 \x3ccode\x3efis4\x3c\/code\x3e 也未尝不可。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader19\x22\x3e9 运维发布问题\x3c\/h2\x3e\n\x3cp\x3e由于涉及到跨部门合作，也没有太多的时间，项目起初放在了内部的 \x3ccode\x3egitlab\x3c\/code\x3e 平台，没有走 \x3ccode\x3egit\x2bgerrit\x2bjenkins\x2b运维发布平台\x3c\/code\x3e 这一内部完整的体系。这样做在前期省去了项目创建、各种权限申请等一堆需要协调沟通的事情，开发协作效率也比较高，但到了发布的阶段就突显出了问题：每次发布都需要由运维人员手动操作，协调发布很花费时间。\x3c\/p\x3e\n\x3cp\x3e另外静态页面也没有独立出来，想当然地简单的扔到后端目录中，结果导致前端的修改需要后端也必须作修改发布，增加了前后端协调的时间成本。\x3c\/p\x3e\n\x3cp\x3e于是，在首次发布后又进行的几次小迭代中，每次迭代发布都涉及到多人手动协调，十分的浪费时间。\x3c\/p\x3e\n\x3cp\x3e总结一句话：项目构建尽量与已有的成熟的规范一致，以少走弯路。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader20\x22\x3e10 其他\x3c\/h2\x3e\n\x3cp\x3e最后列举一些移动端 H5 开发可参考的内容：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e真机调试 \x3ca href=\x22https:\/\/github.com\/jieyou\/remote_inspect_web_on_real_device\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/jieyou\/remote_inspect_web_on_real_device\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evConsole: 客户端内 H5 调试 \x3ca href=\x22https:\/\/github.com\/WechatFE\/vConsole\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/WechatFE\/vConsole\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e移动端布局终极解决方案 \x3ca href=\x22https:\/\/github.com\/imochen\/hotcss\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/imochen\/hotcss\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emobileHack \x3ca href=\x22https:\/\/github.com\/RubyLouvre\/mobileHack\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/RubyLouvre\/mobileHack\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader21\x22\x3e小结\x3c\/h2\x3e\n\x3cp\x3e这是我们第一次尝试这种活动页，在如此紧凑的时间节点下，没有什么高大上的东西，更多的是各种采坑尝试的实践过程。以上列举的内容算是对本次开发实践做一个总结记录，采用的相关实现方案也可作后续参考。欢迎探讨分享你们的经验。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>HTML5 活动宣传页「My Flyme 独家记忆」开发实践总结</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008299193">https://segmentfault.com/a/1190000008299193</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/i0jw2zo51ee/" target="_blank">https://alili.tech/archive/i0jw2zo51ee/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/z09muaar7j/">2年前端应该会哪些技能<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/ke982v6qrfg/">CSS 性能优化笔记<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/if1i2hs28ah/">H5打造3d场景不完全攻略（二）: Amazing CSS3D<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/s4apghsr7o/">JS原生一步步实现前端路由和单页面应用<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/hjgkntbgqek/">JavaScript 中对大量数据的多重过滤<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/h1hfvr2a2nj/">JavaScript 中的错误处理机制<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/a0ukpm125gm/">JavaScript 数组分组的实现<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/fwosouhbhmj/">JavaScript 类型转换深度学习<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/z193p9xv2p/">JavaScript设计模式之发布-订阅模式（观察者模式）-Part1<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/6i7sr0vgkxm/">Javascript中的时间<aside class="dates">2019-02-01</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>