<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用Nuxt&#43;Vue&#43;Node构建的SSR博客项目"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用Nuxt&#43;Vue&#43;Node构建的SSR博客项目 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/q517z3zvm8/",
				"appid": "1613049289050283", 
				"title": "使用Nuxt&#43;Vue&#43;Node构建的SSR博客项目 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-09T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/k8lhh1srs8/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/60el14nefbj/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f&text=%e4%bd%bf%e7%94%a8Nuxt%2bVue%2bNode%e6%9e%84%e5%bb%ba%e7%9a%84SSR%e5%8d%9a%e5%ae%a2%e9%a1%b9%e7%9b%ae"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f&text=%e4%bd%bf%e7%94%a8Nuxt%2bVue%2bNode%e6%9e%84%e5%bb%ba%e7%9a%84SSR%e5%8d%9a%e5%ae%a2%e9%a1%b9%e7%9b%ae"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f&title=%e4%bd%bf%e7%94%a8Nuxt%2bVue%2bNode%e6%9e%84%e5%bb%ba%e7%9a%84SSR%e5%8d%9a%e5%ae%a2%e9%a1%b9%e7%9b%ae"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f&is_video=false&description=%e4%bd%bf%e7%94%a8Nuxt%2bVue%2bNode%e6%9e%84%e5%bb%ba%e7%9a%84SSR%e5%8d%9a%e5%ae%a2%e9%a1%b9%e7%9b%ae"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8Nuxt%2bVue%2bNode%e6%9e%84%e5%bb%ba%e7%9a%84SSR%e5%8d%9a%e5%ae%a2%e9%a1%b9%e7%9b%ae&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f&title=%e4%bd%bf%e7%94%a8Nuxt%2bVue%2bNode%e6%9e%84%e5%bb%ba%e7%9a%84SSR%e5%8d%9a%e5%ae%a2%e9%a1%b9%e7%9b%ae"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f&title=%e4%bd%bf%e7%94%a8Nuxt%2bVue%2bNode%e6%9e%84%e5%bb%ba%e7%9a%84SSR%e5%8d%9a%e5%ae%a2%e9%a1%b9%e7%9b%ae"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f&title=%e4%bd%bf%e7%94%a8Nuxt%2bVue%2bNode%e6%9e%84%e5%bb%ba%e7%9a%84SSR%e5%8d%9a%e5%ae%a2%e9%a1%b9%e7%9b%ae"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fq517z3zvm8%2f&title=%e4%bd%bf%e7%94%a8Nuxt%2bVue%2bNode%e6%9e%84%e5%bb%ba%e7%9a%84SSR%e5%8d%9a%e5%ae%a2%e9%a1%b9%e7%9b%ae"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用Nuxt&#43;Vue&#43;Node构建的SSR博客项目</h1><div class="meta"><div class="postdate"><time datetime="2019-01-09" itemprop="datePublished">2019-01-09</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e以前的博客使用的是Ghost，不过被攻击了，勒索我几百美元，还是算了吧，顺便说一句，数据备份很重要！前段时间学了Vue.js，以前看的Node还能记起来点，主要为了锻炼自己吧，这次的博客没有用Hexo，Ghost什么的，自己写的。由于有SEO的需求，毕竟自己写自己看也没什么意思，最终的使用的技术方案：Vue.js\x2bNuxt.js\x2bES6\x2bWebpack\x2bMysql\x2bNoyde.js\x2bExpress.js。动手之前其实还有很多东西不是很熟，不过最终也算是完成了，这个项目给了我一个启发：实践是学习的最快途径，看再多次文档真不如动手写一个项目来的实在。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3eVue.js和Nuxt.js\x3c\/h2\x3e\n\x3cp\x3e\x3cstrong\x3eVue.js\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e当前流行的前端框架，官网地址：\x3ca href=\x22https:\/\/cn.vuejs.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/cn.vuejs.org\/\x3c\/a\x3e，文档写的很好，点个赞！\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eNuxt.js\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/zh.nuxtjs.org\/guide\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eNuxt.js\x3c\/a\x3e的文档写的也不错，话说Vue.js系列的文档写的都很好，再次点赞，官网是这样介绍自己的：\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3eNuxt.js 是一个基于 Vue.js 的通用应用框架。\x3c\/p\x3e\n\x3cp\x3e通过对客户端\/服务端基础架构的抽象组织，Nuxt.js 主要关注的是应用的 UI渲染。\x3c\/p\x3e\n\x3cp\x3e我们的目标是创建一个灵活的应用框架，你可以基于它初始化新项目的基础结构代码，或者在已有 Node.js 项目中使用 Nuxt.js。\x3c\/p\x3e\n\x3cp\x3eNuxt.js 预设了利用Vue.js开发服务端渲染的应用所需要的各种配置。\x3c\/p\x3e\n\x3cp\x3e除此之外，我们还提供了一种命令叫：nuxt generate，为基于 Vue.js 的应用提供生成对应的静态站点的功能。\x3c\/p\x3e\n\x3cp\x3e我们相信这个命令所提供的功能，是向开发集成各种微服务（miscroservices）的 Web 应用迈开的新一步。\x3c\/p\x3e\n\x3cp\x3e作为框架，Nuxt.js 为 客户端\/服务端 这种典型的应用架构模式提供了许多有用的特性，例如异步数据加载、中间件支持、布局支持等。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e总结一下，Nuxt.js就是一个利用Vue, webpack 和 Node.js帮我们简单方便实现SSR的框架。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e关于SSR\x3c\/h2\x3e\n\x3cp\x3e\x3cstrong\x3e什么是SSR\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3eSSR是Server Side Render的缩写，即服务器端渲染。在没有SPA之前，绝大多数的网页都是通过服务器渲染生成的：用户向服务器发送请求，服务器获取请求，然后再查询数据库，根据查询的数据动态的生成一张网页，最后将网页内容返回给浏览器端。\x3c\/p\x3e\n\x3cp\x3e现在拿Vue来说，在通常情况下，Vue.js是运行在浏览器中的，在浏览器你发送一个请求，然后获得了后台返回的数据，最后通过Vue.js将数据渲染成需要的HTML片段。现在，我们把将组件渲染成HTML这个工作拿到Node上来执行，可以将Node看成一个隐形的“浏览器”，在这个“浏览器”中我们将组件都渲染好，然后将渲染好的HTML直接发送给实际的浏览器（客户端），这就是Vue SSR。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eSSR的好处\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e通过前端框架（Vue，Angular,React）构建的SPA（Single-Page Application - 单页应用程序），因为内容是通过Ajax获取的，所以就有一个天然的缺陷，就是搜索引擎没法获取里面的内容。右键查看一个SPA网页的源代码，你会发现你里面几乎没什么内容。对于像博客，新闻这样的网站，这一点是不可接收的。\x3c\/p\x3e\n\x3cp\x3e总结起来，SSR带来的好处就是能够SEO，顺便因为内容在服务器端已经渲染好了，还能够减少请求数量，对于一些比较老旧的浏览器（Vue.js不支持），也能看到基础的内容。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e开发总结\x3c\/h3\x3e\n\x3cp\x3e开发中遇到了不少问题，在这里我列举一下，可以让大家尽量少走弯路，解决方案我尽量说的简洁点，有些东西我会单独开一篇博文。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eRestful\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e项目后台使用的是Restful API，后台框架用的是express，你可以用\x3ccode\x3evue init nuxt-community\/express-template \x26lt;project-name\x26gt;\x3c\/code\x3e生成一套基于express的模板文件，后台的代码在server目录，这个目录里面就是关于Node和express的内容了，这里不展开。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3easyncData多个请求\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e参考下面的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22async asyncData({ req, error }) {\n    const page = 0\n    let [pageRes, countRes] = await Promise.all([\n        axios.get(`\/api\/post\/page\/${page}?scope=published`),\n        axios.get(\x27\/api\/post\/count\/published\x27),\n    ])\n    return {\n        posts: pageRes.data.list,\n        count: countRes.data.result,\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3easync asyncData({ req, \x3cspan class=\x22hljs-keyword\x22\x3eerror\x3c\/span\x3e }) {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e page = 0\n    let [pageRes, countRes] = await Promise.all([\n        axios.\x3cspan class=\x22hljs-built_in\x22\x3eget\x3c\/span\x3e(`\/api\/\x3cspan class=\x22hljs-keyword\x22\x3epost\x3c\/span\x3e\/page\/\x3cspan class=\x22hljs-variable\x22\x3e${page}\x3c\/span\x3e?scope=published`),\n        axios.\x3cspan class=\x22hljs-built_in\x22\x3eget\x3c\/span\x3e(\x27\/api\/\x3cspan class=\x22hljs-keyword\x22\x3epost\x3c\/span\x3e\/\x3cspan class=\x22hljs-keyword\x22\x3ecount\x3c\/span\x3e\/published\x27),\n    ])\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        posts: pageRes.data.\x3cspan class=\x22hljs-keyword\x22\x3elist\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-keyword\x22\x3ecount\x3c\/span\x3e: countRes.data.result,\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e中间件\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e中间件允许您定义一个自定义函数运行在一个页面或一组页面渲染之前。每一个中间件应放置在 middleware\/ 目录。文件名的名称将成为中间件名称(middleware\/auth.js将成为 auth 中间件)。下面是一个示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { isLogin } from \x27..\/util\/assist\x27\nconst needAuth = require(\x27..\/util\/api.config\x27).needAuth\nexport default function ({ isClient, isServer, route, req, res, redirect }) {\n    \/\/在服务端判读是否需要登陆(如果直接输地址，在客户端是判断不到的)\n    if (isServer) {\n        let cookies = req.cookies\n        let path = req.originalUrl;\n\n        if (path.indexOf(\x27admin\x27) \x3e 0 \x26amp;\x26amp; !cookies.token) {\n            redirect(\x27\/login\x27)\n        }\n    }\n    \/\/在客户端判读是否需要登陆\n    if (isClient) {\n        if (route.path.indexOf(\x27admin\x27) \x3e 0 \x26amp;\x26amp; !isLogin()) {\n            redirect(\x27login\x27)\n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { isLogin } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27..\/util\/assist\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e needAuth = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/util\/api.config\x27\x3c\/span\x3e).needAuth\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e{ isClient, isServer, route, req, res, redirect }\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/在服务端判读是否需要登陆(如果直接输地址，在客户端是判断不到的)\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isServer) {\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e cookies = req.cookies\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e path = req.originalUrl;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (path.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27admin\x27\x3c\/span\x3e) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x26amp;\x26amp; !cookies.token) {\n            redirect(\x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e)\n        }\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/在客户端判读是否需要登陆\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isClient) {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (route.path.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x27admin\x27\x3c\/span\x3e) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x26amp;\x26amp; !isLogin()) {\n            redirect(\x3cspan class=\x22hljs-string\x22\x3e\x27login\x27\x3c\/span\x3e)\n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3eNode循环\x2b异步问题\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e在项目里面有这样一个需求：显示文章（Post）对应的若干个标签（Tag），解决办法就是获取PostList，然后循环这个List并获取PostId，根据PostId去查对应的Tag。由于获取PostList异步操作，然后又在循环里面套了许多异步操作（获取Tag），所以用回调的方式就没法写下去了，最后使用的是\x3ccode\x3easync\x3c\/code\x3e这个库，贴一段代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/获取Post列表\nlet list = (params, callback) =\x3e {\n    postModel.list(params, (err, posts) =\x3e {\n        if (err) {\n            return callback({ code: 404, message: \x27no result\x27 });\n        }\n        \/\/get each posts\x27 tags\n        async.eachSeries(posts, (post, tagCallback) =\x3e {\n            postTagModel.tagsByPostId(post.id, (err, result) =\x3e {\n                if (err) {\n                    tagCallback(err)\n                }\n                post.tags = result;\n                tagCallback()\n            });\n        }, (err) =\x3e {\n            if (err) {\n                callback({ code: 404, message: \x27no result\x27 });\n                return false;\n            }\n            callback({ code: 404, message: \x27no result\x27, list: posts });\n        });\n    });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stata\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/获取Post列表\x3c\/span\x3e\nlet \x3cspan class=\x22hljs-keyword\x22\x3elist\x3c\/span\x3e = (params, callback) =\x26gt; {\n    postModel.\x3cspan class=\x22hljs-keyword\x22\x3elist\x3c\/span\x3e(params, (\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e, posts) =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e callback({ code: 404, message: \x27\x3cspan class=\x22hljs-keyword\x22\x3eno\x3c\/span\x3e result\x27 });\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/get each posts\x27 tags\x3c\/span\x3e\n        async.eachSeries(posts, (\x3cspan class=\x22hljs-keyword\x22\x3epost\x3c\/span\x3e, tagCallback) =\x26gt; {\n            postTagModel.tagsByPostId(\x3cspan class=\x22hljs-keyword\x22\x3epost\x3c\/span\x3e.id, (\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e, result) =\x26gt; {\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e) {\n                    tagCallback(\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e)\n                }\n                \x3cspan class=\x22hljs-keyword\x22\x3epost\x3c\/span\x3e.tags = result;\n                tagCallback()\n            });\n        }, (\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e) =\x26gt; {\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eerr\x3c\/span\x3e) {\n                callback({ code: 404, message: \x27\x3cspan class=\x22hljs-keyword\x22\x3eno\x3c\/span\x3e result\x27 });\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e false;\n            }\n            callback({ code: 404, message: \x27\x3cspan class=\x22hljs-keyword\x22\x3eno\x3c\/span\x3e result\x27, \x3cspan class=\x22hljs-keyword\x22\x3elist\x3c\/span\x3e: posts });\n        });\n    });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e静态资源\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e在Nuxt中，你可以将静态文件放到项目根目录的static文件夹中，然后直接使用根路径\x3ccode\x3e\/\x3c\/code\x3e就可以访问了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!-- 假设static目录下有一张图片my-image.png，可以这样直接访问 --\x3e\n\x3cimg src=\x26quot;\/my-image.png\x26quot;\/\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- 假设static目录下有一张图片my-image.png，可以这样直接访问 --\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/my-image.png\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e登陆\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e第一次使用restful，登陆问题一直困扰着我，搜了不少资料，最后的解决方案是使用token。\x3c\/p\x3e\n\x3cp\x3e在前端，检测到用户没有登陆就跳转到登陆页面，用户发送登陆请求后先在后台校验用户名和密码，校验成功之后返回一个token。前端接收到这个token后将它存在本地，以后每次发送请求时将这个token带上，之后的请求后台对这个token进行校验，如果合法就认为登陆成功。\x3c\/p\x3e\n\x3cp\x3e下面的代码用于生成token（使用的是jwt-simple），uid是用户ID，exp的取值是七天后的时间，jwtSecret是加密和解密的密钥。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let auth = (user, callback) =\x3e {\n    if (user.account.trim() == \x27\x27) {\n        return callback({ code: 403, message: \x27用户名不正确\x27 });\n    }\n    if (user.password.trim() == \x27\x27) {\n        return callback({ code: 403, message: \x27密码不正确\x27 });\n    }\n    userModel.auth(user, (err, user) =\x3e {\n        if (err) {\n            return callback({ code: 404, message: \x27登陆失败\x27 });\n        }\n        if (user.length === 1) {\n            \/\/设置七天有效期\n            let expires = moment().add(7, \x27days\x27).valueOf();\n\n            let token = jwt.encode({\n                uid: user[0].id,\n                exp: expires\n            }, jwtSecret)\n\n            return callback({ code: 200, message: \x27success\x27, token: token });\n        }\n        callback({ code: 404, message: \x27登陆失败\x27 });\n    });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3elet auth = (user, callback) =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (user.account.trim() == \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e callback({ \x3cspan class=\x22hljs-string\x22\x3ecode:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e403\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3emessage:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27用户名不正确\x27\x3c\/span\x3e });\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (user.password.trim() == \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e callback({ \x3cspan class=\x22hljs-string\x22\x3ecode:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e403\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3emessage:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27密码不正确\x27\x3c\/span\x3e });\n    }\n    userModel.auth(user, (err, user) =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e callback({ \x3cspan class=\x22hljs-string\x22\x3ecode:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e404\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3emessage:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27登陆失败\x27\x3c\/span\x3e });\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (user.length === \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置七天有效期\x3c\/span\x3e\n            let expires = moment().add(\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27days\x27\x3c\/span\x3e).valueOf();\n\n            let token = jwt.encode({\n\x3cspan class=\x22hljs-symbol\x22\x3e                uid:\x3c\/span\x3e user[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].id,\n\x3cspan class=\x22hljs-symbol\x22\x3e                exp:\x3c\/span\x3e expires\n            }, jwtSecret)\n\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e callback({ \x3cspan class=\x22hljs-string\x22\x3ecode:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3emessage:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27success\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3etoken:\x3c\/span\x3e token });\n        }\n        callback({ \x3cspan class=\x22hljs-string\x22\x3ecode:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e404\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3emessage:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27登陆失败\x27\x3c\/span\x3e });\n    });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我使用的Ajax工具是axios，下面代码的作用是给所有请求添加一个header。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 拦截request\n$http.interceptors.request.use(\n  config =\x3e {\n    if (typeof document === \x27object\x27) {\n      let token = getCookieInClient(\x27token\x27)\n      if (token) {\n        config.headers.Authorization = token;\n      }\n    }\n    return config;\n  }, err =\x3e {\n    return Promise.reject(err);\n  }\n);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拦截request\x3c\/span\x3e\n$http.interceptors.request.use(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3econfig\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e token = getCookieInClient(\x3cspan class=\x22hljs-string\x22\x3e\x27token\x27\x3c\/span\x3e)\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (token) {\n        config.headers.Authorization = token;\n      }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e config;\n  }, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(err);\n  }\n);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e下面是校验token的中间件，先判断接口是否需要验证身份，不需要就直接Next，如果需要就获取并校验token，校验做的比较粗糙，就是直接判断token是否在有效期内，当然可以有更安全的做法，你可以自己去搜索一下。登陆成功的标志就是token校验合法，然后下一步操作。校验失败就直接返回，前端根据响应跳转到登陆页面。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module.exports = function (req, res, next) {\n    let path = req.originalUrl\n    \n    \/\/接口不需要登陆：直接next\n    if (needAuth.indexOf(path) \x3c 0) {\n        return next();\n    }\n    \n    \/\/接口需要登陆\n    var token = req.headers[\x27authorization\x27]\n    if (!token) {\n        return res.json({\n            code: 401,\n            message: \x27you need login:there is no token\x27\n        })\n    }\n    \n    try {\n        \/\/解密获取的token\n        let decoded = jwt.decode(token, jwtSecret);\n\n        \/\/校验有效期\n        if (decoded.exp \x3c= Date.now()) {\n            return res.json({\n                code: 401,\n                message: \x27you need login:token is expired\x27\n            });\n        }\n        next();\n    } catch (err) {\n        return res.json({\n            code: 401,\n            message: \x27you need login:decode token fail\x27\n        })\n    }\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ereq, res, next\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e path = req.originalUrl\n    \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/接口不需要登陆：直接next\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (needAuth.indexOf(path) \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e next();\n    }\n    \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/接口需要登陆\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e token = req.headers[\x3cspan class=\x22hljs-string\x22\x3e\x27authorization\x27\x3c\/span\x3e]\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!token) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e res.json({\n            \x3cspan class=\x22hljs-attr\x22\x3ecode\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e401\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3emessage\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27you need login:there is no token\x27\x3c\/span\x3e\n        })\n    }\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/解密获取的token\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e decoded = jwt.decode(token, jwtSecret);\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/校验有效期\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (decoded.exp \x26lt;= \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e.now()) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e res.json({\n                \x3cspan class=\x22hljs-attr\x22\x3ecode\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e401\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-attr\x22\x3emessage\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27you need login:token is expired\x27\x3c\/span\x3e\n            });\n        }\n        next();\n    } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (err) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e res.json({\n            \x3cspan class=\x22hljs-attr\x22\x3ecode\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e401\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3emessage\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27you need login:decode token fail\x27\x3c\/span\x3e\n        })\n    }\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3enuxt.config\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3enuxt的配置文件，具体的配置项可以参考\x3ca href=\x22https:\/\/zh.nuxtjs.org\/guide\/configuration\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这个链接\x3c\/a\x3e，下面是我的配置文件，里面的内容应该是一看就懂。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module.exports = {\n  \/\/页面的head标签\n  head: {\n    title: \x27JustYeh的前端博客\x27,\n    meta: [\n      { charset: \x27utf-8\x27 },\n      { name: \x27viewport\x27, content: \x27width=device-width, initial-scale=1, user-scalable=no\x27 },\n      { hid: \x27description\x27, name: \x27description\x27, content: \x27叶文祥的前端博客\x27 },\n      { name: \x27renderer\x27, content: \x27webkit\x27 },\n      { \x27http-equiv\x27: \x27X-UA-Compatible\x27, content: \x27IE=edge\x27 },\n      { name: \x27author\x27, content: \x27叶文祥,justyeh@163.com\x27 },\n      { name: \x27apple-mobile-web-app-title\x27, content: \x27叶文祥的前端博客\x27 },\n      { name: \x27apple-mobile-web-app-capable\x27, content: \x27yes\x27 },\n      { name: \x27apple-mobile-web-app-status-bar-style\x27, content: \x27#263238\x27 },\n      { name: \x27screen-orientation\x27, content: \x27portrait\x27 },\n      { name: \x27x5-orientation\x27, content: \x27portrait\x27 },\n      { name: \x27full-screen\x27, content: \x27yes\x27 },\n      { name: \x27x5-fullscreen\x27, content: \x27true\x27 },\n      { name: \x27browsermode\x27, content: \x27application\x27 },\n      { name: \x27x5-page-mode\x27, content: \x27app\x27 },\n      { name: \x27theme-color\x27, content: \x27#263238\x27 },\n    ],\n    link: [\n      { rel: \x27icon\x27, type: \x27image\/x-icon\x27, href: \x27\/favicon.ico\x27 }\n    ]\n  },\n  \/\/全局引用的css文件\n  css: [\x27~assets\/css\/main.css\x27, \x27~assets\/css\/font-awesome.min.css\x27],\n  \/\/ 页面顶部loading效果\n  loading: {\n    color: \x27#04acf7\x27,\n    height: \x274px\x27,\n    failedColor: \x27red\x27\n  },\n  \/\/页面的过渡效果\n  transition: {\n    name: \x27page\x27\n  },\n  \/\/配置路由中间件\n  router: {\n    middleware: \x27adminAuth\x27\n  }\n\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3emodule.exports = {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/页面的head标签\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  head:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    title:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27JustYeh的前端博客\x27\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    meta:\x3c\/span\x3e [\n      { \x3cspan class=\x22hljs-string\x22\x3echarset:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27utf-8\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27viewport\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27width=device-width, initial-scale=1, user-scalable=no\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ehid:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27description\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27description\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27叶文祥的前端博客\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27renderer\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27webkit\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3e\x27http-equiv\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27X-UA-Compatible\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27IE=edge\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27author\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27叶文祥,justyeh@163.com\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27apple-mobile-web-app-title\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27叶文祥的前端博客\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27apple-mobile-web-app-capable\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27yes\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27apple-mobile-web-app-status-bar-style\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27#263238\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27screen-orientation\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27portrait\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27x5-orientation\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27portrait\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27full-screen\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27yes\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27x5-fullscreen\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27true\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27browsermode\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27application\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27x5-page-mode\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27app\x27\x3c\/span\x3e },\n      { \x3cspan class=\x22hljs-string\x22\x3ename:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27theme-color\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3econtent:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27#263238\x27\x3c\/span\x3e },\n    ],\n\x3cspan class=\x22hljs-symbol\x22\x3e    link:\x3c\/span\x3e [\n      { \x3cspan class=\x22hljs-string\x22\x3erel:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27icon\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3etype:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27image\/x-icon\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3ehref:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27\/favicon.ico\x27\x3c\/span\x3e }\n    ]\n  },\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/全局引用的css文件\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  css:\x3c\/span\x3e [\x3cspan class=\x22hljs-string\x22\x3e\x27~assets\/css\/main.css\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27~assets\/css\/font-awesome.min.css\x27\x3c\/span\x3e],\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 页面顶部loading效果\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  loading:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    color:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27#04acf7\x27\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    height:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x274px\x27\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    failedColor:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27red\x27\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/页面的过渡效果\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  transition:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27page\x27\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/配置路由中间件\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  router:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    middleware:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27adminAuth\x27\x3c\/span\x3e\n  }\n\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e部署\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e部署一直不怎么会弄，这次也确实在上面遇到了不少问题，这里就不说了。最终使用的是\x3ca href=\x22http:\/\/pm2.keymetrics.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3epm2\x3c\/a\x3e，现在假设你已经安装好了node、pm2、vue等之类的包，依次运行下面的命令：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22#进入文件所在目录\ncd your_project\n#安装项目所需依赖\nnpm insatll\n#打包\nnpm run build\n#运行,--name \x27your project name\x27是可选的\npm2 start npm [--name \x27your project name\x27] -- start\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e#进入文件所在目录\x3c\/span\x3e\ncd your_project\n\x3cspan class=\x22hljs-comment\x22\x3e#安装项目所需依赖\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3enpm\x3c\/span\x3e insatll\n\x3cspan class=\x22hljs-comment\x22\x3e#打包\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3enpm\x3c\/span\x3e run build\n\x3cspan class=\x22hljs-comment\x22\x3e#运行,--name \x27your project name\x27是可选的\x3c\/span\x3e\npm2 start \x3cspan class=\x22hljs-built_in\x22\x3enpm\x3c\/span\x3e [--name \x3cspan class=\x22hljs-string\x22\x3e\x27your project name\x27\x3c\/span\x3e] -- start\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e说在最后\x3c\/h3\x3e\n\x3cp\x3e上面的东西比较琐碎，如果你正好遇到相关的问题可能就有帮助了。系统性的梳理我也不知道怎么展开，只能抱歉了。\x3c\/p\x3e\n\x3cp\x3e好了，全部的代码在这里：\x3ca href=\x22https:\/\/github.com\/justyeh\/justyeh.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/justyeh\/justyeh.com\x3c\/a\x3e，关于细节你都可以在这里面查看。这个是最终的成果：\x3ca href=\x22http:\/\/justyeh.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/justyeh.com\/\x3c\/a\x3e，鉴于这个是私人项目，线上后台就不公布了，不过可以直接clone我的项目，数据库什么的都在，直接在本地就可以跑起来。\x3c\/p\x3e\n\x3cp\x3e水平有限，如果有什么错误的地方还请包含。喜欢的话，可以给个star。如果你有什么好的建议和意见，欢迎\x3ca href=\x22http:\/\/justyeh.com\/about\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e联系我\x3c\/a\x3e！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>使用Nuxt+Vue+Node构建的SSR博客项目</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010140155">https://segmentfault.com/a/1190000010140155</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/q517z3zvm8/" target="_blank">https://alili.tech/archive/q517z3zvm8/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5x6tenwjeux/">ES6中的异步编程：Generators函数&#43;Promise:最强大的异步处理方式<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/nvtmua2a1hd/">GreenSock (TweenMax) 极简入门指南<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/7kt5s47oysx/">HTML5 中 canvas 的使用总结<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/41pgo3a2iyp/">JavaScript 开发者所需要知道的 V8（一）：V8 In NodeJS<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/krb1zm7x38j/">JavaScript 时间与日期处理实战:你肯定被坑过<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/yh2lq30d0x/">JavaScript中的各种宽高属性<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/eydwczesyv/">Muse UI — 基于 Vue2.0 的 Material Design UI 库<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/y62oejm8cr/">Nodejs基础：路径处理模块path总结<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/06cwh88ankmd/">PhantomJS &amp; NodeJS 在京东网站前端监控平台的最佳实践<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/z4ymvs0jz2h/">Promise 的链式调用与中止<aside class="dates">2019-01-31</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>