<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Nodejs进阶：如何玩转子进程（child_process）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Nodejs进阶：如何玩转子进程（child_process） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/3txhfn3ejcb/",
				"appid": "1613049289050283", 
				"title": "Nodejs进阶：如何玩转子进程（child_process） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-30T02:30:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/yr7v8e9fao/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/u2la0cn9do/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f&text=Nodejs%e8%bf%9b%e9%98%b6%ef%bc%9a%e5%a6%82%e4%bd%95%e7%8e%a9%e8%bd%ac%e5%ad%90%e8%bf%9b%e7%a8%8b%ef%bc%88child_process%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f&text=Nodejs%e8%bf%9b%e9%98%b6%ef%bc%9a%e5%a6%82%e4%bd%95%e7%8e%a9%e8%bd%ac%e5%ad%90%e8%bf%9b%e7%a8%8b%ef%bc%88child_process%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f&title=Nodejs%e8%bf%9b%e9%98%b6%ef%bc%9a%e5%a6%82%e4%bd%95%e7%8e%a9%e8%bd%ac%e5%ad%90%e8%bf%9b%e7%a8%8b%ef%bc%88child_process%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f&is_video=false&description=Nodejs%e8%bf%9b%e9%98%b6%ef%bc%9a%e5%a6%82%e4%bd%95%e7%8e%a9%e8%bd%ac%e5%ad%90%e8%bf%9b%e7%a8%8b%ef%bc%88child_process%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Nodejs%e8%bf%9b%e9%98%b6%ef%bc%9a%e5%a6%82%e4%bd%95%e7%8e%a9%e8%bd%ac%e5%ad%90%e8%bf%9b%e7%a8%8b%ef%bc%88child_process%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f&title=Nodejs%e8%bf%9b%e9%98%b6%ef%bc%9a%e5%a6%82%e4%bd%95%e7%8e%a9%e8%bd%ac%e5%ad%90%e8%bf%9b%e7%a8%8b%ef%bc%88child_process%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f&title=Nodejs%e8%bf%9b%e9%98%b6%ef%bc%9a%e5%a6%82%e4%bd%95%e7%8e%a9%e8%bd%ac%e5%ad%90%e8%bf%9b%e7%a8%8b%ef%bc%88child_process%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f&title=Nodejs%e8%bf%9b%e9%98%b6%ef%bc%9a%e5%a6%82%e4%bd%95%e7%8e%a9%e8%bd%ac%e5%ad%90%e8%bf%9b%e7%a8%8b%ef%bc%88child_process%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3txhfn3ejcb%2f&title=Nodejs%e8%bf%9b%e9%98%b6%ef%bc%9a%e5%a6%82%e4%bd%95%e7%8e%a9%e8%bd%ac%e5%ad%90%e8%bf%9b%e7%a8%8b%ef%bc%88child_process%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Nodejs进阶：如何玩转子进程（child_process）</h1><div class="meta"><div class="postdate"><time datetime="2019-01-30" itemprop="datePublished">2019-01-30</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e本文摘录自《Nodejs学习笔记》，更多章节及更新，请访问 \x3ca href=\x22https:\/\/github.com\/chyingp\/nodejs-learning-guide\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egithub主页地址\x3c\/a\x3e。欢迎加群交流，群号 \x3ca href=\x22http:\/\/shang.qq.com\/wpa\/qunwpa?idkey=7e4f670e1cd9278f30003965a1cc068a4f30d8c73aa071c8da189f4842dbbee6\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e197339705\x3c\/a\x3e。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e模块概览\x3c\/h2\x3e\n\x3cp\x3e在node中，child_process这个模块非常重要。掌握了它，等于在node的世界开启了一扇新的大门。熟悉shell脚本的同学，可以用它来完成很多有意思的事情，比如文件压缩、增量部署等，感兴趣的同学，看文本文后可以尝试下。\x3c\/p\x3e\n\x3cp\x3e举个简单的例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const spawn = require(\x27child_process\x27).spawn;\nconst ls = spawn(\x27ls\x27, [\x27-lh\x27, \x27\/usr\x27]);\n\nls.stdout.on(\x27data\x27, (data) =\x3e {\n  console.log(`stdout: ${data}`);\n});\n\nls.stderr.on(\x27data\x27, (data) =\x3e {\n  console.log(`stderr: ${data}`);\n});\n\nls.on(\x27close\x27, (code) =\x3e {\n  console.log(`child process exited with code ${code}`);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e spawn = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).spawn;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ls = spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27ls\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27-lh\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/usr\x27\x3c\/span\x3e]);\n\nls.stdout.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, (data) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e`stdout: \x3cspan class=\x22hljs-subst\x22\x3e${data}\x3c\/span\x3e`\x3c\/span\x3e);\n});\n\nls.stderr.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, (data) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e`stderr: \x3cspan class=\x22hljs-subst\x22\x3e${data}\x3c\/span\x3e`\x3c\/span\x3e);\n});\n\nls.on(\x3cspan class=\x22hljs-string\x22\x3e\x27close\x27\x3c\/span\x3e, (code) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e`child process exited with code \x3cspan class=\x22hljs-subst\x22\x3e${code}\x3c\/span\x3e`\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e几种创建子进程的方式\x3c\/h2\x3e\n\x3cp\x3e注意事项：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e下面列出来的都是异步创建子进程的方式，每一种方式都有对应的同步版本。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e.exec()\x3c\/code\x3e、\x3ccode\x3e.execFile()\x3c\/code\x3e、\x3ccode\x3e.fork()\x3c\/code\x3e底层都是通过\x3ccode\x3e.spawn()\x3c\/code\x3e实现的。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e.exec()\x3c\/code\x3e、\x3ccode\x3eexecFile()\x3c\/code\x3e额外提供了回调，当子进程停止的时候执行。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\x3cp\x3echild_process.spawn(command, args)\x3cbr\x3echild_process.exec(command, options)\x3cbr\x3echild_process.execFile(file, args[, callback])\x3cbr\x3echild_process.fork(modulePath, args)\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3echild_process.exec(command, options)\x3c\/h3\x3e\n\x3cp\x3e创建一个shell，然后在shell里执行命令。执行完成后，将stdout、stderr作为参数传入回调方法。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3espawns a shell and runs a command within that shell, passing the stdout and stderr to a callback function when complete.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e例子如下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e执行成功，\x3ccode\x3eerror\x3c\/code\x3e为\x3ccode\x3enull\x3c\/code\x3e；执行失败，\x3ccode\x3eerror\x3c\/code\x3e为\x3ccode\x3eError\x3c\/code\x3e实例。\x3ccode\x3eerror.code\x3c\/code\x3e为错误码，\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3estdout\x3c\/code\x3e、\x3ccode\x3estderr\x3c\/code\x3e为标准输出、标准错误。默认是字符串，除非\x3ccode\x3eoptions.encoding\x3c\/code\x3e为\x3ccode\x3ebuffer\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var exec = require(\x27child_process\x27).exec;\n\n\/\/ 成功的例子\nexec(\x27ls -al\x27, function(error, stdout, stderr){\n    if(error) {\n        console.error(\x27error: \x27 \x2b error);\n        return;\n    }\n    console.log(\x27stdout: \x27 \x2b stdout);\n    console.log(\x27stderr: \x27 \x2b typeof stderr);\n});\n\n\/\/ 失败的例子\nexec(\x27ls hello.txt\x27, function(error, stdout, stderr){\n    if(error) {\n        console.error(\x27error: \x27 \x2b error);\n        return;\n    }\n    console.log(\x27stdout: \x27 \x2b stdout);\n    console.log(\x27stderr: \x27 \x2b stderr);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e exec = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).exec;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 成功的例子\x3c\/span\x3e\nexec(\x3cspan class=\x22hljs-string\x22\x3e\x27ls -al\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerror, stdout, stderr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(error) {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(\x3cspan class=\x22hljs-string\x22\x3e\x27error: \x27\x3c\/span\x3e \x2b error);\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27stdout: \x27\x3c\/span\x3e \x2b stdout);\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27stderr: \x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e stderr);\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 失败的例子\x3c\/span\x3e\nexec(\x3cspan class=\x22hljs-string\x22\x3e\x27ls hello.txt\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerror, stdout, stderr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(error) {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(\x3cspan class=\x22hljs-string\x22\x3e\x27error: \x27\x3c\/span\x3e \x2b error);\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27stdout: \x27\x3c\/span\x3e \x2b stdout);\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27stderr: \x27\x3c\/span\x3e \x2b stderr);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e参数说明：\x3c\/h4\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ecwd\x3c\/code\x3e：当前工作路径。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eenv\x3c\/code\x3e：环境变量。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eencoding\x3c\/code\x3e：编码，默认是\x3ccode\x3eutf8\x3c\/code\x3e。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eshell\x3c\/code\x3e：用来执行命令的shell，unix上默认是\x3ccode\x3e\/bin\/sh\x3c\/code\x3e，windows上默认是\x3ccode\x3ecmd.exe\x3c\/code\x3e。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3etimeout\x3c\/code\x3e：默认是0。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3ekillSignal\x3c\/code\x3e：默认是\x3ccode\x3eSIGTERM\x3c\/code\x3e。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3euid\x3c\/code\x3e：执行进程的uid。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3egid\x3c\/code\x3e：执行进程的gid。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3emaxBuffer\x3c\/code\x3e：\x26lt;Number\x26gt; 标准输出、错误输出最大允许的数据量（单位为字节），如果超出的话，子进程就会被杀死。默认是200*1024（就是200k啦）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e备注：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e如果\x3ccode\x3etimeout\x3c\/code\x3e大于0，那么，当子进程运行超过\x3ccode\x3etimeout\x3c\/code\x3e毫秒，那么，就会给进程发送\x3ccode\x3ekillSignal\x3c\/code\x3e指定的信号（比如\x3ccode\x3eSIGTERM\x3c\/code\x3e）。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e如果运行没有出错，那么\x3ccode\x3eerror\x3c\/code\x3e为\x3ccode\x3enull\x3c\/code\x3e。如果运行出错，那么，\x3ccode\x3eerror.code\x3c\/code\x3e就是退出代码（exist code），\x3ccode\x3eerror.signal\x3c\/code\x3e会被设置成终止进程的信号。（比如\x3ccode\x3eCTRL\x2bC\x3c\/code\x3e时发送的\x3ccode\x3eSIGINT\x3c\/code\x3e）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch4\x3e风险项\x3c\/h4\x3e\n\x3cp\x3e传入的命令，如果是用户输入的，有可能产生类似sql注入的风险，比如\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22exec(\x27ls hello.txt; rm -rf *\x27, function(error, stdout, stderr){\n    if(error) {\n        console.error(\x27error: \x27 \x2b error);\n        \/\/ return;\n    }\n    console.log(\x27stdout: \x27 \x2b stdout);\n    console.log(\x27stderr: \x27 \x2b stderr);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scilab\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3eexec\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27ls hello.txt; rm -rf *\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(error, stdout, stderr)\x3c\/span\x3e{\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e) {\n        console.\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27error: \x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ return;\x3c\/span\x3e\n    }\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27stdout: \x27\x3c\/span\x3e \x2b stdout);\n    console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27stderr: \x27\x3c\/span\x3e \x2b stderr);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e备注事项\x3c\/h4\x3e\n\x3cp\x3eNote: Unlike the exec(3) POSIX system call, child_process.exec() does not replace the existing process and uses a shell to execute the command.\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3echild_process.execFile(file, args[, callback])\x3c\/h3\x3e\n\x3cp\x3e跟\x3ccode\x3e.exec()\x3c\/code\x3e类似，不同点在于，没有创建一个新的shell。至少有两点影响\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e比\x3ccode\x3echild_process.exec()\x3c\/code\x3e效率高一些。（实际待测试）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e一些操作，比如I\/O重定向，文件glob等不支持。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cblockquote\x3e\x3cp\x3esimilar to child_process.exec() except that it spawns the command directly without first spawning a shell.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3ccode\x3efile\x3c\/code\x3e：\x26lt;String\x26gt; 可执行文件的名字，或者路径。\x3c\/p\x3e\n\x3cp\x3e例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var child_process = require(\x27child_process\x27);\n\nchild_process.execFile(\x27node\x27, [\x27--version\x27], function(error, stdout, stderr){\n    if(error){\n        throw error;\n    }\n    console.log(stdout);\n});\n\nchild_process.execFile(\x27\/Users\/a\/.nvm\/versions\/node\/v6.1.0\/bin\/node\x27, [\x27--version\x27], function(error, stdout, stderr){\n    if(error){\n        throw error;\n    }\n    console.log(stdout);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child_process = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\n\nchild_process.execFile(\x3cspan class=\x22hljs-string\x22\x3e\x27node\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27--version\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerror, stdout, stderr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(error){\n        \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e error;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(stdout);\n});\n\nchild_process.execFile(\x3cspan class=\x22hljs-string\x22\x3e\x27\/Users\/a\/.nvm\/versions\/node\/v6.1.0\/bin\/node\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27--version\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerror, stdout, stderr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(error){\n        \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e error;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(stdout);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e====== 扩展阅读 =======\x3c\/p\x3e\n\x3cp\x3e从node源码来看，\x3ccode\x3eexec()\x3c\/code\x3e、\x3ccode\x3eexecFile()\x3c\/code\x3e最大的差别，就在于是否创建了shell。（execFile()内部，options.shell === false），那么，可以手动设置shell。以下代码差不多是等价的。win下的shell设置有所不同，感兴趣的同学可以自己试验下。\x3c\/p\x3e\n\x3cp\x3e备注：execFile()内部最终还是通过spawn()实现的， 如果没有设置 {shell: \x27\/bin\/bash\x27}，那么 spawm() 内部对命令的解析会有所不同，execFile(\x27ls -al .\x27) 会直接报错。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var child_process = require(\x27child_process\x27);\nvar execFile = child_process.execFile;\nvar exec = child_process.exec;\n\nexec(\x27ls -al .\x27, function(error, stdout, stderr){\n    if(error){\n        throw error;\n    }\n    console.log(stdout);\n});\n\nexecFile(\x27ls -al .\x27, {shell: \x27\/bin\/bash\x27}, function(error, stdout, stderr){\n    if(error){\n        throw error;\n    }\n    console.log(stdout);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child_process = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e execFile = child_process.execFile;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e exec = child_process.exec;\n\nexec(\x3cspan class=\x22hljs-string\x22\x3e\x27ls -al .\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerror, stdout, stderr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(error){\n        \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e error;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(stdout);\n});\n\nexecFile(\x3cspan class=\x22hljs-string\x22\x3e\x27ls -al .\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3eshell\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/bin\/bash\x27\x3c\/span\x3e}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerror, stdout, stderr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(error){\n        \x3cspan class=\x22hljs-keyword\x22\x3ethrow\x3c\/span\x3e error;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(stdout);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3echild_process.fork(modulePath, args)\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3emodulePath\x3c\/code\x3e：子进程运行的模块。\x3c\/p\x3e\n\x3cp\x3e参数说明：（重复的参数说明就不在这里列举）\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eexecPath\x3c\/code\x3e：\x26lt;String\x26gt; 用来创建子进程的可执行文件，默认是\x3ccode\x3e\/usr\/local\/bin\/node\x3c\/code\x3e。也就是说，你可通过\x3ccode\x3eexecPath\x3c\/code\x3e来指定具体的node可执行文件路径。（比如多个node版本）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eexecArgv\x3c\/code\x3e：\x26lt;Array\x26gt; 传给可执行文件的字符串参数列表。默认是\x3ccode\x3eprocess.execArgv\x3c\/code\x3e，跟父进程保持一致。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3esilent\x3c\/code\x3e：\x26lt;Boolean\x26gt; 默认是\x3ccode\x3efalse\x3c\/code\x3e，即子进程的\x3ccode\x3estdio\x3c\/code\x3e从父进程继承。如果是\x3ccode\x3etrue\x3c\/code\x3e，则直接\x3ccode\x3epipe\x3c\/code\x3e向子进程的\x3ccode\x3echild.stdin\x3c\/code\x3e、\x3ccode\x3echild.stdout\x3c\/code\x3e等。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3estdio\x3c\/code\x3e：\x26lt;Array\x26gt; 如果声明了\x3ccode\x3estdio\x3c\/code\x3e，则会覆盖\x3ccode\x3esilent\x3c\/code\x3e选项的设置。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e例子1：silent\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eparent.js\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var child_process = require(\x27child_process\x27);\n\n\/\/ 例子一：会打印出 output from the child\n\/\/ 默认情况，silent 为 false，子进程的 stdout 等\n\/\/ 从父进程继承\nchild_process.fork(\x27.\/child.js\x27, {\n    silent: false\n});\n\n\/\/ 例子二：不会打印出 output from the silent child\n\/\/ silent 为 true，子进程的 stdout 等\n\/\/ pipe 向父进程\nchild_process.fork(\x27.\/silentChild.js\x27, {\n    silent: true\n});\n\n\/\/ 例子三：打印出 output from another silent child\nvar child = child_process.fork(\x27.\/anotherSilentChild.js\x27, {\n    silent: true\n});\n\nchild.stdout.setEncoding(\x27utf8\x27);\nchild.stdout.on(\x27data\x27, function(data){\n    console.log(data);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child_process = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 例子一：会打印出 output from the child\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 默认情况，silent 为 false，子进程的 stdout 等\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 从父进程继承\x3c\/span\x3e\nchild_process.fork(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/child.js\x27\x3c\/span\x3e, {\n    \x3cspan class=\x22hljs-attr\x22\x3esilent\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 例子二：不会打印出 output from the silent child\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ silent 为 true，子进程的 stdout 等\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ pipe 向父进程\x3c\/span\x3e\nchild_process.fork(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/silentChild.js\x27\x3c\/span\x3e, {\n    \x3cspan class=\x22hljs-attr\x22\x3esilent\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 例子三：打印出 output from another silent child\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child = child_process.fork(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/anotherSilentChild.js\x27\x3c\/span\x3e, {\n    \x3cspan class=\x22hljs-attr\x22\x3esilent\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n});\n\nchild.stdout.setEncoding(\x3cspan class=\x22hljs-string\x22\x3e\x27utf8\x27\x3c\/span\x3e);\nchild.stdout.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3echild.js\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22console.log(\x27output from the child\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27output from the child\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3esilentChild.js\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22console.log(\x27output from the silent child\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27output from the silent child\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3eanotherSilentChild.js\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22console.log(\x27output from another silent child\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27output from another silent child\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子二：ipc\x3c\/p\x3e\n\x3cp\x3eparent.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var child_process = require(\x27child_process\x27);\n\nvar child = child_process.fork(\x27.\/child.js\x27);\n\nchild.on(\x27message\x27, function(m){\n    console.log(\x27message from child: \x27 \x2b JSON.stringify(m));\n});\n\nchild.send({from: \x27parent\x27});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child_process = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child = child_process.fork(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/child.js\x27\x3c\/span\x3e);\n\nchild.on(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3em\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27message from child: \x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(m));\n});\n\nchild.send({\x3cspan class=\x22hljs-attr\x22\x3efrom\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27parent\x27\x3c\/span\x3e});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22process.on(\x27message\x27, function(m){\n    console.log(\x27message from parent: \x27 \x2b JSON.stringify(m));\n});\n\nprocess.send({from: \x27child\x27});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eprocess.on(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3em\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27message from parent: \x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(m));\n});\n\nprocess.send({\x3cspan class=\x22hljs-attr\x22\x3efrom\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27child\x27\x3c\/span\x3e});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行结果\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22➜  ipc git:(master) ✗ node parent.js\nmessage from child: {\x26quot;from\x26quot;:\x26quot;child\x26quot;}\nmessage from parent: {\x26quot;from\x26quot;:\x26quot;parent\x26quot;}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22powershell hljs\x22\x3e\x3ccode class=\x22powershell\x22\x3e➜  ipc git:(master) ✗ node parent.js\nmessage from child: {\x3cspan class=\x22hljs-string\x22\x3e\x22from\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22child\x22\x3c\/span\x3e}\nmessage from parent: {\x3cspan class=\x22hljs-string\x22\x3e\x22from\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22parent\x22\x3c\/span\x3e}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子三：execArgv\x3c\/p\x3e\n\x3cp\x3e首先，process.execArgv的定义，参考\x3ca href=\x22https:\/\/nodejs.org\/api\/process.html#process_process_execargv\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e。设置\x3ccode\x3eexecArgv\x3c\/code\x3e的目的一般在于，让子进程跟父进程保持相同的执行环境。\x3c\/p\x3e\n\x3cp\x3e比如，父进程指定了\x3ccode\x3e--harmony\x3c\/code\x3e，如果子进程没有指定，那么就要跪了。\x3c\/p\x3e\n\x3cp\x3eparent.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var child_process = require(\x27child_process\x27);\n\nconsole.log(\x27parent execArgv: \x27 \x2b process.execArgv);\n\nchild_process.fork(\x27.\/child.js\x27, {\n    execArgv: process.execArgv\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child_process = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27parent execArgv: \x27\x3c\/span\x3e \x2b process.execArgv);\n\nchild_process.fork(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/child.js\x27\x3c\/span\x3e, {\n    \x3cspan class=\x22hljs-attr\x22\x3eexecArgv\x3c\/span\x3e: process.execArgv\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3echild.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22console.log(\x27child execArgv: \x27 \x2b process.execArgv);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27child execArgv: \x27\x3c\/span\x3e \x2b process.execArgv);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行结果\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22➜  execArgv git:(master) ✗ node --harmony parent.js\nparent execArgv: --harmony\nchild execArgv: --harmony\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22powershell hljs\x22\x3e\x3ccode class=\x22powershell\x22\x3e➜  execArgv git:(master) ✗ node --harmony parent.js\nparent execArgv: --harmony\nchild execArgv: --harmony\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子3：execPath（TODO 待举例子）\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3echild_process.spawn(command, args)\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3ecommand\x3c\/code\x3e：要执行的命令\x3c\/p\x3e\n\x3cp\x3eoptions参数说明：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eargv0\x3c\/code\x3e：[String] 这货比较诡异，在uninx、windows上表现不一样。有需要再深究。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3estdio\x3c\/code\x3e：[Array] | [String] 子进程的stdio。参考\x3ca href=\x22https:\/\/nodejs.org\/api\/child_process.html#child_process_options_stdio\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3edetached\x3c\/code\x3e：[Boolean] 让子进程独立于父进程之外运行。同样在不同平台上表现有差异，具体参考\x3ca href=\x22https:\/\/nodejs.org\/api\/child_process.html#child_process_options_detached\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eshell\x3c\/code\x3e：[Boolean] | [String] 如果是\x3ccode\x3etrue\x3c\/code\x3e，在shell里运行程序。默认是\x3ccode\x3efalse\x3c\/code\x3e。（很有用，比如 可以通过 \/bin\/sh -c xxx 来实现 .exec() 这样的效果）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e例子1：基础例子\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var spawn = require(\x27child_process\x27).spawn;\nvar ls = spawn(\x27ls\x27, [\x27-al\x27]);\n\nls.stdout.on(\x27data\x27, function(data){\n    console.log(\x27data from child: \x27 \x2b data);\n});\n\n\nls.stderr.on(\x27data\x27, function(data){\n    console.log(\x27error from child: \x27 \x2b data);\n});\n\nls.on(\x27close\x27, function(code){\n    console.log(\x27child exists with code: \x27 \x2b code);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e spawn = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).spawn;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ls = spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27ls\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27-al\x27\x3c\/span\x3e]);\n\nls.stdout.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27data from child: \x27\x3c\/span\x3e \x2b data);\n});\n\n\nls.stderr.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27error from child: \x27\x3c\/span\x3e \x2b data);\n});\n\nls.on(\x3cspan class=\x22hljs-string\x22\x3e\x27close\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecode\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27child exists with code: \x27\x3c\/span\x3e \x2b code);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子2：声明stdio\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var spawn = require(\x27child_process\x27).spawn;\nvar ls = spawn(\x27ls\x27, [\x27-al\x27], {\n    stdio: \x27inherit\x27\n});\n\nls.on(\x27close\x27, function(code){\n    console.log(\x27child exists with code: \x27 \x2b code);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e spawn = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).spawn;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ls = spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27ls\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27-al\x27\x3c\/span\x3e], {\n    \x3cspan class=\x22hljs-attr\x22\x3estdio\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27inherit\x27\x3c\/span\x3e\n});\n\nls.on(\x3cspan class=\x22hljs-string\x22\x3e\x27close\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecode\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27child exists with code: \x27\x3c\/span\x3e \x2b code);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子3：声明使用shell\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var spawn = require(\x27child_process\x27).spawn;\n\n\/\/ 运行 echo \x26quot;hello nodejs\x26quot; | wc\nvar ls = spawn(\x27bash\x27, [\x27-c\x27, \x27echo \x26quot;hello nodejs\x26quot; | wc\x27], {\n    stdio: \x27inherit\x27,\n    shell: true\n});\n\nls.on(\x27close\x27, function(code){\n    console.log(\x27child exists with code: \x27 \x2b code);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e spawn = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).spawn;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 运行 echo \x22hello nodejs\x22 | wc\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ls = spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27bash\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27-c\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27echo \x22hello nodejs\x22 | wc\x27\x3c\/span\x3e], {\n    \x3cspan class=\x22hljs-attr\x22\x3estdio\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27inherit\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eshell\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n});\n\nls.on(\x3cspan class=\x22hljs-string\x22\x3e\x27close\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecode\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27child exists with code: \x27\x3c\/span\x3e \x2b code);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子4：错误处理，包含两种场景，这两种场景有不同的处理方式。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e场景1：命令本身不存在，创建子进程报错。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e场景2：命令存在，但运行过程报错。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var spawn = require(\x27child_process\x27).spawn;\nvar child = spawn(\x27bad_command\x27);\n\nchild.on(\x27error\x27, (err) =\x3e {\n  console.log(\x27Failed to start child process 1.\x27);\n});\n\nvar child2 = spawn(\x27ls\x27, [\x27nonexistFile\x27]);\n\nchild2.stderr.on(\x27data\x27, function(data){\n    console.log(\x27Error msg from process 2: \x27 \x2b data);\n});\n\nchild2.on(\x27error\x27, (err) =\x3e {\n  console.log(\x27Failed to start child process 2.\x27);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e spawn = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).spawn;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child = spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27bad_command\x27\x3c\/span\x3e);\n\nchild.on(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e, (err) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Failed to start child process 1.\x27\x3c\/span\x3e);\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child2 = spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27ls\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27nonexistFile\x27\x3c\/span\x3e]);\n\nchild2.stderr.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Error msg from process 2: \x27\x3c\/span\x3e \x2b data);\n});\n\nchild2.on(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e, (err) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Failed to start child process 2.\x27\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行结果如下。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22➜  spawn git:(master) ✗ node error\/error.js\nFailed to start child process 1.\nError msg from process 2: ls: nonexistFile: No such file or directory\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22powershell hljs\x22\x3e\x3ccode class=\x22powershell\x22\x3e➜  spawn git:(master) ✗ node error\/error.js\nFailed to start child \x3cspan class=\x22hljs-keyword\x22\x3eprocess\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e.\nError msg from \x3cspan class=\x22hljs-keyword\x22\x3eprocess\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e: ls: nonexistFile: No such file or directory\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子5：echo \x22hello nodejs\x22 | grep \x22nodejs\x22\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ echo \x26quot;hello nodejs\x26quot; | grep \x26quot;nodejs\x26quot;\nvar child_process = require(\x27child_process\x27);\n\nvar echo = child_process.spawn(\x27echo\x27, [\x27hello nodejs\x27]);\nvar grep = child_process.spawn(\x27grep\x27, [\x27nodejs\x27]);\n\ngrep.stdout.setEncoding(\x27utf8\x27);\n\necho.stdout.on(\x27data\x27, function(data){\n    grep.stdin.write(data);\n});\n\necho.on(\x27close\x27, function(code){\n    if(code!==0){\n        console.log(\x27echo exists with code: \x27 \x2b code);\n    }\n    grep.stdin.end();\n});\n\ngrep.stdout.on(\x27data\x27, function(data){\n    console.log(\x27grep: \x27 \x2b data);\n});\n\ngrep.on(\x27close\x27, function(code){\n    if(code!==0){\n        console.log(\x27grep exists with code: \x27 \x2b code);\n    }\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ echo \x22hello nodejs\x22 | grep \x22nodejs\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child_process = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e echo = child_process.spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27echo\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27hello nodejs\x27\x3c\/span\x3e]);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e grep = child_process.spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27grep\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27nodejs\x27\x3c\/span\x3e]);\n\ngrep.stdout.setEncoding(\x3cspan class=\x22hljs-string\x22\x3e\x27utf8\x27\x3c\/span\x3e);\n\necho.stdout.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    grep.stdin.write(data);\n});\n\necho.on(\x3cspan class=\x22hljs-string\x22\x3e\x27close\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecode\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(code!==\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27echo exists with code: \x27\x3c\/span\x3e \x2b code);\n    }\n    grep.stdin.end();\n});\n\ngrep.stdout.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27grep: \x27\x3c\/span\x3e \x2b data);\n});\n\ngrep.on(\x3cspan class=\x22hljs-string\x22\x3e\x27close\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecode\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(code!==\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27grep exists with code: \x27\x3c\/span\x3e \x2b code);\n    }\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22➜  spawn git:(master) ✗ node pipe\/pipe.js\ngrep: hello nodejs\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22powershell hljs\x22\x3e\x3ccode class=\x22powershell\x22\x3e➜  spawn git:(master) ✗ node pipe\/pipe.js\ngrep: hello nodejs\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e关于\x3ccode\x3eoptions.stdio\x3c\/code\x3e\n\x3c\/h2\x3e\n\x3cp\x3e默认值：[\x27pipe\x27, \x27pipe\x27, \x27pipe\x27]，这意味着：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3echild.stdin、child.stdout 不是\x3ccode\x3eundefined\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e可以通过监听 \x3ccode\x3edata\x3c\/code\x3e 事件，来获取数据。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e基础例子\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var spawn = require(\x27child_process\x27).spawn;\nvar ls = spawn(\x27ls\x27, [\x27-al\x27]);\n\nls.stdout.on(\x27data\x27, function(data){\n    console.log(\x27data from child: \x27 \x2b data);\n});\n\nls.on(\x27close\x27, function(code){\n    console.log(\x27child exists with code: \x27 \x2b code);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e spawn = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).spawn;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e ls = spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27ls\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27-al\x27\x3c\/span\x3e]);\n\nls.stdout.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27data from child: \x27\x3c\/span\x3e \x2b data);\n});\n\nls.on(\x3cspan class=\x22hljs-string\x22\x3e\x27close\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecode\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27child exists with code: \x27\x3c\/span\x3e \x2b code);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e通过child.stdin.write()写入\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var spawn = require(\x27child_process\x27).spawn;\nvar grep = spawn(\x27grep\x27, [\x27nodejs\x27]);\n\nsetTimeout(function(){\n    grep.stdin.write(\x27hello nodejs \\n hello javascript\x27);\n    grep.stdin.end();\n}, 2000);\n\ngrep.stdout.on(\x27data\x27, function(data){\n    console.log(\x27data from grep: \x27 \x2b data);\n});\n\ngrep.on(\x27close\x27, function(code){\n    console.log(\x27grep exists with code: \x27 \x2b code);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e spawn = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).spawn;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e grep = spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27grep\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27nodejs\x27\x3c\/span\x3e]);\n\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    grep.stdin.write(\x3cspan class=\x22hljs-string\x22\x3e\x27hello nodejs \\n hello javascript\x27\x3c\/span\x3e);\n    grep.stdin.end();\n}, \x3cspan class=\x22hljs-number\x22\x3e2000\x3c\/span\x3e);\n\ngrep.stdout.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27data from grep: \x27\x3c\/span\x3e \x2b data);\n});\n\ngrep.on(\x3cspan class=\x22hljs-string\x22\x3e\x27close\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ecode\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27grep exists with code: \x27\x3c\/span\x3e \x2b code);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e异步 vs 同步\x3c\/h2\x3e\n\x3cp\x3e大部分时候，子进程的创建是异步的。也就是说，它不会阻塞当前的事件循环，这对于性能的提升很有帮助。\x3c\/p\x3e\n\x3cp\x3e当然，有的时候，同步的方式会更方便（阻塞事件循环），比如通过子进程的方式来执行shell脚本时。\x3c\/p\x3e\n\x3cp\x3enode同样提供同步的版本，比如：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3espawnSync()\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eexecSync()\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eexecFileSync()\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e关于\x3ccode\x3eoptions.detached\x3c\/code\x3e\n\x3c\/h2\x3e\n\x3cp\x3e由于木有在windows上做测试，于是先贴原文\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eOn Windows, setting options.detached to true makes it possible for the child process to continue running after the parent exits. The child will have its own console window. Once enabled for a child process, it cannot be disabled.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e在非window是平台上的表现\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eOn non-Windows platforms, if options.detached is set to true, the child process will be made the leader of a new process group and session. Note that child processes may continue running after the parent exits regardless of whether they are detached or not. See setsid(2) for more information.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e默认情况：父进程等待子进程结束。\x3c\/h3\x3e\n\x3cp\x3e子进程。可以看到，有个定时器一直在跑\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var times = 0;\nsetInterval(function(){\n    console.log(\x2b\x2btimes);\n}, 1000);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e times = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\nsetInterval(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x2b\x2btimes);\n}, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行下面代码，会发现父进程一直hold着不退出。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var child_process = require(\x27child_process\x27);\nchild_process.spawn(\x27node\x27, [\x27child.js\x27], {\n    \/\/ stdio: \x27inherit\x27\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ruby\x22\x3e\x3ccode\x3evar child_process = \x3cspan class=\x22hljs-keyword\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\nchild_process.spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27node\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27child.js\x27\x3c\/span\x3e], {\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e \x3cspan class=\x22hljs-symbol\x22\x3estdio:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27inherit\x27\x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e通过child.unref()让父进程退出\x3c\/h3\x3e\n\x3cp\x3e调用\x3ccode\x3echild.unref()\x3c\/code\x3e，将子进程从父进程的事件循环中剔除。于是父进程可以愉快的退出。这里有几个要点\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e调用\x3ccode\x3echild.unref()\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e设置\x3ccode\x3edetached\x3c\/code\x3e为\x3ccode\x3etrue\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e设置\x3ccode\x3estdio\x3c\/code\x3e为\x3ccode\x3eignore\x3c\/code\x3e（这点容易忘）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var child_process = require(\x27child_process\x27);\nvar child = child_process.spawn(\x27node\x27, [\x27child.js\x27], {\n    detached: true,\n    stdio: \x27ignore\x27  \/\/ 备注：如果不置为 ignore，那么 父进程还是不会退出\n    \/\/ stdio: \x27inherit\x27\n});\n\nchild.unref();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child_process = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child = child_process.spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27node\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27child.js\x27\x3c\/span\x3e], {\n    \x3cspan class=\x22hljs-attr\x22\x3edetached\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3estdio\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27ignore\x27\x3c\/span\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 备注：如果不置为 ignore，那么 父进程还是不会退出\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ stdio: \x27inherit\x27\x3c\/span\x3e\n});\n\nchild.unref();\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e将\x3ccode\x3estdio\x3c\/code\x3e重定向到文件\x3c\/h3\x3e\n\x3cp\x3e除了直接将stdio设置为\x3ccode\x3eignore\x3c\/code\x3e，还可以将它重定向到本地的文件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var child_process = require(\x27child_process\x27);\nvar fs = require(\x27fs\x27);\n\nvar out = fs.openSync(\x27.\/out.log\x27, \x27a\x27);\nvar err = fs.openSync(\x27.\/err.log\x27, \x27a\x27);\n\nvar child = child_process.spawn(\x27node\x27, [\x27child.js\x27], {\n    detached: true,\n    stdio: [\x27ignore\x27, out, err]\n});\n\nchild.unref();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child_process = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e fs = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27fs\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e out = fs.openSync(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/out.log\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e err = fs.openSync(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/err.log\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child = child_process.spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27node\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27child.js\x27\x3c\/span\x3e], {\n    \x3cspan class=\x22hljs-attr\x22\x3edetached\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3estdio\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27ignore\x27\x3c\/span\x3e, out, err]\n});\n\nchild.unref();\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader14\x22\x3eexec()与execFile()之间的区别\x3c\/h2\x3e\n\x3cp\x3e首先，exec() 内部调用 execFile() 来实现，而 execFile() 内部调用 spawn() 来实现。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eexec() -\x26gt; execFile() -\x26gt; spawn()\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e其次，execFile() 内部默认将 options.shell 设置为false，exec() 默认不是false。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader15\x22\x3eClass: ChildProcess\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e通过\x3ccode\x3echild_process.spawn()\x3c\/code\x3e等创建，一般不直接用构造函数创建。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e继承了\x3ccode\x3eEventEmitters\x3c\/code\x3e，所以有\x3ccode\x3e.on()\x3c\/code\x3e等方法。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3e各种事件\x3c\/h3\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3eclose\x3c\/h3\x3e\n\x3cp\x3e当stdio流关闭时触发。这个事件跟\x3ccode\x3eexit\x3c\/code\x3e不同，因为多个进程可以共享同个stdio流。   \x3cbr\x3e参数：code（退出码，如果子进程是自己退出的话），signal（结束子进程的信号）\x3cbr\x3e问题：code一定是有的吗？（从对code的注解来看好像不是）比如用\x3ccode\x3ekill\x3c\/code\x3e杀死子进程，那么，code是？\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader18\x22\x3eexit\x3c\/h3\x3e\n\x3cp\x3e参数：code、signal，如果子进程是自己退出的，那么\x3ccode\x3ecode\x3c\/code\x3e就是退出码，否则为null；如果子进程是通过信号结束的，那么，\x3ccode\x3esignal\x3c\/code\x3e就是结束进程的信号，否则为null。这两者中，一者肯定不为null。\x3cbr\x3e注意事项：\x3ccode\x3eexit\x3c\/code\x3e事件触发时，子进程的stdio stream可能还打开着。（场景？）此外，nodejs监听了SIGINT和SIGTERM信号，也就是说，nodejs收到这两个信号时，不会立刻退出，而是先做一些清理的工作，然后重新抛出这两个信号。（目测此时js可以做清理工作了，比如关闭数据库等。）\x3c\/p\x3e\n\x3cp\x3eSIGINT：interrupt，程序终止信号，通常在用户按下CTRL\x2bC时发出，用来通知前台进程终止进程。\x3cbr\x3eSIGTERM：terminate，程序结束信号，该信号可以被阻塞和处理，通常用来要求程序自己正常退出。shell命令kill缺省产生这个信号。如果信号终止不了，我们才会尝试SIGKILL（强制终止）。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eAlso, note that Node.js establishes signal handlers for SIGINT and SIGTERM and Node.js processes will not terminate immediately due to receipt of those signals. Rather, Node.js will perform a sequence of cleanup actions and then will re-raise the handled signal.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader19\x22\x3eerror\x3c\/h3\x3e\n\x3cp\x3e当发生下列事情时，error就会被触发。当error触发时，exit可能触发，也可能不触发。（内心是崩溃的）\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e无法创建子进程。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e进程无法kill。（TODO 举例子）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e向子进程发送消息失败。（TODO  举例子）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader20\x22\x3emessage\x3c\/h3\x3e\n\x3cp\x3e当采用\x3ccode\x3eprocess.send()\x3c\/code\x3e来发送消息时触发。\x3cbr\x3e参数：\x3ccode\x3emessage\x3c\/code\x3e，为json对象，或者primitive value；\x3ccode\x3esendHandle\x3c\/code\x3e，net.Socket对象，或者net.Server对象（熟悉cluster的同学应该对这个不陌生）\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e.connected\x3c\/strong\x3e：当调用\x3ccode\x3e.disconnected()\x3c\/code\x3e时，设为false。代表是否能够从子进程接收消息，或者对子进程发送消息。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e.disconnect()\x3c\/strong\x3e：关闭父进程、子进程之间的IPC通道。当这个方法被调用时，\x3ccode\x3edisconnect\x3c\/code\x3e事件就会触发。如果子进程是node实例（通过child_process.fork()创建），那么在子进程内部也可以主动调用\x3ccode\x3eprocess.disconnect()\x3c\/code\x3e来终止IPC通道。参考\x3ca href=\x22https:\/\/nodejs.org\/api\/process.html#process_process_disconnect\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eprocess.disconnect\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader21\x22\x3e非重要的备忘点\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader22\x22\x3ewindows平台上的\x3ccode\x3ecmd\x3c\/code\x3e、\x3ccode\x3ebat\x3c\/code\x3e\n\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3eThe importance of the distinction between child_process.exec() and child_process.execFile() can vary based on platform. On Unix-type operating systems (Unix, Linux, OSX) child_process.execFile() can be more efficient because it does not spawn a shell. On Windows, however, .bat and .cmd files are not executable on their own without a terminal, and therefore cannot be launched using child_process.execFile(). When running on Windows, .bat and .cmd files can be invoked using child_process.spawn() with the shell option set, with child_process.exec(), or by spawning cmd.exe and passing the .bat or .cmd file as an argument (which is what the shell option and child_process.exec() do).\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ On Windows Only ...\nconst spawn = require(\x27child_process\x27).spawn;\nconst bat = spawn(\x27cmd.exe\x27, [\x27\/c\x27, \x27my.bat\x27]);\n\nbat.stdout.on(\x27data\x27, (data) =\x3e {\n  console.log(data);\n});\n\nbat.stderr.on(\x27data\x27, (data) =\x3e {\n  console.log(data);\n});\n\nbat.on(\x27exit\x27, (code) =\x3e {\n  console.log(`Child exited with code ${code}`);\n});\n\n\/\/ OR...\nconst exec = require(\x27child_process\x27).exec;\nexec(\x27my.bat\x27, (err, stdout, stderr) =\x3e {\n  if (err) {\n    console.error(err);\n    return;\n  }\n  console.log(stdout);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ On Windows Only ...\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e spawn = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).spawn;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e bat = spawn(\x3cspan class=\x22hljs-string\x22\x3e\x27cmd.exe\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27\/c\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27my.bat\x27\x3c\/span\x3e]);\n\nbat.stdout.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, (data) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data);\n});\n\nbat.stderr.on(\x3cspan class=\x22hljs-string\x22\x3e\x27data\x27\x3c\/span\x3e, (data) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data);\n});\n\nbat.on(\x3cspan class=\x22hljs-string\x22\x3e\x27exit\x27\x3c\/span\x3e, (code) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e`Child exited with code \x3cspan class=\x22hljs-subst\x22\x3e${code}\x3c\/span\x3e`\x3c\/span\x3e);\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ OR...\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e exec = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).exec;\nexec(\x3cspan class=\x22hljs-string\x22\x3e\x27my.bat\x27\x3c\/span\x3e, (err, stdout, stderr) =\x26gt; {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(err);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(stdout);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader23\x22\x3e进程标题\x3c\/h3\x3e\n\x3cp\x3eNote: Certain platforms (OS X, Linux) will use the value of argv[0] for the process title while others (Windows, SunOS) will use command.\x3c\/p\x3e\n\x3cp\x3eNote: Node.js currently overwrites argv[0] with process.execPath on startup, so process.argv[0] in a Node.js child process will not match the argv0 parameter passed to spawn from the parent, retrieve it with the process.argv0 property instead.\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader24\x22\x3e代码运行次序的问题\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3ep.js\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const cp = require(\x27child_process\x27);\nconst n = cp.fork(`${__dirname}\/sub.js`);\n\nconsole.log(\x271\x27);\n\nn.on(\x27message\x27, (m) =\x3e {\n  console.log(\x27PARENT got message:\x27, m);\n});\n\nconsole.log(\x272\x27);\n\nn.send({ hello: \x27world\x27 });\n\nconsole.log(\x273\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e cp = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e n = cp.fork(\x3cspan class=\x22hljs-string\x22\x3e`\x3cspan class=\x22hljs-subst\x22\x3e${__dirname}\x3c\/span\x3e\/sub.js`\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e);\n\nn.on(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, (m) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27PARENT got message:\x27\x3c\/span\x3e, m);\n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e);\n\nn.send({ \x3cspan class=\x22hljs-attr\x22\x3ehello\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27world\x27\x3c\/span\x3e });\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3esub.js\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22console.log(\x274\x27);\nprocess.on(\x27message\x27, (m) =\x3e {\n  console.log(\x27CHILD got message:\x27, m);\n});\n\nprocess.send({ foo: \x27bar\x27 });\nconsole.log(\x275\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x274\x27\x3c\/span\x3e);\nprocess.on(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, (m) =\x26gt; {\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27CHILD got message:\x27\x3c\/span\x3e, m);\n});\n\nprocess.send({ \x3cspan class=\x22hljs-attr\x22\x3efoo\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27bar\x27\x3c\/span\x3e });\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x275\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行\x3ccode\x3enode p.js\x3c\/code\x3e，打印出来的内容如下\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22➜  ch node p.js       \n1\n2\n3\n4\n5\nPARENT got message: { foo: \x27bar\x27 }\nCHILD got message: { hello: \x27world\x27 }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22powershell hljs\x22\x3e\x3ccode class=\x22powershell\x22\x3e➜  ch node p.js       \n\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e\nPARENT got message: { foo: \x3cspan class=\x22hljs-string\x22\x3e\x27bar\x27\x3c\/span\x3e }\nCHILD got message: { hello: \x3cspan class=\x22hljs-string\x22\x3e\x27world\x27\x3c\/span\x3e }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e再来个例子\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ p2.js\nvar fork = require(\x27child_process\x27).fork;\n\nconsole.log(\x27p: 1\x27);\n\nfork(\x27.\/c2.js\x27);\n\nconsole.log(\x27p: 2\x27);\n\n\/\/ 从测试结果来看，同样是70ms，有的时候，定时器回调比子进程先执行，有的时候比子进程慢执行。\nconst t = 70;\nsetTimeout(function(){\n    console.log(\x27p: 3 in %s\x27, t);\n}, t);\n\n\n\/\/ c2.js\nconsole.log(\x27c: 1\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ p2.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e fork = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27child_process\x27\x3c\/span\x3e).fork;\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p: 1\x27\x3c\/span\x3e);\n\nfork(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/c2.js\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p: 2\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 从测试结果来看，同样是70ms，有的时候，定时器回调比子进程先执行，有的时候比子进程慢执行。\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e t = \x3cspan class=\x22hljs-number\x22\x3e70\x3c\/span\x3e;\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p: 3 in %s\x27\x3c\/span\x3e, t);\n}, t);\n\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ c2.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27c: 1\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader25\x22\x3e关于NODE_CHANNEL_FD\x3c\/h3\x3e\n\x3cp\x3echild_process.fork()时，如果指定了execPath，那么父、子进程间通过NODE_CHANNEL_FD 进行通信。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eNode.js processes launched with a custom execPath will communicate with the parent process using the file descriptor (fd) identified using the environment variable NODE_CHANNEL_FD on the child process. The input and output on this fd is expected to be line delimited JSON objects.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader26\x22\x3e写在后面\x3c\/h2\x3e\n\x3cp\x3e内容较多，如有错漏及建议请指出。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader27\x22\x3e相关链接\x3c\/h2\x3e\n\x3cp\x3e官方文档：\x3ca href=\x22https:\/\/nodejs.org\/api\/child_process.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/nodejs.org\/api\/child_...\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Nodejs进阶：如何玩转子进程（child_process）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007735211">https://segmentfault.com/a/1190000007735211</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/3txhfn3ejcb/" target="_blank">https://alili.tech/archive/3txhfn3ejcb/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5fmk2pl6rab/">2016年前端开发者深度调研，看看别人使用什么技术体系<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/stp6408xnu/">Bootstrap使用模态框modal实现表单提交弹出框<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/fu7a86e9uyh/">CSS水平垂直居中总结<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/r0w29esklr/">JS 里怎么给数组填充默认值<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/i00hiszlr1/">JavaScript - EventEmitter 背后的秘密<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/u2la0cn9do/">JavaScript 精度丢失问题<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/yr7v8e9fao/">Promise介绍--规范篇<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/9lyxyz4wc6g/">QQ音乐API整理<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/84zzlljmes4/">SegmentFault 技术周刊 Vol.14 - 进阶 Vue 2.0<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/88a6vlwjvy9/">SegmentFault 技术周刊 Vol.15 - “一天精通 Chrome 开发”<aside class="dates">2019-01-30</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>