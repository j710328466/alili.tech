<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="在重构脚手架中掌握React/Redux/Webpack2基本套路"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>在重构脚手架中掌握React/Redux/Webpack2基本套路 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/jbjafkzanw/",
				"appid": "1613049289050283", 
				"title": "在重构脚手架中掌握React/Redux/Webpack2基本套路 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-02T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/urvpnai88r/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/pmf9wfq8qlm/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f&text=%e5%9c%a8%e9%87%8d%e6%9e%84%e8%84%9a%e6%89%8b%e6%9e%b6%e4%b8%ad%e6%8e%8c%e6%8f%a1React%2fRedux%2fWebpack2%e5%9f%ba%e6%9c%ac%e5%a5%97%e8%b7%af"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f&text=%e5%9c%a8%e9%87%8d%e6%9e%84%e8%84%9a%e6%89%8b%e6%9e%b6%e4%b8%ad%e6%8e%8c%e6%8f%a1React%2fRedux%2fWebpack2%e5%9f%ba%e6%9c%ac%e5%a5%97%e8%b7%af"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f&title=%e5%9c%a8%e9%87%8d%e6%9e%84%e8%84%9a%e6%89%8b%e6%9e%b6%e4%b8%ad%e6%8e%8c%e6%8f%a1React%2fRedux%2fWebpack2%e5%9f%ba%e6%9c%ac%e5%a5%97%e8%b7%af"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f&is_video=false&description=%e5%9c%a8%e9%87%8d%e6%9e%84%e8%84%9a%e6%89%8b%e6%9e%b6%e4%b8%ad%e6%8e%8c%e6%8f%a1React%2fRedux%2fWebpack2%e5%9f%ba%e6%9c%ac%e5%a5%97%e8%b7%af"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%9c%a8%e9%87%8d%e6%9e%84%e8%84%9a%e6%89%8b%e6%9e%b6%e4%b8%ad%e6%8e%8c%e6%8f%a1React%2fRedux%2fWebpack2%e5%9f%ba%e6%9c%ac%e5%a5%97%e8%b7%af&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f&title=%e5%9c%a8%e9%87%8d%e6%9e%84%e8%84%9a%e6%89%8b%e6%9e%b6%e4%b8%ad%e6%8e%8c%e6%8f%a1React%2fRedux%2fWebpack2%e5%9f%ba%e6%9c%ac%e5%a5%97%e8%b7%af"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f&title=%e5%9c%a8%e9%87%8d%e6%9e%84%e8%84%9a%e6%89%8b%e6%9e%b6%e4%b8%ad%e6%8e%8c%e6%8f%a1React%2fRedux%2fWebpack2%e5%9f%ba%e6%9c%ac%e5%a5%97%e8%b7%af"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f&title=%e5%9c%a8%e9%87%8d%e6%9e%84%e8%84%9a%e6%89%8b%e6%9e%b6%e4%b8%ad%e6%8e%8c%e6%8f%a1React%2fRedux%2fWebpack2%e5%9f%ba%e6%9c%ac%e5%a5%97%e8%b7%af"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fjbjafkzanw%2f&title=%e5%9c%a8%e9%87%8d%e6%9e%84%e8%84%9a%e6%89%8b%e6%9e%b6%e4%b8%ad%e6%8e%8c%e6%8f%a1React%2fRedux%2fWebpack2%e5%9f%ba%e6%9c%ac%e5%a5%97%e8%b7%af"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">在重构脚手架中掌握React/Redux/Webpack2基本套路</h1><div class="meta"><div class="postdate"><time datetime="2019-02-02" itemprop="datePublished">2019-02-02</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\n\x3cp\x3e本文从属于笔者的\x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/Web-Develop-Introduction-And-Best-Practices\/tree\/master\/Frontend\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWeb Frontend Introduction And Best Practices:前端入门与最佳实践\x3c\/a\x3e,项目的Github地址为\x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/Webpack2-React-Redux-Boilerplate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWebpack2-React-Redux-Boilerplate\x3c\/a\x3e.\x3c\/p\x3e\n\x3cp\x3eWarning!笔者自己构建的基于Webpack\x2bReact\x2bRedux的脚手架已经经历了三个版本,之前的两个版本参考\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000003873739\x22\x3eWebpack实战之Quick Start\x3c\/a\x3e以及\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005122575\x22 target=\x22_blank\x22\x3e我的Webpack套装\x3c\/a\x3e。在本文文首此处,我必须严肃吐槽下,我深刻感觉到Boilerplate就像当年的Rails,方便入门的同时会给你无尽的束缚,因此笔者不建议任何人在正式项目中直接使用自己不能完全掌控的脚手架。我觉得我是无法忘记当初被\x3ca href=\x22https:\/\/github.com\/erikras\/react-redux-universal-hot-example\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-redux-universal-hot-example\x3c\/a\x3e支配的恐惧。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3eWebpack2 React Redux Boilerplate\x3c\/h1\x3e\n\x3cblockquote\x3e\x3cp\x3e核心组件代码与脚手架之间务必存在有机分割，整个程序架构清晰易懂。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007166610?w=1400\x26amp;h=1120\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007166610?w=1400\x26amp;h=1120\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e如果你是完全的React初学者,那么建议首先了解下\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000006055973\x22\x3e使用Facebook的create-react-app快速构建React开发环境\x3c\/a\x3e，同时参考笔者的\x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/Web-Develop-Introduction-And-Best-Practices\/tree\/master\/Frontend\/Framework\/View\/React\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReact 入门与最佳实践\x3c\/a\x3e以及\x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/Web-Develop-Introduction-And-Best-Practices\/tree\/master\/Frontend\/Framework\/StateManagement\/Redux\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRedux 入门与最佳实践\x3c\/a\x3e。本项目算是个半自动化的脚手架工具,笔者并不希望做成完全傻瓜式的开箱即用的工具,这只会给你的项目埋下危险的伏笔,希望每个可能用这个Boilerplate的同学都能阅读文本,至少要保证对文本提及的知识点有个全局的了解。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3eFeatures\x3c\/h2\x3e\n\x3cp\x3e本部分假设你已经对Webpack有了大概的了解，这里我们会针对笔者自己在生产环境下使用的Webpack编译脚本进行的一个总结，在介绍具体的配置方案之前笔者想先概述下该配置文件的设计的目标，或者说是笔者认为一个前端编译环境应该达成的特性，这样以后即使Webpack被淘汰了也可以利用其他的譬如JSPM之类的来完成类似的工作。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e考虑到同一项目对多编译目标的支持，包括开发环境、纯前端运行环境（包括Cordova、APICloud、Weapp这种面向移动端的方案）、同构直出环境，并且保证项目可以在这三个环境之间平滑切换，合理分割脚手架工具与核心应用代码。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e单一的配置文件：很多项目里面是把开发环境与生产环境写了两个配置文件，可能笔者比较懒吧，不喜欢这么做，因此笔者的第一个特性就是单一的配置文件，然后通过npm封装不同的编译命令传入环境变量，然后在配置文件中根据不同的环境变量进行动态响应。另外，要保证一个Boilerplate能够在最小修改的情况下应用到其他项目。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e多应用入口支持：无论是单页应用还是多页应用，在Webpack中往往会把一个html文件作为一个入口。笔者在进行项目开发时，往往会需要面对多个入口，即多个HTML文件，然后这个HTML文件加载不同的JS或者CSS文件。譬如登录页面与主界面，往往可以视作两个不同的入口。Webpack原生提倡的配置方案是面向过程的，而笔者在这里是面向应用方式的封装配置。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e调试时热加载：这个特性毋庸多言，不过热加载因为走得是中间服务器，同时只能支持监听一个项目，因此需要在多应用配置的情况下加上一个参数，即指定当前调试的应用。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e自动化的Polyfill：这个是Webpack自带的一个特性吧，不过笔者就加以整合，主要是实现了对于ES6、React、CSS(Flexbox)等等的自动Polyfill。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e资源文件的自动管理：这部分主要指从模板自动生成目标HTML文件、自动处理图片\/字体等资源文件以及自动提取出CSS文件等。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e文件分割与异步加载：可以将多个应用中的公共文件，譬如都引用了React类库的话，可以将这部分文件提取出来，这样前端可以减少一定的数据传输。另外的话还需要支持组件的异步加载，譬如用了React Router，那需要支持组件在需要时再加载。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e真的需要Redux吗?\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000007103433\x22\x3e思考:我需要怎样的前端状态管理工具?\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000006966262\x22 target=\x22_blank\x22\x3e你不一定需要Redux\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\x3c\/blockquote\x3e\n\x3cp\x3e虽然本项目是面向Webpack\x2bReact\x2bRedux的Boilerplate，但是笔者还是希望在此抛出这个问题，也是便于大家能够理解Redux。对于这个问题笔者没有明确的答案,但是在这两年的自己对于Redux的实战中,也一直在摇把。我坚定的认为Redux指明了解决某类问题的正确方向,但是它真的适合于所有的项目吗?笔者在\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000004292245\x22\x3e我的前端之路\x3c\/a\x3e一文中提及,从以DOM操作为核心的jQuery时代到以声明式组件为核心的React时代的变迁是声明式编程对于命令式的慢慢代替,而Redux则是纯粹的声明式编程典范。这里以某个登录认证的小例子进行说明，产品的需求是允许用户在登录成功之后在登录页面上显示“登录成功，正在跳转”，然后延时跳转到其他页面。这里强调要在登录页面上进行回显是因为很多人习惯将，跳转作为Side Effect在Thunk或者Saga中就处理了，并没有影响到界面本身。具体的代码对比可以参考\x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/Webpack-React-Redux-Boilerplate\/blob\/master\/src\/react\/component\/login.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e纯粹的React实现的登录跳转\x3c\/a\x3e与\x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/Webpack-React-Redux-Boilerplate\/blob\/master\/src\/redux\/container\/login.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e基于Redux实现的登录跳转\x3c\/a\x3e。首先，如果是纯粹的React命令式的话，会是:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22class ReactComponent{\n  ...\n  if(!isValid){ \/\/isValid是外部传入的状态变量，存放用户是否已经登录\n  \/\/如果尚未登录，则进行登录操作\n  login().then(()=\x3e{\n    \/\/登录成功之后，显示文字并且执行跳转\n    show(\x27登录成功，正在跳转\x27);\n    redirect();\n  });\n}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReactComponent\x3c\/span\x3e{\x3c\/span\x3e\n  ...\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(!isValid){ \x3cspan class=\x22hljs-regexp\x22\x3e\/\/i\x3c\/span\x3esValid是外部传入的状态变量，存放用户是否已经登录\n  \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e如果尚未登录，则进行登录操作\n  login().\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e登录成功之后，显示文字并且执行跳转\n    show(\x3cspan class=\x22hljs-string\x22\x3e\x27登录成功，正在跳转\x27\x3c\/span\x3e);\n    redirect();\n  });\n}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果我们引入Redux，并且将Component中的所有副作用移除的话:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22class ReduxComponent{\n  ...\n  if(!isValid){ \n      login(); \/\/执行登录操作，其会dispatch某个Action，触发外部状态变化\n  }\n  \n  if(shouldRedirect){ \/\/需要添加该变量来记录是否需要进行跳转\n    show(\x27登录成功，正在跳转\x27);\n    dispatch({type:\x27SET_SHOULDREDIRECT_FALSE\x27});\/\/将控制是否跳转的状态变量重置\n    redirect();\n  }\n}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3eReduxComponent\x3c\/span\x3e{\n  ...\n  \x3cspan class=\x22hljs-selector-tag\x22\x3eif\x3c\/span\x3e(!isValid){ \n      \x3cspan class=\x22hljs-selector-tag\x22\x3elogin\x3c\/span\x3e(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/执行登录操作，其会dispatch某个Action，触发外部状态变化\x3c\/span\x3e\n  }\n  \n  \x3cspan class=\x22hljs-selector-tag\x22\x3eif\x3c\/span\x3e(shouldRedirect){ \x3cspan class=\x22hljs-comment\x22\x3e\/\/需要添加该变量来记录是否需要进行跳转\x3c\/span\x3e\n    \x3cspan class=\x22hljs-selector-tag\x22\x3eshow\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27登录成功，正在跳转\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-selector-tag\x22\x3edispatch\x3c\/span\x3e({\x3cspan class=\x22hljs-attribute\x22\x3etype\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27SET_SHOULDREDIRECT_FALSE\x27\x3c\/span\x3e});\x3cspan class=\x22hljs-comment\x22\x3e\/\/将控制是否跳转的状态变量重置\x3c\/span\x3e\n    \x3cspan class=\x22hljs-selector-tag\x22\x3eredirect\x3c\/span\x3e();\n  }\n}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e从上面的例子中我们能看出,就好像能量守恒定理一样,对于任何的业务逻辑的实现要么以命令的方式,要么以声明的方式辅以大量的状态变量（参考基于变量的循环与基于迭代的循环二者的代码复杂度比较）。Redux以函数式编程的强约束将我们很多的逻辑拆分为了多个纯函数表示,并以数据流驱动整个项目。Redux允许我们以支离破碎的逻辑代码与相较于命令式编程膨胀很多的模板代码为代价实现百分百的可测试性与可预测性。经过这么长时间的摸索与社区广泛的讨论实践，Redux的优势与劣势都已经很明显了。对于具体的使用者也是见仁见智，以笔者而言因为一直都在中小型企业中，往往对于产品进度的要求会多余测试，并且更多的以人工测试为主，因此笔者目前是尝试在项目中混用\x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/Web-Develop-Introduction-And-Best-Practices\/tree\/master\/OpenSource\/mobx-react-webpack-boilerplate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eMobX\x3c\/a\x3e与Redux，希望能够有效平衡开发速度与整体的鲁棒性\/可扩展性。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3ePersonal Best Practice\x3c\/h2\x3e\n\x3cp\x3e本部分是列举一些通用的个人最佳实践的感受，不局限于React或者Redux。具体的关于React与Redux的实践建议会在下文中介绍。\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3ePromise\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e使用Promise进行异步操作，建议使用await\/async作为Promise语法糖构建异步函数。\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3efetch\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e使用fetch作为统一的数据获取函数，在本项目中使用了笔者的[fluent-fetcher]()作为fetch的上层封装使用。\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e尽可能少的使用行内样式,将每个组件的样式文件与组件声明文件同地存放\x3cbr\x3e  譬如Material-UI这个著名的React样式组件库与\x3ca href=\x22https:\/\/github.com\/erikras\/react-redux-universal-hot-example\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-redux-universal-hot-example\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e之前的版本都是用的CSS-IN-JavaScript,全部内联样式。笔者感觉还是需要将CSS与JS剥离开来,一方面是处于职责分割的考虑,另一方面也是为了样式的可变性。通过样式类的方式来定义方式很方便地可以通过CSS来修正样式,而不需要每次都要找半天内联样式在哪里,然后去重新编译整个项目。\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e适当合理地编写纯函数，在合理范围内尽可能地将逻辑处理抽象为纯函数\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3eReference\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3eBoilerplate\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/gaearon\/react-transform-boilerplate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-transform-boilerplate\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/mxstbr\/react-boilerplate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-boilerplate\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/gilbarbara\/react-redux-saga-boilerplate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-redux-saga-boilerplate\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/erikras\/react-redux-universal-hot-example\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-redux-universal-hot-example\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3eBlogs\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/medium.freecodecamp.com\/webpack-for-the-fast-and-the-furious-bf8d3746adbd#.poot9r5ee\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack-for-the-fast-and-the-furious\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/ryanflorence\/react-project#lazy\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-project\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader7\x22\x3eQuick Start\x3c\/h1\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007166611?w=1280\x26amp;h=852\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007166611?w=1280\x26amp;h=852\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e本部分笔者首先会介绍本项目中所有预置的项目编译及运行命令。首先需要明确的两点，本Boilerplate是希望达成以下两个目标：\x3c\/p\x3e\n\x3cp\x3e（1）将关于应用的配置与关于Webpack的配置剥离开\x3c\/p\x3e\n\x3cp\x3e项目中开发配置主要在dev-config目录下，如果你要基于本项目进行二次开发,可以直接拷贝dev-config与package.json到你自己的项目中,然后根据需要配置dev-config\/apps.config.js项目。而主要的应用配置信息目前是抽象到了\x3ccode\x3edev-config\/app.config.js\x3c\/code\x3e文件中，主要的可配置项如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n * Created by apple on 16\/6\/8.\n *\/\nconst defaultIndexPage = \x26quot;.\/dev-config\/server\/template.html\x26quot;;\n\nmodule.exports = {\n  apps: [\n    \/\/HelloWorld\n    {\n      id: \x26quot;helloworld\x26quot;,\n      src: \x26quot;.\/src\/simple\/helloworld\/helloworld.js\x26quot;,\n      indexPage: defaultIndexPage,\n      compiled: false \/\/控制在执行npm run build时是否会编译该app\n    },\n    {\n      id: \x26quot;react\x26quot;,\n      src: \x26quot;.\/src\/react\/react_app.js\x26quot;,\n      indexPage: defaultIndexPage,\n      compiled: true\n    },\n    {\n      id: \x26quot;redux\x26quot;,\n      src: \x26quot;.\/src\/redux\/redux_app.js\x26quot;,\n      indexPage: defaultIndexPage,\n      compiled: false\n    }\n  ],\n\n  \/\/开发服务器配置\n  devServer: {\n    appEntrySrc: \x26quot;.\/src\/react\/react_app.js\x26quot;, \/\/当前待调试的APP的入口文件\n    port: 3000 \/\/监听的Server端口\n  },\n\n  \/\/依赖项配置\n  proxy: {\n    \/\/后端服务器地址 http:\/\/your.backend\/\n    backend: \x26quot;\x26quot;,\n  },\n\n  \/\/如果是生成的依赖库的配置项\n  library: {\n    name: \x26quot;library_portal\x26quot;,\/\/依赖项入口名\n    entry: \x26quot;.\/src\/library\/library_portal.js\x26quot;,\/\/依赖库的入口,\n    libraryName: \x26quot;libraryName\x26quot;,\/\/生成的挂载在全局依赖项下面的名称\n    libraryTarget: \x26quot;var\x26quot;\/\/挂载的全局变量名\n  }\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Created by apple on 16\/6\/8.\n *\/\x3c\/span\x3e\nconst defaultIndexPage = \x3cspan class=\x22hljs-string\x22\x3e\x22.\/dev-config\/server\/template.html\x22\x3c\/span\x3e;\n\nmodule.exports = {\n\x3cspan class=\x22hljs-symbol\x22\x3e  apps:\x3c\/span\x3e [\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/HelloWorld\x3c\/span\x3e\n    {\n\x3cspan class=\x22hljs-symbol\x22\x3e      id:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22helloworld\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e      src:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/simple\/helloworld\/helloworld.js\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e      indexPage:\x3c\/span\x3e defaultIndexPage,\n\x3cspan class=\x22hljs-symbol\x22\x3e      compiled:\x3c\/span\x3e false \x3cspan class=\x22hljs-comment\x22\x3e\/\/控制在执行npm run build时是否会编译该app\x3c\/span\x3e\n    },\n    {\n\x3cspan class=\x22hljs-symbol\x22\x3e      id:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22react\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e      src:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/react\/react_app.js\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e      indexPage:\x3c\/span\x3e defaultIndexPage,\n\x3cspan class=\x22hljs-symbol\x22\x3e      compiled:\x3c\/span\x3e true\n    },\n    {\n\x3cspan class=\x22hljs-symbol\x22\x3e      id:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22redux\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e      src:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/redux\/redux_app.js\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e      indexPage:\x3c\/span\x3e defaultIndexPage,\n\x3cspan class=\x22hljs-symbol\x22\x3e      compiled:\x3c\/span\x3e false\n    }\n  ],\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/开发服务器配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  devServer:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    appEntrySrc:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/react\/react_app.js\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/当前待调试的APP的入口文件\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    port:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/监听的Server端口\x3c\/span\x3e\n  },\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/依赖项配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  proxy:\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/后端服务器地址 http:\/\/your.backend\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    backend:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n  },\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果是生成的依赖库的配置项\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  library:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22library_portal\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/依赖项入口名\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    entry:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/library\/library_portal.js\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/依赖库的入口,\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    libraryName:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22libraryName\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/生成的挂载在全局依赖项下面的名称\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    libraryTarget:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22var\x22\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/挂载的全局变量名\x3c\/span\x3e\n  }\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e（2）能够以平滑的方式编译为三个不同的目标，主要是独立部署（往往作为单页应用或者离线WebAPP）与Server Side Rendering这两种。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3eSimple\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cp\x3e笔者正在逐步采用\x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/Web-Develop-Introduction-And-Best-Practices\/blob\/master\/Server\/NodeJS\/Yarn.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eyarn\x3c\/a\x3e作为替代npm的依赖管理工具，不过在目前的README中还是保留了npm方式，有兴趣的朋友可以自己进行尝试。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e首先使用\x3ccode\x3egit clone\x3c\/code\x3e命令将项目Clone到本地:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22git clone https:\/\/github.com\/wxyyxc1992\/Webpack2-React-Redux-Boilerplate\ncd Webpack2-React-Redux-Boilerplate\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode\x3egit \x3cspan class=\x22hljs-keyword\x22\x3eclone\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehttps\x3c\/span\x3e:\/\/github.com\/wxyyxc1992\/Webpack2-React-Redux-Boilerplate\ncd Webpack2-React-Redux-Boilerplate\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后使用 \x3ccode\x3enpm install\x3c\/code\x3e \/ \x3ccode\x3enpm link\x3c\/code\x3e命令安装依赖项目，同时如果你要实现部署的话还需要一些全局命令，可以使用\x3ccode\x3esh install.sh\x3c\/code\x3e进行安装。然后将\x3ccode\x3edev-config\/app.config.js\x3c\/code\x3e作如下配置:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/\/开发服务器配置\n  devServer: {\n    appEntrySrc: \x26quot;.\/src\/simple\/helloworld\/helloworld.js\x26quot;, \/\/当前待调试的APP的入口文件\n    port: 3000 \/\/监听的Server端口\n  },\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/开发服务器配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  devServer:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    appEntrySrc:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/simple\/helloworld\/helloworld.js\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/当前待调试的APP的入口文件\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    port:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/监听的Server端口\x3c\/span\x3e\n  },\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后使用\x3ccode\x3enpm start\x3c\/code\x3e命令启动调试服务器，此时在命令行中Webpack DashBoard会自动输出编译信息:\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007166612?w=2700\x26amp;h=658\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007166612?w=2700\x26amp;h=658\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e然后在浏览器中打开\x3ca href=\x22http:\/\/localhost:3000\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost:3000\x3c\/a\x3e，你可以看到如下画面：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007166613?w=1490\x26amp;h=744\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007166613?w=1490\x26amp;h=744\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e此时在编辑器中实时修改App.js，结果可以通过热加载实时反馈到界面上，热加载主要是利用实时传送描述热加载的json与js文件:\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007166614?w=1726\x26amp;h=725\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007166614?w=1726\x26amp;h=725\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这样当我们有需要自定义某些热加载的规则时可以同样利用这种方式。我们通过\x3ccode\x3enpm start\x3c\/code\x3e利用WebpackDevServer来启动开发服务器，这个很方便我们进行开发。接下来我们通过\x3ccode\x3enpm run build\x3c\/code\x3e命令来构建可发布版本，这种方式编译得出的基于hashHistory，可以用于单页应用（路径不变）或者离线应用（譬如应用到Cordova中），首先我们需要在\x3ccode\x3edev-config\/apps.config.js\x3c\/code\x3e中将目标应用编译状态设置为true。注意，如果同时编译多个应用，那么CommonsChunkPlugin会将这几个应用中的公共代码抽取出来:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    \/\/HelloWorld\n    {\n      id: \x26quot;helloworld\x26quot;,\n      src: \x26quot;.\/src\/simple\/helloworld\/helloworld.js\x26quot;,\n      indexPage: defaultIndexPage,\n      compiled: true \/\/控制在执行npm run build时是否会编译该app\n    },\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e    \x3cspan class=\x22hljs-comment\x22\x3e\/\/HelloWorld\x3c\/span\x3e\n    {\n\x3cspan class=\x22hljs-symbol\x22\x3e      id:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22helloworld\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e      src:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/simple\/helloworld\/helloworld.js\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e      indexPage:\x3c\/span\x3e defaultIndexPage,\n\x3cspan class=\x22hljs-symbol\x22\x3e      compiled:\x3c\/span\x3e true \x3cspan class=\x22hljs-comment\x22\x3e\/\/控制在执行npm run build时是否会编译该app\x3c\/span\x3e\n    },\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007166615?w=633\x26amp;h=206\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007166615?w=633\x26amp;h=206\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e直接在浏览器中打开\x3ccode\x3ehelloworld.html\x3c\/code\x3e文件，即可看到与刚才热加载时相同的页面。另外需要注意的是，这里使用的HTML模板都是统一放置于\x3ccode\x3edev-config\/server\/template.html\x3c\/code\x3e文件，笔者建议使用\x3ca href=\x22https:\/\/github.com\/nfl\/react-helmet\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHelmet\x3c\/a\x3e来为HTML添加自定义的元标签或者样式脚本等。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3eLibrary\x3c\/h3\x3e\n\x3cp\x3e以上述方式编译的是独立可运行的脚本，而在有些情况下我们希望以类似于jQuery的方式挂载全局变量\/函数的方式使用部分功能，这里我们就需要将编译目标设置为Library。首先将\x3ccode\x3edev-config\/apps.config.js\x3c\/code\x3e中Library配置如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/\/如果是生成的依赖库的配置项\n  library: {\n    name: \x26quot;library_portal\x26quot;,\/\/依赖项入口名\n    entry: \x26quot;.\/src\/simple\/library\/library_portal.js\x26quot;,\/\/依赖库的入口,\n    libraryName: \x26quot;libraryName\x26quot;,\/\/生成的挂载在全局依赖项下面的名称\n    libraryTarget: \x26quot;var\x26quot;\/\/挂载的全局变量名\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果是生成的依赖库的配置项\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  library:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22library_portal\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/依赖项入口名\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    entry:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/simple\/library\/library_portal.js\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/依赖库的入口,\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    libraryName:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22libraryName\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/生成的挂载在全局依赖项下面的名称\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    libraryTarget:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22var\x22\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/挂载的全局变量名\x3c\/span\x3e\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后使用\x3ccode\x3enpm run build:library\x3c\/code\x3e进行编译，这里我们希望将某个简单的ES6类导出到页面中使用:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n * @function 基于ES6的服务类\n *\/\nexport class FooService {\n\n    static echo(){\n\n        const fooService = new FooService();\n\n        return fooService.getMessage();\n    }\n\n    \/**\n     * @function 默认构造函数\n     *\/\n    constructor() {\n        this.message = \x26quot;This is Message From FooService!\x26quot;;\n    }\n\n    getMessage() {\n        return this.message;\n    }\n\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * @function 基于ES6的服务类\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eFooService\x3c\/span\x3e \x3c\/span\x3e{\n\n    \x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e echo(){\n\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e fooService = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FooService();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fooService.getMessage();\n    }\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * @function 默认构造函数\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.message = \x3cspan class=\x22hljs-string\x22\x3e\x22This is Message From FooService!\x22\x3c\/span\x3e;\n    }\n\n    getMessage() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.message;\n    }\n\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们还需要设置专门的入口文件:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n * Created by apple on 16\/7\/23.\n *\/\nimport {FooService} from \x26quot;.\/foo\x26quot;;\n\n\/**\n * @function 配置需要暴露的API\n * @type \x22{{\x22foo: {echo: FooService.echo\x22}}\x22}\n *\/\nmodule.exports = {\n\n    foo: {\n        echo: FooService.echo\n    }\n\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e\/**\n * Created \x3cspan class=\x22hljs-keyword\x22\x3eby\x3c\/span\x3e apple on \x3cspan class=\x22hljs-number\x22\x3e16\x3c\/span\x3e\/\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e\/\x3cspan class=\x22hljs-number\x22\x3e23\x3c\/span\x3e.\n *\/\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {FooService} from \x3cspan class=\x22hljs-string\x22\x3e\x22.\/foo\x22\x3c\/span\x3e;\n\n\/**\n * @\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e 配置需要暴露的API\n * @type \x22{{\x22foo: {echo: FooService.echo\x22}}\x22}\n *\/\nmodule.exports = {\n\n    foo: {\n        echo: FooService.echo\n    }\n\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后在需要的页面中引入编译好的两个脚本:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript src=\x26quot;..\/..\/..\/dist\/vendors.bundle.js\x26quot;\x3e\x3c\/script\x3e\n\x3cscript src=\x26quot;..\/..\/..\/dist\/library_portal.library.js\x26quot;\x3e\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22..\/..\/..\/dist\/vendors.bundle.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22..\/..\/..\/dist\/library_portal.library.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此时打开该界面，即可以弹出如下窗口:\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007166616?w=862\x26amp;h=607\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007166616?w=862\x26amp;h=607\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3eServer Side Rendering Support\x3c\/h2\x3e\n\x3cp\x3e本部分我们使用react_app这个应用作为示例，首先同样将配置中调试目标设置为react_app.js:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/\/开发服务器配置\n  devServer: {\n    appEntrySrc: \x26quot;.\/src\/react\/react_app.js\x26quot;, \/\/当前待调试的APP的入口文件\n    port: 3000 \/\/监听的Server端口\n  },\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/开发服务器配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  devServer:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    appEntrySrc:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/react\/react_app.js\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/当前待调试的APP的入口文件\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    port:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/监听的Server端口\x3c\/span\x3e\n  },\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后使用\x3ccode\x3enpm start\x3c\/code\x3e命令来启动开发服务器，然后同样可以使用\x3ccode\x3enpm run build\x3c\/code\x3e命令编译可发布版本。然后打开\x3ccode\x3edist\/\x3c\/code\x3e目录下的\x3ccode\x3ereact.html\x3c\/code\x3e文件，即可以看到界面，注意，此时使用的是hashHistory，因此URL的形式为:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22react.html?_ijt=4t0fmg7f6rhsv85efsau6j3t1r#\/detail?_k=f9r3og\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gcode\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3ereact.html?_ijt=\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3et\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3efm\x3cspan class=\x22hljs-name\x22\x3eg7\x3c\/span\x3ef\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3erhsv\x3cspan class=\x22hljs-number\x22\x3e85\x3c\/span\x3eefsau\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3ej\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3et\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3er\x3cspan class=\x22hljs-attr\x22\x3e#\/detail?_k=f9\x3c\/span\x3er\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3eog\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后我们需要以Server Side Rendering的方式发布项目，其主要区别在于支持browserHistory以及服务端完成渲染。注意，实际上页面发送到客户端之后还会依靠加载的JS脚本全部重新渲染，其只是为了方便SEO\/首屏显示速度\/填充初始状态到界面中。\x3c\/p\x3e\n\x3cp\x3e首先，我们需要将\x3ccode\x3eapps.config.js\x3c\/code\x3e文件中的ssrServer项目设置为我们目标的ssrServer:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/\/用于服务端渲染的Server路径\n  ssrServer: {\n    serverEntrySrc: \x27.\/src\/react\/ssr_server.js\x27\n  },\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/用于服务端渲染的Server路径\x3c\/span\x3e\n  \x3cspan class=\x22hljs-attribute\x22\x3essrServer\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attribute\x22\x3eserverEntrySrc\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27.\/src\/react\/ssr_server.js\x27\x3c\/span\x3e\n  },\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们使用\x3ccode\x3enpm run build:ssr\x3c\/code\x3e命令进行编译，在\x3ccode\x3edist\x3c\/code\x3e目录下可以得到如下文件:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22.\n├── react.bundle.js\n├── react.css\n├── react.html\n├── ssr_server.bundle.js\n├── ssr_server.bundle.js.map\n└── vendors.bundle.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e.\n├── react\x3cspan class=\x22hljs-selector-class\x22\x3e.bundle\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n├── react\x3cspan class=\x22hljs-selector-class\x22\x3e.css\x3c\/span\x3e\n├── react\x3cspan class=\x22hljs-selector-class\x22\x3e.html\x3c\/span\x3e\n├── ssr_server\x3cspan class=\x22hljs-selector-class\x22\x3e.bundle\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n├── ssr_server\x3cspan class=\x22hljs-selector-class\x22\x3e.bundle\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.map\x3c\/span\x3e\n└── vendors\x3cspan class=\x22hljs-selector-class\x22\x3e.bundle\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在本项目中为了尽可能的代码复用，使用了变量来控制是否支持服务端渲染，我们直接使用\x3ccode\x3e node dist\/ssr_server.bundle.js\x3c\/code\x3e即可以启动服务器，此时URL格式为:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22http:\/\/localhost:3001\/login\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-symbol\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/localhost:3001\/login\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader11\x22\x3eDevelop Environment:开发环境机制详解\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3eWebpack2\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cul\x3e\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/gist.github.com\/sokra\/27b24881210b56bbaff7\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWhat\x27s new in webpack 2\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22sokra\/27b24881210b56bbaff7\x22 data-typeid=\x221\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\x3c\/blockquote\x3e\n\x3cp\x3e本项目中使用Webpack 2替代原本的Webpack 1，从Webpack 1到Webpack 2很多的配置项目发生了变化，详细列表可以参考引用中提供的链接。而在本项目中，其中几个典型的修改为:\x3cbr\x3e（1）所有loader的配置提取到了LoaderOptionsPlugin中。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/\/提取Loader定义到同一地方\n  new webpack.LoaderOptionsPlugin({\n    minimize: true,\n    debug: false,\n    options: {\n      context: \x27\/\x27,\n      postcss: [\n        utils.postCSSConfig\n      ]\n    }\n  }),\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/提取Loader定义到同一地方\x3c\/span\x3e\n  \x3cspan class=\x22hljs-selector-tag\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-selector-tag\x22\x3ewebpack\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.LoaderOptionsPlugin\x3c\/span\x3e({\n    \x3cspan class=\x22hljs-attribute\x22\x3eminimize\x3c\/span\x3e: true,\n    \x3cspan class=\x22hljs-attribute\x22\x3edebug\x3c\/span\x3e: false,\n    \x3cspan class=\x22hljs-attribute\x22\x3eoptions\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-attribute\x22\x3econtext\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attribute\x22\x3epostcss\x3c\/span\x3e: [\n        utils.postCSSConfig\n      ]\n    }\n  }),\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里包含对于原本的UglifyJsPlugin与PostCSS的配置。\x3c\/p\x3e\n\x3cp\x3e（2）loader配置更加灵活。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22loaders: [\n    {\n        test: \/\\.css$\/,\n        loaders: [\n            \x26quot;style-loader\x26quot;,\n            { loader: \x26quot;css-loader\x26quot;, query: { modules: true } },\n            {\n                loader: \x26quot;sass-loader\x26quot;,\n                query: {\n                    includePaths: [\n                        path.resolve(__dirname, \x26quot;some-folder\x26quot;)\n                    ]\n                }\n            }\n        ]\n    }\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs yaml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attr\x22\x3eloaders:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        test:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\/\\.css$\/,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        loaders:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[\x3c\/span\x3e\n            \x3cspan class=\x22hljs-string\x22\x3e\x22style-loader\x22\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n            \x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eloader:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22css-loader\x22\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3equery:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3emodules:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e},\x3c\/span\x3e\n            \x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e                loader:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22sass-loader\x22\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e                query:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e                    includePaths:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[\x3c\/span\x3e\n                        \x3cspan class=\x22hljs-string\x22\x3epath.resolve(__dirname,\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22some-folder\x22\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e)\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-string\x22\x3e]\x3c\/span\x3e\n                \x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e\n            \x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e\n        \x3cspan class=\x22hljs-string\x22\x3e]\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader13\x22\x3eWebpackDevServer \x26amp; Hot Loader\x3c\/h2\x3e\n\x3cp\x3e在前一版本的devServer中，笔者使用了express加上webpack-dev-middleware与webpack-hot-middleware中间件，本版本中是迁移到了WebpackDevServer:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new WebpackDevServer(webpack(config), {\n  \/\/设置WebpackDevServer的开发目录\n  contentBase: path.join(__dirname \x2b \x26quot;\/\x26quot;),\n  \/\/ publicPath: `http:\/\/0.0.0.0:${appsConfig.devServer.port}\/`,\n  hot: true,\n  historyApiFallback: true,\n  quiet:true,\n  \/\/ noInfo: true,\n  stats: {colors: true}\n}).listen(appsConfig.devServer.port, \x270.0.0.0\x27, function (err, result) {\n  if (err) {\n    return console.log(err);\n  }\n\n  console.log(`Listening at http:\/\/0.0.0.0:${appsConfig.devServer.port}\/`);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e WebpackDevServer(webpack(config), {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置WebpackDevServer的开发目录\x3c\/span\x3e\n  contentBase: path.join(__dirname \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e),\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ publicPath: `http:\/\/0.0.0.0:${appsConfig.devServer.port}\/`,\x3c\/span\x3e\n  hot: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ehistoryApiFallback\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3equiet\x3c\/span\x3e:\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ noInfo: true,\x3c\/span\x3e\n  stats: {\x3cspan class=\x22hljs-attr\x22\x3ecolors\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e}\n}).listen(appsConfig.devServer.port, \x3cspan class=\x22hljs-string\x22\x3e\x270.0.0.0\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eerr, result\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(err);\n  }\n\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e`Listening at http:\/\/0.0.0.0:\x3cspan class=\x22hljs-subst\x22\x3e${appsConfig.devServer.port}\x3c\/span\x3e\/`\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外就是对于HotReloader的使用，目前很多热加载的实现方式还是基于\x3ca href=\x22https:\/\/github.com\/gaearon\/react-transform-boilerplate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-transform\x3c\/a\x3e，不过该项目已经废弃了，因此这里如果要自己添加热加载组件的话，建议使用\x3ca href=\x22https:\/\/github.com\/gaearon\/react-hot-loader\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-hot-loader\x3c\/a\x3e，目前笔者使用了3.0版本。我们分别需要将上面的WebpackDevServer中的hot设置为true，并且在Babel配置文件中添加如下配置:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \x26quot;env\x26quot;: {\n    \x26quot;development\x26quot;: {\n      \x26quot;presets\x26quot;: [\n        \x26quot;react-hmre\x26quot;\n      ],\n      \x26quot;plugins\x26quot;: [\n        \x26quot;react-hot-loader\/babel\x26quot;\n      ]\n    }\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs prolog\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-string\x22\x3e\x22env\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22development\x22\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22presets\x22\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-string\x22\x3e\x22react-hmre\x22\x3c\/span\x3e\n      ],\n      \x3cspan class=\x22hljs-string\x22\x3e\x22plugins\x22\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-string\x22\x3e\x22react-hot-loader\/babel\x22\x3c\/span\x3e\n      ]\n    }\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader14\x22\x3eAPI Proxy\x3c\/h2\x3e\n\x3cp\x3e待补充。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader15\x22\x3eReact Router \x26amp; Server Side Rendering\x3c\/h1\x3e\n\x3cblockquote\x3e\x3cul\x3e\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/Web-Develop-Introduction-And-Best-Practices\/blob\/master\/Frontend\/Framework\/View\/React\/Router\/React-Router.md\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReact路由解决方案React-Router介绍与实践\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader16\x22\x3ePure Frontend\x3c\/h2\x3e\n\x3cp\x3e我们首先从应用的入口程序看起:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let history;\n\n\/\/判断是否为SSR从而确定应该选用哪个History\nif (__SSR__) {\n  \/\/如果是浏览器环境,则使用browserHistory\n  history = browserHistory;\n} else {\n  \/\/如果是独立环境,则使用hashHistory\n  history = hashHistory;\n}\n\n\/\/在浏览器环境下使用hashHistory\nconst router = \x3cRouter history={history}\x3e\n  {getRoutes(localStorage)}\n\x3c\/Router\x3e;\n\n\/\/将组件渲染到DOM中\nrender(\n  router,\n  document.getElementById(\x27root\x27)\n);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e history;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/判断是否为SSR从而确定应该选用哪个History\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (__SSR__) {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果是浏览器环境,则使用browserHistory\x3c\/span\x3e\n  history = browserHistory;\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果是独立环境,则使用hashHistory\x3c\/span\x3e\n  history = hashHistory;\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/在浏览器环境下使用hashHistory\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e router = \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eRouter\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehistory\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{history}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  {getRoutes(localStorage)}\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eRouter\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/将组件渲染到DOM中\x3c\/span\x3e\nrender(\n  router,\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27root\x27\x3c\/span\x3e)\n);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里将路由配置提取到单独文件中，是因为路由配置是需要在服务端与客户端共享的，因此将可能是DOM下独有的localStorage或者类似的对象以参数方式传入。对于Route的配置倒是客户端与服务端保持一致:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  return (\n    \x3cRoute path=\x26quot;\/\x26quot; history={browserHistory} component={Container}\x3e\n      \x3cIndexRoute component={Home}\/\x3e\n      \x3cRoute path=\x26quot;home\x26quot; component={withRouter(Home)}\/\x3e\n      \x3cRoute path=\x26quot;login\x26quot; component={withRouter(Login)}\/\x3e\n      \x3cRoute path=\x26quot;detail\x26quot; component={withRouter(Detail)} onEnter={auth}\/\x3e\n    \x3c\/Route\x3e\n  );\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e  return (\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eRoute\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehistory\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{browserHistory}\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ecomponent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{Container}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eIndexRoute\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ecomponent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{Home}\/\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eRoute\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22home\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ecomponent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{withRouter(Home)}\/\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eRoute\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22login\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ecomponent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{withRouter(Login)}\/\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eRoute\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22detail\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ecomponent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{withRouter(Detail)}\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonEnter\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{auth}\/\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eRoute\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  );\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其余的代码不多，可以自行浏览整个项目。这里有个关于React Router的点我想说明下,在Route配置时使用\x3ccode\x3ewithRouter\x3c\/code\x3e这个方法可以以HOC方式注入router对象到Props中，这样我们在进行页面跳转时可以使用:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22this.props.router.goBack()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3ethis\x3cspan class=\x22hljs-selector-class\x22\x3e.props\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.router\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.goBack\x3c\/span\x3e()\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader17\x22\x3eServer Side Rendering\x3c\/h2\x3e\n\x3cp\x3e首先我们说几句废话，需要了解服务端渲染到底做了啥:\x3c\/p\x3e\n\x3cp\x3e（1）Server端只负责首页的渲染，其他页面仍然由客户端进行渲染。即虽然URL Path发生了变化，但是并未触发整个页面的完全刷新。\x3c\/p\x3e\n\x3cp\x3e（2）以Redux为代表的状态管理工具中的Store只是在第一次渲染时将数据传递给客户端，在后续的页面切换\/认证等操作中的所有代码皆在客户端运行。\x3c\/p\x3e\n\x3cp\x3e这里我们不需要改造上面的客户端入口文件，而需要添加一个用于服务端运行的文件，其核心代码为:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/处理所有的请求地址\napp.get(\x27\/*\x27, function (req, res) {\n\n  \/\/匹配客户端路由\n  match({routes: getRoutes(), location:req.originalUrl}, (error, redirectLocation, renderProps) =\x3e {\n\n    if (error) {\n\n      res.status(500).send(error.message)\n\n    } else if (redirectLocation) {\n\n      res.redirect(302, redirectLocation.pathname \x2b redirectLocation.search)\n\n    } else if (renderProps) {\n\n      let html = renderToString(\x3cRouterContext {...renderProps} \/\x3e);\n\n      res.status(200).send(renderHTML(html, {key: \x26quot;value\x26quot;}, [\x27\/static\/vendors.bundle.js\x27, \x27\/static\/react.bundle.js\x27]));\n\n    } else {\n      res.status(404).send(\x27Not found\x27)\n    }\n  })\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lua\x22\x3e\x3ccode\x3e\/\/处理所有的请求地址\napp.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/*\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(req, res)\x3c\/span\x3e\x3c\/span\x3e {\n\n  \/\/匹配客户端路由\n  match({routes: getRoutes(), location:req.originalUrl}, (\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e, redirectLocation, renderProps) =\x26gt; {\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e) {\n\n      res.\x3cspan class=\x22hljs-built_in\x22\x3estatus\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e).send(\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e.message)\n\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (redirectLocation) {\n\n      res.redirect(\x3cspan class=\x22hljs-number\x22\x3e302\x3c\/span\x3e, redirectLocation.pathname \x2b redirectLocation.search)\n\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (renderProps) {\n\n      let html = renderToString(\x26lt;RouterContext {...renderProps} \/\x26gt;);\n\n      res.\x3cspan class=\x22hljs-built_in\x22\x3estatus\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e).send(renderHTML(html, {key: \x3cspan class=\x22hljs-string\x22\x3e\x22value\x22\x3c\/span\x3e}, [\x3cspan class=\x22hljs-string\x22\x3e\x27\/static\/vendors.bundle.js\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/static\/react.bundle.js\x27\x3c\/span\x3e]));\n\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      res.\x3cspan class=\x22hljs-built_in\x22\x3estatus\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e404\x3c\/span\x3e).send(\x3cspan class=\x22hljs-string\x22\x3e\x27Not found\x27\x3c\/span\x3e)\n    }\n  })\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看出，即是用户首次向服务端发起请求时，首先对于首屏展示的组件进行渲染。我们来做一个对比，服务端渲染之后的得到的HTML字符串为:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv data-reactroot=\x26quot;\x26quot; data-reactid=\x26quot;1\x26quot; data-react-checksum=\x26quot;663537196\x26quot;\x3e\n    \x3csection class=\x26quot;login__container\x26quot; data-reactid=\x26quot;2\x26quot;\x3e\x3c!-- react-text: 3 --\x3e登陆界面\x3c!-- \/react-text --\x3e\n        \x3cdiv data-reactid=\x26quot;4utton data-reactid=\x26quot; 5\n        \x26quot;\x3e点击登陆\x3c\/button\x3e\n        \x3cbutton data-reactid=\x26quot;6\x26quot;\x3e点击登出\x3c\/button\x3e\n\x3c\/div\x3e\x3c\/section\x3e\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x26lt;div data-reactroot=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e data-reactid=\x3cspan class=\x22hljs-string\x22\x3e\x221\x22\x3c\/span\x3e data-react-checksum=\x3cspan class=\x22hljs-string\x22\x3e\x22663537196\x22\x3c\/span\x3e\x26gt;\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3esection\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22login__container\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-reactid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x222\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- react-text: 3 --\x26gt;\x3c\/span\x3e登陆界面\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- \/react-text --\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-reactid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x224utton data-reactid=\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3e5\x3c\/span\x3e\n        \x22\x26gt;\x3c\/span\x3e点击登陆\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edata-reactid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x226\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e点击登出\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3esection\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而原始的JSX组件如下，可以发现事件处理等很多代码都被过滤了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n * Created by apple on 16\/9\/13.\n *\/\nexport class Login extends Component {\n\n  \/**\n   * @function 默认渲染函数\n   * @return {XML}\n   *\/\n  render() {\n    return \x3csection className=\x26quot;login__container\x26quot;\x3e\n      登陆界面\n\n      \x3cdiv\x3e\n        \x3cbutton onClick={()=\x3e {\n          \/\/将登陆信息写入cookies与localStorage\n          login().then(()=\x3e {\n            \/\/登陆成功跳转到详情页\n            this.props.router.push(\x27\/detail\x27);\n          });\n        \x22}}\x22\x3e\n          点击登陆\n        \x3c\/button\x3e\n\n        \x3cbutton onClick={()=\x3e {\n          \/\/将登陆信息写入cookies与localStorage\n          logout();\n          \/\/登陆成功跳转到详情页\n          this.props.router.push(\x27\/\x27);\n        \x22}}\x22\x3e\n          点击登出\n        \x3c\/button\x3e\n      \x3c\/div\x3e\n\n    \x3c\/section\x3e\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scala\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Created by apple on 16\/9\/13.\n *\/\x3c\/span\x3e\nexport \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eLogin\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * @function 默认渲染函数\n   * @return {XML}\n   *\/\x3c\/span\x3e\n  render() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x26lt;section className=\x3cspan class=\x22hljs-string\x22\x3e\x22login__container\x22\x3c\/span\x3e\x26gt;\n      登陆界面\n\n      \x26lt;div\x26gt;\n        \x26lt;button onClick={()=\x26gt; {\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/将登陆信息写入cookies与localStorage\x3c\/span\x3e\n          login().then(()=\x26gt; {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/登陆成功跳转到详情页\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props.router.push(\x27\/detail\x27);\n          });\n        \x22}}\x22\x26gt;\n          点击登陆\n        \x26lt;\/button\x26gt;\n\n        \x26lt;button onClick={()=\x26gt; {\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/将登陆信息写入cookies与localStorage\x3c\/span\x3e\n          logout();\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/登陆成功跳转到详情页\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props.router.push(\x27\/\x27);\n        \x22}}\x22\x26gt;\n          点击登出\n        \x26lt;\/button\x26gt;\n      \x26lt;\/div\x26gt;\n\n    \x26lt;\/section\x26gt;\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader18\x22\x3eAuthentication\x3c\/h2\x3e\n\x3cp\x3e有时候我们需要对某些URL添加权限认证，即只允许认证用户才能访问，这里我们可以通过Route中的onEnter属性进行控制:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cRoute path=\x26quot;detail\x26quot; component={withRouter(Detail)} onEnter={auth}\/\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eRoute\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22detail\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ecomponent\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{withRouter(Detail)}\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonEnter\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{auth}\/\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而我们在上文中传入的Store对象也是在这个时候派上用场:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n   * @function 判断用户是否登陆,如果未登陆则强制性跳转到登录页面\n   * @param nextState\n   * @param replace\n   * @param callback\n   *\/\n  async function auth(nextState, replace, callback) {\n\n    let userToken = store.userToken;\n\n    \/\/在这里执行异步认证,假设传入的store中包含userToken\n    \/\/这里使用Promise执行异步操作\n    \/\/如果是SSR,则本部分代码会在服务端运行\n\n    let isValid = await valid_user(userToken);\n\n    \/\/如果用户尚未认证,则进行跳转操作\n    isValid || replace(\x27\/login\x27);\n\n    \/\/执行回调函数\n    callback();\n\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs zephir\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * \x3cspan class=\x22hljs-doctag\x22\x3e@function\x3c\/span\x3e 判断用户是否登陆,如果未登陆则强制性跳转到登录页面\n   * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e nextState\n   * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e replace\n   * \x3cspan class=\x22hljs-doctag\x22\x3e@param\x3c\/span\x3e callback\n   *\/\x3c\/span\x3e\n  async \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eauth\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(nextState, replace, callback)\x3c\/span\x3e \x3c\/span\x3e{\n\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e userToken = store.userToken;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/在这里执行异步认证,假设传入的store中包含userToken\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/这里使用Promise执行异步操作\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果是SSR,则本部分代码会在服务端运行\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e isValid = await valid_user(userToken);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果用户尚未认证,则进行跳转操作\x3c\/span\x3e\n    isValid || replace(\x3cspan class=\x22hljs-string\x22\x3e\x27\/login\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/执行回调函数\x3c\/span\x3e\n    callback();\n\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader19\x22\x3eIsomorphic Redux\x3c\/h1\x3e\n\x3cp\x3e笔者目前在自己主导的几个前端项目中渐渐的转向MobX与Redux并行.本项目中对于Redux的文件布局采取的是\x3ca href=\x22https:\/\/github.com\/erikras\/ducks-modular-redux\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDucks\x3c\/a\x3e这种方式,参考了\x3ca href=\x22https:\/\/hackernoon.com\/my-journey-toward-a-maintainable-project-structure-for-react-redux-b05dfd999b5#.yot2mml9t\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3emy-journey-toward-a-maintainable-project-structure-for-react-redux\x3c\/a\x3e一文。即按照特性来将Reducers、ActionCreators、Actions、Selectors集中到单个文件中:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ src\/ducks\/auth.js\nconst AUTO_LOGIN = \x27AUTH\/AUTH_AUTO_LOGIN\x27\nconst SIGNUP_REQUEST = \x27AUTH\/SIGNUP_REQUEST\x27\nconst SIGNUP_SUCCESS = \x27AUTH\/SIGNUP_SUCCESS\x27\nconst SIGNUP_FAILURE = \x27AUTH\/SIGNUP_FAILURE\x27\nconst LOGIN_REQUEST = \x27AUTH\/LOGIN_REQUEST\x27\nconst LOGIN_SUCCESS = \x27AUTH\/LOGIN_SUCCESS\x27\nconst LOGIN_FAILURE = \x27AUTH\/LOGIN_FAILURE\x27\nconst LOGOUT = \x27AUTH\/LOGOUT\x27\n\nconst initialState = {\n  user: null,\n  isLoading: false,\n  error: null\n}\n\nexport default (state = initialState, action) =\x3e {\n  switch (action.type) {\n    case SIGNUP_REQUEST:\n    case LOGIN_REQUEST:\n      return { ...state, isLoading: true, error: null }\n\n    case SIGNUP_SUCCESS:\n    case LOGIN_SUCCESS:\n      return { ...state, isLoading: false, user: action.user }\n\n    case SIGNUP_FAILURE:\n    case LOGIN_FAILURE:\n      return { ...state, isLoading: false, error: action.error }\n\n    case LOGOUT:\n      return { ...state, user: null }\n\n    default:\n      return state\n  }\n}\n\nexport const signup = (email, password) =\x3e ({ type: SIGNUP_REQUEST, email, password })\nexport const login = (email, password) =\x3e ({ type: LOGIN_REQUEST, email, password })\nexport const logout = () =\x3e ({ type: LOGOUT })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ src\/ducks\/auth.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e AUTO_LOGIN = \x3cspan class=\x22hljs-string\x22\x3e\x27AUTH\/AUTH_AUTO_LOGIN\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SIGNUP_REQUEST = \x3cspan class=\x22hljs-string\x22\x3e\x27AUTH\/SIGNUP_REQUEST\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SIGNUP_SUCCESS = \x3cspan class=\x22hljs-string\x22\x3e\x27AUTH\/SIGNUP_SUCCESS\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SIGNUP_FAILURE = \x3cspan class=\x22hljs-string\x22\x3e\x27AUTH\/SIGNUP_FAILURE\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e LOGIN_REQUEST = \x3cspan class=\x22hljs-string\x22\x3e\x27AUTH\/LOGIN_REQUEST\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e LOGIN_SUCCESS = \x3cspan class=\x22hljs-string\x22\x3e\x27AUTH\/LOGIN_SUCCESS\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e LOGIN_FAILURE = \x3cspan class=\x22hljs-string\x22\x3e\x27AUTH\/LOGIN_FAILURE\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e LOGOUT = \x3cspan class=\x22hljs-string\x22\x3e\x27AUTH\/LOGOUT\x27\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e initialState = {\n  user: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e,\n  isLoading: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n  error: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e (state = initialState, action) =\x26gt; {\n  \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (action.type) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e SIGNUP_REQUEST:\n    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e LOGIN_REQUEST:\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e { ...state, isLoading: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, error: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e SIGNUP_SUCCESS:\n    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e LOGIN_SUCCESS:\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e { ...state, isLoading: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, user: action.user }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e SIGNUP_FAILURE:\n    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e LOGIN_FAILURE:\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e { ...state, isLoading: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, error: action.error }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e LOGOUT:\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e { ...state, user: \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e state\n  }\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e signup = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eemail, password\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e ({ \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e: SIGNUP_REQUEST, email, password })\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e login = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eemail, password\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e ({ \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e: LOGIN_REQUEST, email, password })\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e logout = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e ({ \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e: LOGOUT })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e对于\x3ca href=\x22https:\/\/github.com\/gaearon\/redux-devtools#browser-extension\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRedux Dev Tools\x3c\/a\x3e,请自行使用[Browser Extension]()。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader20\x22\x3eSimple Count\x3c\/h2\x3e\n\x3cp\x3e我们首先以简单的基于Redux的计数器为例，将\x3ccode\x3edev-config\/apps.config.js\x3c\/code\x3e中的开发配置设置为如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  \/\/开发服务器配置\n  devServer: {\n    appEntrySrc: \x26quot;.\/src\/redux\/redux_app.js\x26quot;, \/\/当前待调试的APP的入口文件\n    port: 3000 \/\/监听的Server端口\n  },\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-comment\x22\x3e\/\/开发服务器配置\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e  devServer:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e    appEntrySrc:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/src\/redux\/redux_app.js\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/当前待调试的APP的入口文件\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    port:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/监听的Server端口\x3c\/span\x3e\n  },\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后使用\x3ccode\x3enpm start\x3c\/code\x3e运行开发服务器，界面上的如下表示即为该示例:\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000007166617?w=1865\x26amp;h=1132\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000007166617?w=1865\x26amp;h=1132\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在Redux DevTools中，红色框线标示出的即为count相关的状态，我们接下来简单描述下其核心代码。在Redux开发中，我们首先需要构建一个Ducks，即包含Action、ActionCreator与Reducer:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n * Created by apple on 16\/10\/11.\n *\/\n\/\/ no changes here ?\n\n\/**\n * @function 定义Actions\n * @type {string}\n *\/\nexport const INCREMENT_COUNT = \x27INCREMENT\x27;\n\nexport const DECREMENT_COUNT = \x27DECREMENT\x27;\n\n\/**\n * @function 定义Reducer\n * @param state\n * @param action\n * @return {number}\n *\/\nexport default (state = 0, {type}) =\x3e {\n  switch (type) {\n    case INCREMENT_COUNT:\n      return state \x2b 1;\n    case DECREMENT_COUNT:\n      return state - 1;\n    default:\n      return state\n  }\n}\n\n\/**\n *@region 定义Action Creator\n *\/\n\n\/**\n * @function 触发加1操作\n * @return \x22{{\x22type: string\x22}}\x22\n *\/\nexport const increment = ()=\x3e {\n\n  return {\n    type: INCREMENT_COUNT\n  }\n\n};\n\n\/**\n * @function 在这里进行异步加1操作\n * @return {function(*)}\n *\/\nexport const incrementAsync = ()=\x3e {\n\n  return dispatch =\x3e {\n    setTimeout(() =\x3e {\n      \/\/ Yay! Can invoke sync or async actions with `dispatch`\n      dispatch(increment());\n    }, 1000);\n  };\n};\n\n\/**\n * @function 执行计数器减一操作\n * @return \x22{{\x22type: string\x22}}\x22\n *\/\nexport const decrement = ()=\x3e {\n\n  return {\n    type: DECREMENT_COUNT\n  }\n\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * Created by apple on 16\/10\/11.\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ no changes here ?\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * @function 定义Actions\n * @type {string}\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e INCREMENT_COUNT = \x3cspan class=\x22hljs-string\x22\x3e\x27INCREMENT\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e DECREMENT_COUNT = \x3cspan class=\x22hljs-string\x22\x3e\x27DECREMENT\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * @function 定义Reducer\n * @param state\n * @param action\n * @return {number}\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e (state = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, {\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e}) =\x26gt; {\n  \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e INCREMENT_COUNT:\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e state \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e DECREMENT_COUNT:\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e state - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e:\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e state\n  }\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n *@region 定义Action Creator\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * @function 触发加1操作\n * @return \x22{{\x22type: string\x22}}\x22\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e increment = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e {\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e: INCREMENT_COUNT\n  }\n\n};\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * @function 在这里进行异步加1操作\n * @return {function(*)}\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e incrementAsync = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e {\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3edispatch\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Yay! Can invoke sync or async actions with `dispatch`\x3c\/span\x3e\n      dispatch(increment());\n    }, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n  };\n};\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * @function 执行计数器减一操作\n * @return \x22{{\x22type: string\x22}}\x22\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e decrement = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e {\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e: DECREMENT_COUNT\n  }\n\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里为了简单起见，我们是使用了redux-thunk来处理异步Action，实际上在Redux中对于异步Action的处理也有各种各样的实践，包括笔者在这里自定义的promiseMiddleware，也是一种方式。然后我们需要构建一个Store来存放全局的状态，Store本身是基于Reducer来递归生成状态树的,其核心代码如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  const store = createStoreWithMiddleware(\n    rootReducer,\n    initialState,\n    typeof window === \x27object\x27 \x26amp;\x26amp; typeof window.devToolsExtension !== \x27undefined\x27 \x26amp;\x26amp; __DEV__ ? window.devToolsExtension() : f =\x3e f);\n\n  \/**\n   * @function 保证Redux Reducer的热加载\n   *\/\n  if (__DEV__ \x26amp;\x26amp; module.hot) {\n    module.hot.accept(\x27.\/reducer\x27, () =\x3e {\n      \/\/替换Store中的Reducer\n      store.replaceReducer(require(\x27.\/reducer\x27));\n    })\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e store = createStoreWithMiddleware(\n    rootReducer,\n    initialState,\n    \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.devToolsExtension !== \x3cspan class=\x22hljs-string\x22\x3e\x27undefined\x27\x3c\/span\x3e \x26amp;\x26amp; __DEV__ ? \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.devToolsExtension() : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ef\x3c\/span\x3e =\x26gt;\x3c\/span\x3e f);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/**\n   * @function 保证Redux Reducer的热加载\n   *\/\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (__DEV__ \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.hot) {\n    \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.hot.accept(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/reducer\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/替换Store中的Reducer\x3c\/span\x3e\n      store.replaceReducer(\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/reducer\x27\x3c\/span\x3e));\n    })\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在我们已经写完了Redux部分的代码，下面就是需要将状态导入到界面中:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@connect(\n  state =\x3e ({\n    count: state.count\n  }),\n  {pushState: push, increment, incrementAsync, decrement}\n)\nexport class Home extends Component {\n  render() {\n\n    \/\/在非SSR状态下导入SCSS文件\n    __SSR__ || require(\x27.\/home.scss\x27);\n\n    const {count, pushState, increment, incrementAsync, decrement} = this.props;\n\n    return \x3csection className=\x26quot;home__container\x26quot;\x3e\n\n      \x3cdiv\x3e\n        王下邀月熊 Webpack2-React-Redux-Boilerplate\n      \x3c\/div\x3e\n\n      \x3cbr\/\x3e\n      \x3cbr\/\x3e\n\n      \x3cdiv\x3e导航栏目:\x3c\/div\x3e\n\n      \x3cli\x3e\n        \x3cbutton onClick={()=\x3e {\n          pushState(\x27\/detail\x27)\n        \x22}}\x22\x3e\n          详情页(需要先进行登陆操作)\n        \x3c\/button\x3e\n      \x3c\/li\x3e\n      \x3cli\x3e\x3cLink to=\x26quot;\/login\x26quot;\x3e登陆页\x3c\/Link\x3e\x3c\/li\x3e\n\n      \x3cbr\/\x3e\n      \x3cbr\/\x3e\n\n      \x3cdiv\x3e基于Redux的Count实例\x3c\/div\x3e\n      \x3cdiv\x3e{count}\x3c\/div\x3e\n      \x3cdiv\x3e\n        \x3cbutton onClick={increment}\x3e加1\x3c\/button\x3e\n        \x3cbutton onClick={incrementAsync}\x3e异步加1\x3c\/button\x3e\n        \x3cbutton onClick={decrement}\x3e减1\x3c\/button\x3e\n      \x3c\/div\x3e\n\n    \x3c\/section\x3e\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e@connect(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3estate\x3c\/span\x3e =\x26gt;\x3c\/span\x3e ({\n    \x3cspan class=\x22hljs-attr\x22\x3ecount\x3c\/span\x3e: state.count\n  }),\n  {\x3cspan class=\x22hljs-attr\x22\x3epushState\x3c\/span\x3e: push, increment, incrementAsync, decrement}\n)\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eHome\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  render() {\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/在非SSR状态下导入SCSS文件\x3c\/span\x3e\n    __SSR__ || \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/home.scss\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {count, pushState, increment, incrementAsync, decrement} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3esection\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22home__container\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        王下邀月熊 Webpack2-React-Redux-Boilerplate\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e导航栏目:\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e {\n          pushState(\x27\/detail\x27)\n        \x22}}\x22\x26gt;\n          详情页(需要先进行登陆操作)\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eLink\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eto\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/login\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e登陆页\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eLink\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebr\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e基于Redux的Count实例\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e{count}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{increment}\x3c\/span\x3e\x26gt;\x3c\/span\x3e加1\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{incrementAsync}\x3c\/span\x3e\x26gt;\x3c\/span\x3e异步加1\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{decrement}\x3c\/span\x3e\x26gt;\x3c\/span\x3e减1\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3esection\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader21\x22\x3e\x3ca href=\x22https:\/\/github.com\/reactjs\/react-router-redux\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReact Router Redux\x3c\/a\x3e\x3c\/h2\x3e\n\x3cp\x3eReact Router Redux的代码还是简单易懂的,其只是在用户点击\/跳转与React Router自身的History之间加上了一层封装\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/reactjs\/history\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehistory\x3c\/a\x3e\x26nbsp;\x2b\x26nbsp;\x3ccode\x3estore\x3c\/code\x3e\x26nbsp;(\x3ca href=\x22https:\/\/github.com\/reactjs\/redux\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eredux\x3c\/a\x3e) →\x26nbsp;\x3ca href=\x22https:\/\/github.com\/reactjs\/react-router-redux\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3cstrong\x3ereact-router-redux\x3c\/strong\x3e\x3c\/a\x3e\x26nbsp;→ enhanced\x26nbsp;\x3ca href=\x22https:\/\/github.com\/reactjs\/history\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehistory\x3c\/a\x3e\x26nbsp;→\x26nbsp;\x3ca href=\x22https:\/\/github.com\/reactjs\/react-router\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-router\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e如果你需要自定义其他的Location,譬如如果你需要引入ImmutableJS作为Store:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Immutable from \x27immutable\x27;\nimport {\n    LOCATION_CHANGE\n} from \x27react-router-redux\x27;\n\nlet initialState;\n\ninitialState = Immutable.fromJS({\n    locationBeforeTransitions: undefined\n});\n\nexport default (state = initialState, action) =\x3e {\n    if (action.type === LOCATION_CHANGE) {\n        return state.merge({\n            locationBeforeTransitions: action.payload\n        });\n    }\n\n    return state;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3eimport Immutable \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x27immutable\x27;\nimport {\n    LOCATION_CHANGE\n} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x27react-router-redux\x27;\n\nlet initialState;\n\ninitialState = Immutable.\x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3eJS({\n    locationBeforeTransitions: undefined\n});\n\nexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e = initialState, action) =\x26gt; {\n    if (action.type === LOCATION_CHANGE) {\n        return \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.merge({\n            locationBeforeTransitions: action.payload\n        });\n    }\n\n    return \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader22\x22\x3eSSR\x3c\/h2\x3e\n\x3cp\x3e与上文中的Server Side Rendering Server相比，其添加了对于状态传递的支持:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\n\/\/处理所有的请求地址\napp.get(\x27\/*\x27, function (req, res) {\n\n  \/\/构建出内存中历史记录\n  const memoryHistory = createHistory(req.originalUrl);\n\n  \/\/服务端构建出Store\n  const store = createStore(memoryHistory);\n\n  \/\/构建出与Store同步的history\n  const history = syncHistoryWithStore(memoryHistory, store);\n\n  \/\/匹配客户端路由\n  match({history, routes: getRoutes(), location: req.originalUrl}, (error, redirectLocation, renderProps) =\x3e {\n\n    if (error) {\n\n      res.status(500).send(error.message)\n\n    } else if (redirectLocation) {\n\n      res.redirect(302, redirectLocation.pathname \x2b redirectLocation.search)\n\n    } else if (renderProps) {\n\n      let html = renderToString(\n        \x3cProvider store={store}\x3e\n          \x3cRouterContext {...renderProps} \/\x3e\n        \x3c\/Provider\x3e\n      );\n\n      \/\/设置全局的navigator值\n      \/\/ global.navigator = {userAgent: req.headers[\x27user-agent\x27]};\n\n      res.status(200).send(renderHTML(html, {key: \x26quot;value\x26quot;}, [\x27\/static\/vendors.bundle.js\x27, \x27\/static\/redux.bundle.js\x27]));\n\n    } else {\n      res.status(404).send(\x27Not found\x27)\n    }\n  })\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs zephir\x22\x3e\x3ccode\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/处理所有的请求地址\x3c\/span\x3e\napp.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/*\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(req, res)\x3c\/span\x3e \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/构建出内存中历史记录\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e memoryHistory = createHistory(req.originalUrl);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/服务端构建出Store\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e store = createStore(memoryHistory);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/构建出与Store同步的history\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e history = syncHistoryWithStore(memoryHistory, store);\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/匹配客户端路由\x3c\/span\x3e\n  match({history, routes: getRoutes(), location: req.originalUrl}, (error, redirectLocation, renderProps) =\x26gt; {\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (error) {\n\n      res.status(\x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e).send(error.message)\n\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (redirectLocation) {\n\n      res.redirect(\x3cspan class=\x22hljs-number\x22\x3e302\x3c\/span\x3e, redirectLocation.pathname \x2b redirectLocation.search)\n\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (renderProps) {\n\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e html = renderToString(\n        \x26lt;Provider store={store}\x26gt;\n          \x26lt;RouterContext {...renderProps} \/\x26gt;\n        \x26lt;\/Provider\x26gt;\n      );\n\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置全局的navigator值\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ global.navigator = {userAgent: req.headers[\x27user-agent\x27]};\x3c\/span\x3e\n\n      res.status(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e).send(renderHTML(html, {key: \x3cspan class=\x22hljs-string\x22\x3e\x22value\x22\x3c\/span\x3e}, [\x3cspan class=\x22hljs-string\x22\x3e\x27\/static\/vendors.bundle.js\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/static\/redux.bundle.js\x27\x3c\/span\x3e]));\n\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      res.status(\x3cspan class=\x22hljs-number\x22\x3e404\x3c\/span\x3e).send(\x3cspan class=\x22hljs-string\x22\x3e\x27Not found\x27\x3c\/span\x3e)\n    }\n  })\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e欢迎大家指导与讨论,同时再次建议,在不能掌握本项目的情况慎重直接用于大型项目中,对自己负责。\x3c\/p\x3e\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>在重构脚手架中掌握React/Redux/Webpack2基本套路</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007166607">https://segmentfault.com/a/1190000007166607</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/jbjafkzanw/" target="_blank">https://alili.tech/archive/jbjafkzanw/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/sj57jxyoook/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（上）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/qsw902j95k/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（下）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/nnpmjlot58j/">IndexedDB使用与出坑指南<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/alvlbas9oai/">JS事件模型<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/u0pzym8k36o/">JS练习实例--编写经典小游戏俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/khwpyk5yz8q/">JavaScript 事件代理和委托<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/kuocl6lc3n/">JavaScript 版俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/n8bk54lyrf/">Promise学习:基础入门<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/7bk7u30qncb/">Redux 入坑进阶 - 源码解析<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/853kqfmqmf7/">Snap.svg 基本知识入门<aside class="dates">2019-02-03</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>