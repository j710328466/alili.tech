<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="基于webpack的前后端分离开发环境实战"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>基于webpack的前后端分离开发环境实战 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/z7kn9qyvhwk/",
				"appid": "1613049289050283", 
				"title": "基于webpack的前后端分离开发环境实战 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-15T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/qzkqt3ij1a/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/oiyecivimim/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f&text=%e5%9f%ba%e4%ba%8ewebpack%e7%9a%84%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e5%ae%9e%e6%88%98"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f&text=%e5%9f%ba%e4%ba%8ewebpack%e7%9a%84%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e5%ae%9e%e6%88%98"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f&title=%e5%9f%ba%e4%ba%8ewebpack%e7%9a%84%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e5%ae%9e%e6%88%98"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f&is_video=false&description=%e5%9f%ba%e4%ba%8ewebpack%e7%9a%84%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e5%ae%9e%e6%88%98"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%9f%ba%e4%ba%8ewebpack%e7%9a%84%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e5%ae%9e%e6%88%98&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f&title=%e5%9f%ba%e4%ba%8ewebpack%e7%9a%84%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e5%ae%9e%e6%88%98"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f&title=%e5%9f%ba%e4%ba%8ewebpack%e7%9a%84%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e5%ae%9e%e6%88%98"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f&title=%e5%9f%ba%e4%ba%8ewebpack%e7%9a%84%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e5%ae%9e%e6%88%98"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fz7kn9qyvhwk%2f&title=%e5%9f%ba%e4%ba%8ewebpack%e7%9a%84%e5%89%8d%e5%90%8e%e7%ab%af%e5%88%86%e7%a6%bb%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e5%ae%9e%e6%88%98"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">基于webpack的前后端分离开发环境实战</h1><div class="meta"><div class="postdate"><time datetime="2019-01-15" itemprop="datePublished">2019-01-15</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e背景\x3c\/h2\x3e\n\x3cp\x3e随着互联网应用工程规模的日益复杂化和精细化，我们在开发一个标准web应用的早已开始告别单干模式，为了提升开发效率，前后端分离的需求越来越被重视，前端负责展现\/交互逻辑，后端负责业务\/数据接口，基本上也成为了我们日常项目分工中的标配，但是前后端分离一直以来都是一个工程概念，每个团队在实现工程中都会基于自身的技术栈选择和开发环境进行具体的实现，本文便根据自身团队在webapck开发中搭建的前后端分离开发环境进行部分叙述。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e理想化的前后端分离环境\x3c\/h2\x3e\n\x3cp\x3e目前业界比较有代表性的前后端分离的例子是SPA(Single-page application)，所有用到的展现数据都是后端通过异步接口(AJAX\/JSONP\/WEBSOCKET)的方式提供的，现如今最火的前端框架如：React， Vue，Angular等也都推荐采用SPA的模式进行开发并且从组件化，数据流，状态容器再到网络请求，单页路由等都给出了完善的全家桶方案。从某种意义上来说，SPA确实做到了前后端分离，但这种方式存在如下几个亟待问题：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e前端开发本地开发环境下该如何突破域的限制和服务端接口进行通信？\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e一条命令，能否同时完成webpack和node sever两个进程的启动？\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e开发环境下的前端资源路径应该如何配置？\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emock数据应该怎么做？\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e打包构建后的文件能否直接预览效果？\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e针对以上的问题，我们来看看怎样利用webpack现有的一些机制和借助node的环境搭配来进行逐个击破，具体设计如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM2TW?w=590\x26amp;h=611\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM2TW?w=590\x26amp;h=611\x22 alt=\x22## 不得不提的webpack-dev-\x22 title=\x22## 不得不提的webpack-dev-\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e由此可见，我们理想化的开发环境应根据具备以下几点要求：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e操作够简单，拉下代码后，只需要记住仅有的几个命令就能直接进入开发状态\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e解耦够彻底，开发者只需要修改路由配置表就能无缝在多个请求接口中灵活切换\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e资源够清晰，所有的开发资源都能到精确可控，同时支持一键打包构建，单页和多页模式可并存\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e配置够灵活，可以根据自身项目的实际情况灵活添加各类中间件，扩展模块和第三方插件\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e不得不提的webpack-dev-server\x3c\/h2\x3e\n\x3cp\x3ewebpack本身的定位是一个资源管理和打包构建工作，本身的强大之处在于对各种静态资源的依赖分析和预编译，在实际开发中官方还推荐了一个快速读取webpack配置的server环境\x3ca href=\x22https:\/\/github.com\/webpack\/webpack-dev-server\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack-dev-server\x3c\/a\x3e，官方的介绍是：\x22Use webpack with a development server that provides live reloading. The webpack-dev-server is a little Node.js Express server, which uses the webpack-dev-middleware to serve a webpack bundle. It also has a little runtime which is connected to the server via Sock.js.\x22，一个适用于开发环境的，基于express \x2b webpack-dev-middleware实现的，支持实时更新，内存构建资源的开发服务器，通过简单的\x3ca href=\x22http:\/\/webpack.github.io\/docs\/webpack-dev-server.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e配置\x3c\/a\x3e即可满足webpack开发环境中的一系列需求，但是当我们的开发环境日趋复杂和多样的时候，不仅需要对自定义配置的细节灵活可控，同时需要对进行加入各种第三方的插件进行功能扩展，才能最大程度的发挥webpack环境中的威力。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e打造项目专属的前端开发环境\x3c\/h2\x3e\n\x3cp\x3e有了理想环境下的的述求，也了解到了webpack-dev-server的实现精髓，那么，我们就可以一步步地来打造专属自身的开发环境：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e一 、借助node和http-proxy实现跨域通信\x3c\/h3\x3e\n\x3cp\x3e前后端分离开发中，本地前端开发调用接口会有跨域问题，一般有以下几种解决方法：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e直接启动服务端项目，再将项目中的资源url指向到前端服务中的静态资源地址，好处在于因为始终在服务端的环境中进行资源调试，不存在接口的跨域访问问题，但是缺陷也比较明显，需要同时启动两套环境，还需要借助nginx，charles等工具进行资源地址的代理转发，配置比较繁琐，对开发者对网络的理解和环境配置要求较高，资源开销也大；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eCORS跨域：后端接口在返回的时候，在header中加入\x27Access-Control-Allow-origin\x27:* 等配置，利用\x3ca href=\x22https:\/\/developer.mozilla.org\/zhCN\/docs\/Web\/HTTP\/Access_control_CORS\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e跨域资源共享\x3c\/a\x3e实现跨域，前端部分只要求支持xhr2标准的浏览器，但是服务端在请求头中需要在header中做响应头配置，在一定程度上还是对服务端的接口设置有一定的依赖；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ehttp-proxy：用nodejs搭建本地http服务器，并且判断访问接口URL时进行转发，由于利用了\x3ca href=\x22https:\/\/github.com\/nodejitsu\/node-http-proxy\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp-proxy\x3c\/a\x3e代理的模式进行了转发，采用的是服务对服务的模式，能较为完美解决本地开发时候的跨域问题，也是本文中推荐的方式，配置如下：\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e1、搭建node和http-proxy环境\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install express # express作为node基础服务框架\nnpm install http-proxy-middleware # http-proxy的express中间件\nnpm install body-parser # bodyParser中间件用来解析http请求体\nnpm install querystring    # querystring用来字符串化对象或解析字符串\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode class=\x22shell\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall \x3c\/span\x3eexpress \x3cspan class=\x22hljs-comment\x22\x3e# express作为node基础服务框架\x3c\/span\x3e\nnpm \x3cspan class=\x22hljs-keyword\x22\x3einstall \x3c\/span\x3ehttp-proxy-middleware \x3cspan class=\x22hljs-comment\x22\x3e# http-proxy的express中间件\x3c\/span\x3e\nnpm \x3cspan class=\x22hljs-keyword\x22\x3einstall \x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3ebody-parser \x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e# bodyParser中间件用来解析http请求体\x3c\/span\x3e\nnpm \x3cspan class=\x22hljs-keyword\x22\x3einstall \x3c\/span\x3equerystring    \x3cspan class=\x22hljs-comment\x22\x3e# querystring用来字符串化对象或解析字符串\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e工程项目下可以新建一个server的文件夹放置node资源，如下所示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22server  \n    ├── main.js\n    ├── proxy.config.js\n    ├── routes\n    └── views\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3eserver  \n    ├── main\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n    ├── proxy\x3cspan class=\x22hljs-selector-class\x22\x3e.config\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n    ├── routes\n    └── views\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e2、编写代理配置脚本：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3eproxy.config.js中可以配置对应需要代理的url和目标url，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const proxy = [\n  {\n    url: \x27\/back_end\/auth\/*\x27,\n    target: \x27http:\/\/10.2.0.1:8351\x27\n  },\n  {\n    url: \x27\/back_end\/*\x27,\n    target: \x27http:\/\/10.2.0.1:8352\x27\n  }\n];\nmodule.exports = proxy;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e proxy = [\n  {\n    \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/back_end\/auth\/*\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3etarget\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/10.2.0.1:8351\x27\x3c\/span\x3e\n  },\n  {\n    \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/back_end\/*\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3etarget\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/10.2.0.1:8352\x27\x3c\/span\x3e\n  }\n];\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = proxy;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3emain.js中的配置如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const express = require(\x27express\x27)\nconst bodyParser = require(\x27body-parser\x27)\nconst proxy = require(\x27http-proxy-middleware\x27)\nconst querystring = require(\x27querystring\x27)\n\nconst app = express()\n\n\/\/ make http proxy middleware setting\nconst createProxySetting = function (url) {\n  return {\n    target: url,\n    changeOrigin: true,\n    headers: {\n      Accept: \x27application\/json\x27,\n      \x27X-Requested-With\x27: \x27XMLHttpRequest\x27\n    },\n    onProxyReq: function (proxyReq, req) {\n      if (req.method === \x27POST\x27 \x26amp;\x26amp; req.body) {\n        const bodyData = querystring.stringify(req.body)\n        proxyReq.write(bodyData)\n      }\n    }\n  }\n}\n\n\/\/ parse application\/json\napp.use(bodyParser.json())\n\n\/\/ parse application\/x-www-form-urlencoded\napp.use(bodyParser.urlencoded({ extended: false }))\n\n\/\/ proxy\nproxyConfig.forEach(function (item) {\n   app.use(item.url, proxy(createProxySetting(item.target)))\n})\n\n\/\/ eg: http:\/\/127.0.0.1:3000\/back_end\/oppor =\x3e http:\/\/10.2.0.1:8352\/back_end\/oppor \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e bodyParser = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27body-parser\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e proxy = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http-proxy-middleware\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e querystring = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27querystring\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e app = express()\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ make http proxy middleware setting\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e createProxySetting = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3etarget\x3c\/span\x3e: url,\n    \x3cspan class=\x22hljs-attr\x22\x3echangeOrigin\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eheaders\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-attr\x22\x3eAccept\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27application\/json\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-string\x22\x3e\x27X-Requested-With\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27XMLHttpRequest\x27\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3eonProxyReq\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eproxyReq, req\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (req.method === \x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e \x26amp;\x26amp; req.body) {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e bodyData = querystring.stringify(req.body)\n        proxyReq.write(bodyData)\n      }\n    }\n  }\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ parse application\/json\x3c\/span\x3e\napp.use(bodyParser.json())\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ parse application\/x-www-form-urlencoded\x3c\/span\x3e\napp.use(bodyParser.urlencoded({ \x3cspan class=\x22hljs-attr\x22\x3eextended\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e }))\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ proxy\x3c\/span\x3e\nproxyConfig.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) \x3c\/span\x3e{\n   app.use(item.url, proxy(createProxySetting(item.target)))\n})\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ eg: http:\/\/127.0.0.1:3000\/back_end\/oppor =\x26gt; http:\/\/10.2.0.1:8352\/back_end\/oppor \x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过以上的配置我们就能轻松将指定url下的请求自动转发到匹配成功的目标接口下。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3e NODE_ENV=development node .\/server\/main.js\n\nisDebug: true\n[HPM] Proxy created: \/  -\x3e  http:\/\/10.2.0.1:8351\n[HPM] Proxy created: \/  -\x3e  http:\/\/10.2.0.1:8352\nListening at 192.168.1.104:3000\n\nwebpack built d558389f7a9a453af17f in 2018ms\nHash: d558389f7a9a453af17f\nVersion: webpack 1.14.0\nTime: 2018ms\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs yaml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x26gt; NODE_ENV=development node .\/server\/main.js\n\n\x3c\/span\x3e\x3cspan class=\x22hljs-attr\x22\x3eisDebug:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e[HPM]\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eProxy\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ecreated:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\/\x3c\/span\x3e  \x3cspan class=\x22hljs-bullet\x22\x3e-\x26gt;\x3c\/span\x3e  \x3cspan class=\x22hljs-attr\x22\x3ehttp:\/\/10.2.0.1:8351\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e[HPM]\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eProxy\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ecreated:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\/\x3c\/span\x3e  \x3cspan class=\x22hljs-bullet\x22\x3e-\x26gt;\x3c\/span\x3e  \x3cspan class=\x22hljs-attr\x22\x3ehttp:\/\/10.2.0.1:8352\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eListening\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eat\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e192.168\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.1\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.104\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e:3000\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-string\x22\x3ewebpack\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ebuilt\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ed558389f7a9a453af17f\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2018\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3ems\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3eHash:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ed558389f7a9a453af17f\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3eVersion:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ewebpack\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1.14\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.0\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3eTime:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2018\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3ems\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e二、将webpack配置和node server进程打通\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e1、解耦webpack中的配置\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e由于webpack在开发和生产环境中经常需要做各种配置的切换，官方也提供了DefinePlugin来进行环境参数设置，但是大量的判断语句侵入webpack.config中其实会导致代码的可读性和复用性变差，也容易造成代码冗余，我们在此可以对配置文件进行重构，将之前的webpack配置文件拆解成了webpack.config.js，project.config.js和environments.config.js三个文件，三个文件各司其职，又可互相协作，减少维护成本，如下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eenvironments.config.js: 主要的作用就是存放在特定环境下的需要变化的配置参数，包含有：publicpath, devtools, wanings，hash等\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eproject.config.js：主要的作用是存放于项目有关的基础配置，如：server，output，loader，externals，plugin等基础配置；通过一个overrides实现对environments中的配置信息重载。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ewebpack.config.js：主要是读取project.config.js中的配置，再按标准的webpack字段填入project中的配置信息，原则上是该文件的信息只与构建工具有关，而与具体的项目工程无关，可以做到跨项目间复用。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22config \n    ├── environments.config.js\n    ├── project.config.js\n    └── webpack.config.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3econfig \n    ├── environments\x3cspan class=\x22hljs-selector-class\x22\x3e.config\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n    ├── project\x3cspan class=\x22hljs-selector-class\x22\x3e.config\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n    └── webpack\x3cspan class=\x22hljs-selector-class\x22\x3e.config\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eenvironments.config.js中的关键实现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Here is where you can define configuration overrides based on the execution environment.\n\/\/ Supply a key to the default export matching the NODE_ENV that you wish to target, and\n\/\/ the base configuration will apply your overrides before exporting itself.\nmodule.exports = {\n  \/\/ ======================================================\n  \/\/ Overrides when NODE_ENV === \x27development\x27\n  \/\/ ======================================================\n  development : (config) =\x3e ({\n    compiler_public_path : `http:\/\/${config.server_host}:${config.server_port}\/`\n  }),\n\n  \/\/ ======================================================\n  \/\/ Overrides when NODE_ENV === \x27production\x27\n  \/\/ ======================================================\n  production : (config) =\x3e ({\n    compiler_base_route      : \x27\/apps\/\x27,\n    compiler_public_path     : \x27\/static\/\x27,\n    compiler_fail_on_warning : false,\n    compiler_hash_type       : \x27chunkhash\x27,\n    compiler_devtool         : false,\n    compiler_stats           : {\n      chunks       : true,\n      chunkModules : true,\n      colors       : true\n    }\n  })\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Here is where you can define configuration overrides based on the execution environment.\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Supply a key to the default export matching the NODE_ENV that you wish to target, and\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ the base configuration will apply your overrides before exporting itself.\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ======================================================\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Overrides when NODE_ENV === \x27development\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ======================================================\x3c\/span\x3e\n  development : \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3econfig\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e ({\n    \x3cspan class=\x22hljs-attr\x22\x3ecompiler_public_path\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e`http:\/\/\x3cspan class=\x22hljs-subst\x22\x3e${config.server_host}\x3c\/span\x3e:\x3cspan class=\x22hljs-subst\x22\x3e${config.server_port}\x3c\/span\x3e\/`\x3c\/span\x3e\n  }),\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ======================================================\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Overrides when NODE_ENV === \x27production\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ======================================================\x3c\/span\x3e\n  production : \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3econfig\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e ({\n    \x3cspan class=\x22hljs-attr\x22\x3ecompiler_base_route\x3c\/span\x3e      : \x3cspan class=\x22hljs-string\x22\x3e\x27\/apps\/\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecompiler_public_path\x3c\/span\x3e     : \x3cspan class=\x22hljs-string\x22\x3e\x27\/static\/\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecompiler_fail_on_warning\x3c\/span\x3e : \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecompiler_hash_type\x3c\/span\x3e       : \x3cspan class=\x22hljs-string\x22\x3e\x27chunkhash\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecompiler_devtool\x3c\/span\x3e         : \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecompiler_stats\x3c\/span\x3e           : {\n      \x3cspan class=\x22hljs-attr\x22\x3echunks\x3c\/span\x3e       : \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3echunkModules\x3c\/span\x3e : \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3ecolors\x3c\/span\x3e       : \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n    }\n  })\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eproject.config.js中的关键实现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ project.config.js\nconst config = {\n  env : process.env.NODE_ENV || \x27development\x27,\n\n  \/\/ ----------------------------------\n  \/\/ Project Structure\n  \/\/ ----------------------------------\n  path_base  : path.resolve(__dirname, \x27..\x27),\n  dir_client : \x27src\x27,\n  dir_dist   : \x27dist\x27,\n  dir_public : \x27public\x27,\n  dir_server : \x27server\x27,\n  dir_test   : \x27tests\x27,\n\n  \/\/ ----------------------------------\n  \/\/ Server Configuration\n  \/\/ ----------------------------------\n  server_host : ip.address(), \/\/ use string \x27localhost\x27 to prevent exposure on local network\n  server_port : process.env.PORT || 3000,\n\n  \/\/ ----------------------------------\n  \/\/ Compiler Configuration\n  \/\/ ----------------------------------\n  compiler_devtool         : \x27source-map\x27,\n  compiler_hash_type       : \x27hash\x27,\n  compiler_fail_on_warning : false,\n  compiler_quiet           : false,\n  compiler_public_path     : \x27\/\x27,\n  compiler_stats           : {\n    chunks : false,\n    chunkModules : false,\n    colors : true\n  }\n};\n\n\/\/ 在此通过读取环境变量读取environments中对应的配置项，对前面的配置项进行覆盖\nconst environments = require(\x27.\/environments.config\x27)\nconst overrides = environments[config.env]\nif (overrides) {\n  debug(\x27Found overrides, applying to default configuration.\x27)\n  Object.assign(config, overrides(config))\n} else {\n  debug(\x27No environment overrides found, defaults will be used.\x27)\n}\nmodule.exports = config\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ project.config.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e config = {\n  \x3cspan class=\x22hljs-attr\x22\x3eenv\x3c\/span\x3e : process.env.NODE_ENV || \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e,\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ----------------------------------\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Project Structure\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ----------------------------------\x3c\/span\x3e\n  path_base  : path.resolve(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27..\x27\x3c\/span\x3e),\n  \x3cspan class=\x22hljs-attr\x22\x3edir_client\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3edir_dist\x3c\/span\x3e   : \x3cspan class=\x22hljs-string\x22\x3e\x27dist\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3edir_public\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27public\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3edir_server\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27server\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3edir_test\x3c\/span\x3e   : \x3cspan class=\x22hljs-string\x22\x3e\x27tests\x27\x3c\/span\x3e,\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ----------------------------------\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Server Configuration\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ----------------------------------\x3c\/span\x3e\n  server_host : ip.address(), \x3cspan class=\x22hljs-comment\x22\x3e\/\/ use string \x27localhost\x27 to prevent exposure on local network\x3c\/span\x3e\n  server_port : process.env.PORT || \x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e,\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ----------------------------------\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Compiler Configuration\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ----------------------------------\x3c\/span\x3e\n  compiler_devtool         : \x3cspan class=\x22hljs-string\x22\x3e\x27source-map\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ecompiler_hash_type\x3c\/span\x3e       : \x3cspan class=\x22hljs-string\x22\x3e\x27hash\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ecompiler_fail_on_warning\x3c\/span\x3e : \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ecompiler_quiet\x3c\/span\x3e           : \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ecompiler_public_path\x3c\/span\x3e     : \x3cspan class=\x22hljs-string\x22\x3e\x27\/\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3ecompiler_stats\x3c\/span\x3e           : {\n    \x3cspan class=\x22hljs-attr\x22\x3echunks\x3c\/span\x3e : \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3echunkModules\x3c\/span\x3e : \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecolors\x3c\/span\x3e : \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  }\n};\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在此通过读取环境变量读取environments中对应的配置项，对前面的配置项进行覆盖\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e environments = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/environments.config\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e overrides = environments[config.env]\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (overrides) {\n  debug(\x3cspan class=\x22hljs-string\x22\x3e\x27Found overrides, applying to default configuration.\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e.assign(config, overrides(config))\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n  debug(\x3cspan class=\x22hljs-string\x22\x3e\x27No environment overrides found, defaults will be used.\x27\x3c\/span\x3e)\n}\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = config\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ewebpack.config.js中的关键实现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const webpack = require(\x27webpack\x27)\nconst project = require(\x27.\/project.config\x27)\nconst debug = require(\x27debug\x27)(\x27app:config:webpack\x27)\nconst UglifyJsParallelPlugin = require(\x27webpack-uglify-parallel\x27)\n\nconst __DEV__ = project.globals.__DEV__\nconst __PROD__ = project.globals.__PROD__\n\nconst webpackConfig = {\n  name    : \x27client\x27,\n  target  : \x27web\x27,\n  devtool : project.compiler_devtool,\n  resolve : {\n    modules: [project.paths.client(), \x27node_modules\x27],\n    extensions: [\x27.web.js\x27, \x27.js\x27, \x27.jsx\x27, \x27.json\x27]\n  },\n  module : {}\n}\n\nif (__DEV__) {\n  debug(\x27Enabling plugins for live development (HMR, NoErrors).\x27)\n  webpackConfig.plugins.push(\n      new webpack.HotModuleReplacementPlugin()\n  )\n} else if (__PROD__) {\n  debug(\x27Enabling plugins for production (UglifyJS).\x27)\n  webpackConfig.plugins.push(\n    new webpack.optimize.OccurrenceOrderPlugin(),\n    new webpack.optimize.DedupePlugin(),\n    new UglifyJsParallelPlugin({\n      workers: os.cpus().length,\n      mangle: true,\n      compressor: {\n        warnings: false,\n        drop_debugger: true,\n        dead_code: true\n      }\n    })\n  )\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e webpack = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e project = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/project.config\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e debug = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27debug\x27\x3c\/span\x3e)(\x3cspan class=\x22hljs-string\x22\x3e\x27app:config:webpack\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e UglifyJsParallelPlugin = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack-uglify-parallel\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e __DEV__ = project.globals.__DEV__\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e __PROD__ = project.globals.__PROD__\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e webpackConfig = {\n  \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e    : \x3cspan class=\x22hljs-string\x22\x3e\x27client\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3etarget\x3c\/span\x3e  : \x3cspan class=\x22hljs-string\x22\x3e\x27web\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3edevtool\x3c\/span\x3e : project.compiler_devtool,\n  \x3cspan class=\x22hljs-attr\x22\x3eresolve\x3c\/span\x3e : {\n    \x3cspan class=\x22hljs-attr\x22\x3emodules\x3c\/span\x3e: [project.paths.client(), \x3cspan class=\x22hljs-string\x22\x3e\x27node_modules\x27\x3c\/span\x3e],\n    \x3cspan class=\x22hljs-attr\x22\x3eextensions\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27.web.js\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.js\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.jsx\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.json\x27\x3c\/span\x3e]\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3emodule\x3c\/span\x3e : {}\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (__DEV__) {\n  debug(\x3cspan class=\x22hljs-string\x22\x3e\x27Enabling plugins for live development (HMR, NoErrors).\x27\x3c\/span\x3e)\n  webpackConfig.plugins.push(\n      \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.HotModuleReplacementPlugin()\n  )\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (__PROD__) {\n  debug(\x3cspan class=\x22hljs-string\x22\x3e\x27Enabling plugins for production (UglifyJS).\x27\x3c\/span\x3e)\n  webpackConfig.plugins.push(\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.OccurrenceOrderPlugin(),\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.DedupePlugin(),\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e UglifyJsParallelPlugin({\n      \x3cspan class=\x22hljs-attr\x22\x3eworkers\x3c\/span\x3e: os.cpus().length,\n      \x3cspan class=\x22hljs-attr\x22\x3emangle\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3ecompressor\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3ewarnings\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edrop_debugger\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edead_code\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      }\n    })\n  )\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e由此可知，三者间的注入关系如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22environments -\x3e project -\x3e webpack   \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xl\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eenvironments\x3c\/span\x3e -\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eproject\x3c\/span\x3e -\x26gt;\x3c\/span\x3e webpack   \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e2、整合webpack在开发环境中依赖的中间件\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e参考webapck-dev-server中的实现，我们可以将webpack-dev-middleware和webpack-hot-middleware加入到我们的express配置中，\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install webpack-dev-middleware\nnpm install webpack-hot-middleware\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cmake\x22\x3e\x3ccode class=\x22shell\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e webpack-dev-middleware\nnpm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e webpack-hot-middleware\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e具体配置如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const express = require(\x27express\x27)\nconst debug = require(\x27debug\x27)(\x27app:server\x27)\nconst webpack = require(\x27webpack\x27)\nconst webpackConfig = require(\x27..\/config\/webpack.config\x27)\nconst project = require(\x27..\/config\/project.config\x27)\n\nconst app = express()\n\n\/\/ ------------------------------------\n\/\/ Apply Webpack HMR Middleware\n\/\/ ------------------------------------\nif (project.env === \x27development\x27) {\n  const compiler = webpack(webpackConfig)\n\n  debug(\x27Enabling webpack dev and HMR middleware\x27)\n  app.use(require(\x27webpack-dev-middleware\x27)(compiler, {\n    publicPath  : webpackConfig.output.publicPath,\n    contentBase : project.paths.client(),\n    hot         : true,\n    quiet       : project.compiler_quiet,\n    noInfo      : project.compiler_quiet,\n    lazy        : false,\n    stats       : project.compiler_stats\n  }))\n  \n  \/\/ webpack_hmr\n  app.use(require(\x27webpack-hot-middleware\x27)(compiler, {\n    path: \x27\/__webpack_hmr\x27\n  }))\n\n  \/\/ proxy\n  ....... \n}\n\nmodule.exports = app.listen(project.server_port, function (err) {\n  if (err) {\n    console.log(err)\n    return\n  }\n  var uri = project.server_host \x2b \x27:\x27 \x2b project.server_port\n  console.log(\x27Listening at \x27 \x2b uri \x2b \x27\\n\x27)\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e debug = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27debug\x27\x3c\/span\x3e)(\x3cspan class=\x22hljs-string\x22\x3e\x27app:server\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e webpack = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e webpackConfig = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/config\/webpack.config\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e project = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/config\/project.config\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e app = express()\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ------------------------------------\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Apply Webpack HMR Middleware\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ ------------------------------------\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (project.env === \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e compiler = webpack(webpackConfig)\n\n  debug(\x3cspan class=\x22hljs-string\x22\x3e\x27Enabling webpack dev and HMR middleware\x27\x3c\/span\x3e)\n  app.use(\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack-dev-middleware\x27\x3c\/span\x3e)(compiler, {\n    \x3cspan class=\x22hljs-attr\x22\x3epublicPath\x3c\/span\x3e  : webpackConfig.output.publicPath,\n    \x3cspan class=\x22hljs-attr\x22\x3econtentBase\x3c\/span\x3e : project.paths.client(),\n    \x3cspan class=\x22hljs-attr\x22\x3ehot\x3c\/span\x3e         : \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3equiet\x3c\/span\x3e       : project.compiler_quiet,\n    \x3cspan class=\x22hljs-attr\x22\x3enoInfo\x3c\/span\x3e      : project.compiler_quiet,\n    \x3cspan class=\x22hljs-attr\x22\x3elazy\x3c\/span\x3e        : \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3estats\x3c\/span\x3e       : project.compiler_stats\n  }))\n  \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ webpack_hmr\x3c\/span\x3e\n  app.use(\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack-hot-middleware\x27\x3c\/span\x3e)(compiler, {\n    \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/__webpack_hmr\x27\x3c\/span\x3e\n  }))\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ proxy\x3c\/span\x3e\n  ....... \n}\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = app.listen(project.server_port, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(err)\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e uri = project.server_host \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27:\x27\x3c\/span\x3e \x2b project.server_port\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Listening at \x27\x3c\/span\x3e \x2b uri \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\\n\x27\x3c\/span\x3e)\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样当我们执行下述的时候，就能一键完成webpack基础配置，热更新以及epxress服务的启动，并且可以完全根据express的配置说明来自定义扩展我们的前端开发资源。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ENV=development node .\/bin\/dev-server.js \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3eENV=\x3c\/span\x3edevelopment \x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e.\/bin\x3c\/span\x3e\/dev-server.js \x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e三、前端资源路径设计\x3c\/h3\x3e\n\x3cp\x3e实际开发中，所有涉及到的前端资源我们进行归类一般会有如下几种：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3ehtml：html页面，结合到服务后一般称为模板资源，是所有资源的入口和结果呈现页；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ejs：javascript执行脚本资源，基于现代Javascript框架开发后通常还需要借助babel，typescript等进行编译处理，分为build前后build后两套代码；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ecss：样式资源，如果采用了less，sass等工具处理后会也会从.less和.sass编译成.css文件;\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3estatic: 静态资源，通常会包含有font，image，audio，video等静态文件，结合到服务框架中一般需要设定特定的访问路径，直接读取文件加载。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e在wepback的配置中，前端资源路径我们通常是借助\x3ca href=\x22http:\/\/webpack.github.io\/docs\/configuration.html#output-publicpath\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3epath和publicPath\x3c\/a\x3e\x3cbr\x3e对构建出来的前端资源进行索引，由于webpack采用了基于内存构建的方式，path通常用来用来存放打包后文件的输出目录，publicPath则用来指定资源文件引用的虚拟目录，具体示例如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module.exports = {\n  entry: path.join(__dirname,\x26quot;src\x26quot;,\x26quot;entry.js\x26quot;),\n  output: {\n    \/*\n        webpack-dev-server环境下，path、publicPath、--content-base 区别与联系\n        path：指定编译目录而已（\/build\/js\/），不能用于html中的js引用。\n        publicPath：虚拟目录，自动指向path编译目录（\/assets\/ =\x3e \/build\/js\/）。html中引用js文件时，必须引用此虚拟路径（但实际上引用的是内存中的文件，既不是\/build\/js\/也不是\/assets\/）。\n        --content-base：必须指向应用根目录（即index.html所在目录），与上面两个配置项毫无关联。\n        ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝\n        发布至生产环境：\n        1.webpack进行编译（当然是编译到\/build\/js\/）\n        2.把编译目录（\/build\/js\/）下的文件，全部复制到\/assets\/目录下（注意：不是去修改index.html中引用bundle.js的路径）\n    *\/\n    path: path.join(__dirname,\x26quot;build\x26quot;,\x26quot;js\x26quot;),\n    publicPath: \x26quot;\/assets\/\x26quot;,\n    \/\/publicPath: \x26quot;http:\/\/cdn.com\/assets\/\x26quot;,\/\/你也可以加上完整的url，效果与上面一致（不需要修改index.html中引用bundle.js的路径，但发布生产环境时，需要使用插件才能批量修改引用地址为cdn地址）。\n    filename: \x27bundle.js\x27\n  }\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = {\n  \x3cspan class=\x22hljs-attr\x22\x3eentry\x3c\/span\x3e: path.join(__dirname,\x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22entry.js\x22\x3c\/span\x3e),\n  \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/*\n        webpack-dev-server环境下，path、publicPath、--content-base 区别与联系\n        path：指定编译目录而已（\/build\/js\/），不能用于html中的js引用。\n        publicPath：虚拟目录，自动指向path编译目录（\/assets\/ =\x26gt; \/build\/js\/）。html中引用js文件时，必须引用此虚拟路径（但实际上引用的是内存中的文件，既不是\/build\/js\/也不是\/assets\/）。\n        --content-base：必须指向应用根目录（即index.html所在目录），与上面两个配置项毫无关联。\n        ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝\n        发布至生产环境：\n        1.webpack进行编译（当然是编译到\/build\/js\/）\n        2.把编译目录（\/build\/js\/）下的文件，全部复制到\/assets\/目录下（注意：不是去修改index.html中引用bundle.js的路径）\n    *\/\x3c\/span\x3e\n    path: path.join(__dirname,\x3cspan class=\x22hljs-string\x22\x3e\x22build\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22js\x22\x3c\/span\x3e),\n    \x3cspan class=\x22hljs-attr\x22\x3epublicPath\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\/assets\/\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/publicPath: \x22http:\/\/cdn.com\/assets\/\x22,\/\/你也可以加上完整的url，效果与上面一致（不需要修改index.html中引用bundle.js的路径，但发布生产环境时，需要使用插件才能批量修改引用地址为cdn地址）。\x3c\/span\x3e\n    filename: \x3cspan class=\x22hljs-string\x22\x3e\x27bundle.js\x27\x3c\/span\x3e\n  }\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e有了如上的概念，我们就可以将path，publicpath和express中的配置结合起来，同时由于在开发环境中我们的的资源入口通常又会按特定的目录来进行文件存放，如下图所示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22project  \n├── LICENSE\n├── README.md\n├── app.json\n├── dist\n├── bin\n├── config\n├── package.json\n├── postcss.config.js\n├── public\n├── server\n├── src\n└── yarn.lock\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3eproject  \n├── LICENSE\n├── README\x3cspan class=\x22hljs-selector-class\x22\x3e.md\x3c\/span\x3e\n├── app\x3cspan class=\x22hljs-selector-class\x22\x3e.json\x3c\/span\x3e\n├── dist\n├── bin\n├── config\n├── package\x3cspan class=\x22hljs-selector-class\x22\x3e.json\x3c\/span\x3e\n├── postcss\x3cspan class=\x22hljs-selector-class\x22\x3e.config\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n├── public\n├── server\n├── src\n└── yarn.lock\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e从中不难发现node server中需要配置的资源目录往往又会和webpack的工程目录重叠，那么我们就需要在express中进行相应的配置，才能实现资源的正确索引。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e1、html模板资源读取\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3ehtml作为webpack中的templates，在express中则会变成views，读取方式会发生变化，所以我们需要对资源进行如下配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm install ejs  #让express支持html模板格式 \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cmake\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e ejs  \x3cspan class=\x22hljs-comment\x22\x3e#让express支持html模板格式 \x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const ejs = require(\x27ejs\x27)\nconst app = express()\n\n\/\/ view engine, 默认可以指向template\napp.set(\x27views\x27, project.paths.template()) \napp.engine(\x27.html\x27, ejs.__express)\napp.set(\x27view engine\x27, \x27html\x27)\n\n\/\/ 通过配置让express读取webpack的内存打包资源下的template文件\napp.use(\x27\/home\x27, function (req, res, next) {\n const filename = path.join(compiler.outputPath, \x27index.html\x27\x27)\n compiler.outputFileSystem.readFile(filename, (err, result) =\x3e {\n    if (err) {\n     return next(err)\n    }\n   res.set(\x27content-type\x27, \x27text\/html\x27)\n     res.send(result)\n     res.end()\n   })\n})\n\n\/\/让express所有的路由请求都落到index.html中，再有前端框架中的前端路由接管页面的跳转\napp.use(\x27*\x27, function (req, res, next) {\n    const filename = path.join(compiler.outputPath, \x27index.html\x27)\n    compiler.outputFileSystem.readFile(filename, (err, result) =\x3e {\n      if (err) {\n        return next(err)\n      }\n      res.set(\x27content-type\x27, \x27text\/html\x27)\n      res.send(result)\n      res.end()\n    })\n    \n    \/*也可以指定到特定的views文件下进行模板资源读取*\/\n     res.render(\x27home.html\x27, {\n       name:\x27home.html\x27\n     })\n  })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ejs = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27ejs\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e app = express()\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ view engine, 默认可以指向template\x3c\/span\x3e\napp.set(\x3cspan class=\x22hljs-string\x22\x3e\x27views\x27\x3c\/span\x3e, project.paths.template()) \napp.engine(\x3cspan class=\x22hljs-string\x22\x3e\x27.html\x27\x3c\/span\x3e, ejs.__express)\napp.set(\x3cspan class=\x22hljs-string\x22\x3e\x27view engine\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27html\x27\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 通过配置让express读取webpack的内存打包资源下的template文件\x3c\/span\x3e\napp.use(\x3cspan class=\x22hljs-string\x22\x3e\x27\/home\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ereq, res, next\x3c\/span\x3e) \x3c\/span\x3e{\n \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e filename = path.join(compiler.outputPath, \x3cspan class=\x22hljs-string\x22\x3e\x27index.html\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27)\n compiler.outputFileSystem.readFile(filename, (err, result) =\x26gt; {\n    if (err) {\n     return next(err)\n    }\n   res.set(\x27\x3c\/span\x3econtent-type\x3cspan class=\x22hljs-string\x22\x3e\x27, \x27\x3c\/span\x3etext\/html\x3cspan class=\x22hljs-string\x22\x3e\x27)\n     res.send(result)\n     res.end()\n   })\n})\n\n\/\/让express所有的路由请求都落到index.html中，再有前端框架中的前端路由接管页面的跳转\napp.use(\x27\x3c\/span\x3e*\x3cspan class=\x22hljs-string\x22\x3e\x27, function (req, res, next) {\n    const filename = path.join(compiler.outputPath, \x27\x3c\/span\x3eindex.html\x3cspan class=\x22hljs-string\x22\x3e\x27)\n    compiler.outputFileSystem.readFile(filename, (err, result) =\x26gt; {\n      if (err) {\n        return next(err)\n      }\n      res.set(\x27\x3c\/span\x3econtent-type\x3cspan class=\x22hljs-string\x22\x3e\x27, \x27\x3c\/span\x3etext\/html\x3cspan class=\x22hljs-string\x22\x3e\x27)\n      res.send(result)\n      res.end()\n    })\n    \n    \/*也可以指定到特定的views文件下进行模板资源读取*\/\n     res.render(\x27\x3c\/span\x3ehome.html\x3cspan class=\x22hljs-string\x22\x3e\x27, {\n       name:\x27\x3c\/span\x3ehome.html\x3cspan class=\x22hljs-string\x22\x3e\x27\n     })\n  })\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e2、js和css资源读取\x3c\/strong\x3e\x3cbr\x3ejs和css的引用地址在webpack的开发环境中通常会指向publicpath，所以在开发页面中会直接如下嵌入如下地址，由于是采用绝对地址指向，所以无需做任何配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 \x3clink rel=\x26quot;stylesheet\x26quot; href=\x26quot;http:\/\/127.0.0.1:3000\/css\/app.qxdfa323434adfc23314.css\x26quot;\/\x3e\n\x3cscript src=\x26quot;http:\/\/127.0.0.1:3000\/js\/app.ab92c02d96a1a7cd4919.js\x26quot;\x3e\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elink\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erel\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22stylesheet\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/127.0.0.1:3000\/css\/app.qxdfa323434adfc23314.css\x22\x3c\/span\x3e\/\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/127.0.0.1:3000\/js\/app.ab92c02d96a1a7cd4919.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e3、静态资源读取\x3c\/strong\x3e\x3cbr\x3e其他类似font，images等静态读取，我们可以将一个图片放到工程结构中的public下，则访问地址可以按如下书写，支持真实路径和虚拟路径：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 真实路径，根目录访问：\/demo.png -\x3e \/pulbic\/demo.png\napp.use(express.static(project.paths.public()))\n\n\/\/ 真实路径，子目录访问：\/static\/demo.png -\x3e \/pulbic\/static\/demo.png\napp.use(express.static(project.paths.public()))\n\n\/\/ 虚拟路径，跟目录访问：\/static\/demo.png -\x3e \/pulbic\/demo.png\napp.use(\x27\/static\/\x27, express.static(project.paths.public()))\n\n\/\/ 虚拟路径，子目录访问：\/static\/img\/demo.png -\x3e \/pulbic\/img\/demo.png\napp.use(\x27\/static\/\x27, express.static(project.paths.public()))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 真实路径，根目录访问：\/demo.png -\x26gt; \/pulbic\/demo.png\x3c\/span\x3e\napp.use(express.static(project.paths.public()))\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 真实路径，子目录访问：\/static\/demo.png -\x26gt; \/pulbic\/static\/demo.png\x3c\/span\x3e\napp.use(express.static(project.paths.public()))\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 虚拟路径，跟目录访问：\/static\/demo.png -\x26gt; \/pulbic\/demo.png\x3c\/span\x3e\napp.use(\x3cspan class=\x22hljs-string\x22\x3e\x27\/static\/\x27\x3c\/span\x3e, express.static(project.paths.public()))\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 虚拟路径，子目录访问：\/static\/img\/demo.png -\x26gt; \/pulbic\/img\/demo.png\x3c\/span\x3e\napp.use(\x3cspan class=\x22hljs-string\x22\x3e\x27\/static\/\x27\x3c\/span\x3e, express.static(project.paths.public()))\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过以上配置，我们就可以在访问开发地址( eg: localhost:3000 )时即可得到所需的全部前端资源。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e四、mock数据模拟\x3c\/h3\x3e\n\x3cp\x3e作为前端经常需要模拟后台数据，我们称之为mock。通常的方式为自己搭建一个服务器，返回我们想要的数据，既然我们已经将express集成到了我们的开发环境下，那么实现一个mock就会非常简单，以下介绍两种mock数据的方式。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e1、配置专属的mock路由模块\x3c\/strong\x3e\x3cbr\x3e我们可以在我们的server项目下的routes模块中加入一个mock模块，如下所示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22server\n├── main.js\n├── mock\n│\x26nbsp;\x26nbsp; ├── opporList.json\n├── routes\n│\x26nbsp;\x26nbsp; ├── index.js\n│\x26nbsp;\x26nbsp; └── mock.js\n└── views\n    └── home.html\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3eserver\n├── main\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n├── mock\n│\x26nbsp;\x26nbsp; ├── opporList\x3cspan class=\x22hljs-selector-class\x22\x3e.json\x3c\/span\x3e\n├── routes\n│\x26nbsp;\x26nbsp; ├── index\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; └── mock\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n└── views\n    └── home.html\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后再在我们的server下的配置文件中导入mock模块配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ main.js\nconst mock = require(\x27.\/routes\/mock\x27)\nif (project.env === \x27development\x27) {\n  \/\/ mock routes\n  app.use(\x27\/mock, mock) \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ main.js\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e mock = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/routes\/mock\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (project.env === \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ mock routes\x3c\/span\x3e\n  app.use(\x3cspan class=\x22hljs-string\x22\x3e\x27\/mock, mock) \n}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eroutes中的mock.js中写入如下mock数据配置即可：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const express = require(\x27express\x27)\nconst router = express.Router()\nconst opporList = require(\x27..\/mock\/opporList.json\x27);\nconst Mock = require(\x27mockjs\x27);\n\n\/\/ 直接读取json文件导出\nrouter.get(\x27\/backend\/opporList\x27, function (req, res) {\n  res.json(opporList)\n})\n\n\/\/ 基于mockjs生成数据, 优势在于对项目代码无侵入，并且支持fetch，xhr等多种方式的拦截\nrouter.get(\x27\/backend\/employee\x27, function (req, res) {\n  var data = Mock.mock({\n    \/\/ 属性 list 的值是一个数组，其中含有 1 到 10 个元素\n    \x27list|1-10\x27: [{\n      \/\/ 属性 id 是一个自增数，起始值为 1，每次增 1\n      \x27id|\x2b1\x27: 1\n    }]\n  })\n  res.json(data)\n})\n\nmodule.exports = router\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode class=\x22javascirpt\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e)\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e router = express.Router()\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e opporList = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27..\/mock\/opporList.json\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e Mock = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27mockjs\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 直接读取json文件导出\x3c\/span\x3e\nrouter.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/backend\/opporList\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n  res.json(opporList)\n})\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 基于mockjs生成数据, 优势在于对项目代码无侵入，并且支持fetch，xhr等多种方式的拦截\x3c\/span\x3e\nrouter.get(\x3cspan class=\x22hljs-string\x22\x3e\x27\/backend\/employee\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = Mock.mock({\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 属性 list 的值是一个数组，其中含有 1 到 10 个元素\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3e\x27list|1-10\x27\x3c\/span\x3e: [{\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 属性 id 是一个自增数，起始值为 1，每次增 1\x3c\/span\x3e\n      \x3cspan class=\x22hljs-string\x22\x3e\x27id|\x2b1\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n    }]\n  })\n  res.json(data)\n})\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = router\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e配置完成后，访问如下地址即可拿到mock数据：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/127.0.0.1:3000\/mock\/backend\/opporList\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/mock\/ba...\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/127.0.0.1:3000\/mock\/backend\/employee\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/mock\/ba...\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e再利用我们的proxy.config修改node-proxy配置，将测试自动转到mock目标地址下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const proxy = [\n    {\n      url: \x27\/backend\/*\x27,\n      target: \x26quot;http:\/\/127.0.0.1:3000\/mock\x26quot;\n    }\n]\nmodule.exports = proxy\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e proxy = [\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/backend\/*\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3etarget\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/127.0.0.1:3000\/mock\x22\x3c\/span\x3e\n    }\n]\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = proxy\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e2、搭建独立的mock服务\x3c\/strong\x3e\x3cbr\x3e如果企业中有部署独立的mock服务器，如\x3ca href=\x22https:\/\/github.com\/ufologist\/puer-mock\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3epuer\x2bmock\x3c\/a\x3e：我们也可以通过修改简单的proxy.config来直接实现需要mock的请求地址转发，相对修改就比较简单，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const proxy = [\n    {\n      url: \x27\/backend\/*\x27,\n      target: \x26quot;http:\/\/10.4.31.11:8080\/mock\x26quot;\n    }\n]\nmodule.exports = proxy\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e proxy = [\n    {\n      \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27\/backend\/*\x27\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3etarget\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/10.4.31.11:8080\/mock\x22\x3c\/span\x3e\n    }\n]\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = proxy\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e五、预览打包后的资源效果\x3c\/h3\x3e\n\x3cp\x3e当我们开发完成后，wepback通过编译可以得到我们需要的各种静态资源，这类文件通常是作为静态资源存在，需要放到cdn或者部署到服务器上才能访问，但是我们通过简单的配置也可以直接在本地环境下直接预览打包后的资源效果，具体操作如下：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e1. 找到构建资源生成目录, 确认构建资源已存在：\x3c\/strong\x3e\x3cbr\x3edist\x3cbr\x3e├── css\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── app.5f5af15a.css\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── login.7cb6ada6.css\x3cbr\x3e│\x26nbsp;\x26nbsp; └── vendors.54895ec1.css\x3cbr\x3e├── images\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── login_bg.8953d181.png\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── logo.01cf3dce.png\x3cbr\x3e│\x26nbsp;\x26nbsp; └── wap_ico.e4e9be83.png\x3cbr\x3e├── index.html\x3cbr\x3e├── js\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── app.eb852be2.js\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── login.9a049514.js\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── manifest.c75a01fc.js\x3cbr\x3e│\x26nbsp;\x26nbsp; └── vendors.20a872dc.js\x3cbr\x3e└── login.html\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2. 修改express的文本配置信息，加入构建完成后的静态资源地址配置：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22app.set(\x27views\x27, project.paths.dist()) \n\nif (project.env === \x27development\x27) {\n  ....\n} else {\n  debug(\n    \x27Server is being run outside of live development mode\x27\n  )\n  \n  \/\/ 配置预览环境下的proxy.config，一般可以指向测试环境地址\n  const proxyConfig = require(\x27.\/proxy.test.config\x27)\n  const routes = require(\x27.\/routes\x27)\n  proxyConfig.forEach(function (item) {\n    app.use(item.url, proxy(createProxySetting(item.target)))\n  })\n  \n  \/\/ 修改静态资源指向地址，可以直接配置到dist目录下\n  app.use(project.compiler_public_path,express.static(project.paths.dist())\n  \n  \/\/ 配置访问路由url，并在设置置真实的template文件地址，与webpack中的htmlplugin下的filename配置路径保持一致，一般都在dist目录下        \n  app.use(project.compiler_base_route, routes)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eapp.set(\x3cspan class=\x22hljs-string\x22\x3e\x27views\x27\x3c\/span\x3e, project.paths.dist()) \n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (project.env === \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e) {\n  ....\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n  debug(\n    \x3cspan class=\x22hljs-string\x22\x3e\x27Server is being run outside of live development mode\x27\x3c\/span\x3e\n  )\n  \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 配置预览环境下的proxy.config，一般可以指向测试环境地址\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e proxyConfig = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/proxy.test.config\x27\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e routes = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/routes\x27\x3c\/span\x3e)\n  proxyConfig.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) \x3c\/span\x3e{\n    app.use(item.url, proxy(createProxySetting(item.target)))\n  })\n  \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 修改静态资源指向地址，可以直接配置到dist目录下\x3c\/span\x3e\n  app.use(project.compiler_public_path,express.static(project.paths.dist())\n  \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 配置访问路由url，并在设置置真实的template文件地址，与webpack中的htmlplugin下的filename配置路径保持一致，一般都在dist目录下        \x3c\/span\x3e\n  app.use(project.compiler_base_route, routes)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e3. 启动预览页面，访问:localhost:3000即可 \x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22NODE_ENV=production node .\/server\/main.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode class=\x22shell\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3eNODE_ENV=\x3c\/span\x3eproduction \x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e.\/server\x3c\/span\x3e\/main.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e完整工程结构目录结构参考\x3c\/h2\x3e\n\x3cp\x3eProject\x3cbr\x3e├── LICENSE\x3cbr\x3e├── README.md\x3cbr\x3e├── app.json\x3cbr\x3e├── bin\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── compile.js\x3cbr\x3e│\x26nbsp;\x26nbsp; └── dev-server.js\x3cbr\x3e├── config\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── environments.config.js\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── karma.config.js\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── npm-debug.log\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── project.config.js\x3cbr\x3e│\x26nbsp;\x26nbsp; └── webpack.config.js\x3cbr\x3e├── package.json\x3cbr\x3e├── postcss.config.js\x3cbr\x3e├── public\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── favicon.ico\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── humans.txt\x3cbr\x3e│\x26nbsp;\x26nbsp; └── robots.txt\x3cbr\x3e├── server\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── main.js\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── proxy.config.js\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── routes\x3cbr\x3e│\x26nbsp;\x26nbsp; └── views\x3cbr\x3e├── src\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── api\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── components\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── containers\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── index.html\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── layouts\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── main.js\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── routes\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── static\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── store\x3cbr\x3e│\x26nbsp;\x26nbsp; └── until\x3cbr\x3e├── tests\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── components\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── layouts\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── routes\x3cbr\x3e│\x26nbsp;\x26nbsp; ├── store\x3cbr\x3e│\x26nbsp;\x26nbsp; └── test-bundler.js\x3cbr\x3e└── yarn.lock\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/taikongfeizhu\/webpack-develop-startkit\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e工程演示demo\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e小结\x3c\/h2\x3e\n\x3cp\x3e将webpack的各类高级特性和node基础服务有效相结合，按需打造专属自身项目的开发平台，不仅能将项目体系从简单的页面开发转向工程化标准迈进，更能极大的改善前端开发的体验，提升开发效率。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>基于webpack的前后端分离开发环境实战</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009266900">https://segmentfault.com/a/1190000009266900</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/z7kn9qyvhwk/" target="_blank">https://alili.tech/archive/z7kn9qyvhwk/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5fmk2pl6rab/">2016年前端开发者深度调研，看看别人使用什么技术体系<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/stp6408xnu/">Bootstrap使用模态框modal实现表单提交弹出框<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/fu7a86e9uyh/">CSS水平垂直居中总结<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/r0w29esklr/">JS 里怎么给数组填充默认值<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/i00hiszlr1/">JavaScript - EventEmitter 背后的秘密<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/u2la0cn9do/">JavaScript 精度丢失问题<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/3txhfn3ejcb/">Nodejs进阶：如何玩转子进程（child_process）<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/yr7v8e9fao/">Promise介绍--规范篇<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/9lyxyz4wc6g/">QQ音乐API整理<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/84zzlljmes4/">SegmentFault 技术周刊 Vol.14 - 进阶 Vue 2.0<aside class="dates">2019-01-30</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>