<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端项目发布后的问题总结"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端项目发布后的问题总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/3e2m0dlm0nq/",
				"appid": "1613049289050283", 
				"title": "前端项目发布后的问题总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-11T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/971lrwy2x15/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/065671fsm2ac/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f&text=%e5%89%8d%e7%ab%af%e9%a1%b9%e7%9b%ae%e5%8f%91%e5%b8%83%e5%90%8e%e7%9a%84%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f&text=%e5%89%8d%e7%ab%af%e9%a1%b9%e7%9b%ae%e5%8f%91%e5%b8%83%e5%90%8e%e7%9a%84%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f&title=%e5%89%8d%e7%ab%af%e9%a1%b9%e7%9b%ae%e5%8f%91%e5%b8%83%e5%90%8e%e7%9a%84%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e9%a1%b9%e7%9b%ae%e5%8f%91%e5%b8%83%e5%90%8e%e7%9a%84%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e9%a1%b9%e7%9b%ae%e5%8f%91%e5%b8%83%e5%90%8e%e7%9a%84%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f&title=%e5%89%8d%e7%ab%af%e9%a1%b9%e7%9b%ae%e5%8f%91%e5%b8%83%e5%90%8e%e7%9a%84%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f&title=%e5%89%8d%e7%ab%af%e9%a1%b9%e7%9b%ae%e5%8f%91%e5%b8%83%e5%90%8e%e7%9a%84%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f&title=%e5%89%8d%e7%ab%af%e9%a1%b9%e7%9b%ae%e5%8f%91%e5%b8%83%e5%90%8e%e7%9a%84%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3e2m0dlm0nq%2f&title=%e5%89%8d%e7%ab%af%e9%a1%b9%e7%9b%ae%e5%8f%91%e5%b8%83%e5%90%8e%e7%9a%84%e9%97%ae%e9%a2%98%e6%80%bb%e7%bb%93"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端项目发布后的问题总结</h1><div class="meta"><div class="postdate"><time datetime="2019-01-11" itemprop="datePublished">2019-01-11</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e引言\x3c\/h1\x3e\n\x3cblockquote\x3e\x3cp\x3e最近做的项目已经接近尾声,刚刚发到线上,回顾和总结一下这段时间遇到的问题和个人的一些想法。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3eselect下拉修改和复原\x3c\/h1\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/部分下拉选项\n \x3cselect  v-model=\x26quot;offer.measureUnit\x26quot;  :data-index=\x26quot;index\x26quot; v-select-change=\x26quot;offer.measureUnit\x26quot;\x3e\n                \x3coption v-for=\x26quot;option in selectList[\x27measureUnit\x27]\x26quot; v-bind:value=\x26quot;option\x26quot; \x3e\n                        \x22{{\x22option\x22}}\x22\n                 \x3c\/option\x3e\n   \x3c\/select\x3e\n  \x3c!-------------------------------------------\x3e\n \/\/select绑定的指令部分操作\n  Vue.directive(\x27select-change\x27, {\n      update: function (el,binding) {\n         var oldValue=binding.oldValue;\n          var newValue=binding.value;\n          if(cache.submitFlag==true){\n              return;\n          }\n          if(validatorRules.isBlank(oldValue)||validatorRules.isBlank(newValue)||(oldValue==newValue)){\n              return;\n          }\n          if(el.getAttribute(\x26quot;measureUnitFlag\x26quot;)!=\x26quot;1\x26quot;){\n            var index= el.dataset.index;\n                  new Dialog.tip({\n                     ………………xxx逻辑\n                      close(){\n                                   el.setAttribute(\x27measureUnitFlag\x27,\x271\x27);\n                                    vm.formData[index].measureUnit=oldValue;\n                              },\n                  })\n          }else {\n              el.setAttribute(\x26quot;measureUnitFlag\x26quot;,\x26quot;0\x26quot;);\n          }\n          return false;\n      }\n  })\n    \x3c!-------------------------------------------\x3e\n    恢复按钮部分逻辑操作\n               vm.formData=formDataFail;\n                   Vue.nextTick(function () {\n                        cache.submitFlag=false;\n                  })\n                   \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lua\x22\x3e\x3ccode\x3e\/\/部分下拉选项\n \x26lt;\x3cspan class=\x22hljs-built_in\x22\x3eselect\x3c\/span\x3e  v-model=\x3cspan class=\x22hljs-string\x22\x3e\x22offer.measureUnit\x22\x3c\/span\x3e  :data-index=\x3cspan class=\x22hljs-string\x22\x3e\x22index\x22\x3c\/span\x3e v-\x3cspan class=\x22hljs-built_in\x22\x3eselect\x3c\/span\x3e-change=\x3cspan class=\x22hljs-string\x22\x3e\x22offer.measureUnit\x22\x3c\/span\x3e\x26gt;\n                \x26lt;option v-\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22option in selectList[\x27measureUnit\x27]\x22\x3c\/span\x3e v-bind:value=\x3cspan class=\x22hljs-string\x22\x3e\x22option\x22\x3c\/span\x3e \x26gt;\n                        \x22{{\x22option\x22}}\x22\n                 \x26lt;\/option\x26gt;\n   \x26lt;\/\x3cspan class=\x22hljs-built_in\x22\x3eselect\x3c\/span\x3e\x26gt;\n  \x26lt;!\x3cspan class=\x22hljs-comment\x22\x3e-------------------------------------------\x26gt;\x3c\/span\x3e\n \/\/\x3cspan class=\x22hljs-built_in\x22\x3eselect\x3c\/span\x3e绑定的指令部分操作\n  Vue.directive(\x3cspan class=\x22hljs-string\x22\x3e\x27select-change\x27\x3c\/span\x3e, {\n      update: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(el,binding)\x3c\/span\x3e\x3c\/span\x3e {\n         var oldValue=binding.oldValue;\n          var newValue=binding.value;\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(cache.submitFlag==\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e){\n              \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n          }\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(validatorRules.isBlank(oldValue)||validatorRules.isBlank(newValue)||(oldValue==newValue)){\n              \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n          }\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(el.getAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22measureUnitFlag\x22\x3c\/span\x3e)!=\x3cspan class=\x22hljs-string\x22\x3e\x221\x22\x3c\/span\x3e){\n            var index= el.dataset.index;\n                  new Dialog.tip({\n                     ………………xxx逻辑\n                      \x3cspan class=\x22hljs-built_in\x22\x3eclose\x3c\/span\x3e(){\n                                   el.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x27measureUnitFlag\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e);\n                                    vm.formData[index].measureUnit=oldValue;\n                              },\n                  })\n          }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n              el.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x22measureUnitFlag\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x220\x22\x3c\/span\x3e);\n          }\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n      }\n  })\n    \x26lt;!\x3cspan class=\x22hljs-comment\x22\x3e-------------------------------------------\x26gt;\x3c\/span\x3e\n    恢复按钮部分逻辑操作\n               vm.formData=formDataFail;\n                   Vue.nextTick(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e\x3c\/span\x3e {\n                        cache.submitFlag=\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n                  })\n                   \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e说明\x3c\/strong\x3e   需求:点击select下拉选项,弹窗提示是否修改(select最多有200个)。实现:不适合用watch和computed,因为offer.measureUnit太多,且每个都是独立的不同的响应式属性,考虑用指令,点击恢复按钮,列表重新渲染,此时指令会全部执行一遍,因为指令是在同一个组件模板中。通过在指令中比较前后值,以及设置cache.submitFlag避免不必要更新导致的弹窗,渲染。渲染完毕,复原submitFlag,防止select下拉选项单个点时击失效;measureUnitFlag是为了防止点击同一个下拉选项时,在弹窗逻辑中点击不修改赋原值时重复弹窗情况。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e知识点1\x3c\/strong\x3e  指令的原理,在vue2中是函数式组件(就是说模板-\x26gt;render函数),由于数据变化,导致依赖watcher--\x26gt;update(),在每次组件经vdom diff,update后绑定在组件上的指令,只要组件中响应式属性有一个更新,指令全部执行一遍.\x3cbr\x3e\x3cstrong\x3e知识点2\x3c\/strong\x3e  nextTick的机制\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export function queueWatcher (watcher: Watcher) {\n  const id = watcher.id\n  \/\/这里保证了相同的watcher只有一个会被加入到异步队列中，\n  \/\/虽然第一个watcher会放进去,但是对dom的操作是在nextTick异步操作中,所以最终执行依赖的update方法时,取的一定是最新的data值。\n  if (has[id] == null) {\n    has[id] = true\n    if (!flushing) {\n      queue.push(watcher)\n    } else {\n      \/\/对应watch里面触发watch的情况,已经刷新的话,根据watcher标识的id删除watcher\n      let i = queue.length - 1\n      while (i \x3e= 0 \x26amp;\x26amp; queue[i].id \x3e watcher.id) {\n        i--\n      }\n      queue.splice(Math.max(i, index) \x2b 1, 0, watcher)\n    }\n    \/\/ queue the flush\n    if (!waiting) {\n      waiting = true\n      nextTick(flushSchedulerQueue)  \/\/异步队列执行  将waiting和flushing都设为false\n    }\n  }\n}\n然后nextTick(flushSchedulerQueue)--\x3e三种兼容机制实现异步处理(基于优先级顺序依次是Promise、MutationObserver、setTimeout)--\x3enextTickHandler()-\x3e watcher.run()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3equeueWatcher\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ewatcher: Watcher\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e id = watcher.id\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/这里保证了相同的watcher只有一个会被加入到异步队列中，\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/虽然第一个watcher会放进去,但是对dom的操作是在nextTick异步操作中,所以最终执行依赖的update方法时,取的一定是最新的data值。\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (has[id] == \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e) {\n    has[id] = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!flushing) {\n      queue.push(watcher)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/对应watch里面触发watch的情况,已经刷新的话,根据watcher标识的id删除watcher\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = queue.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (i \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x26amp;\x26amp; queue[i].id \x26gt; watcher.id) {\n        i--\n      }\n      queue.splice(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.max(i, index) \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, watcher)\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ queue the flush\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!waiting) {\n      waiting = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      nextTick(flushSchedulerQueue)  \x3cspan class=\x22hljs-comment\x22\x3e\/\/异步队列执行  将waiting和flushing都设为false\x3c\/span\x3e\n    }\n  }\n}\n然后nextTick(flushSchedulerQueue)--\x26gt;三种兼容机制实现异步处理(基于优先级顺序依次是\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e、MutationObserver、setTimeout)--\x26gt;nextTickHandler()-\x26gt; watcher.run()\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e打包问题\x3c\/h1\x3e\n\x3cp\x3e因为几个项目依赖一个公共目录,项目1是基于webpack1,项目2是gulp。依赖的公共目录在被import时能被打包,但是不能编译。当时没找到原因,统一改成webpack2可以了,最后做项目3时,基于vue2脚手架，出现同样问题,探索一番,找到原因,include导致能打包但是不能编译。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 {\n        test: \/\\.js$\/,\n        loader: \x27babel-loader\x27,\n         exclude: \/node_modules\/,\n        \/\/ include: [resolve(\x27src\x27), resolve(\x27test\x27)],\n        options: {\n          presets: [\n            [\x27es2015\x27]\n          ]\n        }\n }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e {\n        \x3cspan class=\x22hljs-attribute\x22\x3etest\x3c\/span\x3e: \/\\.js$\/,\n        loader: \x3cspan class=\x22hljs-string\x22\x3e\x27babel-loader\x27\x3c\/span\x3e,\n         exclude: \/node_modules\/,\n        \/\/ include: [\x3cspan class=\x22hljs-built_in\x22\x3eresolve\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e), \x3cspan class=\x22hljs-built_in\x22\x3eresolve\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e)],\n        options: {\n          presets: [\n            [\x3cspan class=\x22hljs-string\x22\x3e\x27es2015\x27\x3c\/span\x3e]\n          ]\n        }\n }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e数据校验\x3c\/h1\x3e\n\x3cp\x3e数据200条校验,在错误多时要进行大量出错样式渲染,比较卡,改成异步(基于setTimeout)单条校验渲染，同时搭配上进度条动态展示处理过程,解决以上问题。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3ebug\x3c\/h1\x3e\n\x3cp\x3eget请求在ie和360兼容模式下多次操作被缓存,接口维护之前的,之前没测出来,发到线上测试验证时发现这个问题,同事一神助攻,帮助我快速定位找到这个bug,这个bug暴露我ie下调试工具使用欠缺,指的是win7上ie调试工具,我平时也没用到过。然后解决方式可以加时间戳或者改成post请求或者后端设置禁止缓存的header。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3erequire.ensure\x3c\/h1\x3e\n\x3cp\x3erequire.ensure只能是用来实现按需加载，同时具有代码分割的作用，不能实现并行加载，如果要实现并行并且按顺序可以用浏览器本身的机制。webpack的require.ensure底层是通过jsonp\x2bpromise的方式,下面是我写的例子被编译后source部分截取,展示出来以便更好的说明问题。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22_\/\/1:__webpack_require__.e 加载chunk.js 异步（动态创建script）的方式,这个操作被封装成promise返回_\n__webpack_require__.e\/* require.ensure *\/(0).then((function (require) {\n    console.log(\x26quot;begin\x26quot;);\n    var module2 = __webpack_require__(2);\n   \n  }).bind(null, __webpack_require__)).catch(__webpack_require__.oe);\n  \n_  ---------------------------\n \/\/ 2:jsonp方式,主要功能是安装chunk_\n   window[\x26quot;webpackJsonp\x26quot;] = function webpackJsonpCallback(chunkIds, moreModules, executeModules) {\n       var moduleId, chunkId, i = 0, resolves = [], result;\n       for(;i \x3c chunkIds.length; i\x2b\x2b) {\n          chunkId = chunkIds[i];\n          if(installedChunks[chunkId])\n             resolves.push(installedChunks[chunkId][0]);\n          installedChunks[chunkId] = 0;\n       }\n       \n       if(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);\n       while(resolves.length)\n          resolves.shift()();  _\/\/3:执行第一步promise的resolve方法，从而可以继续执行then当中的业务逻辑。_\n  \n    };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-literal\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/1:__webpack_require__.e 加载chunk.js 异步（动态创建script）的方式,这个操作被封装成promise返回_\x3c\/span\x3e\n__webpack_require__.e\x3cspan class=\x22hljs-comment\x22\x3e\/* require.ensure *\/\x3c\/span\x3e(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e).then((\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3c\/span\x3e(require) {\n    console.log(\x3cspan class=\x22hljs-string\x22\x3e\x22begin\x22\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e module2 = __webpack_require__(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n   \n  }).bind(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, __webpack_require__)).\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e(__webpack_require__.oe);\n  \n\x3cspan class=\x22hljs-literal\x22\x3e_\x3c\/span\x3e  ---------------------------\n \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2:jsonp方式,主要功能是安装chunk_\x3c\/span\x3e\n   window[\x3cspan class=\x22hljs-string\x22\x3e\x22webpackJsonp\x22\x3c\/span\x3e] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ewebpackJsonpCallback\x3c\/span\x3e\x3c\/span\x3e(chunkIds, moreModules, executeModules) {\n       \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e moduleId, chunkId, i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, resolves = [], result;\n       \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(;i \x26lt; chunkIds.length; i\x2b\x2b) {\n          chunkId = chunkIds[i];\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(installedChunks[chunkId])\n             resolves.push(installedChunks[chunkId][\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]);\n          installedChunks[chunkId] = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n       }\n       \n       \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);\n       \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e(resolves.length)\n          resolves.shift()();  \x3cspan class=\x22hljs-literal\x22\x3e_\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/3:执行第一步promise的resolve方法，从而可以继续执行then当中的业务逻辑。_\x3c\/span\x3e\n  \n    };\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch1 id=\x22articleHeader6\x22\x3e开发\x3c\/h1\x3e\n\x3cp\x3e合理的使用dev-server的热加载机制,优化的开发配置提升开发效率;合理的使用mixins选项,模块化拆分封装功能;利用函数式思想,封装抽象函数单元,业务相近的一组功能封装成一个模块;关键变量以及逻辑单元加上必要注释,规范的编程风格等。感悟：以后我在code时,half or one day time,先在思想中先大致走一遍,做好完善的前期项目规划--\x26gt;技术选型、结构组织、难优化点、可归纳的抽象功能等等 --\x26gt;A good beginning is half of success.\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader7\x22\x3e总结\x3c\/h1\x3e\n\x3cp\x3e几乎没有实现不了的视觉和交互需求,只有小部分实现起来需考虑时间成本问题。规范、TDD、性能、开发效率等等都追求完美有困难,找到一个良好的动态平衡点很重要。路漫漫其修远，吾将上下而求索。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端项目发布后的问题总结</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009862697">https://segmentfault.com/a/1190000009862697</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/3e2m0dlm0nq/" target="_blank">https://alili.tech/archive/3e2m0dlm0nq/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5x6tenwjeux/">ES6中的异步编程：Generators函数&#43;Promise:最强大的异步处理方式<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/nvtmua2a1hd/">GreenSock (TweenMax) 极简入门指南<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/7kt5s47oysx/">HTML5 中 canvas 的使用总结<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/41pgo3a2iyp/">JavaScript 开发者所需要知道的 V8（一）：V8 In NodeJS<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/krb1zm7x38j/">JavaScript 时间与日期处理实战:你肯定被坑过<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/yh2lq30d0x/">JavaScript中的各种宽高属性<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/eydwczesyv/">Muse UI — 基于 Vue2.0 的 Material Design UI 库<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/y62oejm8cr/">Nodejs基础：路径处理模块path总结<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/06cwh88ankmd/">PhantomJS &amp; NodeJS 在京东网站前端监控平台的最佳实践<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/z4ymvs0jz2h/">Promise 的链式调用与中止<aside class="dates">2019-01-31</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>