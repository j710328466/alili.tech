<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="从零到一：用Phaser.js写意地开发小游戏（Chapter 4 - 游戏即将开始）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>从零到一：用Phaser.js写意地开发小游戏（Chapter 4 - 游戏即将开始） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/5r7uyl81wkj/",
				"appid": "1613049289050283", 
				"title": "从零到一：用Phaser.js写意地开发小游戏（Chapter 4 - 游戏即将开始） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-15T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ez9frc5ms0f/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/84966nl6zcm/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f&text=%e4%bb%8e%e9%9b%b6%e5%88%b0%e4%b8%80%ef%bc%9a%e7%94%a8Phaser.js%e5%86%99%e6%84%8f%e5%9c%b0%e5%bc%80%e5%8f%91%e5%b0%8f%e6%b8%b8%e6%88%8f%ef%bc%88Chapter%204%20-%20%e6%b8%b8%e6%88%8f%e5%8d%b3%e5%b0%86%e5%bc%80%e5%a7%8b%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f&text=%e4%bb%8e%e9%9b%b6%e5%88%b0%e4%b8%80%ef%bc%9a%e7%94%a8Phaser.js%e5%86%99%e6%84%8f%e5%9c%b0%e5%bc%80%e5%8f%91%e5%b0%8f%e6%b8%b8%e6%88%8f%ef%bc%88Chapter%204%20-%20%e6%b8%b8%e6%88%8f%e5%8d%b3%e5%b0%86%e5%bc%80%e5%a7%8b%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f&title=%e4%bb%8e%e9%9b%b6%e5%88%b0%e4%b8%80%ef%bc%9a%e7%94%a8Phaser.js%e5%86%99%e6%84%8f%e5%9c%b0%e5%bc%80%e5%8f%91%e5%b0%8f%e6%b8%b8%e6%88%8f%ef%bc%88Chapter%204%20-%20%e6%b8%b8%e6%88%8f%e5%8d%b3%e5%b0%86%e5%bc%80%e5%a7%8b%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f&is_video=false&description=%e4%bb%8e%e9%9b%b6%e5%88%b0%e4%b8%80%ef%bc%9a%e7%94%a8Phaser.js%e5%86%99%e6%84%8f%e5%9c%b0%e5%bc%80%e5%8f%91%e5%b0%8f%e6%b8%b8%e6%88%8f%ef%bc%88Chapter%204%20-%20%e6%b8%b8%e6%88%8f%e5%8d%b3%e5%b0%86%e5%bc%80%e5%a7%8b%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bb%8e%e9%9b%b6%e5%88%b0%e4%b8%80%ef%bc%9a%e7%94%a8Phaser.js%e5%86%99%e6%84%8f%e5%9c%b0%e5%bc%80%e5%8f%91%e5%b0%8f%e6%b8%b8%e6%88%8f%ef%bc%88Chapter%204%20-%20%e6%b8%b8%e6%88%8f%e5%8d%b3%e5%b0%86%e5%bc%80%e5%a7%8b%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f&title=%e4%bb%8e%e9%9b%b6%e5%88%b0%e4%b8%80%ef%bc%9a%e7%94%a8Phaser.js%e5%86%99%e6%84%8f%e5%9c%b0%e5%bc%80%e5%8f%91%e5%b0%8f%e6%b8%b8%e6%88%8f%ef%bc%88Chapter%204%20-%20%e6%b8%b8%e6%88%8f%e5%8d%b3%e5%b0%86%e5%bc%80%e5%a7%8b%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f&title=%e4%bb%8e%e9%9b%b6%e5%88%b0%e4%b8%80%ef%bc%9a%e7%94%a8Phaser.js%e5%86%99%e6%84%8f%e5%9c%b0%e5%bc%80%e5%8f%91%e5%b0%8f%e6%b8%b8%e6%88%8f%ef%bc%88Chapter%204%20-%20%e6%b8%b8%e6%88%8f%e5%8d%b3%e5%b0%86%e5%bc%80%e5%a7%8b%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f&title=%e4%bb%8e%e9%9b%b6%e5%88%b0%e4%b8%80%ef%bc%9a%e7%94%a8Phaser.js%e5%86%99%e6%84%8f%e5%9c%b0%e5%bc%80%e5%8f%91%e5%b0%8f%e6%b8%b8%e6%88%8f%ef%bc%88Chapter%204%20-%20%e6%b8%b8%e6%88%8f%e5%8d%b3%e5%b0%86%e5%bc%80%e5%a7%8b%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f5r7uyl81wkj%2f&title=%e4%bb%8e%e9%9b%b6%e5%88%b0%e4%b8%80%ef%bc%9a%e7%94%a8Phaser.js%e5%86%99%e6%84%8f%e5%9c%b0%e5%bc%80%e5%8f%91%e5%b0%8f%e6%b8%b8%e6%88%8f%ef%bc%88Chapter%204%20-%20%e6%b8%b8%e6%88%8f%e5%8d%b3%e5%b0%86%e5%bc%80%e5%a7%8b%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">从零到一：用Phaser.js写意地开发小游戏（Chapter 4 - 游戏即将开始）</h1><div class="meta"><div class="postdate"><time datetime="2019-01-15" itemprop="datePublished">2019-01-15</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM22H?w=900\x26amp;h=500\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM22H?w=900\x26amp;h=500\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e回顾\x3c\/h4\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000009252244\x22\x3e上一节\x3c\/a\x3e我们介绍了加载场景，并利用加载好的资源，丰富了开始界面。现在点击屏幕后仍是一片黑暗，那么，这一节我们就来完成游戏最核心的场景——play。我们要做的是一个接苹果的游戏，为此我们会加入物理引擎，会使用一些过渡动画以及监听触摸事件等等。\x3c\/p\x3e\n\x3ch4\x3e物理引擎\x3c\/h4\x3e\n\x3cp\x3e几乎每一个游戏框架都必须具备一个甚至多个物理引擎供开发使用，使用物理引擎可以实现例如碰撞、加减速运动、摩擦力等效果。Phaser非常人性化，提供了3个物理引擎供开发者使用，每个引擎各有自己的特点。下面来简单介绍一下：\x3c\/p\x3e\n\x3ch5\x3eArcade\x3c\/h5\x3e\n\x3cp\x3e最简单快速的物理引擎，因为只支持AABB式的碰撞，计算速度最快，实现简单的物理碰撞、接触、重力等效果最佳。\x3c\/p\x3e\n\x3cp\x3e关于AABB下面有几个链接可以让你去理解，全称是\x3ccode\x3eAxis-Aligned Bounding Box\x3c\/code\x3e，直译就是\x3ccode\x3e轴对称盒\x3c\/code\x3e。例如一张星星的图片，尽管边上很多透明的部分，但如果使用AABB来计算碰撞的话，则会用一个矩形将星星框住，这样计算起来非常方便，但精度就比较低。如此一来我们也可以想到，用Arcade构建的body是不可以发生形变的。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM25M?w=1706\x26amp;h=242\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM25M?w=1706\x26amp;h=242\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e相关概念：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/stackoverflow.com\/questions\/22512319\/what-is-aabb-collision-detection\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWhat is AABB - Collision detection?\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/baike.baidu.com\/item\/AABB%E7%9B%92\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAABB盒\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/baike.baidu.com\/item\/%E5%8C%85%E5%9B%B4%E7%9B%92\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e包围盒算法\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3chr\x3e\n\x3ch5\x3eP2\x3c\/h5\x3e\n\x3cp\x3e如果说Arcade是小而精，P2引擎则是大而全了。各种物理模型均可实现，诸如多边形、弹簧、摩擦力、碰撞物体的材质、反弹系数等等都可以实现。尽管在性能上有一定消耗，毕竟要做更多复杂的运算，但为了效果，我们也很常用P2，作者引进P2也是由于它的全面。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM250?w=1710\x26amp;h=282\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM250?w=1710\x26amp;h=282\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3ch5\x3eNinja\x3c\/h5\x3e\n\x3cp\x3e至于Ninja，则是比较专注精确的多种模式的碰撞检测。例如凹凸面的碰撞、平面和球的碰撞等等。平常比较少用，有兴趣的可以查看\x3ca href=\x22http:\/\/phaser.io\/examples\/v2\/category\/ninja-physics\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e官方示例\x3c\/a\x3e，另外，作者给出引进Ninja的理由是：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eIt\x27s a really nice little physics system, supporting AABB and Circle vs. Tile collision, with lots of defs for sloping, convex and concave tile types. But that\x27s all it does, it\x27s not trying to be anything more really.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM253?w=1708\x26amp;h=840\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM253?w=1708\x26amp;h=840\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3eStack Exchange - Game Development上关于Phaser三个引擎的介绍\x3cbr\x3e\x3ca href=\x22https:\/\/gamedev.stackexchange.com\/questions\/72930\/difference-between-arcade-p2-and-ninja-physics-in-phaser\/72941\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDifference between Arcade, P2 and Ninja physics in Phaser\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3ePhaser作者写的，关于物理引擎的介绍：\x3cbr\x3e\x3ca href=\x22http:\/\/www.html5gamedevs.com\/topic\/4518-explaining-phaser-2s-multiple-physics-systems\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eExplaining Phaser 2\x27s multiple physics systems\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3chr\x3e\n\x3ch5\x3eBox2D\x3c\/h5\x3e\n\x3cp\x3e咦？为什么没有上面没有提到Box2D？很遗憾，这个引擎是收费的，40刀，如果没有特别大的需求，估计也用不上。\x3c\/p\x3e\n\x3cp\x3e附上：\x3ca href=\x22http:\/\/phaser.io\/examples\/v2\/box2d\/car-on-terrain\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e非常有趣的官方示例，车掉坑里就爬不起来了。\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM3a2?w=1698\x26amp;h=786\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM3a2?w=1698\x26amp;h=786\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3ch4\x3e正式开始\x3c\/h4\x3e\n\x3ch5\x3e第一步：先布置好场景\x3c\/h5\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e添加背景\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e添加主角\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e添加分数\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e播放背景音乐\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e背景音乐的使用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 创建背景音乐实例\nvar bgMusic = game.add.audio(\x27bgMusic\x27);\n\/\/ 循环播放\nbgMusic.loopFull();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建背景音乐实例\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e bgMusic = game.\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e.audio(\x3cspan class=\x22hljs-string\x22\x3e\x27bgMusic\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 循环播放\x3c\/span\x3e\nbgMusic.loopFull();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e注意：\x3c\/p\x3e\n\x3cp\x3e场景的布置和开始场景差不多，在开始场景中我们添加了背景音乐。会有人问，为什么不进入游戏就自动播放，是因为移动端的浏览器，必须要用户操作才能播放音频。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developer.apple.com\/library\/content\/documentation\/AudioVideo\/Conceptual\/Using_HTML5_Audio_Video\/AudioandVideoTagBasics\/AudioandVideoTagBasics.html#\/\/apple_ref\/doc\/uid\/TP40009523-CH2-SW1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSafari HTML5 Audio and Video Guide\x3c\/a\x3e\x3cbr\x3eWarning: To prevent unsolicited downloads over cellular networks at the user’s expense, embedded media cannot be played automatically in Safari on iOS—the user always initiates playback.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e另外可参考：\x3c\/p\x3e\n\x3cp\x3esegmentfault上的讨论：\x3ca href=\x22https:\/\/segmentfault.com\/q\/1010000002565534\x22\x3eHTML5的audio标签设置了autoplay属性在手机端出现的问题\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e示例代码：\x3ca href=\x22https:\/\/jsfiddle.net\/Vincent_Pat\/webzd2bc\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/jsfiddle.net\/Vincent_...\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22Vincent_Pat\/webzd2bc\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3ch5\x3e第二步：让你的主角动起来\x3c\/h5\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e监听滑动事件\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e移动主角位置\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e主要使用的就是input的addMoveCallback方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 监听滑动事件\ngame.input.addMoveCallback(function(pointer, x, y, isTap) {\n    if (!isTap) man.x = x;\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听滑动事件\x3c\/span\x3e\ngame.input.addMoveCallback(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(pointer, x, y, isTap)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isTap) man.x = x;\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e第四个参数非常有用，可以判断是否为点击事件，如果是点击就不移动主角。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM6OY?w=1716\x26amp;h=516\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM6OY?w=1716\x26amp;h=516\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e示例代码：\x3ca href=\x22https:\/\/jsfiddle.net\/Vincent_Pat\/tf1hxgee\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/jsfiddle.net\/Vincent_...\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22Vincent_Pat\/tf1hxgee\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3ch5\x3e就这么简单？NO,NO,NO\x3c\/h5\x3e\n\x3cp\x3e很快你就会发觉在PC上主角一直跟着鼠标移动，根本无法停下来！\x3c\/p\x3e\n\x3cp\x3e其实原因也很简单，在PC端，Phaser的move事件对应的是\x3ccode\x3emousemove\x3c\/code\x3e；在移动端，对应的是\x3ccode\x3etouchmove\x3c\/code\x3e。这两个事件有什么区别？主要区别就是touchmove必须手指触摸屏幕并滑动才会触发，而mousemove则不需要点住鼠标，只需要移动鼠标就会触发。\x3c\/p\x3e\n\x3cp\x3e于是，我们来修改一下代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 是否正在触摸\nvar touching = false;\n\/\/ 监听按下事件\ngame.input.onDown.add(function() {\n    touching = true;\n});\n\/\/ 监听离开事件\ngame.input.onUp.add(function() {\n    touching = false;\n});\n\/\/ 监听滑动事件\ngame.input.addMoveCallback(function(pointer, x, y, isTap) {\n    if (!isTap \x26amp;\x26amp; touching) man.x = x;\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 是否正在触摸\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e touching = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听按下事件\x3c\/span\x3e\ngame.input.onDown.add(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    touching = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n});\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听离开事件\x3c\/span\x3e\ngame.input.onUp.add(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    touching = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n});\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听滑动事件\x3c\/span\x3e\ngame.input.addMoveCallback(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(pointer, x, y, isTap)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isTap \x26amp;\x26amp; touching) man.x = x;\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eGood！加入了触摸标记以后，我们监听了按下和离开事件，在PC端和移动端的表现一致了！\x3c\/p\x3e\n\x3cp\x3e示例代码：\x3ca href=\x22https:\/\/jsfiddle.net\/Vincent_Pat\/ymrvtxj7\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/jsfiddle.net\/Vincent_...\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22Vincent_Pat\/ymrvtxj7\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3ch5\x3e这样算完事了？NO,NO,NO\x3c\/h5\x3e\n\x3cp\x3e细心的你多测试了几下，这时候发现了一个非常诡异的情况，当开始点击的时候，不是点在主角身上，主角就会瞬移过去！不难理解，因为我们是直接设置主角的x坐标，等于触摸位置的x坐标的。如果开始时x坐标不在主角身上，就会在一瞬间移动到手指的位置。\x3c\/p\x3e\n\x3cp\x3e于是，我们又来修改一下代码，非常简单的一个方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 监听按下事件\ngame.input.onDown.add(function(pointer) {\n    \/\/ 要判断是否点住主角，避免瞬移\n    if (Math.abs(pointer.x - man.x) \x3c man.width \/ 2) touching = true;\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听按下事件\x3c\/span\x3e\ngame.input.onDown.add(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3epointer\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 要判断是否点住主角，避免瞬移\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(pointer.x - man.x) \x26lt; man.width \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e) touching = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上述代码的意思就是，开始触摸的位置必须在主角的最左边到最右边的x坐标范围内，才算作开始触摸，否则不算。\x3c\/p\x3e\n\x3cp\x3eExcellent！现在可以随心所欲地操控你的主角了！\x3c\/p\x3e\n\x3cp\x3e示例代码：\x3ca href=\x22https:\/\/jsfiddle.net\/Vincent_Pat\/2gfnadau\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/jsfiddle.net\/Vincent_...\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22Vincent_Pat\/2gfnadau\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3ch5\x3e第三步：让苹果掉下来吧\x3c\/h5\x3e\n\x3ch5\x3e先来创造几个苹果看看\x3c\/h5\x3e\n\x3cp\x3e这里用到了Phaser的group，实际上可以理解成是一个数组，只不过更形象，组的常用方法：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eadd\/addChild\/addChildAt - 创建成员\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ecountDead\/countLiving - 统计成员\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eforEach\/forEachAlive\/forEachDead - 遍历成员\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eremove\/removeAll\/removeChildAt - 删除成员\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ecreate - 创建成员\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ebringToTop - 整个组的元素的图层提到最上层\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e另外组本身也有x,y等属性，也就是说，整个组的成员都可以根据组的偏移值而一起偏移！另外组还提供了很多丰富的方法，活用组可以达到事半功倍的效果。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 添加苹果组\nvar apples = game.add.group();\nvar green = apples.create(50, 0, \x27green\x27);\nvar red = apples.create(150, 0, \x27red\x27);\nvar yellow = apples.create(250, 0, \x27yellow\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加苹果组\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apples = game.\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e();\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e green = apples.create(\x3cspan class=\x22hljs-number\x22\x3e50\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27green\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e red = apples.create(\x3cspan class=\x22hljs-number\x22\x3e150\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27red\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e yellow = apples.create(\x3cspan class=\x22hljs-number\x22\x3e250\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27yellow\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e示例代码：\x3ca href=\x22https:\/\/jsfiddle.net\/Vincent_Pat\/rzw0jjd9\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/jsfiddle.net\/Vincent_...\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22Vincent_Pat\/rzw0jjd9\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3ch5\x3e定时随机创造苹果\x3c\/h5\x3e\n\x3cp\x3e上面我们看到有三种苹果，那么下面我们来实现：每隔一段时间，随机创建三种苹果中的一种，并且摆放到不同的位置。\x3c\/p\x3e\n\x3cp\x3e为此我们用到Phaser的timer，用于创建定时任务。会有人问为什么不用setInterval，setTimeout这些，是因为Phaser只要焦点离开了页面，就会自动暂停游戏，包括定时任务也会暂停，而setInterval和setTimeout则不会。\x3c\/p\x3e\n\x3cp\x3e一般会用到\x3ccode\x3eadd\x3c\/code\x3e和\x3ccode\x3eloop\x3c\/code\x3e两个方法，分别对应setTimeout和setInterval：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM6Wq?w=1676\x26amp;h=870\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM6Wq?w=1676\x26amp;h=870\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM6V6?w=1684\x26amp;h=862\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM6V6?w=1684\x26amp;h=862\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e我们修改一下代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 添加苹果组\nvar apples = game.add.group();\n\/\/ 苹果类型\nvar appleTypes = [\x27green\x27, \x27red\x27, \x27yellow\x27];\nvar appleTimer = game.time.create(true);\nappleTimer.loop(1000, function() {\n    var x = Math.random() * game.world.width;\n    var y = Math.random() * game.world.height;\n    var type = appleTypes[Math.floor(Math.random() * appleTypes.length)];\n    apples.create(x, y, type);\n});\nappleTimer.start();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加苹果组\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apples = game.add.group();\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 苹果类型\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e appleTypes = [\x3cspan class=\x22hljs-string\x22\x3e\x27green\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27red\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27yellow\x27\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e appleTimer = game.time.create(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nappleTimer.loop(\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * game.world.width;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e y = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * game.world.height;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e = appleTypes[\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * appleTypes.length)];\n    apples.create(x, y, \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e);\n});\nappleTimer.start();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在每隔1秒就会在屏幕随机位置出现一个苹果了，而且种类是随机的。\x3c\/p\x3e\n\x3cp\x3e示例代码：\x3ca href=\x22https:\/\/jsfiddle.net\/Vincent_Pat\/Lcnv2s50\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/jsfiddle.net\/Vincent_...\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22Vincent_Pat\/Lcnv2s50\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3ch5\x3e最后，我们让苹果掉下来\x3c\/h5\x3e\n\x3cp\x3e这里就要使用到物理引擎了，考虑到接苹果的游戏对碰撞精度要求不是很高，我们选择使用Arcade，也就是Phaser默认的物理引擎。\x3c\/p\x3e\n\x3cp\x3e关键代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 开启物理引擎\ngame.physics.startSystem(Phaser.Physics.Arcade);\ngame.physics.arcade.gravity.y = 300;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs abnf\x22\x3e\x3ccode\x3e\/\/ 开启物理引擎\ngame.physics.startSystem(Phaser.Physics.Arcade)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\ngame.physics.arcade.gravity.y = \x3cspan class=\x22hljs-number\x22\x3e300\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 设置苹果加入物理运动\ngame.physics.enable(apple);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gauss\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置苹果加入物理运动\x3c\/span\x3e\ngame.physics.\x3cspan class=\x22hljs-keyword\x22\x3eenable\x3c\/span\x3e(apple);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e于是，我们继续修改上面的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 添加苹果组\nvar apples = game.add.group();\n\/\/ 苹果类型\nvar appleTypes = [\x27green\x27, \x27red\x27, \x27yellow\x27];\nvar appleTimer = game.time.create(true);\nappleTimer.loop(1000, function() {\n    var x = Math.random() * game.world.width;\n    var type = appleTypes[Math.floor(Math.random() * appleTypes.length)];\n    var apple = apples.create(x, 0, type);\n    \/\/ 设置苹果大小\n    var appleImg = game.cache.getImage(type);\n    apple.width = game.world.width \/ 8;\n    apple.height = apple.width \/ appleImg.width * appleImg.height;\n    \/\/ 设置苹果加入物理运动\n    game.physics.enable(apple);\n});\nappleTimer.start();\n\/\/ 开启物理引擎\ngame.physics.startSystem(Phaser.Physics.Arcade);\ngame.physics.arcade.gravity.y = 300;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs typescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 添加苹果组\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apples = game.add.group();\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 苹果类型\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e appleTypes = [\x3cspan class=\x22hljs-string\x22\x3e\x27green\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27red\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27yellow\x27\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e appleTimer = game.time.create(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nappleTimer.loop(\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * game.world.width;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e = appleTypes[\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() * appleTypes.length)];\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e apple = apples.create(x, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置苹果大小\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e appleImg = game.cache.getImage(\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e);\n    apple.width = game.world.width \/ \x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e;\n    apple.height = apple.width \/ appleImg.width * appleImg.height;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置苹果加入物理运动\x3c\/span\x3e\n    game.physics.enable(apple);\n});\nappleTimer.start();\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 开启物理引擎\x3c\/span\x3e\ngame.physics.startSystem(Phaser.Physics.Arcade);\ngame.physics.arcade.gravity.y = \x3cspan class=\x22hljs-number\x22\x3e300\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ePerfect！现在满天苹果都会有了重力，加速掉向地上了。\x3c\/p\x3e\n\x3cp\x3e示例代码：\x3ca href=\x22https:\/\/jsfiddle.net\/Vincent_Pat\/vaba16zt\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/jsfiddle.net\/Vincent_...\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22Vincent_Pat\/vaba16zt\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3chr\x3e\n\x3ch4\x3e小结\x3c\/h4\x3e\n\x3cp\x3e这一节内容比较多，我们首先布置了游戏场景，加入了背景音乐。然后实现了对主角的操作，最后实现了苹果的随机掉落。经过这一节，万事俱备只欠东风，下一节我们就来完成这个游戏的剩余逻辑，比如接苹果加分，接到炸弹或苹果掉到地上游戏结束，还有加入更丰富的音效。\x3c\/p\x3e\n\x3cp\x3e游戏截图：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVM61h?w=696\x26amp;h=1226\x22 src=\x22https:\/\/static.alili.tech\/img\/bVM61h?w=696\x26amp;h=1226\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e未完待续\x3c\/h4\x3e\n\x3ch5\x3e回顾：\x3c\/h5\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000009212221\x22\x3eChapter 1 - 认识Phaser.js\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000009226335\x22 target=\x22_blank\x22\x3eChapter 2 - 搭建游戏的骨架\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000009252244\x22\x3eChapter 3 - 加载游戏资源\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch5\x3e下一节：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000009309167\x22 target=\x22_blank\x22\x3eChapter 5 - 游戏大功告成\x3c\/a\x3e\n\x3c\/h5\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>从零到一：用Phaser.js写意地开发小游戏（Chapter 4 - 游戏即将开始）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009282734">https://segmentfault.com/a/1190000009282734</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/5r7uyl81wkj/" target="_blank">https://alili.tech/archive/5r7uyl81wkj/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/sj57jxyoook/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（上）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/qsw902j95k/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（下）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/nnpmjlot58j/">IndexedDB使用与出坑指南<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/alvlbas9oai/">JS事件模型<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/u0pzym8k36o/">JS练习实例--编写经典小游戏俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/khwpyk5yz8q/">JavaScript 事件代理和委托<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/kuocl6lc3n/">JavaScript 版俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/n8bk54lyrf/">Promise学习:基础入门<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/7bk7u30qncb/">Redux 入坑进阶 - 源码解析<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/853kqfmqmf7/">Snap.svg 基本知识入门<aside class="dates">2019-02-03</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>