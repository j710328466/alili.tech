<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="React事件机制"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>React事件机制 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/3ckpffaw715/",
				"appid": "1613049289050283", 
				"title": "React事件机制 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-18T02:30:34"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/n2ofcej3nj/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/0yy98aknirqi/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f&text=React%e4%ba%8b%e4%bb%b6%e6%9c%ba%e5%88%b6"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f&text=React%e4%ba%8b%e4%bb%b6%e6%9c%ba%e5%88%b6"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f&title=React%e4%ba%8b%e4%bb%b6%e6%9c%ba%e5%88%b6"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f&is_video=false&description=React%e4%ba%8b%e4%bb%b6%e6%9c%ba%e5%88%b6"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=React%e4%ba%8b%e4%bb%b6%e6%9c%ba%e5%88%b6&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f&title=React%e4%ba%8b%e4%bb%b6%e6%9c%ba%e5%88%b6"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f&title=React%e4%ba%8b%e4%bb%b6%e6%9c%ba%e5%88%b6"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f&title=React%e4%ba%8b%e4%bb%b6%e6%9c%ba%e5%88%b6"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f3ckpffaw715%2f&title=React%e4%ba%8b%e4%bb%b6%e6%9c%ba%e5%88%b6"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">React事件机制</h1><div class="meta"><div class="postdate"><time datetime="2019-01-18" itemprop="datePublished">2019-01-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e　　最近在阅读\x3ca href=\x22https:\/\/book.douban.com\/subject\/26918038\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e《深入React技术栈》\x3c\/a\x3e一书中，发现了之前使用React中并没有注意到的React事件与浏览器原生事件之间的区别，鉴于好久已经没有写东西了，就想写一下关于React事件的文章。\x3cbr\x3e　　首先我们举个例子，如果我们需要实现一个组件，这个组件点击按钮会显示一个二维码，点击二维码之外的区域可以隐藏二维码，但是点击二维码本身却不会关闭，代码如下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/代码来源于《深入React技术栈》2.1.4节\nclass QrCode extends Component {\n  constructor(props) {\n    super(props);\n    this.handleClick = this.handleClick.bind(this);\n    this.handleClickQr = this.handleClickQr.bind(this);\n    this.state = {\n      active: false,\n    };\n  }\n  \n  componentDidMount() {\n    document.body.addEventListener(\x27click\x27, e =\x3e {\n      this.setState({\n        active: false,\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    document.body.removeEventListener(\x27click\x27);\n  }\n  \n  handleClick() {\n    this.setState({\n      active: !this.state.active,\n    });\n  }\n  \n  handleClickQr(e) {\n    e.stopPropagation();\n  }\n\n  render() {\n    return (\n      \x3cdiv className=\x26quot;qr-wrapper\x26quot;\x3e\n        \x3cbutton className=\x26quot;qr\x26quot; onClick={this.handleClick}\x3e二维码\x3c\/button\x3e\n        \x3cdiv\n          className=\x26quot;code\x26quot;\n          style=\x22{{\x22 display: this.state.active ? \x27block\x27 : \x27none\x27 \x22}}\x22\n          onClick={this.handleClickQr}\n        \x3e\n          \x3cimg src=\x26quot;qr.jpg\x26quot; alt=\x26quot;qr\x26quot; \/\x3e\n        \x3c\/div\x3e\n      \x3c\/div\x3e\n    );\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/代码来源于《深入React技术栈》2.1.4节\x3c\/span\x3e\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eQrCode\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(props) {\n    \x3cspan class=\x22hljs-keyword\x22\x3esuper\x3c\/span\x3e(props);\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleClick = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleClick.bind(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleClickQr = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.handleClickQr.bind(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state = {\n      \x3cspan class=\x22hljs-attr\x22\x3eactive\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    };\n  }\n  \n  componentDidMount() {\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, e =\x26gt; {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n        \x3cspan class=\x22hljs-attr\x22\x3eactive\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.removeEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e);\n  }\n  \n  handleClick() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n      \x3cspan class=\x22hljs-attr\x22\x3eactive\x3c\/span\x3e: !\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state.active,\n    });\n  }\n  \n  handleClickQr(e) {\n    e.stopPropagation();\n  }\n\n  render() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n      \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22qr-wrapper\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22qr\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.handleClick}\x3c\/span\x3e\x26gt;\x3c\/span\x3e二维码\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\n          \x3cspan class=\x22hljs-attr\x22\x3eclassName\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22code\x22\x3c\/span\x3e\n          \x3cspan class=\x22hljs-attr\x22\x3estyle\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22{{\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3edisplay:\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ethis.state.active\x3c\/span\x3e ? \x27\x3cspan class=\x22hljs-attr\x22\x3eblock\x3c\/span\x3e\x27 \x3cspan class=\x22hljs-attr\x22\x3e:\x3c\/span\x3e \x27\x3cspan class=\x22hljs-attr\x22\x3enone\x3c\/span\x3e\x27 \x22}}\x22\n          \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.handleClickQr}\x3c\/span\x3e\n        \x26gt;\x3c\/span\x3e\n          \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22qr.jpg\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ealt\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22qr\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    );\n  }\n}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e　　上面代码从感官上感觉确实可以实现要求的组件，但事实上我们运行上述代码可以发现，点击二维码本身也会导致二维码的隐藏，现在就有意思了，我们来仔细分析一下。\x3cbr\x3e　　其实React事件并没有原生的绑定在真实的DOM上，而是使用了\x3cstrong\x3e行为委托\x3c\/strong\x3e方式实现事件机制。\x3cbr\x3e　　\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008782648?w=407\x26amp;h=356\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008782648?w=407\x26amp;h=356\x22 alt=\x22DOM事件机制\x22 title=\x22DOM事件机制\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e　　如上图所示，在JavaScript中，事件的触发实质上是要经过三个阶段:事件捕获、目标对象本身的事件处理和事件冒泡，假设在\x3ccode\x3ediv\x3c\/code\x3e中触发了\x3ccode\x3eclick\x3c\/code\x3e事件，实际上首先经历\x3cstrong\x3e捕获阶段\x3c\/strong\x3e会由父级元素将事件一直传递到事件发生的元素，执行完目标事件本身的处理事件后，然后经历\x3cstrong\x3e冒泡阶段\x3c\/strong\x3e，将事件从子元素向父元素冒泡。正因为事件在DOM的传递经历这样一个过程，从而为行为委托提供了可能。通俗地讲，行为委托的实质就是将子元素事件的处理委托给父级元素处理。React会将所有的事件都绑定在最外层(\x3ccode\x3edocument\x3c\/code\x3e)，使用统一的事件监听，并在冒泡阶段处理事件，当挂载或者卸载组件时，只需要在通过的在统一的事件监听位置增加或者删除对象，因此可以提高效率。\x3cbr\x3e　　并且React并没有使用原生的浏览器事件，而是在基于Virtual DOM的基础上实现了合成事件(SyntheticEvent)，事件处理程序接收到的是SyntheticEvent的实例。SyntheticEvent完全符合W3C的标准，因此在事件层次上具有浏览器兼容性，与原生的浏览器事件一样拥有同样的接口，可以通过\x3ccode\x3estopPropagation()\x3c\/code\x3e和\x3ccode\x3epreventDefault()\x3c\/code\x3e相应的中断。如果需要访问当原生的事件对象，可以通过引用\x3ccode\x3enativeEvent\x3c\/code\x3e获得。\x3cbr\x3e　　\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008782649?w=885\x26amp;h=518\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008782649?w=885\x26amp;h=518\x22 alt=\x22此处输入图片的描述\x22 title=\x22此处输入图片的描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e　　上图为大致的React事件机制的流程图，React中的事件机制分为两个阶段:事件注册和事件触发:\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e事件注册　　\x3cbr\x3e　　React在组件加载(\x3ccode\x3emount\x3c\/code\x3e)和更新(\x3ccode\x3eupdate\x3c\/code\x3e)时,其中的\x3ccode\x3eReactDOMComponent\x3c\/code\x3e会对传入的\x3cstrong\x3e事件属性\x3c\/strong\x3e进行处理，对相关事件进行注册和存储。\x3ccode\x3edocument\x3c\/code\x3e中注册的事件不处理具体的事件，仅对事件进行分发。\x3ccode\x3eReactBrowserEventEmitter\x3c\/code\x3e作为事件注册入口，担负着事件注册和事件触发。注册事件的回调函数由\x3ccode\x3eEventPluginHub\x3c\/code\x3e来统一管理，根据事件的类型(\x3ccode\x3etype\x3c\/code\x3e)和组件标识(\x3ccode\x3e_rootNodeID\x3c\/code\x3e)为\x3ccode\x3ekey\x3c\/code\x3e唯一标识事件并进行存储。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e事件执行\x3cbr\x3e　　事件执行时，document上绑定事件\x3ccode\x3eReactEventListener.dispatchEvent\x3c\/code\x3e会对事件进行分发，根据之前存储的类型(\x3ccode\x3etype\x3c\/code\x3e)和组件标识(\x3ccode\x3e_rootNodeID\x3c\/code\x3e)找到触发事件的组件。\x3ccode\x3eReactEventEmitter\x3c\/code\x3e利用\x3ccode\x3eEventPluginHub\x3c\/code\x3e中注入(\x3ccode\x3einject\x3c\/code\x3e)的\x3ccode\x3eplugins\x3c\/code\x3e(例如:\x3ccode\x3eSimpleEventPlugin\x3c\/code\x3e、\x3ccode\x3eEnterLeaveEventPlugin\x3c\/code\x3e)会将原生的DOM事件转化成合成的事件，然后批量执行存储的回调函，回调函数的执行分为两步，第一步是将所有的合成事件放到事件队列里面，第二步是逐个执行。需要注意的是，浏览器原生会为每个事件的每个listener创建一个事件对象，可以从这个事件对象获取到事件的引用。这会造成高额的内存分配，React在启动时就会为每种对象分配内存池，用到某一个事件对象时就可以从这个内存池进行复用，节省内存。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e　　再回到我们刚开始的问题，现在看起来就很没有很费解了，之所以会出现上面的问题是因为我们混用了React的事件机制和DOM原生的事件机制，认为通过:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22handleClickQr(e) {\n    e.stopPropagation();\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ehandleClickQr(e) {\n    e.stopPropagation();\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e就能阻止原生的事件传播，其实在事件委托的情形下是不能实现这一点的。当然解决的办法也不复杂,不要将React事件和DOM原生事件混用。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22componentDidMount() {\n  document.body.addEventListener(\x27click\x27, e =\x3e {\n    this.setState({\n      active: false,\n    });\n  });\n　\n  document.querySelector(\x27.code\x27).addEventListener(\x27click\x27, e =\x3e {\n    e.stopPropagation();\n  })\n}\n\ncomponentWillUnmount() {\n  document.body.removeEventListener(\x27click\x27);\n  document.querySelector(\x27.qr\x27).removeEventListener(\x27click\x27);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ecomponentDidMount() {\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, e =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n      \x3cspan class=\x22hljs-attr\x22\x3eactive\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    });\n  });\n　\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.code\x27\x3c\/span\x3e).addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, e =\x26gt; {\n    e.stopPropagation();\n  })\n}\n\ncomponentWillUnmount() {\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.removeEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.qr\x27\x3c\/span\x3e).removeEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e或者通过事件原件对象中的\x3ccode\x3etarget\x3c\/code\x3e进行判断:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22componentDidMount() {\n  document.body.addEventListener(\x27click\x27, e =\x3e {\n    if (e.target \x26amp;\x26amp; e.target.matches(\x27div.code\x27)) {\n      return;\n    }\n　\n    this.setState({\n      active: false,\n    });\n  });\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ecomponentDidMount() {\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, e =\x26gt; {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.target \x26amp;\x26amp; e.target.matches(\x3cspan class=\x22hljs-string\x22\x3e\x27div.code\x27\x3c\/span\x3e)) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n    }\n　\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n      \x3cspan class=\x22hljs-attr\x22\x3eactive\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    });\n  });\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e都可以解决异常关闭的问题。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>React事件机制</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008782645">https://segmentfault.com/a/1190000008782645</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/3ckpffaw715/" target="_blank">https://alili.tech/archive/3ckpffaw715/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/dgic8s5qnlg/">CSS五种方式实现Footer置底<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/z94br1a9g2o/">React的10种有效的设计模式<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/xe4kfnhxlfo/">Seneca ：NodeJS 微服务框架入门指南<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/ffpl5ftnw2u/">Unable to preventDefault inside passive event listener<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/twqwd2wscy/">Vue源码详细解析:transclude,compile,link,依赖,批处理...一网打尽，全解析!<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/i1zivpsjdl/">chart.js 中文文档 翻译<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/ik09416kg2/">flex-box 速记表<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/ic5ys9tnr1n/">riotjs 2.2.4<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/wd1i4kdw4jq/">vuejs2.0运用原生js实现简单的拖拽元素功能<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/l7r8ye5804/">一道JS面试题所引发的&#34;血案&#34;，透过现象寻本质，再从本质看现象<aside class="dates">2019-01-25</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>