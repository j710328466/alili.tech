<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="JavaScript 语法树与代码转化实践"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>JavaScript 语法树与代码转化实践 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/9rg87hx6il/",
				"appid": "1613049289050283", 
				"title": "JavaScript 语法树与代码转化实践 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-07T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/6q1oum6e9os/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/gu5ytmacclt/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f&text=JavaScript%20%e8%af%ad%e6%b3%95%e6%a0%91%e4%b8%8e%e4%bb%a3%e7%a0%81%e8%bd%ac%e5%8c%96%e5%ae%9e%e8%b7%b5"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f&text=JavaScript%20%e8%af%ad%e6%b3%95%e6%a0%91%e4%b8%8e%e4%bb%a3%e7%a0%81%e8%bd%ac%e5%8c%96%e5%ae%9e%e8%b7%b5"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f&title=JavaScript%20%e8%af%ad%e6%b3%95%e6%a0%91%e4%b8%8e%e4%bb%a3%e7%a0%81%e8%bd%ac%e5%8c%96%e5%ae%9e%e8%b7%b5"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f&is_video=false&description=JavaScript%20%e8%af%ad%e6%b3%95%e6%a0%91%e4%b8%8e%e4%bb%a3%e7%a0%81%e8%bd%ac%e5%8c%96%e5%ae%9e%e8%b7%b5"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=JavaScript%20%e8%af%ad%e6%b3%95%e6%a0%91%e4%b8%8e%e4%bb%a3%e7%a0%81%e8%bd%ac%e5%8c%96%e5%ae%9e%e8%b7%b5&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f&title=JavaScript%20%e8%af%ad%e6%b3%95%e6%a0%91%e4%b8%8e%e4%bb%a3%e7%a0%81%e8%bd%ac%e5%8c%96%e5%ae%9e%e8%b7%b5"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f&title=JavaScript%20%e8%af%ad%e6%b3%95%e6%a0%91%e4%b8%8e%e4%bb%a3%e7%a0%81%e8%bd%ac%e5%8c%96%e5%ae%9e%e8%b7%b5"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f&title=JavaScript%20%e8%af%ad%e6%b3%95%e6%a0%91%e4%b8%8e%e4%bb%a3%e7%a0%81%e8%bd%ac%e5%8c%96%e5%ae%9e%e8%b7%b5"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f9rg87hx6il%2f&title=JavaScript%20%e8%af%ad%e6%b3%95%e6%a0%91%e4%b8%8e%e4%bb%a3%e7%a0%81%e8%bd%ac%e5%8c%96%e5%ae%9e%e8%b7%b5"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">JavaScript 语法树与代码转化实践</h1><div class="meta"><div class="postdate"><time datetime="2019-01-07" itemprop="datePublished">2019-01-07</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e\x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/28054817\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJavaScript 语法树与代码转化实践\x3c\/a\x3e 归纳于笔者的\x3ca href=\x22https:\/\/parg.co\/b1c\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e现代 JavaScript 开发：语法基础与实践技巧\x3c\/a\x3e系列文章中。本文引用的参考资料声明于\x3ca href=\x22https:\/\/parg.co\/bMI\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e JavaScript 学习与实践资料索引\x3c\/a\x3e中，特别需要声明是部分代码片引用自\x3ca href=\x22https:\/\/github.com\/thejameskyle\/babel-handbook\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e Babel Handbook \x3c\/a\x3e开源手册；也欢迎关注\x3ca href=\x22https:\/\/parg.co\/bh1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e前端每周清单系列\x3c\/a\x3e获得一手资讯。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3eJavaScript 语法树与代码转化\x3c\/h1\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000010309804\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000010309804\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e浏览器的兼容性问题一直是前端项目开发中的难点之一，往往客户端浏览器的升级无法与语法特性的迭代保持一致；因此我们需要使用大量的垫片（Polyfill），以保证现代语法编写而成的 JavaScript 顺利运行在生产环境下的浏览器中，从而在可用性与代码的可维护性之间达成较好的平衡。而以 Babel 为代表的语法转化工具能够帮我们自动将 ES6 等现代 JavaScript 代码转化为可以运行在旧版本浏览器中的 ES5 或其他同等的实现；实际上，Babel 不仅仅是语法解析器，其更是拥有丰富插件的平台，稍加扩展即可被应用在前端监控埋点、错误日志收集等场景中。笔者也利用 Babel 以及 Babylon 为 \x3ca href=\x22https:\/\/github.com\/wxyyxc1992\/swagger-decorator\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eswagger-decorator\x3c\/a\x3e 实现了 \x3ccode\x3eflowToDecorator\x3c\/code\x3e 函数，其能够从 Flow 文件中自动提取出类型信息并为类属性添加合适的注解。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3eBabel\x3c\/h2\x3e\n\x3cp\x3e自 Babel 6 之后，核心的 babel-core 仅暴露了部分核心接口，并使用 Babylon 进行语法树构建，即上图中的 Parse 与 Generate 步骤；实际的转化步骤则是由配置的插件（Plugin）完成。而所谓的 Preset 则是一系列插件的合集，譬如 babel-preset-es2015 的源代码中就定义了一系列的插件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  return {\n    plugins: [\n      [transformES2015TemplateLiterals, { loose, spec }],\n      transformES2015Literals,\n      transformES2015FunctionName,\n      [transformES2015ArrowFunctions, { spec }],\n      transformES2015BlockScopedFunctions,\n      [transformES2015Classes, optsLoose],\n      transformES2015ObjectSuper,\n      ...\n      modules === \x26quot;commonjs\x26quot; \x26amp;\x26amp; [transformES2015ModulesCommonJS, optsLoose],\n      modules === \x26quot;systemjs\x26quot; \x26amp;\x26amp; [transformES2015ModulesSystemJS, optsLoose],\n      modules === \x26quot;amd\x26quot; \x26amp;\x26amp; [transformES2015ModulesAMD, optsLoose],\n      modules === \x26quot;umd\x26quot; \x26amp;\x26amp; [transformES2015ModulesUMD, optsLoose],\n      [transformRegenerator, { async: false, asyncGenerators: false }]\n    ].filter(Boolean) \/\/ filter out falsy values\n  };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs prolog\x22\x3e\x3ccode\x3e  return {\n    plugins: [\n      [transformES2015TemplateLiterals, { loose, spec }],\n      transformES2015Literals,\n      transformES2015FunctionName,\n      [transformES2015ArrowFunctions, { spec }],\n      transformES2015BlockScopedFunctions,\n      [transformES2015Classes, optsLoose],\n      transformES2015ObjectSuper,\n      ...\n      modules === \x3cspan class=\x22hljs-string\x22\x3e\x22commonjs\x22\x3c\/span\x3e \x26amp;\x26amp; [transformES2015ModulesCommonJS, optsLoose],\n      modules === \x3cspan class=\x22hljs-string\x22\x3e\x22systemjs\x22\x3c\/span\x3e \x26amp;\x26amp; [transformES2015ModulesSystemJS, optsLoose],\n      modules === \x3cspan class=\x22hljs-string\x22\x3e\x22amd\x22\x3c\/span\x3e \x26amp;\x26amp; [transformES2015ModulesAMD, optsLoose],\n      modules === \x3cspan class=\x22hljs-string\x22\x3e\x22umd\x22\x3c\/span\x3e \x26amp;\x26amp; [transformES2015ModulesUMD, optsLoose],\n      [transformRegenerator, { async: false, asyncGenerators: false }]\n    ].filter(\x3cspan class=\x22hljs-symbol\x22\x3eBoolean\x3c\/span\x3e) \/\/ filter out falsy values\n  };\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eBabel 能够将输入的 JavaScript 代码根据不同的配置将代码进行适当地转化，其主要步骤分为解析（Parse）、转化（Transform）与生成（Generate）：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e在解析步骤中，Babel 分别使用词法分析（Lexical Analysis）与语法分析（Syntactic Analysis）来将输入的代码转化为抽象语法树；其中词法分析步骤会将代码转化为令牌流，而语法分析步骤则是将令牌流转化为语言内置的 AST 表示。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e在转化步骤中，Babel 会遍历上一步生成的令牌流，根据配置对节点进行添加、更新与移除等操作；Babel 本身并没有进行转化操作，而是依赖于外置的插件进行实际的转化。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e最后的代码生成则是将上一步中经过转化的抽象语法树重新生成为代码，并且同时创建 SourceMap；代码生成相较于前两步会简单很多，其核心思想在于深度优先遍历抽象语法树，然后生成对应的代码字符串。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e抽象语法树\x3c\/h2\x3e\n\x3cp\x3e抽象语法树（Abstract Syntax Tree, AST）的作用在于牢牢抓住程序的脉络，从而方便编译过程的后续环节（如代码生成）对程序进行解读。AST 就是开发者为语言量身定制的一套模型，基本上语言中的每种结构都与一种 AST 对象相对应。上文提及的解析步骤中的词法分析步骤会将代码转化为所谓的令牌流，譬如对于代码 \x3ccode\x3en * n\x3c\/code\x3e，其会被转化为如下数组：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22[\n  { type: { ... }, value: \x26quot;n\x26quot;, start: 0, end: 1, loc: { ... } },\n  { type: { ... }, value: \x26quot;*\x26quot;, start: 2, end: 3, loc: { ... } },\n  { type: { ... }, value: \x26quot;n\x26quot;, start: 4, end: 5, loc: { ... } },\n  ...\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3e[\n  { \x3cspan class=\x22hljs-string\x22\x3etype:\x3c\/span\x3e { ... }, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22n\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3estart:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3eend:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3eloc:\x3c\/span\x3e { ... } },\n  { \x3cspan class=\x22hljs-string\x22\x3etype:\x3c\/span\x3e { ... }, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22*\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3estart:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3eend:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3eloc:\x3c\/span\x3e { ... } },\n  { \x3cspan class=\x22hljs-string\x22\x3etype:\x3c\/span\x3e { ... }, \x3cspan class=\x22hljs-string\x22\x3evalue:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22n\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3estart:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3eend:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3eloc:\x3c\/span\x3e { ... } },\n  ...\n]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其中每个 \x3ccode\x3etype\x3c\/code\x3e 是一系列描述该令牌属性的集合：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  type: {\n    label: \x27name\x27,\n    keyword: undefined,\n    beforeExpr: false,\n    startsExpr: true,\n    rightAssociative: false,\n    isLoop: false,\n    isAssign: false,\n    prefix: false,\n    postfix: false,\n    binop: null,\n    updateContext: null\n  },\n  ...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs yaml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e  type:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    label:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    keyword:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eundefined,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    beforeExpr:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    startsExpr:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    rightAssociative:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    isLoop:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    isAssign:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    prefix:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    postfix:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    binop:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    updateContext:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e},\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3e...\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里的每一个 \x3ccode\x3etype\x3c\/code\x3e 类似于 AST 中的节点都拥有 \x3ccode\x3estart\x3c\/code\x3e、\x3ccode\x3eend\x3c\/code\x3e、\x3ccode\x3eloc\x3c\/code\x3e 等属性；在实际应用中，譬如对于 ES6 中的箭头函数，我们可以通过 \x3ccode\x3ebabylon\x3c\/code\x3e 解释器生成如下的 AST 表示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 源代码\n(foo, bar) =\x3e foo \x2b bar;\n\n\/\/ 简化的 AST 表示\n{\n    \x26quot;program\x26quot;: {\n        \x26quot;body\x26quot;: [\n            {\n                \x26quot;type\x26quot;: \x26quot;ExpressionStatement\x26quot;,\n                \x26quot;expression\x26quot;: {\n                    \x26quot;type\x26quot;: \x26quot;ArrowFunctionExpression\x26quot;,\n                    \x26quot;params\x26quot;: [\n                        {\n                            \x26quot;type\x26quot;: \x26quot;Identifier\x26quot;,\n                            \x26quot;name\x26quot;: \x26quot;foo\x26quot;\n                        },\n                        {\n                            \x26quot;type\x26quot;: \x26quot;Identifier\x26quot;,\n                            \x26quot;name\x26quot;: \x26quot;bar\x26quot;\n                        }\n                    ],\n                    \x26quot;body\x26quot;: {\n                        \x26quot;type\x26quot;: \x26quot;BinaryExpression\x26quot;,\n                        \x26quot;left\x26quot;: {\n                            \x26quot;type\x26quot;: \x26quot;Identifier\x26quot;,\n                            \x26quot;name\x26quot;: \x26quot;foo\x26quot;\n                        },\n                        \x26quot;operator\x26quot;: \x26quot;\x2b\x26quot;,\n                        \x26quot;right\x26quot;: {\n                            \x26quot;type\x26quot;: \x26quot;Identifier\x26quot;,\n                            \x26quot;name\x26quot;: \x26quot;bar\x26quot;\n                        }\n                    }\n                }\n            }\n        ]\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e\/\/ 源代码\n(foo, bar) =\x26gt; foo \x2b bar;\n\n\/\/ 简化的 AST 表示\n{\n    \x3cspan class=\x22hljs-string\x22\x3e\x22program\x22\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-string\x22\x3e\x22body\x22\x3c\/span\x3e: [\n            {\n                \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22ExpressionStatement\x22\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-string\x22\x3e\x22expression\x22\x3c\/span\x3e: {\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22ArrowFunctionExpression\x22\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22params\x22\x3c\/span\x3e: [\n                        {\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e,\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22foo\x22\x3c\/span\x3e\n                        },\n                        {\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e,\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22bar\x22\x3c\/span\x3e\n                        }\n                    ],\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22body\x22\x3c\/span\x3e: {\n                        \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22BinaryExpression\x22\x3c\/span\x3e,\n                        \x3cspan class=\x22hljs-string\x22\x3e\x22left\x22\x3c\/span\x3e: {\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e,\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22foo\x22\x3c\/span\x3e\n                        },\n                        \x3cspan class=\x22hljs-string\x22\x3e\x22operator\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x2b\x22\x3c\/span\x3e,\n                        \x3cspan class=\x22hljs-string\x22\x3e\x22right\x22\x3c\/span\x3e: {\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e,\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22bar\x22\x3c\/span\x3e\n                        }\n                    }\n                }\n            }\n        ]\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们可以使用\x3ca href=\x22http:\/\/astexplorer.net\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e AST Explorer \x3c\/a\x3e这个工具进行在线预览与编辑；在上述的 AST 表示中，顾名思义，ArrowFunctionExpression 就表示该表达式为箭头函数表达式。该函数拥有 foo 与 bar 这两个参数，参数所属的 Identifiers 类型是没有任何子节点的变量名类型；接下来我们发现加号运算符被表示为了 BinaryExpression 类型，并且其 \x3ccode\x3eoperator\x3c\/code\x3e 属性设置为 \x3ccode\x3e\x2b\x3c\/code\x3e，而左右两个参数分别挂载于 \x3ccode\x3eleft\x3c\/code\x3e 与 \x3ccode\x3eright\x3c\/code\x3e 属性下。在接下来的转化步骤中，我们即是需要对这样的抽象语法树进行转换，该步骤主要由 Babel Preset 与 Plugin 控制；Babel 内部提供了 \x3ccode\x3ebabel-traverse\x3c\/code\x3e 这个库来辅助进行 AST 遍历，该库还提供了一系列内置的替换与操作接口。而经过转化之后的 AST 表示如下，在实际开发中我们也常常首先对比转化前后代码的 AST 表示的不同，以了解应该进行怎样的转化操作：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ AST shortened for clarity\n{\n    \x26quot;program\x26quot;: {\n        \x26quot;type\x26quot;: \x26quot;Program\x26quot;,\n        \x26quot;body\x26quot;: [\n            {\n                \x26quot;type\x26quot;: \x26quot;ExpressionStatement\x26quot;,\n                \x26quot;expression\x26quot;: {\n                    \x26quot;type\x26quot;: \x26quot;Literal\x26quot;,\n                    \x26quot;value\x26quot;: \x26quot;use strict\x26quot;\n                }\n            },\n            {\n                \x26quot;type\x26quot;: \x26quot;ExpressionStatement\x26quot;,\n                \x26quot;expression\x26quot;: {\n                    \x26quot;type\x26quot;: \x26quot;FunctionExpression\x26quot;,\n                    \x26quot;async\x26quot;: false,\n                    \x26quot;params\x26quot;: [\n                        {\n                            \x26quot;type\x26quot;: \x26quot;Identifier\x26quot;,\n                            \x26quot;name\x26quot;: \x26quot;foo\x26quot;\n                        },\n                        {\n                            \x26quot;type\x26quot;: \x26quot;Identifier\x26quot;,\n                            \x26quot;name\x26quot;: \x26quot;bar\x26quot;\n                        }\n                    ],\n                    \x26quot;body\x26quot;: {\n                        \x26quot;type\x26quot;: \x26quot;BlockStatement\x26quot;,\n                        \x26quot;body\x26quot;: [\n                            {\n                                \x26quot;type\x26quot;: \x26quot;ReturnStatement\x26quot;,\n                                \x26quot;argument\x26quot;: {\n                                    \x26quot;type\x26quot;: \x26quot;BinaryExpression\x26quot;,\n                                    \x26quot;left\x26quot;: {\n                                        \x26quot;type\x26quot;: \x26quot;Identifier\x26quot;,\n                                        \x26quot;name\x26quot;: \x26quot;foo\x26quot;\n                                    },\n                                    \x26quot;operator\x26quot;: \x26quot;\x2b\x26quot;,\n                                    \x26quot;right\x26quot;: {\n                                        \x26quot;type\x26quot;: \x26quot;Identifier\x26quot;,\n                                        \x26quot;name\x26quot;: \x26quot;bar\x26quot;\n                                    }\n                                }\n                            }\n                        ]\n                    },\n                    \x26quot;parenthesizedExpression\x26quot;: true\n                }\n            }\n        ]\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e\/\/ AST shortened \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e clarity\n{\n    \x3cspan class=\x22hljs-string\x22\x3e\x22program\x22\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Program\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x22body\x22\x3c\/span\x3e: [\n            {\n                \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22ExpressionStatement\x22\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-string\x22\x3e\x22expression\x22\x3c\/span\x3e: {\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Literal\x22\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22value\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22use strict\x22\x3c\/span\x3e\n                }\n            },\n            {\n                \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22ExpressionStatement\x22\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-string\x22\x3e\x22expression\x22\x3c\/span\x3e: {\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22FunctionExpression\x22\x3c\/span\x3e,\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22async\x22\x3c\/span\x3e: false,\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22params\x22\x3c\/span\x3e: [\n                        {\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e,\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22foo\x22\x3c\/span\x3e\n                        },\n                        {\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e,\n                            \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22bar\x22\x3c\/span\x3e\n                        }\n                    ],\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22body\x22\x3c\/span\x3e: {\n                        \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22BlockStatement\x22\x3c\/span\x3e,\n                        \x3cspan class=\x22hljs-string\x22\x3e\x22body\x22\x3c\/span\x3e: [\n                            {\n                                \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22ReturnStatement\x22\x3c\/span\x3e,\n                                \x3cspan class=\x22hljs-string\x22\x3e\x22argument\x22\x3c\/span\x3e: {\n                                    \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22BinaryExpression\x22\x3c\/span\x3e,\n                                    \x3cspan class=\x22hljs-string\x22\x3e\x22left\x22\x3c\/span\x3e: {\n                                        \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e,\n                                        \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22foo\x22\x3c\/span\x3e\n                                    },\n                                    \x3cspan class=\x22hljs-string\x22\x3e\x22operator\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x2b\x22\x3c\/span\x3e,\n                                    \x3cspan class=\x22hljs-string\x22\x3e\x22right\x22\x3c\/span\x3e: {\n                                        \x3cspan class=\x22hljs-string\x22\x3e\x22type\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e,\n                                        \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22bar\x22\x3c\/span\x3e\n                                    }\n                                }\n                            }\n                        ]\n                    },\n                    \x3cspan class=\x22hljs-string\x22\x3e\x22parenthesizedExpression\x22\x3c\/span\x3e: true\n                }\n            }\n        ]\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e自定义插件\x3c\/h2\x3e\n\x3cp\x3eBabel 支持以观察者（Visitor）模式定义插件，我们可以在 visitor 中预设想要观察的 Babel 结点类型，然后进行操作；譬如我们需要将下述箭头函数源代码转化为 ES5 中的函数定义：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Source Code\nconst func = (foo, bar) =\x3e foo \x2b bar;\n\n\/\/ Transformed Code\n\x26quot;use strict\x26quot;;\nconst _func = function(_foo, _bar) {\n  return _foo \x2b _bar;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Source Code\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e func = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3efoo, bar\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e foo \x2b bar;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Transformed Code\x3c\/span\x3e\n\x3cspan class=\x22hljs-meta\x22\x3e\x22use strict\x22\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e _func = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e_foo, _bar\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e _foo \x2b _bar;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在上一节中我们对比过转化前后两个函数语法树的差异，这里我们就开始定义转化插件。首先每个插件都是以 babel 对象为输入参数，返回某个包含 visitor 的对象的函数。最后我们需要调用 babel-core 提供的 transform 函数来注册插件，并且指定需要转化的源代码或者源代码文件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ plugin.js 文件，定义插件\nimport type NodePath from \x26quot;babel-traverse\x26quot;;\n\nexport default function(babel) {\n  const { types: t } = babel;\n\n  return {\n    name: \x26quot;ast-transform\x26quot;, \/\/ not required\n    visitor: {\n      Identifier(path) {\n        path.node.name = `_${path.node.name}`;\n      },\n      ArrowFunctionExpression(path: NodePath\x3cBabelNodeArrowFunctionExpression\x3e, state: Object) {\n        \/\/ In some conversion cases, it may have already been converted to a function while this callback\n        \/\/ was queued up.\n        if (!path.isArrowFunctionExpression()) return;\n\n        path.arrowFunctionToExpression({\n          \/\/ While other utils may be fine inserting other arrows to make more transforms possible,\n          \/\/ the arrow transform itself absolutely cannot insert new arrow functions.\n          allowInsertArrow: false,\n          specCompliant: !!state.opts.spec\n        });\n      }\n    }\n  };\n}\n\n\/\/ babel.js 使用插件\nvar babel = require(\x27babel-core\x27);\nvar plugin= require(\x27.\/plugin\x27);\n\nvar out = babel.transform(src, {\n  plugins: [plugin]\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ plugin.js 文件，定义插件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e type NodePath \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22babel-traverse\x22\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ebabel\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { \x3cspan class=\x22hljs-attr\x22\x3etypes\x3c\/span\x3e: t } = babel;\n\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22ast-transform\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ not required\x3c\/span\x3e\n    visitor: {\n      Identifier(path) {\n        path.node.name = \x3cspan class=\x22hljs-string\x22\x3e`_\x3cspan class=\x22hljs-subst\x22\x3e${path.node.name}\x3c\/span\x3e`\x3c\/span\x3e;\n      },\n      ArrowFunctionExpression(path: NodePath\x26lt;BabelNodeArrowFunctionExpression\x26gt;, \x3cspan class=\x22hljs-attr\x22\x3estate\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eObject\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ In some conversion cases, it may have already been converted to a function while this callback\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ was queued up.\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!path.isArrowFunctionExpression()) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n\n        path.arrowFunctionToExpression({\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ While other utils may be fine inserting other arrows to make more transforms possible,\x3c\/span\x3e\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ the arrow transform itself absolutely cannot insert new arrow functions.\x3c\/span\x3e\n          allowInsertArrow: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n          \x3cspan class=\x22hljs-attr\x22\x3especCompliant\x3c\/span\x3e: !!state.opts.spec\n        });\n      }\n    }\n  };\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ babel.js 使用插件\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e babel = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27babel-core\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e plugin= \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27.\/plugin\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e out = babel.transform(src, {\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [plugin]\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e常用转化操作\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e遍历\x3c\/h3\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e获取子节点路径\x3cbr\x3e我们可以通过 \x3ccode\x3epath.node.{property}\x3c\/code\x3e 的方式来访问 AST 中节点属性：\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ the BinaryExpression AST node has properties: `left`, `right`, `operator`\nBinaryExpression(path) {\n  path.node.left;\n  path.node.right;\n  path.node.operator;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autohotkey\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-symbol\x22\x3e\/\/ the BinaryExpression AST node has properties:\x3c\/span\x3e `left`, `right`, `operator`\nBinaryExpression(path) {\n  path.node.left\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  path.node.right\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  path.node.operator\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们也可以使用某个路径对象的 \x3ccode\x3eget\x3c\/code\x3e 方法，通过传入子路径的字符串表示来访问某个属性：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22BinaryExpression(path) {\n  path.get(\x27left\x27);\n}\nProgram(path) {\n  path.get(\x27body.0\x27);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3eBinaryExpression\x3c\/span\x3e(path) {\n  \x3cspan class=\x22hljs-selector-tag\x22\x3epath\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.get\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27left\x27\x3c\/span\x3e);\n}\n\x3cspan class=\x22hljs-selector-tag\x22\x3eProgram\x3c\/span\x3e(path) {\n  \x3cspan class=\x22hljs-selector-tag\x22\x3epath\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.get\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27body.0\x27\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e判断某个节点是否为指定类型\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3e内置的 type 对象提供了许多可以直接用来判断节点类型的工具函数：\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22BinaryExpression(path) {\n  if (t.isIdentifier(path.node.left)) {\n    \/\/ ...\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eBinaryExpression\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(path)\x3c\/span\x3e\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (t.isIdentifier(path\x3cspan class=\x22hljs-selector-class\x22\x3e.node\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.left\x3c\/span\x3e)) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e或者同时以浅比较来查看节点属性：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22BinaryExpression(path) {\n  if (t.isIdentifier(path.node.left, { name: \x26quot;n\x26quot; })) {\n    \/\/ ...\n  }\n}\n\n\/\/ 等价于\nBinaryExpression(path) {\n  if (\n    path.node.left != null \x26amp;\x26amp;\n    path.node.left.type === \x26quot;Identifier\x26quot; \x26amp;\x26amp;\n    path.node.left.name === \x26quot;n\x26quot;\n  ) {\n    \/\/ ...\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xl\x22\x3e\x3ccode\x3eBinaryExpression(\x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (t.isIdentifier(\x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e.node.left, { \x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22n\x22\x3c\/span\x3e })) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 等价于\x3c\/span\x3e\nBinaryExpression(\x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\n    \x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e.node.left != null \x26amp;\x26amp;\n    \x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e.node.left.type === \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e \x26amp;\x26amp;\n    \x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e.node.left.\x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x22n\x22\x3c\/span\x3e\n  ) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e判断某个路径对应的节点是否为指定类型\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22BinaryExpression(path) {\n  if (path.get(\x27left\x27).isIdentifier({ name: \x26quot;n\x26quot; })) {\n    \/\/ ...\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eBinaryExpression\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(path)\x3c\/span\x3e\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (path.get(\x3cspan class=\x22hljs-string\x22\x3e\x27left\x27\x3c\/span\x3e).isIdentifier({ name: \x3cspan class=\x22hljs-string\x22\x3e\x22n\x22\x3c\/span\x3e })) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e获取指定路径的父节点\x3cbr\x3e有时候我们需要从某个指定节点开始向上遍历获取某个父节点，此时我们可以通过传入检测的回调来判断：\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22path.findParent((path) =\x3e path.isObjectExpression());\n\n\/\/ 获取最近的函数声明节点\npath.getFunctionParent();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xl\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e.findParent((\x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e) =\x26gt; \x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e.isObjectExpression());\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取最近的函数声明节点\x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e.getFunctionParent();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e获取兄弟路径\x3cbr\x3e如果某个路径存在于 Function 或者 Program 中的类似列表的结构中，那么其可能会包含兄弟路径：\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 源代码\nvar a = 1; \/\/ pathA, path.key = 0\nvar b = 2; \/\/ pathB, path.key = 1\nvar c = 3; \/\/ pathC, path.key = 2\n\n\/\/ 插件定义\nexport default function({ types: t }) {\n  return {\n    visitor: {\n      VariableDeclaration(path) {\n        \/\/ if the current path is pathA\n        path.inList \/\/ true\n        path.listKey \/\/ \x26quot;body\x26quot;\n        path.key \/\/ 0\n        path.getSibling(0) \/\/ pathA\n        path.getSibling(path.key \x2b 1) \/\/ pathB\n        path.container \/\/ [pathA, pathB, pathC]\n      }\n    }\n  };\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 源代码\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ pathA, path.key = 0\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e b = \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ pathB, path.key = 1\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e c = \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ pathC, path.key = 2\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插件定义\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e{ types: t }\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3evisitor\x3c\/span\x3e: {\n      VariableDeclaration(path) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ if the current path is pathA\x3c\/span\x3e\n        path.inList \x3cspan class=\x22hljs-comment\x22\x3e\/\/ true\x3c\/span\x3e\n        path.listKey \x3cspan class=\x22hljs-comment\x22\x3e\/\/ \x22body\x22\x3c\/span\x3e\n        path.key \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 0\x3c\/span\x3e\n        path.getSibling(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ pathA\x3c\/span\x3e\n        path.getSibling(path.key \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ pathB\x3c\/span\x3e\n        path.container \x3cspan class=\x22hljs-comment\x22\x3e\/\/ [pathA, pathB, pathC]\x3c\/span\x3e\n      }\n    }\n  };\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e停止遍历\x3cbr\x3e部分情况下插件需要停止遍历，我们此时只需要在插件中添加 return 表达式：\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22BinaryExpression(path) {\n  if (path.node.operator !== \x27**\x27) return;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3eBinaryExpression(path) {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (path.node.\x3cspan class=\x22hljs-keyword\x22\x3eoperator\x3c\/span\x3e !== \x3cspan class=\x22hljs-string\x22\x3e\x27**\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们也可以指定忽略遍历某个子路径：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22outerPath.traverse({\n  Function(innerPath) {\n    innerPath.skip(); \/\/ if checking the children is irrelevant\n  },\n  ReferencedIdentifier(innerPath, state) {\n    state.iife = true;\n    innerPath.stop(); \/\/ if you want to save some state and then stop traversal, or deopt\n  }\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs pf\x22\x3e\x3ccode\x3eouterPath.traverse({\n  Function(innerPath) {\n    innerPath.\x3cspan class=\x22hljs-keyword\x22\x3eskip\x3c\/span\x3e(); \/\/ if checking the children is irrelevant\n  },\n  ReferencedIdentifier(innerPath, \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e.iife = true;\n    innerPath.stop(); \/\/ if you want \x3cspan class=\x22hljs-keyword\x22\x3eto\x3c\/span\x3e save some \x3cspan class=\x22hljs-keyword\x22\x3estate\x3c\/span\x3e and then stop traversal, or deopt\n  }\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e操作\x3c\/h3\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e替换节点\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 插件定义\nBinaryExpression(path) {\n  path.replaceWith(\n    t.binaryExpression(\x26quot;**\x26quot;, path.node.left, t.numberLiteral(2))\n  );\n}\n\n\/\/ 代码结果\n  function square(n) {\n-   return n * n;\n\x2b   return n ** 2;\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插件定义\x3c\/span\x3e\nBinaryExpression(path) {\n  path.replaceWith(\n    t.binaryExpression(\x3cspan class=\x22hljs-string\x22\x3e\x22**\x22\x3c\/span\x3e, path.node.left, t.numberLiteral(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e))\n  );\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 代码结果\x3c\/span\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esquare\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(n)\x3c\/span\x3e \x3c\/span\x3e{\n-   \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e n * n;\n\x2b   \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e n ** \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e将某个节点替换为多个节点\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 插件定义\nReturnStatement(path) {\n  path.replaceWithMultiple([\n    t.expressionStatement(t.stringLiteral(\x26quot;Is this the real life?\x26quot;)),\n    t.expressionStatement(t.stringLiteral(\x26quot;Is this just fantasy?\x26quot;)),\n    t.expressionStatement(t.stringLiteral(\x26quot;(Enjoy singing the rest of the song in your head)\x26quot;)),\n  ]);\n}\n\n\/\/ 代码结果\n  function square(n) {\n-   return n * n;\n\x2b   \x26quot;Is this the real life?\x26quot;;\n\x2b   \x26quot;Is this just fantasy?\x26quot;;\n\x2b   \x26quot;(Enjoy singing the rest of the song in your head)\x26quot;;\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs smalltalk\x22\x3e\x3ccode\x3e\/\/ 插件定义\n\x3cspan class=\x22hljs-type\x22\x3eReturnStatement\x3c\/span\x3e(path) {\n  path.replaceWithMultiple([\n    t.expressionStatement(t.stringLiteral(\x3cspan class=\x22hljs-comment\x22\x3e\x22Is this the real life?\x22\x3c\/span\x3e)),\n    t.expressionStatement(t.stringLiteral(\x3cspan class=\x22hljs-comment\x22\x3e\x22Is this just fantasy?\x22\x3c\/span\x3e)),\n    t.expressionStatement(t.stringLiteral(\x3cspan class=\x22hljs-comment\x22\x3e\x22(Enjoy singing the rest of the song in your head)\x22\x3c\/span\x3e)),\n  ]);\n}\n\n\/\/ 代码结果\n  function square(n) {\n-   return n * n;\n\x2b   \x3cspan class=\x22hljs-comment\x22\x3e\x22Is this the real life?\x22\x3c\/span\x3e;\n\x2b   \x3cspan class=\x22hljs-comment\x22\x3e\x22Is this just fantasy?\x22\x3c\/span\x3e;\n\x2b   \x3cspan class=\x22hljs-comment\x22\x3e\x22(Enjoy singing the rest of the song in your head)\x22\x3c\/span\x3e;\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e将某个节点替换为源代码字符串\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 插件定义\nFunctionDeclaration(path) {\n  path.replaceWithSourceString(`function add(a, b) {\n    return a \x2b b;\n  }`);\n}\n\n\/\/ 代码结果\n- function square(n) {\n-   return n * n;\n\x2b function add(a, b) {\n\x2b   return a \x2b b;\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode\x3e\/\/ 插件定义\nFunctionDeclaration(path) {\n  path.replaceWithSourceString(`\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(a, b) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3ea\x3c\/span\x3e \x2b b;\n  }`);\n}\n\n\/\/ 代码结果\n- \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esquare\x3c\/span\x3e(n) {\n-   \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3en\x3c\/span\x3e * n;\n\x2b \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(a, b) {\n\x2b   \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3ea\x3c\/span\x3e \x2b b;\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e插入兄弟节点\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 插件定义\nFunctionDeclaration(path) {\n  path.insertBefore(t.expressionStatement(t.stringLiteral(\x26quot;Because I\x27m easy come, easy go.\x26quot;)));\n  path.insertAfter(t.expressionStatement(t.stringLiteral(\x26quot;A little high, little low.\x26quot;)));\n}\n\n\/\/ 代码结果\n\x2b \x26quot;Because I\x27m easy come, easy go.\x26quot;;\n  function square(n) {\n    return n * n;\n  }\n\x2b \x26quot;A little high, little low.\x26quot;;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插件定义\x3c\/span\x3e\nFunctionDeclaration(path) {\n  path.insertBefore(t.expressionStatement(t.stringLiteral(\x3cspan class=\x22hljs-string\x22\x3e\x22Because I\x27m easy come, easy go.\x22\x3c\/span\x3e)));\n  path.insertAfter(t.expressionStatement(t.stringLiteral(\x3cspan class=\x22hljs-string\x22\x3e\x22A little high, little low.\x22\x3c\/span\x3e)));\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 代码结果\x3c\/span\x3e\n\x2b \x3cspan class=\x22hljs-string\x22\x3e\x22Because I\x27m easy come, easy go.\x22\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esquare\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(n)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e n * n;\n  }\n\x2b \x3cspan class=\x22hljs-string\x22\x3e\x22A little high, little low.\x22\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e移除某个节点\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 插件定义\nFunctionDeclaration(path) {\n  path.remove();\n}\n\n\/\/ 代码结果\n- function square(n) {\n-   return n * n;\n- }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插件定义\x3c\/span\x3e\nFunctionDeclaration(path) {\n  path.remove();\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 代码结果\x3c\/span\x3e\n- \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esquare\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(n)\x3c\/span\x3e \x3c\/span\x3e{\n-   \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e n * n;\n- }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e替换节点\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 插件定义\nBinaryExpression(path) {\n  path.parentPath.replaceWith(\n    t.expressionStatement(t.stringLiteral(\x26quot;Anyway the wind blows, doesn\x27t really matter to me, to me.\x26quot;))\n  );\n}\n\n\/\/ 代码结果\n  function square(n) {\n-   return n * n;\n\x2b   \x26quot;Anyway the wind blows, doesn\x27t really matter to me, to me.\x26quot;;\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插件定义\x3c\/span\x3e\nBinaryExpression(path) {\n  path.parentPath.replaceWith(\n    t.expressionStatement(t.stringLiteral(\x3cspan class=\x22hljs-string\x22\x3e\x22Anyway the wind blows, doesn\x27t really matter to me, to me.\x22\x3c\/span\x3e))\n  );\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 代码结果\x3c\/span\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esquare\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(n)\x3c\/span\x3e \x3c\/span\x3e{\n-   \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e n * n;\n\x2b   \x3cspan class=\x22hljs-string\x22\x3e\x22Anyway the wind blows, doesn\x27t really matter to me, to me.\x22\x3c\/span\x3e;\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e移除某个父节点\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 插件定义\nBinaryExpression(path) {\n  path.parentPath.remove();\n}\n\n\/\/ 代码结果\n  function square(n) {\n-   return n * n;\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插件定义\x3c\/span\x3e\nBinaryExpression(path) {\n  path.parentPath.remove();\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 代码结果\x3c\/span\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esquare\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(n)\x3c\/span\x3e \x3c\/span\x3e{\n-   \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e n * n;\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e作用域\x3c\/h3\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e判断某个局部变量是否被绑定：\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22FunctionDeclaration(path) {\n  if (path.scope.hasBinding(\x26quot;n\x26quot;)) {\n    \/\/ ...\n  }\n}\n\nFunctionDeclaration(path) {\n  if (path.scope.hasOwnBinding(\x26quot;n\x26quot;)) {\n    \/\/ ...\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eFunctionDeclaration\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(path)\x3c\/span\x3e\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (path\x3cspan class=\x22hljs-selector-class\x22\x3e.scope\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.hasBinding\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22n\x22\x3c\/span\x3e)) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eFunctionDeclaration\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(path)\x3c\/span\x3e\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (path\x3cspan class=\x22hljs-selector-class\x22\x3e.scope\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.hasOwnBinding\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22n\x22\x3c\/span\x3e)) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ ...\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e创建 UID\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22FunctionDeclaration(path) {\n  path.scope.generateUidIdentifier(\x26quot;uid\x26quot;);\n  \/\/ Node { type: \x26quot;Identifier\x26quot;, name: \x26quot;_uid\x26quot; }\n  path.scope.generateUidIdentifier(\x26quot;uid\x26quot;);\n  \/\/ Node { type: \x26quot;Identifier\x26quot;, name: \x26quot;_uid2\x26quot; }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs crmsh\x22\x3e\x3ccode\x3eFunctionDeclaration(path) {\n  path.scope.generateUidIdentifier(\x3cspan class=\x22hljs-string\x22\x3e\x22uid\x22\x3c\/span\x3e);\n  \/\/ \x3cspan class=\x22hljs-keyword\x22\x3eNode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e{ type\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e, name: \x3cspan class=\x22hljs-string\x22\x3e\x22_uid\x22\x3c\/span\x3e }\n  path.scope.generateUidIdentifier(\x3cspan class=\x22hljs-string\x22\x3e\x22uid\x22\x3c\/span\x3e);\n  \/\/ \x3cspan class=\x22hljs-keyword\x22\x3eNode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e{ type\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Identifier\x22\x3c\/span\x3e, name: \x3cspan class=\x22hljs-string\x22\x3e\x22_uid2\x22\x3c\/span\x3e }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e将某个变量声明提取到副作用中\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 插件定义\nFunctionDeclaration(path) {\n  const id = path.scope.generateUidIdentifierBasedOnNode(path.node.id);\n  path.remove();\n  path.scope.parent.push({ id, init: path.node });\n}\n\n\/\/ 代码结果\n- function square(n) {\n\x2b var _square = function square(n) {\n    return n * n;\n- }\n\x2b };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 插件定义\x3c\/span\x3e\nFunctionDeclaration(path) {\n  \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e id = path.scope.generateUidIdentifierBasedOnNode(path.node.id);\n  path.remove();\n  path.scope.\x3cspan class=\x22hljs-keyword\x22\x3eparent\x3c\/span\x3e.push({ id, init: path.node });\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 代码结果\x3c\/span\x3e\n- \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esquare\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(n)\x3c\/span\x3e \x3c\/span\x3e{\n\x2b \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e _square = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esquare\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(n)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e n * n;\n- }\n\x2b };\x3c\/code\x3e\x3c\/pre\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>JavaScript 语法树与代码转化实践</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010309799">https://segmentfault.com/a/1190000010309799</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/9rg87hx6il/" target="_blank">https://alili.tech/archive/9rg87hx6il/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/z09muaar7j/">2年前端应该会哪些技能<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/ke982v6qrfg/">CSS 性能优化笔记<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/if1i2hs28ah/">H5打造3d场景不完全攻略（二）: Amazing CSS3D<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/s4apghsr7o/">JS原生一步步实现前端路由和单页面应用<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/hjgkntbgqek/">JavaScript 中对大量数据的多重过滤<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/h1hfvr2a2nj/">JavaScript 中的错误处理机制<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/a0ukpm125gm/">JavaScript 数组分组的实现<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/fwosouhbhmj/">JavaScript 类型转换深度学习<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/z193p9xv2p/">JavaScript设计模式之发布-订阅模式（观察者模式）-Part1<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/6i7sr0vgkxm/">Javascript中的时间<aside class="dates">2019-02-01</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>