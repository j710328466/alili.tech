<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="javascript中实现跨域的方式总结"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>javascript中实现跨域的方式总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/zqs5uwna9u/",
				"appid": "1613049289050283", 
				"title": "javascript中实现跨域的方式总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-25T02:30:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/75qxzac296q/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/02a6l6a62klg/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f&text=javascript%e4%b8%ad%e5%ae%9e%e7%8e%b0%e8%b7%a8%e5%9f%9f%e7%9a%84%e6%96%b9%e5%bc%8f%e6%80%bb%e7%bb%93"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f&text=javascript%e4%b8%ad%e5%ae%9e%e7%8e%b0%e8%b7%a8%e5%9f%9f%e7%9a%84%e6%96%b9%e5%bc%8f%e6%80%bb%e7%bb%93"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f&title=javascript%e4%b8%ad%e5%ae%9e%e7%8e%b0%e8%b7%a8%e5%9f%9f%e7%9a%84%e6%96%b9%e5%bc%8f%e6%80%bb%e7%bb%93"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f&is_video=false&description=javascript%e4%b8%ad%e5%ae%9e%e7%8e%b0%e8%b7%a8%e5%9f%9f%e7%9a%84%e6%96%b9%e5%bc%8f%e6%80%bb%e7%bb%93"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=javascript%e4%b8%ad%e5%ae%9e%e7%8e%b0%e8%b7%a8%e5%9f%9f%e7%9a%84%e6%96%b9%e5%bc%8f%e6%80%bb%e7%bb%93&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f&title=javascript%e4%b8%ad%e5%ae%9e%e7%8e%b0%e8%b7%a8%e5%9f%9f%e7%9a%84%e6%96%b9%e5%bc%8f%e6%80%bb%e7%bb%93"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f&title=javascript%e4%b8%ad%e5%ae%9e%e7%8e%b0%e8%b7%a8%e5%9f%9f%e7%9a%84%e6%96%b9%e5%bc%8f%e6%80%bb%e7%bb%93"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f&title=javascript%e4%b8%ad%e5%ae%9e%e7%8e%b0%e8%b7%a8%e5%9f%9f%e7%9a%84%e6%96%b9%e5%bc%8f%e6%80%bb%e7%bb%93"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fzqs5uwna9u%2f&title=javascript%e4%b8%ad%e5%ae%9e%e7%8e%b0%e8%b7%a8%e5%9f%9f%e7%9a%84%e6%96%b9%e5%bc%8f%e6%80%bb%e7%bb%93"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">javascript中实现跨域的方式总结</h1><div class="meta"><div class="postdate"><time datetime="2019-01-25" itemprop="datePublished">2019-01-25</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3ejs中的跨域请求应该也算是一个重点，具体什么叫跨域，在这里我就不展开了，可以查一下浏览器的同源策略和跨域的定义。原来只知道常用的jsonp和document.domain这两种方式，这几天学习了一下其他几种跨域请求的方式，正好一起做个总结。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e第一种方式：jsonp请求\x3c\/h2\x3e\n\x3cp\x3ejsonp请求应该是大家最为熟悉的一种（至少是我知道的第一种跨域请求方式）。jsonp的原理是利用\x26lt;script\x26gt;标签的跨域特性，可以不受限制地从其他域中加载资源，类似的标签还有\x26lt;img\x26gt;.利用\x26lt;script\x26gt;标签的这个特性可以从服务器中返回需要的跨域数据。下面用代码的小例子加以分析：\x3cbr\x3e例子中html文件和后台php（这里我以php后台为例，后台我自己会的是php）文件位于不同域中！\x3c\/p\x3e\n\x3cp\x3e先看html文件：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVJQFX?w=825\x26amp;h=180\x22 src=\x22https:\/\/static.alili.tech\/img\/bVJQFX?w=825\x26amp;h=180\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e文件底部的\x26lt;script\x26gt;标签的src链接到后台service.php文件，并传入参数callback,这里的关键是把回调函数作为参数传给后台。\x3c\/p\x3e\n\x3cp\x3e再看后台php文件：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVJQHL?w=586\x26amp;h=158\x22 src=\x22https:\/\/static.alili.tech\/img\/bVJQHL?w=586\x26amp;h=158\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22文件接收回调函数并把要返回的参数以参数注入的方式注入到回调函数中，再返回给客户端。\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs\x22\x3e\x3ccode\x3e文件接收回调函数并把要返回的参数以参数注入的方式注入到回调函数中，再返回给客户端。\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样的话浏览器解析script标签，并执行返回的js文档，此时服务器返回的数据作为参数，传到页面中定义好的 jsonpBack 函数里.（动态执行回调函数）,就拿到了我们需要的跨域数据。\x3c\/p\x3e\n\x3cp\x3e这里补充一点就是jquery对jsonp有着很好的支持，jquery中$.getJSON方法将jsonp的调用方式进行了封装，用起来十分方便，使用的方式如下即可：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\n$.getJSON(\x26quot;后台文件地址?参数=**\x26quot;,function(jsondata){\n\/\/在这里就可以操作从后台拿到的jsondata数据\n})\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n$.getJSON(\x3cspan class=\x22hljs-string\x22\x3e\x22后台文件地址?参数=**\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ejsondata\x3c\/span\x3e)\x3c\/span\x3e{\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/在这里就可以操作从后台拿到的jsondata数据\x3c\/span\x3e\n})\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e第二种方式：document.domain\x3c\/h2\x3e\n\x3cp\x3e这种方式用在主域名相同子域名不同的跨域访问中，举个例子：\x3ca href=\x22http:\/\/a.frame.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/a.frame.com\x3c\/a\x3e和\x3ca href=\x22http:\/\/b.frame.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/b.frame.com\x3c\/a\x3e 他们的主域名都是frame.com 这两个域名中的文件可以用这种方式进行访问，通过在两个域中具体的文件中设置document.domain=\x22frame.com\x22就可达到跨域访问的目的。\x3c\/p\x3e\n\x3cp\x3e实际应用中常常用在iframe中窗口之间的访问，根据浏览器的同源策略，浏览器中不同域的框架之间是不能进行js的交互操作的，所以一个窗口是不能拿到另一个窗口中的contentWindow对象的属性和方法的（注意是能拿到contentWindow对象的，只是属性和方法都不可用）。为了能拿到数据，只要在两个iframe中分别写入document.domain=\x22主域名\x22，这样设置之后，就能拿到contentWindow对象的属性和方法了。代码就这么简单的一行，我就不写小例子了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e第三种方式：window.name\x3c\/h2\x3e\n\x3cp\x3ewindow的name属性有个特征：在一个窗口(window)的生命周期内,窗口载入的所有的页面都是共享一个window.name的，每个页面对window.name都有读写的权限，window.name是持久存在一个窗口载入过的所有页面中的，并不会因新页面的载入而进行重置。\x3c\/p\x3e\n\x3cp\x3e这是什么意思呢？通俗来讲，就是比如我在a.html这个页面中设置了window.name=\x22a\x22;然后让window重新加载b.html页面，然后在b.html页面中输出window.name会发现window.name=“a”。所以就算a.html和b.html这两个页面不是在同一个域中的，也可以在b页面中拿到a页面设置的window.name的值，跨域的核心思路就是这个原理。\x3c\/p\x3e\n\x3cp\x3e实际应用中也是常常用在两个iframe之间(需要结合iframe的特性来用)，先上一张从别人那边借鉴过来的原理图，我再按照自己的理解进行分析：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVJQSq?w=936\x26amp;h=249\x22 src=\x22https:\/\/static.alili.tech\/img\/bVJQSq?w=936\x26amp;h=249\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e图中有三个页面，getDomainData.html是获取数据的页面，null.html是一个和getDomainData.html同域的空页面，它的作用是作为一个中转站，进行数据的过渡。data.html是要获取数据的所在页面，这里有着我们要的数据，它和getDomainData.html处于不同域中，所以取数据是跨域访问。具体的过程是这样的：在getDomainData.html中建立一个子页面iframe，把这个iframe的src指向b.com\/data.html，这样当这个iframe加载完成后就可以访问到data.html中的window.name的数据，之后再将iframe的src改为a.com\/null.html，跳回getDomainData.html的同一个域，这样根据同源策略，getDomainData.html就可以访问到null.html中取得的data.html的数据了。获取数据以后最好销毁这个iframe，释放掉内存，也保证了安全。下面附上代码小例子：\x3c\/p\x3e\n\x3cp\x3e\x3cem\x3egetDomainData.html：\x3c\/em\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n     var flag=0;\n     var data;\n     var iframe=document.createElement(\x26quot;iframe\x26quot;);\/\/创建一个中转站iframe\n     document.appendChild(iframe);\n     getData=function(){\/\/iframe加载完成后调用的处理函数\n         if(flag==1){\n             data=iframe.contentWindow.name;\/\/读取b.html中的window.name\n         }else{\n             flag=1;\n             iframe.src=\x26quot;http:\/\/a.com\/null.html\x26quot;;\/\/跳回getDomainData.html的同一个域\n         }\n    };\n     iframe.src=\x26quot;http:\/\/b.com\/data.html\x26quot;;\/\/设置src到要获得数据的域中的对应页面\n\n    if (iframe.attachEvent) {\/\/兼容IE，监听iframe加载完成\n        iframe.attachEvent(\x27onload\x27, getData);\n    } else {\n        iframe.addEventListener(\x27load\x27,getData);\n    }\n\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n     \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e flag=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n     \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data;\n     \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e iframe=\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x22iframe\x22\x3c\/span\x3e);\x3cspan class=\x22hljs-comment\x22\x3e\/\/创建一个中转站iframe\x3c\/span\x3e\n     \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.appendChild(iframe);\n     getData=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\x3cspan class=\x22hljs-comment\x22\x3e\/\/iframe加载完成后调用的处理函数\x3c\/span\x3e\n         \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(flag==\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e){\n             data=iframe.contentWindow.name;\x3cspan class=\x22hljs-comment\x22\x3e\/\/读取b.html中的window.name\x3c\/span\x3e\n         }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n             flag=\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n             iframe.src=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/a.com\/null.html\x22\x3c\/span\x3e;\x3cspan class=\x22hljs-comment\x22\x3e\/\/跳回getDomainData.html的同一个域\x3c\/span\x3e\n         }\n    };\n     iframe.src=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/b.com\/data.html\x22\x3c\/span\x3e;\x3cspan class=\x22hljs-comment\x22\x3e\/\/设置src到要获得数据的域中的对应页面\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (iframe.attachEvent) {\x3cspan class=\x22hljs-comment\x22\x3e\/\/兼容IE，监听iframe加载完成\x3c\/span\x3e\n        iframe.attachEvent(\x3cspan class=\x22hljs-string\x22\x3e\x27onload\x27\x3c\/span\x3e, getData);\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        iframe.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27load\x27\x3c\/span\x3e,getData);\n    }\n\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cem\x3edata.html:\x3c\/em\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\nwindow.name=\x26quot;被获取数据\x26quot;\/\/简单的一行代码\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.name=\x3cspan class=\x22hljs-string\x22\x3e\x22被获取数据\x22\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/简单的一行代码\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cem\x3e最后的iframe销毁：\x3c\/em\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\n    iframe.contentWindow.document.write(\x26quot;\x26quot;);\/\/情况iframe中的内容\n    iframe.contentWindow.close();\/\/避免iframe的内存泄漏\n    document.body.removeChild(iframe);\/\/移除iframe节点\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    iframe.contentWindow.document.write(\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e);\x3cspan class=\x22hljs-comment\x22\x3e\/\/情况iframe中的内容\x3c\/span\x3e\n    iframe.contentWindow.close();\x3cspan class=\x22hljs-comment\x22\x3e\/\/避免iframe的内存泄漏\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.removeChild(iframe);\x3cspan class=\x22hljs-comment\x22\x3e\/\/移除iframe节点\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e第四种方式：window.postMessage\x3c\/h2\x3e\n\x3cp\x3ewindow.postMessages是html5中实现跨域访问的一种新方式，可以使用它来向其它的window对象发送消息，无论这个window对象是属于同源或不同源。\x3cbr\x3e该方式的使用还是十分简单的，给要发送数据的页面中的window对象调用一个postMessage(message,targetOrigin)方法即可，该方法的第一个参数message为要发送的消息，类型只能为字符串；第二个参数targetOrigin用来限定接收消息的那个window对象所在的域，如果不想限定域，直接使用通配符 * 。再让接收数据页面的window对象监听自身的message事件来获取传过来的消息，消息内容储存在该事件对象的data属性中。简单的小例子如下：\x3c\/p\x3e\n\x3cp\x3e\x3cem\x3etest.html(发送页面)：\x3c\/em\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\n\x3ciframe name=\x26quot;receive\x26quot; id=\x26quot;iframe\x26quot; src=\x26quot;test2.html\x26quot; scrolling=\x26quot;no\x26quot;\x3e\n\n\x3c\/iframe\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n\nwindow.onload=function(){\n    var iframWindow = document.getElementById(\x26quot;iframe\x26quot;).contentWindow;\n    iframWindow.postMessage(\x26quot;A secret\x26quot;, \x26quot;*\x26quot;);\/\/发送消息\n    \n}\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22handlebars\x22\x3e\x3cspan class=\x22xml\x22\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22receive\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22iframe\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22test2.html\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3escrolling\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22no\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onload=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e iframWindow = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22iframe\x22\x3c\/span\x3e).contentWindow;\n    iframWindow.postMessage(\x3cspan class=\x22hljs-string\x22\x3e\x22A secret\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22*\x22\x3c\/span\x3e);\x3cspan class=\x22hljs-comment\x22\x3e\/\/发送消息\x3c\/span\x3e\n    \n}\n\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cem\x3etest2.html（接收页面）\x3c\/em\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\n    window.addEventListener(\x26quot;message\x26quot;,function(e){\n        alert(e.data);\/\/接收到的消息\n    })\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22message\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{\n        alert(e.data);\x3cspan class=\x22hljs-comment\x22\x3e\/\/接收到的消息\x3c\/span\x3e\n    })\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cem\x3e测试结果如下\x3c\/em\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVJUwP?w=1072\x26amp;h=522\x22 src=\x22https:\/\/static.alili.tech\/img\/bVJUwP?w=1072\x26amp;h=522\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e关于这个用法困扰了我好久，\x3cem\x3e困扰1\x3c\/em\x3e：因为最后弹出的消息是在test.html，而不是在test2.html中，我不确定是因为test.html包含了test2.html，所以浏览器渲染才弹出的alert,还是test2.html接收到消息的反馈。后来查阅了权威的文档，才有了进一步的理解，应该是test2.html收到消息，以iframe在test.html中渲染加载出的。\x3cbr\x3e\x3cem\x3e困扰2：\x3c\/em\x3epostMessage的调用对象是目标窗口还是发送窗口，是否能以window形式调用？\x3cbr\x3e查阅文档后得出结论：*postMessage的调用对象，是\x3cstrong\x3e其他窗口的一个引用，即目标窗口，不是要发送的窗口，（这里比较出乎意料）\x3c\/strong\x3e  而且postMessage想要通信必须使得一个窗口以iframe的形式存在于另一个窗口，或者一个窗口是从另一个窗口通过window.open()或者超链接的形式打开的（同样可以用window.opener获取源窗口）；换句话说，你要交换数据，必须能获取目标窗口(target window)的引用，不然两个窗口之间毫无联系，想通信也无能为力，所以不能直接以主页面window的形式调用。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e具体的权威解释请看这个链接：\x3c\/strong\x3e  \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Window\/postMessage\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewindow.postMessage\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e第五种方式：CORS\x3c\/h2\x3e\n\x3cp\x3eCORS(Corss-Origin-Resource Sharing,跨源资源共享)，是一种网络浏览器的技术规范，它为Web服务器定义了一种方式，允许网页从不同的域访问其资源，而这种访问是被同源策略所禁止的。CORS系统定义了一种浏览器和服务器交互的方式来确定是否允许跨域请求。 它是一个妥协，有更大的灵活性，但比起简单地允许所有这些的要求来说更加安全。\x3cbr\x3eCORS背后的基本思想，就是使用自定义的HTTP头部让\x3cstrong\x3e浏览器与服务器\x3c\/strong\x3e进行沟通，从而决定请求或响应是应该成功还是应该失败。\x3c\/p\x3e\n\x3cp\x3eCORS的使用还是十分简便的，比如一个简单的GET或者POST请求，在发送的时候给它附加一个额外的origin头部，其中包含请求页面的源信息（协议、域名和端口），以便服务器根据这个头部信息来决定是否给以响应。下面是javascript高级程序设计书上的一个小例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Origin:http:\/\/www.nczonline.net\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.nczonline.net\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果服务器认为这个请求可以接受，就在Access-Control-Allow-Origin头部中回发相同的源消息（如果是公共资源，可以回发“ * ”）。例如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Origin：http:\/\/www.nczonline.net\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eAccess-Control-Allow-Origin：\x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/www.nczonline.net\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样设置之后，服务器与浏览器就可以进行跨域信息的交换了。具体的在不同浏览器上的支持和使用，我就不展开了，js高级程序设计书上提到了很多，网上查一下也有很多。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e第六种方式：Web Sockets\x3c\/h2\x3e\n\x3cp\x3eWeb Sockets是一种新浏览器API，能在一个单独的持久连接上提供全双工、双向通信，使用ws（代替\x3ca\x3ehttp:\/\/\x3c\/a\x3e）或wss(代替\x3ca href=\x22https:\/\/)\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/)\x3c\/a\x3e协议，可用于任意的客户端和服务器程序。\x3cbr\x3eweb sockets原理：在JS创建了web socket之后，会有一个HTTP请求发送到浏览器以发起连接。取得服务器响应后，建立的连接会使用HTTP升级从HTTP协议交换为web sockt协议。\x3cbr\x3e使用的小例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 创建一个Socket实例\nvar socket = new WebSocket(\x27ws:\/\/www.example.com\/server.php\x27); \n\n\/\/ 打开Socket \nsocket.onopen = function(event) { \n\n  \/\/ 发送消息\n  socket.send(\x27a secret\x27); \n\n  \/\/ 监听消息的接收\n  socket.onmessage = function(event) { \n    var data=event.data;\n    \/\/处理data...\n  }; \n\n  \/\/ 监听socket的关闭\n  socket.onclose = function(event) { \n    console.log(\x27socket has closed\x27,event); \n  }; \n\n  \/\/ 关闭Socket\n  \/\/socket.close() \n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建一个Socket实例\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e socket = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e WebSocket(\x3cspan class=\x22hljs-string\x22\x3e\x27ws:\/\/www.example.com\/server.php\x27\x3c\/span\x3e); \n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 打开Socket \x3c\/span\x3e\nsocket.onopen = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{ \n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 发送消息\x3c\/span\x3e\n  socket.send(\x3cspan class=\x22hljs-string\x22\x3e\x27a secret\x27\x3c\/span\x3e); \n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听消息的接收\x3c\/span\x3e\n  socket.onmessage = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{ \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data=event.data;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/处理data...\x3c\/span\x3e\n  }; \n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听socket的关闭\x3c\/span\x3e\n  socket.onclose = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{ \n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27socket has closed\x27\x3c\/span\x3e,event); \n  }; \n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 关闭Socket\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/socket.close() \x3c\/span\x3e\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同样附上权威文档供参考：\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/Web_Workers_API\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWeb Workers API\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e除此之外还有一些跨域访问的方式：比如Comet、图像Ping、SSE等，感兴趣的可以直接查找这些内容。在这些跨域访问方式上，各有各的适用访问和相应的限制，需要结合实际来适用。我在这里有个疑问：\x3cem\x3e我自己运用的比较多的就是jsonp这种方式，\x3cstrong\x3e那么在实际开发中，比较推崇的跨域访问方式是哪种呢？还有就是html5的postMessage是不是可以取代window.name（同样都需要一个iframe作为中间媒介）这类访问方式，这个新API方式是不是在实际中很有效呢？希望有经验的大牛可以解答，不胜感激。\x3c\/strong\x3e\x3c\/em\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>javascript中实现跨域的方式总结</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008525104">https://segmentfault.com/a/1190000008525104</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/zqs5uwna9u/" target="_blank">https://alili.tech/archive/zqs5uwna9u/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/dc9tmbt89lc/">CSS3 巧妙实现聊天气泡<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/awfhylei7vr/">Element 一套优雅的 Vue 2 组件库是如何开发的<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/5n6e7oj31zb/">Ionic2入坑基础教程和安装指南<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/k9uktrr2ck/">JavaScript arguments 对象全面介绍<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/d31ygsiurr7/">JavaScript 版俄罗斯方块——重构<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/f1goxj498pc/">JavaScript中this绑定详解<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/fpk9tyls8sb/">Markcook2.0，使用Vue2.0和Vuex2.0进行完全重构升级<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/rnj4z8l02t/">N3-components - 强劲的 Vue UI组件库<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/7njdijhy2um/">Node.js &#43; React Native 毕设：农业物联网监测系统的开发手记<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/f8zzbybr4tl/">Redux、Flux、Vuex<aside class="dates">2019-02-02</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>