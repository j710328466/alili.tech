<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="前端图像处理指南"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>前端图像处理指南 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/84vzycbnu2a/",
				"appid": "1613049289050283", 
				"title": "前端图像处理指南 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-28T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/3fd7p7o5ji3/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/2z3221tkybf/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f&text=%e5%89%8d%e7%ab%af%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%8c%87%e5%8d%97"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f&text=%e5%89%8d%e7%ab%af%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%8c%87%e5%8d%97"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f&title=%e5%89%8d%e7%ab%af%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%8c%87%e5%8d%97"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f&is_video=false&description=%e5%89%8d%e7%ab%af%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%8c%87%e5%8d%97"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%89%8d%e7%ab%af%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%8c%87%e5%8d%97&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f&title=%e5%89%8d%e7%ab%af%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%8c%87%e5%8d%97"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f&title=%e5%89%8d%e7%ab%af%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%8c%87%e5%8d%97"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f&title=%e5%89%8d%e7%ab%af%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%8c%87%e5%8d%97"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f84vzycbnu2a%2f&title=%e5%89%8d%e7%ab%af%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86%e6%8c%87%e5%8d%97"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">前端图像处理指南</h1><div class="meta"><div class="postdate"><time datetime="2019-01-28" itemprop="datePublished">2019-01-28</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e计算机图像处理是一门很成熟的技术，任何一门可操作系统接口的语言都能很轻易的实现各种处理操作。但是前端限于浏览器环境和接口限制，处理起来会有诸多不便，这里所说的前端图像处理，是真的指\x3cstrong\x3e不借助任何后端服务\x3c\/strong\x3e纯前端实现的图像处理。本文会介绍canvas位图处理，SVG矢量图和CSS3图像处理，重点是canvas，并且最后会附上一个\x3ca href=\x22http:\/\/quanfeng.tech\/trimpng\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTrimPNG小应用\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3ecanvas位图处理\x3c\/h1\x3e\n\x3cp\x3eHTML5 canvas为我们提供了一块画布，让前端也有了操作位图的功能：图片旋转、缩放、滤镜、压缩等都可以通过JS来实现。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e图像基本处理\x3c\/h3\x3e\n\x3cp\x3e通过设置drawImage参数可以实现图片绘制、缩放、拉伸和裁剪等操作(\x3ccode\x3e注意canvas无法绘制体积过大图片，否则会卡甚至崩掉，大图可以分块读取绘制\x3c\/code\x3e)：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008044207?w=1000\x26amp;h=423\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008044207?w=1000\x26amp;h=423\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e详细用法参考 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/CanvasRenderingContext2D\/drawImage\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3edrawImage()\x3c\/a\x3e，DEMO源码戳这里 \x3ca href=\x22http:\/\/jsbin.com\/nuqojowayi\/edit?html,output\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJS Bin\x3c\/a\x3e.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e只需要drawImage一个方法，就可以实现基本图形处理功能，再结合鼠标或滚轮事件，就可以实现更复杂的局部放大预览，缩放等功能了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e图像滤镜处理\x3c\/h3\x3e\n\x3cp\x3e现在的朋友圈发个图都要用滤镜美一下，复古清纯胶片LOMO各种风格应有尽有。canvas提供了getImageData方法来获取图像上每一个像素点的RGBA信息，这样我们就能对图片进行像素级处理了。通过特定算法来重写imageData中的像素信息，然后用setImageData方法把新的数据重新绘制在canvas上，这样就可以实现图像滤镜打码加特效等一系列功能。\x3c\/p\x3e\n\x3cp\x3e比如我们现在要实现一个复古滤镜:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 复古滤镜处理算法：获取每个像素的RGB信息，并按特定权重返回其加权平均值\nlet sepiaFilter = function(imgData) {\n  let d = imgData.data\n  for (let i = 0; i \x3c d.length; i \x2b= 4) {\n    let r = d[i]\n    let g = d[i \x2b 1]\n    let b = d[i \x2b 2]\n    d[i] = (r * 0.393) \x2b (g * 0.769) \x2b (b * 0.189) \/\/ red\n    d[i \x2b 1] = (r * 0.349) \x2b (g * 0.686) \x2b (b * 0.168) \/\/ green\n    d[i \x2b 2] = (r * 0.272) \x2b (g * 0.534) \x2b (b * 0.131) \/\/ blue\n  }\n  return imgData\n}\n\/\/图像地址必须和当前页面同域，否则会报cross-origin错误 \nimg.src = \x27\/img\/logo@2x.png\x27 \nimg.onload = () =\x3e {\n  ctx.drawImage(img, 0, 0) \/\/ 绘制原图\n  let imgData = ctx.getImageData(0, 0, img.width, img.height) \/\/ 获取图片信息\n  ctx.putImageData(sepiaFilter(imgData), 100, 0) \/\/ 绘制处理后图片\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 复古滤镜处理算法：获取每个像素的RGB信息，并按特定权重返回其加权平均值\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e sepiaFilter = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eimgData\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e d = imgData.data\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i \x26lt; d.length; i \x2b= \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e r = d[i]\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e g = d[i \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e b = d[i \x2b \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e]\n    d[i] = (r * \x3cspan class=\x22hljs-number\x22\x3e0.393\x3c\/span\x3e) \x2b (g * \x3cspan class=\x22hljs-number\x22\x3e0.769\x3c\/span\x3e) \x2b (b * \x3cspan class=\x22hljs-number\x22\x3e0.189\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ red\x3c\/span\x3e\n    d[i \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e] = (r * \x3cspan class=\x22hljs-number\x22\x3e0.349\x3c\/span\x3e) \x2b (g * \x3cspan class=\x22hljs-number\x22\x3e0.686\x3c\/span\x3e) \x2b (b * \x3cspan class=\x22hljs-number\x22\x3e0.168\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ green\x3c\/span\x3e\n    d[i \x2b \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e] = (r * \x3cspan class=\x22hljs-number\x22\x3e0.272\x3c\/span\x3e) \x2b (g * \x3cspan class=\x22hljs-number\x22\x3e0.534\x3c\/span\x3e) \x2b (b * \x3cspan class=\x22hljs-number\x22\x3e0.131\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ blue\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e imgData\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/图像地址必须和当前页面同域，否则会报cross-origin错误 \x3c\/span\x3e\nimg.src = \x3cspan class=\x22hljs-string\x22\x3e\x27\/img\/logo@2x.png\x27\x3c\/span\x3e \nimg.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  ctx.drawImage(img, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制原图\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e imgData = ctx.getImageData(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, img.width, img.height) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取图片信息\x3c\/span\x3e\n  ctx.putImageData(sepiaFilter(imgData), \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 绘制处理后图片\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22http:\/\/segmentfault.com\/img\/bVHTYo\x22 src=\x22https:\/\/static.alili.techhttp:\/\/segmentfault.com\/img\/bVHTYo\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e详细用法参考 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/CanvasRenderingContext2D\/getImageData\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egetImageData()\x3c\/a\x3e 和  \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/CanvasRenderingContext2D\/putImageData\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eputImageData()\x3c\/a\x3e，DEMO源码戳这里 \x3ca href=\x22https:\/\/jsfiddle.net\/vghszt61\/2\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJSFiddle\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22vghszt61\/2\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e滤镜处理关键在于滤镜算法，要想写出更高级的特效需要有计算机图形学基础，对卷积矩阵、拉普拉斯变换、傅里叶变换等数学知识也要了解，这个坑很大我就不挖了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e图像base64存储\x3c\/h3\x3e\n\x3cp\x3e加完特效后如果我们想把图像保存下来，就可以用toDataURL方法来对图片进行格式转换、压缩存储了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 支持三种文件类型：image\/png(默认) | image\/jpeg | image\/webp(仅Chrome)\ncanvas.toDataURL() \/\/ 默认存储为png\n\/\/ 仅jpeg\/webp支持质量参数(0~1,默认0.92)\ncanvas.toDataURL(\x26quot;image\/jpeg\x26quot;, 0.1) \/\/ 存储为质量为0.1的jpeg\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 支持三种文件类型：image\/png(默认) | image\/jpeg | image\/webp(仅Chrome)\x3c\/span\x3e\ncanvas.toDataURL() \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 默认存储为png\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 仅jpeg\/webp支持质量参数(0~1,默认0.92)\x3c\/span\x3e\ncanvas.toDataURL(\x3cspan class=\x22hljs-string\x22\x3e\x22image\/jpeg\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0.1\x3c\/span\x3e) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 存储为质量为0.1的jpeg\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e由于存储形式是base64编码，原来图片的每三个字节都会被扩展成4字节，所以整体上编码后数据会比原来多约1\/3。以下是通过toDataURL存储后的图片和原图大小相关对比数据(\x3ccode\x3e数据仅供参考，不具通用性\x3c\/code\x3e)：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008044208?w=1606\x26amp;h=1002\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008044208?w=1606\x26amp;h=1002\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e可见存储后图片体积并不是原来的4\/3，实际上处理后的图片都会比原图大好几倍，并且不同的图片增大的体积也是不确定的。如果是要上传图片到服务器，可以把base64转化成Blob二进制数据压缩上传；如果要直接在前端显示或供用户下载，jpg还好可以设置质量参数，要是png就没法压缩了。\x3c\/p\x3e\n\x3cp\x3e只是用toDataURL还不够，用户需要通过\x3ccode\x3e手动点击图片-右键图片存储为\x3c\/code\x3e来保存图片，如果要实现点击下载按钮自动下载图片还需要修改图片类型为octet-stream，然后利用HTML5的download属性强制让浏览器下载。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e详细用法参考\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/API\/HTMLCanvasElement\/toDataURL\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etoDataURL()\x3c\/a\x3e. 自动下载图片DEMO源码快戳我 \x3ca href=\x22https:\/\/jsfiddle.net\/0326\/vghszt61\/4\/#\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJSFiddle\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x220326\/vghszt61\/4\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e程序员的备胎\x3c\/h3\x3e\n\x3cp\x3e有了以上基础，再结合成熟的图形处理算法，我们可以完成日常工作中大部分图像处理需求，以下列出了一些相关轮子可做备胎。备胎这种东西多多益善，万一以后用到了呢？\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e注意：本人很专一。\x3c\/code\x3e\x3c\/p\x3e\n\x3ch4\x3e\x3ca href=\x22http:\/\/html2canvas.hertzen.com\/documentation.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehtml2canvas\x3c\/a\x3e\x3c\/h4\x3e\n\x3cp\x3e将web页面通过canvas来实现截屏，其原理就是遍历DOM结构和样式，然后在canvas中绘制出来，通过toDataURL输出图片。但由于canvas图片的同源策略限制，如果图片和网站不同源的话会截取不出来的。另外在微信中测试时，即使用同源的图片截取出来的图片也有问题，所以要想将其用于生产环境，还是得看场景，有很多坑要踩。\x3c\/p\x3e\n\x3ch4\x3e\x3ca href=\x22https:\/\/github.com\/akira-cn\/code-to-image\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ecode-to-image\x3c\/a\x3e\x3c\/h4\x3e\n\x3cp\x3e代码转图片工具。有时候你在不同的平台写文章贴代码，由于不同平台代码格式化规范不一，所以经常会出现代码排版问题，通过这个工具将代码转成图片就可以避免排版问题了。\x3c\/p\x3e\n\x3ch4\x3e\x3ca href=\x22https:\/\/fengyuanchen.github.io\/cropper\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCropper\x3c\/a\x3e\x3c\/h4\x3e\n\x3cp\x3e一个专门用来做图片裁剪的应用。\x3c\/p\x3e\n\x3ch4\x3e\x3ca href=\x22https:\/\/github.com\/eduardolundgren\/tracking.js\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etracking.js\x3c\/a\x3e\x3c\/h4\x3e\n\x3cp\x3e这是一个专业的计算机视觉处理JS库，包含了大量图形处理算法，可用来做人脸识别，色彩追踪等酷炫功能。\x3c\/p\x3e\n\x3ch4\x3e\x3ca href=\x22https:\/\/github.com\/nicolaszhao\/qrcode2\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eqrcode2\x3c\/a\x3e\x3c\/h4\x3e\n\x3cp\x3e用JS动态生成二维码，这个库还是很实用的，原理就是qrcode算法\x2bcanvas绘图，不支持canvas的用table兼容。\x3c\/p\x3e\n\x3ch4\x3e\x3ca href=\x22https:\/\/github.com\/AlloyTeam\/AlloyImage\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAlloyImage\x3c\/a\x3e\x3c\/h4\x3e\n\x3cp\x3e腾讯出的基于HTML5的专业级图像处理开源引擎，功能很强大，简直就是Web版的PS。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008044209?w=1381\x26amp;h=597\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008044209?w=1381\x26amp;h=597\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e以上列举部分，更多备胎在此： \x3ca href=\x22https:\/\/github.com\/0326\/canvas\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/0326\/canvas\x3c\/a\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3eSVG矢量图处理\x3c\/h1\x3e\n\x3cp\x3e讲完位图再说矢量图。矢量图在绘制图标、商业LOGO、动画元素上应用非常广范。Web最开始支持的矢量图形并不是现在的SVG，而是微软主推的VML，所以在低版本IE下面只支持VML而不支持SVG，直到后来SVG成为W3C标准并被普及，微软才在IE9中支持SVG。\x3c\/p\x3e\n\x3cp\x3eSVG遵循XML规范，可以很好的集成在HTML里面，同时支持JS脚本控制，还有基于SMIL标准的动态内容支持，做起动画来也是非常方便。目前基于SVG的JS图形库轮子也是非常多，如\x3ca href=\x22https:\/\/github.com\/svgdotjs\/svg.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3esvg.js\x3c\/a\x3e, \x3ca href=\x22http:\/\/snapsvg.io\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSnap.svg\x3c\/a\x3e, \x3ca href=\x22http:\/\/velocityjs.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eVelocity.js\x3c\/a\x3e, \x3ca href=\x22https:\/\/d3js.org\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eD3.js\x3c\/a\x3e等等，目前暂无SVG应用需求，等用的时候再翻牌子吧。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader6\x22\x3eCSS图像处理\x3c\/h1\x3e\n\x3cp\x3e如果你的图像特效只是用来给用户展示，并不需要存储的话，可以直接用CSS处理，基本的调整图片大小、拉伸、旋转、裁切等操作直接几个CSS属性width\/height\/skew\/rotate\/clip-path等就能搞定了。如果想加特效，使用CSS滤镜Duang的一下就出来了，不需要任何图形学基础和数学知识：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008044210?w=989\x26amp;h=957\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008044210?w=989\x26amp;h=957\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e详细说明见 \x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/CSS\/filter\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCSS filter - MDN\x3c\/a\x3e, \x3ca href=\x22http:\/\/jsbin.com\/cejifa\/edit?html,output\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDEMO 源码见JS Bin\x3c\/a\x3e.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader7\x22\x3e总结\x3c\/h1\x3e\n\x3cp\x3e最后介绍个小工具\x3ca href=\x22http:\/\/quanfeng.tech\/trimpng\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTrimPNG\x3c\/a\x3e。大家都知道\x3ca href=\x22https:\/\/tinypng.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTinyPNG\x3c\/a\x3e可以压缩PNG, \x3ca href=\x22http:\/\/quanfeng.tech\/trimpng\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eTrimPNG\x3c\/a\x3e顾名思义就是去除图片空白和白边的，实现了自动抠图和切图的功能（logo我是直接抄的TinyPNG，都是熊猫，应该不要紧?）\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22http:\/\/segmentfault.com\/img\/bVHV0v\x22 src=\x22https:\/\/static.alili.techhttp:\/\/segmentfault.com\/img\/bVHV0v\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e用到的技术点上面都说到了，裁切实现原理就是横向纵向分别扫描两次像素点阵，找出上下左右最外面的非透明点，然后定位出有效图像区域。\x3cdel\x3e去除白边算法目前还比较傻逼，只要是接近白色的点都被我干掉了，后面再完善好了\x3c\/del\x3e 去白边算法优化了一下，采用标记清除策略（听着耳熟吧，其实就是从GC受的启发...），先扫描一遍标记出可疑白点，然后再扫描一遍，凡是与透明区域相邻的可疑白点就清除，当然这个算法也比较死，如果有更专业更智能的请务必告诉我。\x3c\/p\x3e\n\x3cp\x3e体验地址：\x3ca href=\x22http:\/\/quanfeng.tech\/trimpng\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/quanfeng.tech\/trimpng\/\x3c\/a\x3e\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e本文只抛砖，作为工作时技能储备，如有任何补充欢迎留言交流~，另外，你们这帮人呐，都收藏了就顺便点个推荐尼！⊙ o ⊙\x3c\/p\x3e\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>前端图像处理指南</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008044204">https://segmentfault.com/a/1190000008044204</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/84vzycbnu2a/" target="_blank">https://alili.tech/archive/84vzycbnu2a/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5fmk2pl6rab/">2016年前端开发者深度调研，看看别人使用什么技术体系<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/stp6408xnu/">Bootstrap使用模态框modal实现表单提交弹出框<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/fu7a86e9uyh/">CSS水平垂直居中总结<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/r0w29esklr/">JS 里怎么给数组填充默认值<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/i00hiszlr1/">JavaScript - EventEmitter 背后的秘密<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/u2la0cn9do/">JavaScript 精度丢失问题<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/3txhfn3ejcb/">Nodejs进阶：如何玩转子进程（child_process）<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/yr7v8e9fao/">Promise介绍--规范篇<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/9lyxyz4wc6g/">QQ音乐API整理<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/84zzlljmes4/">SegmentFault 技术周刊 Vol.14 - 进阶 Vue 2.0<aside class="dates">2019-01-30</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>