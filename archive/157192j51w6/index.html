<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="常见的canvas优化——模糊问题、旋转效果"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>常见的canvas优化——模糊问题、旋转效果 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/157192j51w6/",
				"appid": "1613049289050283", 
				"title": "常见的canvas优化——模糊问题、旋转效果 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-14T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ub6f38ju7si/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/5n58srmvqeq/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f&text=%e5%b8%b8%e8%a7%81%e7%9a%84canvas%e4%bc%98%e5%8c%96%e2%80%94%e2%80%94%e6%a8%a1%e7%b3%8a%e9%97%ae%e9%a2%98%e3%80%81%e6%97%8b%e8%bd%ac%e6%95%88%e6%9e%9c"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f&text=%e5%b8%b8%e8%a7%81%e7%9a%84canvas%e4%bc%98%e5%8c%96%e2%80%94%e2%80%94%e6%a8%a1%e7%b3%8a%e9%97%ae%e9%a2%98%e3%80%81%e6%97%8b%e8%bd%ac%e6%95%88%e6%9e%9c"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f&title=%e5%b8%b8%e8%a7%81%e7%9a%84canvas%e4%bc%98%e5%8c%96%e2%80%94%e2%80%94%e6%a8%a1%e7%b3%8a%e9%97%ae%e9%a2%98%e3%80%81%e6%97%8b%e8%bd%ac%e6%95%88%e6%9e%9c"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f&is_video=false&description=%e5%b8%b8%e8%a7%81%e7%9a%84canvas%e4%bc%98%e5%8c%96%e2%80%94%e2%80%94%e6%a8%a1%e7%b3%8a%e9%97%ae%e9%a2%98%e3%80%81%e6%97%8b%e8%bd%ac%e6%95%88%e6%9e%9c"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%b8%b8%e8%a7%81%e7%9a%84canvas%e4%bc%98%e5%8c%96%e2%80%94%e2%80%94%e6%a8%a1%e7%b3%8a%e9%97%ae%e9%a2%98%e3%80%81%e6%97%8b%e8%bd%ac%e6%95%88%e6%9e%9c&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f&title=%e5%b8%b8%e8%a7%81%e7%9a%84canvas%e4%bc%98%e5%8c%96%e2%80%94%e2%80%94%e6%a8%a1%e7%b3%8a%e9%97%ae%e9%a2%98%e3%80%81%e6%97%8b%e8%bd%ac%e6%95%88%e6%9e%9c"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f&title=%e5%b8%b8%e8%a7%81%e7%9a%84canvas%e4%bc%98%e5%8c%96%e2%80%94%e2%80%94%e6%a8%a1%e7%b3%8a%e9%97%ae%e9%a2%98%e3%80%81%e6%97%8b%e8%bd%ac%e6%95%88%e6%9e%9c"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f&title=%e5%b8%b8%e8%a7%81%e7%9a%84canvas%e4%bc%98%e5%8c%96%e2%80%94%e2%80%94%e6%a8%a1%e7%b3%8a%e9%97%ae%e9%a2%98%e3%80%81%e6%97%8b%e8%bd%ac%e6%95%88%e6%9e%9c"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f157192j51w6%2f&title=%e5%b8%b8%e8%a7%81%e7%9a%84canvas%e4%bc%98%e5%8c%96%e2%80%94%e2%80%94%e6%a8%a1%e7%b3%8a%e9%97%ae%e9%a2%98%e3%80%81%e6%97%8b%e8%bd%ac%e6%95%88%e6%9e%9c"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">常见的canvas优化——模糊问题、旋转效果</h1><div class="meta"><div class="postdate"><time datetime="2019-01-14" itemprop="datePublished">2019-01-14</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3ecanvas常见优化方案——模糊问题、旋转效果、离屏、自定义图片尺寸\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000009406855\x22\x3e实践demo——“canvas离屏、旋转效果实践——旋转的雪花”\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e2017-12-18 16:27:35更新关于模糊问题\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22前几天研究html2Canvas的时候刚好赶上作者发布新版本，发现新版本截屏出来的效果比我对旧版本处理后(画布尺寸都设为2倍)的效果更好。\n扒源码的时候发现他们并没有直接设为两倍尺寸，而是先获取当前dom结构的scale，用当前dom的scale去设置canvas的画布尺寸比。\n我自己手机上测试时打印出来的dom的scale显示为3倍尺寸，所以我设置canvas两倍画布尺寸的时候，其实还是会模糊的，不过对比1倍尺寸的是要清晰很多了。\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mel\x22\x3e\x3ccode\x3e前几天研究html2Canvas的时候刚好赶上作者发布新版本，发现新版本截屏出来的效果比我对旧版本处理后(画布尺寸都设为\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e倍)的效果更好。\n扒源码的时候发现他们并没有直接设为两倍尺寸，而是先获取当前dom结构的\x3cspan class=\x22hljs-keyword\x22\x3escale\x3c\/span\x3e，用当前dom的\x3cspan class=\x22hljs-keyword\x22\x3escale\x3c\/span\x3e去设置\x3cspan class=\x22hljs-keyword\x22\x3ecanvas\x3c\/span\x3e的画布尺寸比。\n我自己手机上测试时打印出来的dom的\x3cspan class=\x22hljs-keyword\x22\x3escale\x3c\/span\x3e显示为\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e倍尺寸，所以我设置\x3cspan class=\x22hljs-keyword\x22\x3ecanvas\x3c\/span\x3e两倍画布尺寸的时候，其实还是会模糊的，不过对比\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e倍尺寸的是要清晰很多了。\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3ecanvas显示模糊问题——画布尺寸设为显示尺寸的两倍即可\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e问题原因\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e查阅canvas的API就可以知道，想要获得精确地线条，必须对线条是如何描绘出来的有所理解。\x3c\/p\x3e\n\x3cp\x3e首先要清楚一点：canvas画线时的定位定的是线条中线的位置，根据线条的宽度再向两边延伸，如果延伸出去的线条没有占满1px，不足的部分将会以实际笔触颜色的一半色调来填充。所以最后我们实际看到的效果就是：1px的线条变宽了，且变模糊了，效果如左图所示：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNAhe?w=311\x26amp;h=161\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNAhe?w=311\x26amp;h=161\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e解决办法\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e根据问题原因我们知道：只要从线条中线开始向外延伸部分占满1px，就不会出现线条变宽且模糊的问题了。\x3c\/p\x3e\n\x3cp\x3e最简单的办法是画线时根据需求将线条定位移动0.5px，不过这是治标不治本的方法，只能用来验证这个方法是不是正确的。\x3c\/p\x3e\n\x3cp\x3e我们还可以将画布尺寸设为显示尺寸的2倍，这相当于用画图时的两个像素点去填充实际显示的一个像素点，这样就能很好的解决canvas显示模糊的问题了。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22canvas.setAttribute(\x27width\x27, x * 2);\ncanvas.setAttribute(\x27height\x27, y * 2);\ncanvas.style.width = x \x2b \x27px\x27;\ncanvas.style.height = y \x2b \x27px\x27;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mel\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3ecanvas\x3c\/span\x3e.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x27width\x27\x3c\/span\x3e, x * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3ecanvas\x3c\/span\x3e.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x27height\x27\x3c\/span\x3e, y * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3ecanvas\x3c\/span\x3e.style.width = x \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27px\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3ecanvas\x3c\/span\x3e.style.height = y \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27px\x27\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e用这种方法要记得：各种布局尺寸也要做相应变化。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e离屏canvas\x3c\/h3\x3e\n\x3cp\x3e定义离屏canvas，在离屏canvas上设定画布尺寸并绘制canvas图片：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var offScreenCanvas = document.createElement(\x27offScreenCanvas\x27);\nvar offScreenCtx = offScreenCanvas.getContext(\x272d\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs nginx\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attribute\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3eoff\x3c\/span\x3eScreenCanvas = document.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27offScreenCanvas\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-attribute\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3eoff\x3c\/span\x3eScreenCtx = \x3cspan class=\x22hljs-literal\x22\x3eoff\x3c\/span\x3eScreenCanvas.getContext(\x3cspan class=\x22hljs-string\x22\x3e\x272d\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后将画好的离屏canvas绘制到实际显示的canvas上：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ctx.drawImage(offScreenCanvas, 0, 0, offScreenCanvas.width, offScreenCanvas.height,\n    0, 0, canvas.width, canvas.height);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3ectx.drawImage(offScreenCanvas, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, offScreenCanvas\x3cspan class=\x22hljs-selector-class\x22\x3e.width\x3c\/span\x3e, offScreenCanvas\x3cspan class=\x22hljs-selector-class\x22\x3e.height\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3ecanvas\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.width\x3c\/span\x3e, \x3cspan class=\x22hljs-selector-tag\x22\x3ecanvas\x3c\/span\x3e.\x3cspan class=\x22hljs-attribute\x22\x3eheight\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e好处\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e一是可以不受限于html标签及实际显示尺寸，画出一个标准尺寸的大图，然后自适应到实际显示的canvas上；\x3cbr\x3e二是离屏canvas的缓存效果可以大大提升canvas的性能(当然像上述那样粗糙的代码，是体现不出这一效果的)。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e不足\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e离屏canvas一定要画好之后才能绘制到实际显示的canvas上，这就导致哪些有延时的元素不方便这样用(如图片、自定义字体等)。针对这一问题，目前我还没有找到好的解决办法。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e图片尺寸问题\x3c\/h3\x3e\n\x3cp\x3e刚开始画图的时候很纠结的一个问题就是：canvas画png图片时，不同屏幕尺寸要配多大的图、配几套。后来在解决上述“离屏canvas”的问题后，这个问题也就迎刃而解了：drawImage函数可以设定将图片绘制成多大的，而不限定于图片本身的尺寸。\x3c\/p\x3e\n\x3cp\x3e这个问题解决之后，就只需要一套图片就好了，还可以使图片大小自适应屏幕、随显示界面缩放。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3ecanvas旋转效果——改变了画布坐标系\x3c\/h3\x3e\n\x3cp\x3ecanvas中有两个很好用的东西：旋转和保存状态。\x3c\/p\x3e\n\x3cp\x3e以画圆的不同角度的半径为例，正常情况下我们要根据圆半径、线的角度和圆心的位置计算得出线的端点坐标P1{x1,y1}、P2{x2,y2}，然后画一条P1到P2的线，代码中的计算量不小。不过canvas中我们有更好的解决办法：\x3c\/p\x3e\n\x3cp\x3e1.定位笔触到圆心位置{x,y}\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ctx.translate(x,y)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3ectx\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.translate\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-tag\x22\x3ex\x3c\/span\x3e,\x3cspan class=\x22hljs-selector-tag\x22\x3ey\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2.根据线的角度旋转画布angle圈(angle=1时表示顺时针旋转一圈)\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ctx.rotate(Math.PI*2 * angle);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3ectx\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.rotate\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-tag\x22\x3eMath\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.PI\x3c\/span\x3e*2 * \x3cspan class=\x22hljs-selector-tag\x22\x3eangle\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e3.画一条{0,0}到{r,0}的线即可\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22ctx.beginPath();\nctx.lineTo(0, 0);\nctx.lineTo(r, 0);\nctx.stroke();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3ectx\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.beginPath\x3c\/span\x3e();\n\x3cspan class=\x22hljs-selector-tag\x22\x3ectx\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.lineTo\x3c\/span\x3e(0, 0);\n\x3cspan class=\x22hljs-selector-tag\x22\x3ectx\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.lineTo\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-tag\x22\x3er\x3c\/span\x3e, 0);\n\x3cspan class=\x22hljs-selector-tag\x22\x3ectx\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.stroke\x3c\/span\x3e();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3ecanvas旋转方式画线步骤解读：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e笔触定位相当于是定画布原点的位置，旋转画布则是以原点为圆心顺时针旋转了x\/y坐标系，旋转后的效果是将x正半轴与要画的线重合，自然就相当于直接画一条{0,0}到{r,0}的线。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e另外一定要注意\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cp\x3e修改画布坐标系(定原点、旋转画布)之前一定要保存状态，画完线后一定要重载状态！不然你会很容易被自己改过的坐标系玩死的。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>常见的canvas优化——模糊问题、旋转效果</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009396591">https://segmentfault.com/a/1190000009396591</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/157192j51w6/" target="_blank">https://alili.tech/archive/157192j51w6/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/z09muaar7j/">2年前端应该会哪些技能<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/ke982v6qrfg/">CSS 性能优化笔记<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/if1i2hs28ah/">H5打造3d场景不完全攻略（二）: Amazing CSS3D<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/s4apghsr7o/">JS原生一步步实现前端路由和单页面应用<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/hjgkntbgqek/">JavaScript 中对大量数据的多重过滤<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/h1hfvr2a2nj/">JavaScript 中的错误处理机制<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/a0ukpm125gm/">JavaScript 数组分组的实现<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/fwosouhbhmj/">JavaScript 类型转换深度学习<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/z193p9xv2p/">JavaScript设计模式之发布-订阅模式（观察者模式）-Part1<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/6i7sr0vgkxm/">Javascript中的时间<aside class="dates">2019-02-01</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>