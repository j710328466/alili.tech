<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="riotjs 2.2.4"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>riotjs 2.2.4 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/ic5ys9tnr1n/",
				"appid": "1613049289050283", 
				"title": "riotjs 2.2.4 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-25T02:30:24"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/wd1i4kdw4jq/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ik09416kg2/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f&text=riotjs%202.2.4"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f&text=riotjs%202.2.4"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f&title=riotjs%202.2.4"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f&is_video=false&description=riotjs%202.2.4"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=riotjs%202.2.4&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f&title=riotjs%202.2.4"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f&title=riotjs%202.2.4"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f&title=riotjs%202.2.4"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fic5ys9tnr1n%2f&title=riotjs%202.2.4"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">riotjs 2.2.4</h1><div class="meta"><div class="postdate"><time datetime="2019-01-25" itemprop="datePublished">2019-01-25</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3eriotjs\x3c\/h1\x3e\n\x3cp\x3eriotjs一款小型的10000star mvp框架。目前进化至3.x版本了。读者注意，本篇文章介绍的是2.2.4哦。为啥介绍这款啊，是因为那个啥，preact面向现代浏览器，对我来说不咋好使。\x3c\/p\x3e\n\x3cp\x3eriotjs从出生到现在总共经历了3个大版本，基本上每个都不一样，1.x最为简陋，可以视之就一个简单的mvc框架哦，模板引擎也是简单的不要不要的，2.x版本完善了各项功能，并且强化了controller的作用，使之成为一个真正的MVP框架。3.x版本使用了大量es6，es5新增方法进行重构，对svg支持，模板引擎，事件系统，内存使用等进行了一定程度的优化。（实际从2.3开始就往现代浏览器上靠了）\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e为何选用\x3c\/h2\x3e\n\x3cp\x3e由于riotjs小，容易和其他框架混合使用\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e特点\x3c\/h2\x3e\n\x3cp\x3e小，但经不起强渲染\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e支持ie8吗\x3c\/h2\x3e\n\x3cp\x3eriotjs 2.2.4是最后一个支持ie8的版本。(然而事实上，代码中使用了一些es5新增的方法，这些方法要ie9才支持，以至于我们不得不使用es5shiv\/es5sham来进行兼容);\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e静态方法\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3eriot.observable\x3c\/h3\x3e\n\x3cp\x3eriot的事件系统，所有事件通知方式都基于该模块,可全局使用\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 发送全局事件\n\nvar window.eventBus = riot.observable();\n\neventBus.on(\x27test\x27, function (e) {\n    console.log(e);\n});\n\neventBus.trigger(\x27test\x27, 123);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 发送全局事件\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.eventBus = riot.observable();\n\neventBus.on(\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e);\n});\n\neventBus.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e123\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e包含方法\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eon(events, fn)\x3c\/li\x3e\n\x3cli\x3eoff(events, fn)\x3c\/li\x3e\n\x3cli\x3etrigger(name[,arguments])\x3c\/li\x3e\n\x3cli\x3eone(name, fn)\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3chr\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3eriot.mixin\x3c\/h3\x3e\n\x3cp\x3e作用是向内部对象mixins添加属性或方法，该对象无保护，所以必须要人为保证命名时不冲突.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 在外部使用\nriot.mixin(\x27testfunction\x27, function () { console.log(2) });\n\nvar c = riot.mixin(\x27testfunction\x27);\n\nc() \/\/ print 2\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在外部使用\x3c\/span\x3e\nriot.mixin(\x3cspan class=\x22hljs-string\x22\x3e\x27testfunction\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e) });\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e c = riot.mixin(\x3cspan class=\x22hljs-string\x22\x3e\x27testfunction\x27\x3c\/span\x3e);\n\nc() \x3cspan class=\x22hljs-comment\x22\x3e\/\/ print 2\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e该方法一般提供给riot tag初始化实例的时候使用。当在tag类中使用this.mixin混入方法的时候，会将内部对象mixins上的方法或属性混合到tag类上\x3c\/p\x3e\n\x3chr\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3eriot.route\x3c\/h3\x3e\n\x3cp\x3e2.2.4版本的riot.route是一个功能超弱的路由管理器,通过监听hashchange事件来触发注册的路由回调。该路由模块是自动启动的。而且它的实现上是有缺陷的。它本质上是个事件分发器。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 使用示例\n\nriot.route(function (path, module, action, params) {\n    console.log(path, module, action, params)\n});\n\nriot.route(\x27search\/index\/search\/1234\x27);\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 使用示例\x3c\/span\x3e\n\nriot.route(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3epath, module, action, params\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(path, \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e, action, params)\n});\n\nriot.route(\x3cspan class=\x22hljs-string\x22\x3e\x27search\/index\/search\/1234\x27\x3c\/span\x3e);\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e包含方法\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3eriot.route(arg)\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e2.2.4版本里arg接受2种类型，字符串和function，上面已经给出示例。需要自己去分出路径，模块，行为和参数。你没看错，就是这么弱\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eriot.route.exec(fn)\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e解释当前哈希路径，并把参数传递到fn里\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eriot.route.parser(fn)\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e指定哈希路径解释器，如果未调用该方法，固定解释方法是 path.split(\x27\/\x27);如示例所示\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eriot.route.stop()\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e销毁监听hashchange事件，销毁路由事件\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eriot.route.start()\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e监听。默认是开启的\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3chr\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eriot.util\x3c\/h3\x3e\n\x3cp\x3e包含两个内容,brackets和tmpl， brackets是tmpl的辅助函数，单独使用意义不大,该辅助函数可以通过正则或者索引制造我们需要匹配的部分。tmpl是riotjs的模板引擎核心，html字符串拼接完全通过该引擎，可独立使用(在npm上有独立维护的模块名为riot-tmpl)\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 设置模板占位符(默认是{ })\nriot.settings.brackets = \x27\x22{{\x22 \x22}}\x22\x27;\n\/\/ 使用\nvar html = riot.util.tmpl(\x27\x3cdiv\x3e\x22{{\x22a\x22}}\x22\x3c\/div\x3e\x27, { a:1 });\nconsole.log(html);\n\n\/\/print \x3cdiv\x3e1\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置模板占位符(默认是{ })\x3c\/span\x3e\nriot.settings.brackets = \x3cspan class=\x22hljs-string\x22\x3e\x27\x22{{\x22 \x22}}\x22\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 使用\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e html = riot.util.tmpl(\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div\x26gt;\x22{{\x22a\x22}}\x22\x26lt;\/div\x26gt;\x27\x3c\/span\x3e, { \x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e });\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(html);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/print \x26lt;div\x26gt;1\x26lt;\/div\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3chr\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3eriot.tag(name, html, css, attrs, fn)\x3c\/h3\x3e\n\x3cp\x3e全局注册一个riot标签, css attrs参数可省略。其实质是向一个内部对象tagImpl上创建了一个名为name的属性，其值是{name,html,css,attrs,fn}。此时该缓存并没有被使用，tag的实例并没有建立。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22riot.tag(\n    \x27ri-root\x27,\n    [\n        \x27\x3cri-login if={showLogin}\x3e\x3c\/ri-login\x3e\x27,\n        \x27\x3cri-error if={showError}\x3e\x3c\/ri-error\x3e\x27\n    ].join(\x27\x27),\n    function () {\n        var self = this;\n        this.showLogin = false;\n        this.showError = false;\n        this.on(\x27mount\x27, function () {\n            var device_id = window.Qutils.getParams(\x27device_id\x27);\n            if (!device_id) {\n                alert(\x27参数device_id缺失！\x27);\n            }\n            else {\n                setTimeout(function () {\n                    bridge.isInApp(\n                        function () {\n                            self.showLogin = true;\n                            self.tags[\x27ri-login\x27].trigger(\x27login-init\x27, device_id);\n                            self.update();\n                        },\n                        function () {\n                            self.showError = true;\n                            self.update();\n                        }\n                    )\n                }, 100);\n            }\n        });\n    }\n);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eriot.tag(\n    \x3cspan class=\x22hljs-string\x22\x3e\x27ri-root\x27\x3c\/span\x3e,\n    [\n        \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;ri-login if={showLogin}\x26gt;\x26lt;\/ri-login\x26gt;\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;ri-error if={showError}\x26gt;\x26lt;\/ri-error\x26gt;\x27\x3c\/span\x3e\n    ].join(\x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e),\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e self = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.showLogin = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.showError = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.on(\x3cspan class=\x22hljs-string\x22\x3e\x27mount\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e device_id = \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.Qutils.getParams(\x3cspan class=\x22hljs-string\x22\x3e\x27device_id\x27\x3c\/span\x3e);\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!device_id) {\n                alert(\x3cspan class=\x22hljs-string\x22\x3e\x27参数device_id缺失！\x27\x3c\/span\x3e);\n            }\n            \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                    bridge.isInApp(\n                        \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                            self.showLogin = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n                            self.tags[\x3cspan class=\x22hljs-string\x22\x3e\x27ri-login\x27\x3c\/span\x3e].trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27login-init\x27\x3c\/span\x3e, device_id);\n                            self.update();\n                        },\n                        \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                            self.showError = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n                            self.update();\n                        }\n                    )\n                }, \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e);\n            }\n        });\n    }\n);\x3c\/code\x3e\x3c\/pre\x3e\n\x3chr\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3eriot.mount \x26amp; riot.mountTo\x3c\/h3\x3e\n\x3cp\x3eriot.mountTo只是riot.mount的别名。该方法顾名思义，挂在riot标签（组件）。会返回一个tag的实例。\x3c\/p\x3e\n\x3cp\x3e参数\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3eselector\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e接受\x27*\x27（mount所有）, string split with \x27,\x27 , string（使用原生的Selectors API，获取一个NodeList),或者接受一个NodeList,Element\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3etagName\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e接受\x27*\x27(mount所有), object(当为Object类型时，即为opts),string(等同mount所有selector上下文下的tagName匹配tag)\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3eopts\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3eObject,传入的参数对象，可直接混合在tag实体的opts对象上\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!-- example --\x3e\n\x3cdiv id=\x26quot;test\x26quot;\x3e\x3c\/div\x3e\n\x3cscript\x3e\n    var tag = riot.mount(\x27#test\x27, \x27*\x27, {a:1,b:2});\n    console.log(tag[0].opts.a) \/\/ print 1\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- example --\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22test\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e tag = riot.mount(\x3cspan class=\x22hljs-string\x22\x3e\x27#test\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27*\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e});\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(tag[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].opts.a) \x3cspan class=\x22hljs-comment\x22\x3e\/\/ print 1\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3eriot.update\x3c\/h3\x3e\n\x3cp\x3e更新所有的tag实体,实质是调用每个实体的update方法。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3eriot的tag实例方法\x3c\/h2\x3e\n\x3cp\x3e上文说到riot中所用通过riot.tag声明的custom tag都只是缓存了，而没有立刻产生tag实例。实际上tag实例是在执行riot.mount的时候被创建的。所有的riot tag实例都是由内部构造器Tag实例化而来的。而对于一个多tag嵌套的组件，其实是递归先将子tag从底部实例化完，当实例化完成，会从根部到底部依次触发mount事件~\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3ethis.isMounted\x3c\/h3\x3e\n\x3cp\x3etrue | false, 指示tag是否完成安装\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3ethis._id\x3c\/h3\x3e\n\x3cp\x3e一个自增的id，用于唯一代表该实例\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3ethis.parent\x3c\/h3\x3e\n\x3cp\x3e若一个tag实例有父实例，这个parent指向父实例\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22this.on(\x27mount\x27, function () {\n    this.parent \x26amp;\x26amp; this.parent.trigger(\x27child-mounted\x27);\n}.bind(this))\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.on(\x3cspan class=\x22hljs-string\x22\x3e\x27mount\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.parent \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.parent.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27child-mounted\x27\x3c\/span\x3e);\n}.bind(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e))\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3ethis.root\x3c\/h3\x3e\n\x3cp\x3e该属性指向tag实例所表示的真实dom元素,另外root._tag同样挂载了tag实例的引用，所以当你的个自定义标签实例化以后，你还可以通过这样的姿势找到tag实例\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var tag = riot.mount(\x27custom-tag\x27);\n\nconsole.log(tag[0].root);\n\/\/ print \x3ccustom-tag\x3e\x3c\/custom-tag\x3e\n\nconsole.log(document.querySelector(\x27custom-tag\x27)._tag)\n\/\/ print Tag {xxx}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e tag = riot.mount(\x3cspan class=\x22hljs-string\x22\x3e\x27custom-tag\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(tag[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].root);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ print \x26lt;custom-tag\x26gt;\x26lt;\/custom-tag\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27custom-tag\x27\x3c\/span\x3e)._tag)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ print Tag {xxx}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3ethis.opts\x3c\/h3\x3e\n\x3cp\x3e哦，这个的构造器是Child，不过特的原型指向你传入的opts的引用。所以如果不想自己配置被改动，请乖乖深度克隆\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var tag = riot.mount(\x27custom-tag\x27, {a:1,b:2,c:3});\n\nconsole.log(tag[0].opts.a);\n\/\/ print 1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e tag = riot.mount(\x3cspan class=\x22hljs-string\x22\x3e\x27custom-tag\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3ec\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(tag[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].opts.a);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ print 1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e另外如果要在父子tag间传递参数也是很好玩的.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22riot.tag(\n    \x27hhh\x27,\n    \x27\x3czzz myoptions={this.opts.test}\x3e\x3c\/zzz\x3e\x27,\n    function () {}\n);\nriot.tag(\n    \x27zzz\x27,\n    \x27\x3cdiv\x3e{this.opts.myoptions}\x3c\/div\x3e\x27,\n    function () {}\n);\nvar new_custom_tag = document.createElement(\x27hhh\x27);\ndocument.body.appendChild(new_custom_tag);\nvar custom_tag = riot.mount(\x27hhh\x27, {test:1});\nconsole.log(custom_tag[0].tags[\x27zzz\x27].opts.myoptions);\n\/\/ print: 1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eriot.tag(\n    \x3cspan class=\x22hljs-string\x22\x3e\x27hhh\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;zzz myoptions={this.opts.test}\x26gt;\x26lt;\/zzz\x26gt;\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{}\n);\nriot.tag(\n    \x3cspan class=\x22hljs-string\x22\x3e\x27zzz\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div\x26gt;{this.opts.myoptions}\x26lt;\/div\x26gt;\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{}\n);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e new_custom_tag = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27hhh\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(new_custom_tag);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e custom_tag = riot.mount(\x3cspan class=\x22hljs-string\x22\x3e\x27hhh\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(custom_tag[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].tags[\x3cspan class=\x22hljs-string\x22\x3e\x27zzz\x27\x3c\/span\x3e].opts.myoptions);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ print: 1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\/\/ 注: riot没有state机制，要通过attributes传值，小心undefined\x3c\/p\x3e\n\x3cp\x3e需要注意的是，由于他遍历的是dom.attributes,你玩表单的时候小心一点。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader18\x22\x3ethis.tags\x3c\/h3\x3e\n\x3cp\x3e这里面放了子tag的实例的引用，上面的示例中有类似用法。多个同名子tag会放在数组里,我记不得在哪个版本里了，即使是一个子tag也会放在数组里。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader19\x22\x3ethis.update(data)\x3c\/h3\x3e\n\x3cp\x3e这个操作分为几个步骤：\x3c\/p\x3e\n\x3cp\x3e一：源码里明确写到，执行该方法先判断data对象里有没有可能覆盖tag实例属性的属性，如果有，丢弃。注意，该处过滤数据使用的是浅复制，如果是对象套对象，你要小心了。\x3c\/p\x3e\n\x3cp\x3e二：如果是循环产生的tag(注意，如果不是在custom-tag上使用each循环产生，不会去继承，因为此时isLoop为undefined)，重新从父tag获取需要继承的值\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22riot.tag(\n    \x27hhh\x27,\n    \x27\x3czzz each={eee} myoptions={opts.test}\x3e\x3c\/zzz\x3e\x27,\n    function () { this.eee = [{a:1,b:2},{a:1,b:2}]; this.eeeeeeeeee = 43214321; this.fdsafsdf = 3253425432 }\n);\nriot.tag(\n    \x27zzz\x27,\n    \x27\x3cdiv\x3e{a} {b}\x3c\/div\x3e\x27,\n    function () { this.fffff = 4325345342543}\n);\nvar new_custom_tag = document.createElement(\x27hhh\x27);\ndocument.body.appendChild(new_custom_tag);\nvar custom_tag = riot.mount(\x27hhh\x27, {test:1});\nconsole.log(custom_tag[0].tags.zzz[0].fdsafsdf)\n\/\/ print 3253425432\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eriot.tag(\n    \x3cspan class=\x22hljs-string\x22\x3e\x27hhh\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;zzz each={eee} myoptions={opts.test}\x26gt;\x26lt;\/zzz\x26gt;\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.eee = [{\x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e},{\x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e}]; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.eeeeeeeeee = \x3cspan class=\x22hljs-number\x22\x3e43214321\x3c\/span\x3e; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.fdsafsdf = \x3cspan class=\x22hljs-number\x22\x3e3253425432\x3c\/span\x3e }\n);\nriot.tag(\n    \x3cspan class=\x22hljs-string\x22\x3e\x27zzz\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div\x26gt;{a} {b}\x26lt;\/div\x26gt;\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.fffff = \x3cspan class=\x22hljs-number\x22\x3e4325345342543\x3c\/span\x3e}\n);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e new_custom_tag = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27hhh\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(new_custom_tag);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e custom_tag = riot.mount(\x3cspan class=\x22hljs-string\x22\x3e\x27hhh\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(custom_tag[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].tags.zzz[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].fdsafsdf)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ print 3253425432\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22riot.tag(\n    \x27hhh\x27,\n    \x27\x3cdiv each={eee}\x3e\x3czzz myoptions={opts.test}\x3e\x3c\/zzz\x3e\x3c\/div\x3e\x27,\n    function () { this.eee = [{a:1,b:2},{a:1,b:2}]; this.eeeeeeeeee = 43214321; this.fdsafsdf = 3253425432 }\n);\nriot.tag(\n    \x27zzz\x27,\n    \x27\x3cdiv\x3e{a} {b}\x3c\/div\x3e\x27,\n    function () { this.fffff = 4325345342543}\n);\nvar new_custom_tag = document.createElement(\x27hhh\x27);\ndocument.body.appendChild(new_custom_tag);\nvar custom_tag = riot.mount(\x27hhh\x27, {test:1});\nconsole.log(custom_tag[0].tags.zzz[0].fdsafsdf)\n\/\/ print undefined\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eriot.tag(\n    \x3cspan class=\x22hljs-string\x22\x3e\x27hhh\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div each={eee}\x26gt;\x26lt;zzz myoptions={opts.test}\x26gt;\x26lt;\/zzz\x26gt;\x26lt;\/div\x26gt;\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.eee = [{\x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e},{\x3cspan class=\x22hljs-attr\x22\x3ea\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\x3cspan class=\x22hljs-attr\x22\x3eb\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e}]; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.eeeeeeeeee = \x3cspan class=\x22hljs-number\x22\x3e43214321\x3c\/span\x3e; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.fdsafsdf = \x3cspan class=\x22hljs-number\x22\x3e3253425432\x3c\/span\x3e }\n);\nriot.tag(\n    \x3cspan class=\x22hljs-string\x22\x3e\x27zzz\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div\x26gt;{a} {b}\x26lt;\/div\x26gt;\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.fffff = \x3cspan class=\x22hljs-number\x22\x3e4325345342543\x3c\/span\x3e}\n);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e new_custom_tag = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27hhh\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(new_custom_tag);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e custom_tag = riot.mount(\x3cspan class=\x22hljs-string\x22\x3e\x27hhh\x27\x3c\/span\x3e, {\x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(custom_tag[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].tags.zzz[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].fdsafsdf)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ print undefined\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e该特性可能会对您造成困扰，啥时候误操作都可能一头雾水不造为什么。\x3c\/p\x3e\n\x3cp\x3e三:混合其他数据和属性到当前tag上\x3c\/p\x3e\n\x3cp\x3e四:更新视图，删除dom传导属性，重置事件。（所以说如果你浏览器在dom回收和事件回收上有问题，那你更新的时候就相当捉急了，在最新的版本里把这个泄漏点给堵上了）\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader20\x22\x3ethis.mixin()\x3c\/h3\x3e\n\x3cp\x3e接受无数多个字符串参数,内部运行 riot.mixin[arguments[i]]将需要混入的属性或方法混入到实例上~~前面介绍过了。在2.2.4以前的版本没有使用.bind(this)来参入作用域，略蛋疼的说,2.2.4 对混入的方法都bind了当前作用域。另外，注意init是很特殊的，在混入时会自动执行。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22riot.mixin({\n    init: function () {\n        this.a = 1;\n        console.log(\x27init\x27)\n    }\n});\n\nriot.tag(\x27test\x27, \x27\x3cdiv\x3e\x3c\/div\x3e\x27, function () {\n    this.mixin(\x27init\x27);\n});\n\nvar a = document.createElement(\x27test\x27);\ndocument.body.appendChild(a);\nvar custom_tag = riot.mount(\x27test\x27);\nconsole.log(custom_tag[0].a)\n\/\/ print 1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eriot.mixin({\n    \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.a = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27init\x27\x3c\/span\x3e)\n    }\n});\n\nriot.tag(\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div\x26gt;\x26lt;\/div\x26gt;\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.mixin(\x3cspan class=\x22hljs-string\x22\x3e\x27init\x27\x3c\/span\x3e);\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.body.appendChild(a);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e custom_tag = riot.mount(\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(custom_tag[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].a)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ print 1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader21\x22\x3ethis.mount()\x3c\/h3\x3e\n\x3cp\x3e将该实例强制重新装载一遍\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader22\x22\x3ethis.unmount(keepRootTag)\x3c\/h3\x3e\n\x3cp\x3e传入参数，如果为true，会把初始化用的那个根节点也删球掉。该方法用于卸载实例，释放内存。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader23\x22\x3eon, off, trigger, one\x3c\/h3\x3e\n\x3cp\x3e通过riot.observable混入的事件方法，然后我们可以在不同tag实例上到处传播事件了，建议使用一个集线器把事件管理起来，或者使用其他玩意，比如riot-flux什么的来玩。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader24\x22\x3e生命周期\x3c\/h2\x3e\n\x3cp\x3e\x3cem\x3eto be continue\x3c\/em\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader25\x22\x3e后记\x3c\/h2\x3e\n\x3cp\x3e这个框架跟虚拟dom没撒关系，因为完全没有diff算法。。。在更新视图的时候用了文档碎片凑~，效果还凑合\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>riotjs 2.2.4</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008518507">https://segmentfault.com/a/1190000008518507</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/ic5ys9tnr1n/" target="_blank">https://alili.tech/archive/ic5ys9tnr1n/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/lfmj4xr00e/">2016年终总结--前端生涯从0到1的过程<aside class="dates">2019-01-27</aside></a></li><li><a href="/archive/ukfvl3yzohq/">ES6新语法疑点简析<aside class="dates">2019-01-27</aside></a></li><li><a href="/archive/adal5cm5rlr/">Icon 进化史<aside class="dates">2019-01-27</aside></a></li><li><a href="/archive/xwquh4g09bl/">JS 中 TDZ 的理解<aside class="dates">2019-01-27</aside></a></li><li><a href="/archive/13j072ppoyf/">Javascript 中 Y 组合子的推导<aside class="dates">2019-01-27</aside></a></li><li><a href="/archive/kn3l7fwd55/">Redux story-1:who creates it?<aside class="dates">2019-01-27</aside></a></li><li><a href="/archive/9gngp6sg77/">Redux概念之二: Redux的三大原则<aside class="dates">2019-01-27</aside></a></li><li><a href="/archive/ktc291v9lq/">V8 Object 内存结构与属性访问详解<aside class="dates">2019-01-27</aside></a></li><li><a href="/archive/62hk7sdq93k/">Vue&#43;MySQL&#43;Express小试牛刀<aside class="dates">2019-01-27</aside></a></li><li><a href="/archive/q9tzlra5qaj/">Vue2.0简易案例<aside class="dates">2019-01-27</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>