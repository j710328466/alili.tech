<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="我们是如何构建Twitter Lite的"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>我们是如何构建Twitter Lite的 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/84ezp8lesnv/",
				"appid": "1613049289050283", 
				"title": "我们是如何构建Twitter Lite的 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-25T02:30:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/rglihqnm4j/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/hyx8qgfszjn/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f&text=%e6%88%91%e4%bb%ac%e6%98%af%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%baTwitter%20Lite%e7%9a%84"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f&text=%e6%88%91%e4%bb%ac%e6%98%af%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%baTwitter%20Lite%e7%9a%84"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f&title=%e6%88%91%e4%bb%ac%e6%98%af%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%baTwitter%20Lite%e7%9a%84"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f&is_video=false&description=%e6%88%91%e4%bb%ac%e6%98%af%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%baTwitter%20Lite%e7%9a%84"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%88%91%e4%bb%ac%e6%98%af%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%baTwitter%20Lite%e7%9a%84&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f&title=%e6%88%91%e4%bb%ac%e6%98%af%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%baTwitter%20Lite%e7%9a%84"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f&title=%e6%88%91%e4%bb%ac%e6%98%af%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%baTwitter%20Lite%e7%9a%84"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f&title=%e6%88%91%e4%bb%ac%e6%98%af%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%baTwitter%20Lite%e7%9a%84"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f84ezp8lesnv%2f&title=%e6%88%91%e4%bb%ac%e6%98%af%e5%a6%82%e4%bd%95%e6%9e%84%e5%bb%baTwitter%20Lite%e7%9a%84"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">我们是如何构建Twitter Lite的</h1><div class="meta"><div class="postdate"><time datetime="2019-01-25" itemprop="datePublished">2019-01-25</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3cp\x3e非常激动向大家介绍 \x3ca href=\x22https:\/\/blog.twitter.com\/2017\/introducing-twitter-lite\/\x22\x3eTwitter Lite\x3c\/a\x3e ，一个已经能在\x3ca href=\x22https:\/\/mobile.twitter.com\/\x22\x3emobile.twitter.com\x3c\/a\x3e上体验的\x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/getting-started\/codelabs\/your-first-pwapp\/\x22\x3e渐进式网页应用\x3c\/a\x3e。 Twitter Lite速度更快，应用了响应式设计，流量消耗更少，占用的存储空间也更小，并且在现代浏览器中支持消息推送和离线使用。网页正在逐渐成为一个承载按需使用、安装简易、渐进更新的轻量级应用的平台。近几年我们逐渐采用了新的、开放的网页端API，极大提升了网页应用的性能和用户体验。\x3c\/p\x3e\n\x3ch4\x3e架构纵观\x3c\/h4\x3e\n\x3cp\x3eTwitter Lite包括一个客户端的JavaScript应用和一个简单的\x3ca href=\x22https:\/\/nodejs.org\/en\/\x22\x3eNode.js\x3c\/a\x3e服务器。服务器负责处理用户验证，绘制应用的初始状态，并渲染出应用的初始HTML结构。一旦浏览器完成初次加载，应用会直接从Twitter API请求数据。这种基本架构的简单性帮助我们提供了出色的大规模的可靠性、高效性服务——Twitter Lite比起服务端渲染的桌面网站运行起来消耗更少。\x3c\/p\x3e\n\x3cp\x3e在客户端JavaScript应用的开发、构建和测试中，我们使用了非常多的开源框架，包括\x3ca href=\x22https:\/\/facebook.github.io\/react\/\x22\x3eReact\x3c\/a\x3e, \x3ca href=\x22http:\/\/redux.js.org\/\x22\x3eRedux\x3c\/a\x3e, \x3ca href=\x22https:\/\/github.com\/paularmstrong\/normalizr\x22\x3eNormalizr\x3c\/a\x3e, \x3ca href=\x22https:\/\/github.com\/globalizejs\/globalize\x22\x3eGlobalize\x3c\/a\x3e, \x3ca href=\x22https:\/\/babeljs.io\/\x22\x3eBabel\x3c\/a\x3e, \x3ca href=\x22https:\/\/webpack.js.org\/\x22\x3eWebpack\x3c\/a\x3e, \x3ca href=\x22https:\/\/facebook.github.io\/jest\/\x22\x3eJest\x3c\/a\x3e, \x3ca href=\x22http:\/\/webdriver.io\/\x22\x3eWebdriverIO\x3c\/a\x3e, and \x3ca href=\x22https:\/\/yarnpkg.com\/\x22\x3eYarn\x3c\/a\x3e。依托着已经成熟的开源软件，我们有了更多的时间去提升用户体验，提高迭代速度和解决一些Twitter中现存的问题，比如定制化和操控时间线和推中包含的数据。\x3c\/p\x3e\n\x3cp\x3e我们书写现代化的JavaScript（ES2015及以后），然后由Babel编译，Webpack打包。API返回的数据在被送往不同的Redux模块之前，首先由Normalizr处理——我们能够删除重复数据并将数据转换成多种格式——之后则用于取出、存储、取回远程和本地数据。UI由数以百计的React组件构成，这些组件负责从小到渲染文本，大到管理虚拟列表、懒加载模块和延迟渲染的所有事务。Twitter Lite支持42种语言，我们用Globalize来定制化数字、日期和信息的显示。\x3c\/p\x3e\n\x3ch4\x3e为性能而生\x3c\/h4\x3e\n\x3cp\x3e每个月有数十亿的人访问mobile.twitter.com。我们想要让Twitter Lite在您的网络速度慢、低可用、受限制或费用昂贵时，成为您访问Twitter的最佳选择。我们通过\x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/performance\/prpl-pattern\/\x22\x3ePRPL pattern\x3c\/a\x3e 做了一系列的性能升级，并使用了安卓平台上支持\x3ca href=\x22https:\/\/github.com\/w3c\/ServiceWorker\x22\x3eService Worker\x3c\/a\x3e, \x3ca href=\x22https:\/\/w3c.github.io\/IndexedDB\/\x22\x3eIndexedDB\x3c\/a\x3e, \x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/engage-and-retain\/app-install-banners\/\x22\x3eWeb App Install Banners\x3c\/a\x3e, and \x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/engage-and-retain\/push-notifications\/\x22\x3eWeb Push Notifications\x3c\/a\x3e等新功能的现代浏览器(比如Google Chrome)，现在我们已经大大提升了访问速度和可靠性。\x3c\/p\x3e\n\x3ch5\x3e可靠性\x3c\/h5\x3e\n\x3cp\x3eTwitter Lite拥有网络自适应性。如果我们想达到每一个人，我们就必须达到使用低速、低可用网络的人。如果支持，我们会使用Service Worker来启用临时性的离线浏览和重复访问时的瞬间加载，不管网络状况如何。Service Worker会缓存HTML应用骨架和静态资源，还有一些流行的表情。当脚本或者取回数据失败时，我们会提供“重试”按钮，帮助用户重新获取数据。这些改进共同帮助我们提升了应用的可靠性，并且在重复访问时，大大提升加载速度、缩短启动时间。\x3c\/p\x3e\n\x3ch5\x3e渐进式加载\x3c\/h5\x3e\n\x3cp\x3eTwitter Lite在大多数使用3G的设备上五秒钟内便可以进入正常交互状态。这个世界上大部分人还使用着2G或者3G网络；初次体验的快速性是很重要的。在过去的三个月里，我们将平均加载时间降低了30%，并将进入交互状态之前的延迟降低了25%。为了达到这些，在服务器构建应用的初始状态时，应用会将初始的HTML响应流发送到浏览器端，并发送一系列的预加载指令，用来加载关键资源。应用了Webpack之后，应用的脚本会被打散到一个一个的小包之中，按需加载。这意味着初次加载仅需要请求在页面可见部分上使用的资源。（如果支持，Service Workder会预先缓存附加的资源和保证其它路由的瞬时加载。）这些改变支持我们渐进式地加载应用，因此人们可以更快地查看和创建推。\x3c\/p\x3e\n\x3ch5\x3e渲染\x3c\/h5\x3e\n\x3cp\x3eTwitter Lite打碎了昂贵的渲染工作。尽管我们已经优化了组件的渲染，推仍然是一个复杂的复合型组件，渲染超长列表依旧需要我们做额外的性能上的考虑。我们使用了虚拟列表组件，它只渲染当前视口可见的内容，使用requestAnimationFrame API渲染多帧上的条目，并保留不同页面的滚动状态。使用\x3ca href=\x22https:\/\/w3c.github.io\/requestidlecallback\/\x22\x3erequestIdleCallback\x3c\/a\x3e API，我们还可以推迟非关键渲染至空闲时段，这可以让应用的性能再上升一个台阶。\x3c\/p\x3e\n\x3ch5\x3e数据使用\x3c\/h5\x3e\n\x3cp\x3eTwitter Lite默认降低数据使用，措施包括请求小体积资源和依赖缓存。我们优化了您时间线上的图片显示，流量使用最高可降低40%。“省流量”模式会通过将推和消息中图片替换为小且模糊的预览图，大大减少流量使用。对图片使用HEAD请求可以帮助我们显示图片的体积大小，然后由用户决定是否加载。Twitter Lite只需要非常小的一片存储空间，因为它的体积只有原生应用的1%-3%。\x3c\/p\x3e\n\x3ch5\x3e设计系统和迭代速度\x3c\/h5\x3e\n\x3cp\x3eTwitter Lite的快速迭代性可以帮助我们维持高质量的用户体验。我们主要依赖弹性伸缩盒布局和其它一些固定数值的颜色、字体和尺寸。Twitter Lite建立在以组件为基础的自适应设计系统之上，适用于各种尺寸的设备。通过使用UI组件，我们建立了一套可以供设计与工程并用的语法，以此来展开快速迭代和组件复用的工作。我们的一些非常复杂的特性，比如内容混合的时间线，最短使用30行代码即可创建，其中包括配置和链接Redux模块与React组件。\x3c\/p\x3e\n\x3ch5\x3e展望\x3c\/h5\x3e\n\x3cp\x3e搭建一个这么大规模的快速的网页应用，并且让其持续保持这种状态，对来自Twitter不同团队的设计、产品、开发人员来讲都是一个很大的挑战。我们现在的进度相当不错，并且一直在通过使用HTTP\/2、GraphQL和其它压缩格式试验如何将加载时间和流量消耗降至更低。在接下来的几个月里，我们会在可用性、安全性、设计、实用性和性能方面，在Twitter Lite中加入更多的改进。\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>我们是如何构建Twitter Lite的</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/how-we-built-twitter-lite">https://www.zcfy.cc/article/how-we-built-twitter-lite</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/84ezp8lesnv/" target="_blank">https://alili.tech/archive/84ezp8lesnv/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5fmk2pl6rab/">2016年前端开发者深度调研，看看别人使用什么技术体系<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/stp6408xnu/">Bootstrap使用模态框modal实现表单提交弹出框<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/fu7a86e9uyh/">CSS水平垂直居中总结<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/r0w29esklr/">JS 里怎么给数组填充默认值<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/i00hiszlr1/">JavaScript - EventEmitter 背后的秘密<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/u2la0cn9do/">JavaScript 精度丢失问题<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/3txhfn3ejcb/">Nodejs进阶：如何玩转子进程（child_process）<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/yr7v8e9fao/">Promise介绍--规范篇<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/9lyxyz4wc6g/">QQ音乐API整理<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/84zzlljmes4/">SegmentFault 技术周刊 Vol.14 - 进阶 Vue 2.0<aside class="dates">2019-01-30</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>