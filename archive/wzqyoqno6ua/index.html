<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="详解js中的闭包"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>详解js中的闭包 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/wzqyoqno6ua/",
				"appid": "1613049289050283", 
				"title": "详解js中的闭包 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-01T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ggk866qh59i/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/on69wfbsuqd/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f&text=%e8%af%a6%e8%a7%a3js%e4%b8%ad%e7%9a%84%e9%97%ad%e5%8c%85"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f&text=%e8%af%a6%e8%a7%a3js%e4%b8%ad%e7%9a%84%e9%97%ad%e5%8c%85"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f&title=%e8%af%a6%e8%a7%a3js%e4%b8%ad%e7%9a%84%e9%97%ad%e5%8c%85"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f&is_video=false&description=%e8%af%a6%e8%a7%a3js%e4%b8%ad%e7%9a%84%e9%97%ad%e5%8c%85"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%af%a6%e8%a7%a3js%e4%b8%ad%e7%9a%84%e9%97%ad%e5%8c%85&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f&title=%e8%af%a6%e8%a7%a3js%e4%b8%ad%e7%9a%84%e9%97%ad%e5%8c%85"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f&title=%e8%af%a6%e8%a7%a3js%e4%b8%ad%e7%9a%84%e9%97%ad%e5%8c%85"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f&title=%e8%af%a6%e8%a7%a3js%e4%b8%ad%e7%9a%84%e9%97%ad%e5%8c%85"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fwzqyoqno6ua%2f&title=%e8%af%a6%e8%a7%a3js%e4%b8%ad%e7%9a%84%e9%97%ad%e5%8c%85"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">详解js中的闭包</h1><div class="meta"><div class="postdate"><time datetime="2019-02-01" itemprop="datePublished">2019-02-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e在js中，闭包是一个很重要又相当不容易完全理解的要点，网上关于讲解闭包的文章非常多，但是并不是非常容易读懂，在这里以《javascript高级程序设计》里面的理论为基础。用拆分的方式，深入讲解一下对于闭包的理解，如果有不对请指正。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e写在闭包之前\x3c\/h2\x3e\n\x3cp\x3e闭包的内部细节，依赖于函数被调用过程所发生的一系列事件为基础，所以有必要先弄清楚以下几个概念：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e1. 执行环境和活动对象\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3cstrong\x3e - 执行环境(execution context)\x3c\/strong\x3e定义了变量或者函数有权访问的其他数据，每个执行环境都有一个与之关联的\x3cstrong\x3e变量对象(variable object)\x3c\/strong\x3e，执行环境中定义的变量和函数就保存在这个变量对象中；\x3cbr\x3e全局执行环境是最外围的一个执行环境，通常被认为是window对象\x3cbr\x3e执行环境和变量对象在\x3cstrong\x3e运行函数\x3c\/strong\x3e时生成\x3cbr\x3e执行环境中的所有代码执行完以后，执行环境被销毁，保存在其中的变量和函数也随之销毁；(全局执行环境到应用退出时销毁)\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e2. 作用域链\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e当代码在一个执行环境中执行时，会创建\x3cstrong\x3e变量对象\x3c\/strong\x3e的一个\x3cstrong\x3e作用域链(scope chain)\x3c\/strong\x3e，作用域链用来指定执行环境有权访问的所有变量和函数的\x3cstrong\x3e访问顺序\x3c\/strong\x3e；\x3cbr\x3e作用域链的最前端，始终是\x3cstrong\x3e当前代码执行环境的变量对象\x3c\/strong\x3e，如果这个环境是函数，则其活动对象就是变量对象\x3cbr\x3e作用域链的下一个变量对象，来自外部包含环境，再下一个变量对象，来自下一个外部包含环境，以此类推直到全局执行环境\x3cbr\x3e在函数执行过程，根据当前执行环境的作用域链来\x3cstrong\x3e逐层向外\x3c\/strong\x3e查找变量，并且进行标识符解析\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e是不是觉得以上的理论很枯燥而且艰涩？因为基本上是从书上引用来的，不着急着理解，先摆在上面，等会结合案例回头再来看！接下来请看样例:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22样例1\n\x3cscript\x3e\n    var a = 2;\n    function A(){\n         var a = 1;\n         return a ;\n    }\n    console.log(A());\/\/1\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e样例1\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eA\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n         \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a ;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(A());\x3cspan class=\x22hljs-comment\x22\x3e\/\/1\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以这段简单的代码为例，根据上面的理论画一下关系图(直接用ps画的，原谅我拙劣的笔迹):\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVE6yu?w=959\x26amp;h=360\x22 src=\x22https:\/\/static.alili.tech\/img\/bVE6yu?w=959\x26amp;h=360\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e如图所示，在执行函数A的时候，创建了A的执行环境和变量对象，其中A的变量对象和全局变量对象中都含有a变量，根据作用域链从前向后查找，在A的变量对象中找到，所以输出1，执行完毕以后 ，\x3cstrong\x3eA的执行环境销毁，A的变量对象由于没有被引用，所以也销毁\x3c\/strong\x3e；\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22样例2\n\x3cscript\x3e\n    function A(){\n         var a = 1;\n         return a ;\n    }\n    console.log(a);\/\/ 报错  a is not defined\n\x3c\/script\x3e     \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e样例2\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eA\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n         \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e a ;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(a);\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 报错  a is not defined\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e     \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个例子比较简单，要画图的话只需要画一个全局变量对即可，因为在js中，外围环境无法访问内围局部变量(其实本质就是作用域链上找不到相应的值)，所以这里会报变量未定义的错误。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22样例3\n\x3cscript\x3e\n      function A(){\n         var a = 1;\n         function B(){\n             if(a==1){\n                 console.log(1)\n             }\n             else\n             {\n                  console.log(0);\n              }\n         }\n         B();\n    }\n    A();\/\/1\n\x3c\/script\x3e  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e样例3\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n      \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eA\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n         \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e a = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eB\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n             \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(a==\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e){\n                 \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n             }\n             \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e\n             {\n                  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);\n              }\n         }\n         B();\n    }\n    A();\x3cspan class=\x22hljs-comment\x22\x3e\/\/1\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面这个例子，在函数A中定义了函数B,关系图如下:  \x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVLi3D?w=800\x26amp;h=536\x22 src=\x22https:\/\/static.alili.tech\/img\/bVLi3D?w=800\x26amp;h=536\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e从图上可以很清楚的看出，在每个执行环境中可以访问到的变量对象，所以B可以访问A的变量对象和全局变量对象中的变量以及自身变量对象，A可以访问自身变量对象和全局变量对象\x3c\/p\x3e\n\x3cp\x3e关于执行环境和作用域链暂时说到这里，下面进入正题，讲闭包;\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e初涉闭包\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cp\x3e闭包是指有权访问另一个函数作用域变量的\x3cstrong\x3e函数\x3c\/strong\x3e，创建闭包的通常方式，是在一个函数内部创建另一个函数\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e上文我们提到了，由于作用域链的结构，外围函数是无法访问内部变量的，为了能够访问内部变量，我们就可以使用闭包，\x3cstrong\x3e闭包的本质还是函数\x3c\/strong\x3e，\x3cstrong\x3e闭包的本质还是函数\x3c\/strong\x3e\x3cstrong\x3e闭包的本质还是函数\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22样例4\n\x3cscript\x3e\n    function A(){\n        var x = 1;\n        return function(){\n            console.log(x);\n        }\n    }\n    var m = A();\n    m();\/\/1\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e样例4\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eA\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(x);\n        }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e m = A();\n    m();\x3cspan class=\x22hljs-comment\x22\x3e\/\/1\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面就是一个很简单的闭包例子，通过m函数，我们可以获得A函数内部变量的值，这个样例比较简单，看不出什么问题，接下来我们来深入了解一下。\x3cbr\x3e-------------------------------从简单到复杂的分割线，请做好准备----------------------------------------------------\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e闭包详解\x3c\/h2\x3e\n\x3ch4\x3e难点一:判断作用域指向的变量对象是否相同\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22样例5\n\x3cscript\x3e\n    function A(){\n        var x = 1;\n        return function(){\n            x\x2b\x2b;\n            console.log(x);\n        }\n    }\n    var m1 = A();\/\/第一次执行A函数\n    m1();\/\/2\n    m1();\/\/3\n    var m2 = A();\/\/第二次执行A函数\n    m2();\/\/2\n    m1();\/\/4\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e样例5\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eA\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n            x\x2b\x2b;\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(x);\n        }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e m1 = A();\x3cspan class=\x22hljs-comment\x22\x3e\/\/第一次执行A函数\x3c\/span\x3e\n    m1();\x3cspan class=\x22hljs-comment\x22\x3e\/\/2\x3c\/span\x3e\n    m1();\x3cspan class=\x22hljs-comment\x22\x3e\/\/3\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e m2 = A();\x3cspan class=\x22hljs-comment\x22\x3e\/\/第二次执行A函数\x3c\/span\x3e\n    m2();\x3cspan class=\x22hljs-comment\x22\x3e\/\/2\x3c\/span\x3e\n    m1();\x3cspan class=\x22hljs-comment\x22\x3e\/\/4\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面这个例子其实可以引出几个问题:\x3cbr\x3e   1.为什么连续执行m1的时候，x的值在递增?\x3cbr\x3e   2.定义函数m2的时候，为什么x的值重新从1开始了?\x3cbr\x3e   3.运行m2以后，为什么再运行m1，x还是按照之前m1的运行结果继续增长?（其实就是m1和m2里面的x为什么是相互独立，各自维持的？）\x3c\/p\x3e\n\x3cp\x3e其实要解决上面的问题，我们就要用到前面铺垫的知识点了:\x3cbr\x3e首先，先画一下结构图，\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVE6Tz?w=1576\x26amp;h=845\x22 src=\x22https:\/\/static.alili.tech\/img\/bVE6Tz?w=1576\x26amp;h=845\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e(额，这图画的可能真的有点丑)，不要慌，图上虽然画的有点乱，但是其实很简单:左半部分和上面简单闭包的例子，其实是完全一样的，而右边半部分，与左边其实是完全对称的；注意看图上的重点：\x3cstrong\x3e每次执行A函数时，都会生成一个A的活动变量和执行环境，执行完毕以后，A的执行环境销毁，但是活动对象由于被闭包函数引用，所以仍然保留\x3c\/strong\x3e，所以，最终剩下两个A的变量对象，\x3cstrong\x3e因此m1和m2在操作x时，指向的是不同的数据\x3c\/strong\x3e，\x3c\/p\x3e\n\x3cp\x3e现在来回答上面的三个问题:\x3cbr\x3e1.(为什么连续执行m1的时候，x的值在递增?)\x3cbr\x3e\x3cstrong\x3eanswer:因为m1在引用的活动对象A一直没有释放(想释放的话可以让m1=null)，所以x的值一直递增。\x3c\/strong\x3e\x3cbr\x3e2.定义函数m2的时候，为什么x的值重新从1开始了?\x3cbr\x3e\x3cstrong\x3eanswer:因为又一次运行了A函数，生成一个新的A的活动对象，所以m2的作用域链引用的是一个新的x值。\x3c\/strong\x3e\x3cbr\x3e3.m1和m2里面的x为什么是相互独立，各自维持的？\x3cbr\x3e\x3cstrong\x3eanswer:因为在定义m1和m2的时候，分别运行了A函数，生成了两个活动对象，所以,m1和m2的作用域链是指向不同的A的活动对象的。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e好的，到这里先回顾一下前面说到的知识点:\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e执行环境和变量对象在\x3cstrong\x3e运行函数\x3c\/strong\x3e时生成\x3cbr\x3e执行环境中的所有代码执行完以后，\x3cstrong\x3e执行环境\x3c\/strong\x3e被销毁，保存在其中的变量和函数也随之销毁；(全局执行环境到应用退出时销毁)\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e感觉理解了吗？接下来，再看看另一个很类似的例子:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22样例6\n \x3cscript\x3e\n    function A(){\n        var x = 1;\n        var m=[];\n        m[0] = function(){\n            x\x2b\x2b;\n            console.log(x);\n        };\n        m[1] = function(){\n            x\x2b\x2b;\n            console.log(x);\n        }\n         return m;\n    }\n    var m = A();\/\/第一次运行A,而且只运行这一次\n    m[0]();\/\/2\n    m[1]();\/\/3\n    m[0]();\/\/4\n    m[1]();\/\/5\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e样例6\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eA\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e m=[];\n        m[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n            x\x2b\x2b;\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(x);\n        };\n        m[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n            x\x2b\x2b;\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(x);\n        }\n         \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e m;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e m = A();\x3cspan class=\x22hljs-comment\x22\x3e\/\/第一次运行A,而且只运行这一次\x3c\/span\x3e\n    m[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]();\x3cspan class=\x22hljs-comment\x22\x3e\/\/2\x3c\/span\x3e\n    m[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]();\x3cspan class=\x22hljs-comment\x22\x3e\/\/3\x3c\/span\x3e\n    m[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]();\x3cspan class=\x22hljs-comment\x22\x3e\/\/4\x3c\/span\x3e\n    m[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]();\x3cspan class=\x22hljs-comment\x22\x3e\/\/5\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个例子和刚刚十分类似，不同的是，在A内部就先定义了两个函数，可以看出 ，最后的结果与上面的例子有些不同:\x3cbr\x3e\x3cstrong\x3e变量x仍然能保持递增，但是m[0]和m[1]定义的函数，对于x的改变不再是相互独立的\x3c\/strong\x3e，其实大家估计猜到了，这里的m[0]和m[1]的作用域指向的A的变量对象，其实是同一个，为什么呢?很简单，看看刚刚这段代码，其实是只调用了一次A函数，再看上文那句话:\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e执行环境和变量对象在\x3cstrong\x3e运行函数\x3c\/strong\x3e时生成\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e既然A只执行一次，那么A的活动变量当然也就生成了一个，所以这里m[0]和m[1]的作用域指向同一个A的变量对象\x3c\/p\x3e\n\x3ch4\x3e难点二:判断变量对象中变量的值\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 样例7\n \x3cscript\x3e\n    function A(){\n        var funs=[];\n        for(var i=0;i\x3c10;i\x2b\x2b){\n           funs[i]=function(){\n               return i;\n           }\n        }\n        return funs; \n    }\n    var funs = A();\/\/定义funs[0]-funs[9]，10个函数\n    console.log(funs[0]());\/\/10\n    console.log(funs[1]());\/\/10\n    console.log(funs[6]());\/\/10\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e 样例7\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eA\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e funs=[];\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;i\x26lt;\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;i\x2b\x2b){\n           funs[i]=\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n               \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e i;\n           }\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e funs; \n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e funs = A();\x3cspan class=\x22hljs-comment\x22\x3e\/\/定义funs[0]-funs[9]，10个函数\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(funs[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]());\x3cspan class=\x22hljs-comment\x22\x3e\/\/10\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(funs[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]());\x3cspan class=\x22hljs-comment\x22\x3e\/\/10\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(funs[\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e]());\x3cspan class=\x22hljs-comment\x22\x3e\/\/10\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个例子其实算是一个经典案例，在很多地方都有提到，执行完毕后 funs数组中，funs[0]-funs[9]存的其实都是一样的,都是一个返回i值的函数，\x3cstrong\x3e这个例子容易错误的地方其实在于，弄错了产生执行环境的时机\x3c\/strong\x3e，还是看这句话：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e执行环境和变量对象在\x3cstrong\x3e运行函数\x3c\/strong\x3e时生成\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e所以，当执行\x3ccode\x3e var funs = A();\x3c\/code\x3e时，只是\x3cstrong\x3e定义\x3c\/strong\x3e函数，而没有\x3cstrong\x3e执行\x3c\/strong\x3e，真正产生环境变量的时间是在\x3ccode\x3econsole.log(funs[0]());\x3c\/code\x3e这三句的时候，此时A的变量对象中i值是什么呢？很简单，\x3cstrong\x3e看它return的时候\x3c\/strong\x3e，i的值，显然，i的值是10，所以，最后三句输出的都是10\x3c\/p\x3e\n\x3cp\x3e好的，针对以上的案例，如果我就是想让fun[i]能够返回i，那应该怎么写呢?在《javascript高级程序设计》中，提供了一种参考的写法:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 样例8\n \x3cscript\x3e\n    function A(){\n        var funs=[];\n        for(var i=0;i\x3c10;i\x2b\x2b){\n           funs[i] = function anonymous1(num){\n                        return function anonymous2(){\n                    return num;\n                }\n            }(i);\n        }\n        return funs; \n    }\n    var funs = A();\/\/定义funs[0]-funs[9]，10个函数\n    console.log(funs[0]());\/\/0\n    console.log(funs[1]());\/\/1\n    console.log(funs[6]());\/\/6\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e 样例8\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eA\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e funs=[];\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;i\x26lt;\x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;i\x2b\x2b){\n           funs[i] = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eanonymous1\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enum\x3c\/span\x3e)\x3c\/span\x3e{\n                        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eanonymous2\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e num;\n                }\n            }(i);\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e funs; \n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e funs = A();\x3cspan class=\x22hljs-comment\x22\x3e\/\/定义funs[0]-funs[9]，10个函数\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(funs[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]());\x3cspan class=\x22hljs-comment\x22\x3e\/\/0\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(funs[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e]());\x3cspan class=\x22hljs-comment\x22\x3e\/\/1\x3c\/span\x3e\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(funs[\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e]());\x3cspan class=\x22hljs-comment\x22\x3e\/\/6\x3c\/span\x3e\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e是不是一看头就大了？没关系，接下来我们慢慢分析，当然，上述代码中anonymous1和anonymous2两个名字是我自己添加上的，为了后面能够更好的说明。\x3cbr\x3e首先，先来看看function anonymous1(num){}(i)，这是一个\x3cstrong\x3e立即执行函数\x3c\/strong\x3e，效果和名字一样，定义完之后马上运行结果，\x3cstrong\x3e那这里运行的结果是什么呢？就是把i的值立即传递给num这个局部变量\x3c\/strong\x3e，然后再返回anonymous2，\x3cstrong\x3e请注意这个立即执行函数被执行的次数，10次\x3c\/strong\x3e，再来看看这句话\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e执行环境和变量对象在\x3cstrong\x3e运行函数\x3c\/strong\x3e时生成\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e好的，那现在请回答我：\x3cbr\x3e\x3cstrong\x3e这里面生成了几个anonymous1的活动变量？\x3c\/strong\x3e\x3cbr\x3eanswer：当然也是10个，\x3cbr\x3e\x3cstrong\x3e那每个anonymous1活动变量中存贮的num值是多少？\x3c\/strong\x3e\x3cbr\x3eanswer：看anonymous函数return的时候可以知道，存贮的num值就是每次传入的i值，也就是0-9\x3c\/p\x3e\n\x3cp\x3e好了，那现在很明了了，这样的写法其实相当于，\x3cstrong\x3e把每次的i值都保存在一个anonymous1活动变量钟，给最内层的anonymous2函数使用\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e小结\x3c\/h2\x3e\n\x3cp\x3e写到这里，关于闭包的主要特征和辨别方式已经基本讲到了，个人感觉因为这个问题比较抽象，还是多看看文中以及网上的一些例子，加深理解。以上内容属于个人见解，如果有不同意见，欢迎指出和探讨。希望能对看到的人有所帮助，同时，码字不易(尤其是还要配上灵魂画师级别的配图~)，请尊重作者的版权，转载请注明出处，如作商用，请与作者联系，感谢！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>详解js中的闭包</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007376061">https://segmentfault.com/a/1190000007376061</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/wzqyoqno6ua/" target="_blank">https://alili.tech/archive/wzqyoqno6ua/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/z09muaar7j/">2年前端应该会哪些技能<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/ke982v6qrfg/">CSS 性能优化笔记<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/if1i2hs28ah/">H5打造3d场景不完全攻略（二）: Amazing CSS3D<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/s4apghsr7o/">JS原生一步步实现前端路由和单页面应用<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/hjgkntbgqek/">JavaScript 中对大量数据的多重过滤<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/h1hfvr2a2nj/">JavaScript 中的错误处理机制<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/a0ukpm125gm/">JavaScript 数组分组的实现<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/fwosouhbhmj/">JavaScript 类型转换深度学习<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/z193p9xv2p/">JavaScript设计模式之发布-订阅模式（观察者模式）-Part1<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/6i7sr0vgkxm/">Javascript中的时间<aside class="dates">2019-02-01</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>