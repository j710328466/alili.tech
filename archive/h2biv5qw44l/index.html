<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用 Ansible Container 构建和测试应用程序"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用 Ansible Container 构建和测试应用程序 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/h2biv5qw44l/",
				"appid": "1613049289050283", 
				"title": "使用 Ansible Container 构建和测试应用程序 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-22T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/1w7qa5sehp/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/dmbc9wijdz9/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f&text=%e4%bd%bf%e7%94%a8%20Ansible%20Container%20%e6%9e%84%e5%bb%ba%e5%92%8c%e6%b5%8b%e8%af%95%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f&text=%e4%bd%bf%e7%94%a8%20Ansible%20Container%20%e6%9e%84%e5%bb%ba%e5%92%8c%e6%b5%8b%e8%af%95%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f&title=%e4%bd%bf%e7%94%a8%20Ansible%20Container%20%e6%9e%84%e5%bb%ba%e5%92%8c%e6%b5%8b%e8%af%95%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f&is_video=false&description=%e4%bd%bf%e7%94%a8%20Ansible%20Container%20%e6%9e%84%e5%bb%ba%e5%92%8c%e6%b5%8b%e8%af%95%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8%20Ansible%20Container%20%e6%9e%84%e5%bb%ba%e5%92%8c%e6%b5%8b%e8%af%95%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f&title=%e4%bd%bf%e7%94%a8%20Ansible%20Container%20%e6%9e%84%e5%bb%ba%e5%92%8c%e6%b5%8b%e8%af%95%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f&title=%e4%bd%bf%e7%94%a8%20Ansible%20Container%20%e6%9e%84%e5%bb%ba%e5%92%8c%e6%b5%8b%e8%af%95%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f&title=%e4%bd%bf%e7%94%a8%20Ansible%20Container%20%e6%9e%84%e5%bb%ba%e5%92%8c%e6%b5%8b%e8%af%95%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fh2biv5qw44l%2f&title=%e4%bd%bf%e7%94%a8%20Ansible%20Container%20%e6%9e%84%e5%bb%ba%e5%92%8c%e6%b5%8b%e8%af%95%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用 Ansible Container 构建和测试应用程序</h1><div class="meta"><div class="postdate"><time datetime="2019-01-22" itemprop="datePublished">2019-01-22</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3ch1\x3e\x3ca href=\x22#使用-ansible-container-构建和测试应用程序\x22\x3e\x3c\/a\x3e使用 Ansible Container 构建和测试应用程序\x3c\/h1\x3e\n\x3cp\x3e容器是一个日益流行的开发环境。作为一名开发人员，你可以选择多种工具来管理你的容器。本文将向你介绍 Ansible Container，并展示如何在类似生产环境中运行和测试你的应用程序。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#入门\x22\x3e\x3c\/a\x3e入门\x3c\/h3\x3e\n\x3cp\x3e这个例子使用了一个简单的 Flask Hello World 程序。这个程序就像在生产环境中一样由 Apache HTTP 服务器提供服务。首先，安装必要的 \x3ccode\x3edocker\x3c\/code\x3e 包：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs cmake\x22\x3esudo dnf \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e docker\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3eAnsible Container 需要通过本地套接字与 Docker 服务进行通信。以下命令将更改套接字所有者，并将你添加到可访问此套接字的 \x3ccode\x3edocker\x3c\/code\x3e 用户组：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs nginx\x22\x3e\x3cspan class=\x22hljs-attribute\x22\x3esudo\x3c\/span\x3e groupadd docker \x26amp;\x26amp; sudo gpasswd -a \x3cspan class=\x22hljs-variable\x22\x3e$USER\x3c\/span\x3e docker\nMYGRP=$(id -g) ; \x3cspan class=\x22hljs-attribute\x22\x3enewgrp\x3c\/span\x3e docker ; \x3cspan class=\x22hljs-attribute\x22\x3enewgrp\x3c\/span\x3e \x3cspan class=\x22hljs-variable\x22\x3e$MYGRP\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e运行 \x3ccode\x3eid\x3c\/code\x3e 命令以确保 \x3ccode\x3edocker\x3c\/code\x3e 组在你的组成员中列出。最后，\x3ca href=\x22https:\/\/fedoramagazine.org\/howto-use-sudo\/\x22\x3e使用 sudo\x3c\/a\x3e 启用并启动 docker 服务：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3esudo systemctl enable docker\x3cspan class=\x22hljs-selector-class\x22\x3e.service\x3c\/span\x3e\nsudo systemctl start docker\x3cspan class=\x22hljs-selector-class\x22\x3e.service\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e\x3ca href=\x22#设置-ansible-container\x22\x3e\x3c\/a\x3e设置 Ansible Container\x3c\/h3\x3e\n\x3cp\x3eAnsible Container 使你能够构建容器镜像并使用 Ansible playbook 进行编排。该程序在一个 YAML 文件中描述，而不是使用 Dockerfile，列出组成容器镜像的 Ansible 角色。\x3c\/p\x3e\n\x3cp\x3e不幸的是，Ansible Container 在 Fedora 中没有 RPM 包可用。要安装它，请使用 python3 虚拟环境模块。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs inform7\x22\x3emkdir ansible-\x3cspan class=\x22hljs-keyword\x22\x3econtainer\x3c\/span\x3e-flask-example\ncd ansible-\x3cspan class=\x22hljs-keyword\x22\x3econtainer\x3c\/span\x3e-flask-example\npython3 -m venv .venv\nsource .venv\/bin\/activate\npip install ansible-\x3cspan class=\x22hljs-keyword\x22\x3econtainer\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e[docker]\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这些命令将安装 Ansible Container 及 Docker 引擎。 Ansible Container 提供三种引擎：Docker、Kubernetes 和 Openshift。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#设置项目\x22\x3e\x3c\/a\x3e设置项目\x3c\/h3\x3e\n\x3cp\x3e现在已经安装了 Ansible Container，接着设置这个项目。Ansible Container 提供了一个简单的命令来创建启动所需的所有文件：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs axapta\x22\x3eansible-\x3cspan class=\x22hljs-keyword\x22\x3econtainer\x3c\/span\x3e init\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e来看看这个命令在当前目录中创建的文件：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ccode\x3eansible.cfg\x3c\/code\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3eansible-requirements.txt\x3c\/code\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3econtainer.yml\x3c\/code\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3emeta.yml\x3c\/code\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ccode\x3erequirements.yml\x3c\/code\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e该项目仅使用 \x3ccode\x3econtainer.yml\x3c\/code\x3e 来描述程序服务。有关其他文件的更多信息，请查看 Ansible Container 的\x3ca href=\x22https:\/\/docs.ansible.com\/ansible-container\/getting_started.html\x22\x3e入门\x3c\/a\x3e文档。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#定义容器\x22\x3e\x3c\/a\x3e定义容器\x3c\/h3\x3e\n\x3cp\x3e如下更新 \x3ccode\x3econtainer.yml\x3c\/code\x3e：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs yaml\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3eversion:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x222\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3esettings:\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e  conductor:\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e# The Conductor container does the heavy lifting, and provides a portable\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e# Python runtime for building your target containers. It should be derived\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e# from the same distribution as you\x27re building your target containers with.\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    base:\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3efedora:26\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e# roles_path:   # Specify a local path containing Ansible roles\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e# volumes:      # Provide a list of volumes to mount\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e# environment:  # List or mapping of environment variables\x3c\/span\x3e\n\n  \x3cspan class=\x22hljs-comment\x22\x3e# Set the name of the project. Defaults to basename of the project directory.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# For built services, concatenated with service name to form the built image name.\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e  project_name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eflask-helloworld\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-attr\x22\x3eservices:\x3c\/span\x3e \n  \x3cspan class=\x22hljs-comment\x22\x3e# Add your containers here, specifying the base image you want to build from.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# To use this example, uncomment it and delete the curly braces after services key.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e# You may need to run `docker pull ubuntu:trusty` for this to work.\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e  web:\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    from:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22fedora:26\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    roles:\x3c\/span\x3e \n\x3cspan class=\x22hljs-bullet\x22\x3e      -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ebase\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    ports:\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e      -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x225000:80\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    command:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[\x22\/usr\/bin\/dumb-init\x22,\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22httpd\x22\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22-DFOREGROUND\x22\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e]\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    volumes:\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e      -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e$PWD\/flask-helloworld:\/flaskapp:Z\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ccode\x3econductor\x3c\/code\x3e 部分更新了基本设置以使用 Fedora 26 容器基础镜像。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eservices\x3c\/code\x3e 部分添加了 \x3ccode\x3eweb\x3c\/code\x3e 服务。这个服务使用 Fedora 26，后面有一个名为 \x3ccode\x3ebase\x3c\/code\x3e 的角色。它还设置容器和主机之间的端口映射。Apache HTTP 服务器为容器的端口 80 上的 Flask 程序提供服务，该容器重定向到主机的端口 5000。然后这个文件定义了一个卷，它将 Flask 程序源代码挂载到容器中的 \x3ccode\x3e\/flaskapp\x3c\/code\x3e 中。\x3c\/p\x3e\n\x3cp\x3e最后，容器启动时运行 \x3ccode\x3ecommand\x3c\/code\x3e 配置。这个例子中使用 \x3ca href=\x22https:\/\/github.com\/Yelp\/dumb-init\x22\x3edumb-init\x3c\/a\x3e，一个简单的进程管理器并初始化系统启动 Apache HTTP 服务器。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#ansible-角色\x22\x3e\x3c\/a\x3eAnsible 角色\x3c\/h3\x3e\n\x3cp\x3e现在已经设置完了容器，创建一个 Ansible 角色来安装并配置 Flask 程序所需的依赖关系。首先，创建 \x3ccode\x3ebase\x3c\/code\x3e 角色。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3emkdir -\x3cspan class=\x22hljs-selector-tag\x22\x3ep\x3c\/span\x3e roles\/base\/tasks\ntouch roles\/base\/tasks\/main\x3cspan class=\x22hljs-selector-class\x22\x3e.yml\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在编辑 \x3ccode\x3emain.yml\x3c\/code\x3e ，它看起来像这样：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs yaml\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e---\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e- name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eInstall\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3edependencies\x3c\/span\x3e \n\x3cspan class=\x22hljs-attr\x22\x3e  dnf:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3epkg=\x22{{\x22item\x22}}\x22\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3estate=present\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e  with_items:\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e    -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3epython3-flask\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e    -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3edumb-init\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e    -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttpd\x3c\/span\x3e\n\x3cspan class=\x22hljs-bullet\x22\x3e    -\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3epython3-mod_wsgi\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-attr\x22\x3e- name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ecopy\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ethe\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eapache\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3econfiguration\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e  copy:\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    src:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eflask-helloworld.conf\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    dest:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\/etc\/httpd\/conf.d\/flask-helloworld.conf\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    owner:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eapache\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    group:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eroot\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e    mode:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e655\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这个 Ansible 角色是简单的。首先它安装依赖关系。然后，复制 Apache HTTP 服务器配置。如果你对 Ansible 角色不熟悉，请查看\x3ca href=\x22http:\/\/docs.ansible.com\/ansible\/latest\/playbooks_reuse_roles.html\x22\x3e角色文档\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#apache-http-配置\x22\x3e\x3c\/a\x3eApache HTTP 配置\x3c\/h3\x3e\n\x3cp\x3e接下来，通过创建 \x3ccode\x3eflask-helloworld.conf\x3c\/code\x3e 来配置 Apache HTTP 服务器：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs gams\x22\x3e\x3cspan class=\x22hljs-symbol\x22\x3e$\x3c\/span\x3e mkdir -p roles\/base\/\x3cspan class=\x22hljs-keyword\x22\x3efiles\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e$\x3c\/span\x3e touch roles\/base\/\x3cspan class=\x22hljs-keyword\x22\x3efiles\x3c\/span\x3e\/flask-helloworld.conf\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e最后将以下内容添加到文件中：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs apache\x22\x3e\x3cspan class=\x22hljs-section\x22\x3e\x26lt;VirtualHost *\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-attribute\x22\x3e\x3cspan class=\x22hljs-nomarkup\x22\x3eServerName\x3c\/span\x3e\x3c\/span\x3e example.com\n\n    \x3cspan class=\x22hljs-attribute\x22\x3eWSGIDaemonProcess\x3c\/span\x3e hello_world user=apache group=root\n    \x3cspan class=\x22hljs-attribute\x22\x3eWSGIScriptAlias\x3c\/span\x3e \/ \/flaskapp\/flask-helloworld.wsgi\n\n    \x3cspan class=\x22hljs-section\x22\x3e\x26lt;Directory \/flaskapp\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-attribute\x22\x3eWSGIProcessGroup\x3c\/span\x3e hello_world\n        \x3cspan class=\x22hljs-attribute\x22\x3eWSGIApplicationGroup\x3c\/span\x3e \x3cspan class=\x22hljs-variable\x22\x3e%{GLOBAL}\x3c\/span\x3e\n    \x3cspan class=\x22hljs-attribute\x22\x3eRequire\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3eall\x3c\/span\x3e granted\n    \x3cspan class=\x22hljs-section\x22\x3e\x26lt;\/Directory\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3e\x26lt;\/VirtualHost\x26gt;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这个文件的重要部分是 \x3ccode\x3eWSGIScriptAlias\x3c\/code\x3e。该指令将脚本 \x3ccode\x3eflask-helloworld.wsgi\x3c\/code\x3e 映射到 \x3ccode\x3e\/\x3c\/code\x3e。有关 Apache HTTP 服务器和 mod_wsgi 的更多详细信息，请阅读 \x3ca href=\x22http:\/\/flask.pocoo.org\/docs\/0.12\/deploying\/mod_wsgi\/\x22\x3eFlask 文档\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#flask-hello-world\x22\x3e\x3c\/a\x3eFlask “hello world”\x3c\/h3\x3e\n\x3cp\x3e最后，创建一个简单的 Flask 程序和 \x3ccode\x3eflask-helloworld.wsgi\x3c\/code\x3e 脚本。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3emkdir flask-helloworld\ntouch flask-helloworld\/app\x3cspan class=\x22hljs-selector-class\x22\x3e.py\x3c\/span\x3e\ntouch flask-helloworld\/flask-helloworld\x3cspan class=\x22hljs-selector-class\x22\x3e.wsgi\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e将以下内容添加到 \x3ccode\x3eapp.py\x3c\/code\x3e：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs python\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e flask \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Flask\napp = Flask(__name__)\n\n\x3cspan class=\x22hljs-meta\x22\x3e@app.route(\x22\/\x22)\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3edef\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehello\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e:\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22Hello World!\x22\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e然后编辑 \x3ccode\x3eflask-helloworld.wsgi\x3c\/code\x3e ，添加这个：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs xl\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e sys\nsys.\x3cspan class=\x22hljs-built_in\x22\x3epath\x3c\/span\x3e.insert(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\/flaskapp\/\x27\x3c\/span\x3e)\n\nfrom app \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e app \x3cspan class=\x22hljs-keyword\x22\x3eas\x3c\/span\x3e application\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e\x3ca href=\x22#构建并运行\x22\x3e\x3c\/a\x3e构建并运行\x3c\/h3\x3e\n\x3cp\x3e现在是时候使用 \x3ccode\x3eansible-container build\x3c\/code\x3e 和 \x3ccode\x3eansible-container run\x3c\/code\x3e 命令来构建和运行容器。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs armasm\x22\x3e\x3cspan class=\x22hljs-symbol\x22\x3eansible\x3c\/span\x3e-container \x3cspan class=\x22hljs-keyword\x22\x3ebuild\n\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这个命令需要一些时间来完成，所以要耐心等待。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs dockerfile\x22\x3eansible-container \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e\n\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e你现在可以通过以下 URL 访问你的 flask 程序： \x3ca href=\x22http:\/\/localhost:5000\/\x22\x3ehttp:\/\/localhost:5000\/\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#结论\x22\x3e\x3c\/a\x3e结论\x3c\/h3\x3e\n\x3cp\x3e你现在已经看到如何使用 Ansible Container 来管理、构建和配置在容器中运行的程序。本例的所有配置文件和源代码在 \x3ca href=\x22https:\/\/pagure.io\/ansible-container-flask-example\x22\x3ePagure.io\x3c\/a\x3e 上。你可以使用此例作为基础来开始在项目中使用 Ansible Container。\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3evia: \x3ca href=\x22https:\/\/fedoramagazine.org\/build-test-applications-ansible-container\/\x22\x3ehttps:\/\/fedoramagazine.org\/build-test-applications-ansible-container\/\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e作者：\x3ca href=\x22https:\/\/fedoramagazine.org\/author\/cverna\/\x22\x3eClement Verna\x3c\/a\x3e 译者：\x3ca href=\x22https:\/\/github.com\/geekpi\x22\x3egeekpi\x3c\/a\x3e 校对：\x3ca href=\x22https:\/\/github.com\/wxy\x22\x3ewxy\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e本文由 \x3ca href=\x22https:\/\/github.com\/LCTT\/TranslateProject\x22\x3eLCTT\x3c\/a\x3e 原创编译，\x3ca href=\x22https:\/\/linux.cn\/\x22\x3eLinux中国\x3c\/a\x3e 荣誉推出\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>使用 Ansible Container 构建和测试应用程序</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/build-and-test-applications-with-ansible-container">https://www.zcfy.cc/article/build-and-test-applications-with-ansible-container</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/h2biv5qw44l/" target="_blank">https://alili.tech/archive/h2biv5qw44l/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/t42iv2yle7e/">2016-我的前端之路:工具化与工程化<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/xlhryjzdso/">2016年总结--成长<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/4wvjfeus9ur/">2016年末总结，我的前端之路<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/w7062tmcw3/">3D 视差效果<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/5jt1iw1t77b/">AlloyTouch实战--60行代码搞定QQ看点资料卡<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/kquf0fxkw2j/">ES6，你不得不学！<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/r5b6g4133jh/">Emmet-前端开发神器<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/5dbaikv4emi/">FreeCodeCamp中级算法题答案<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/iuyeljg6lm/">JSONP是什么<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/23ftsgrtzzc/">JS中的观察者模式(发布订阅)<aside class="dates">2019-01-29</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>