<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="用 Weex Vanilla 写 Todolist 的尝试"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>用 Weex Vanilla 写 Todolist 的尝试 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/b8n0atmlvzh/",
				"appid": "1613049289050283", 
				"title": "用 Weex Vanilla 写 Todolist 的尝试 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-18T02:30:35"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/82lp7j7ywmr/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/bg0lveo07vu/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f&text=%e7%94%a8%20Weex%20Vanilla%20%e5%86%99%20Todolist%20%e7%9a%84%e5%b0%9d%e8%af%95"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f&text=%e7%94%a8%20Weex%20Vanilla%20%e5%86%99%20Todolist%20%e7%9a%84%e5%b0%9d%e8%af%95"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f&title=%e7%94%a8%20Weex%20Vanilla%20%e5%86%99%20Todolist%20%e7%9a%84%e5%b0%9d%e8%af%95"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f&is_video=false&description=%e7%94%a8%20Weex%20Vanilla%20%e5%86%99%20Todolist%20%e7%9a%84%e5%b0%9d%e8%af%95"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e7%94%a8%20Weex%20Vanilla%20%e5%86%99%20Todolist%20%e7%9a%84%e5%b0%9d%e8%af%95&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f&title=%e7%94%a8%20Weex%20Vanilla%20%e5%86%99%20Todolist%20%e7%9a%84%e5%b0%9d%e8%af%95"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f&title=%e7%94%a8%20Weex%20Vanilla%20%e5%86%99%20Todolist%20%e7%9a%84%e5%b0%9d%e8%af%95"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f&title=%e7%94%a8%20Weex%20Vanilla%20%e5%86%99%20Todolist%20%e7%9a%84%e5%b0%9d%e8%af%95"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fb8n0atmlvzh%2f&title=%e7%94%a8%20Weex%20Vanilla%20%e5%86%99%20Todolist%20%e7%9a%84%e5%b0%9d%e8%af%95"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">用 Weex Vanilla 写 Todolist 的尝试</h1><div class="meta"><div class="postdate"><time datetime="2019-01-18" itemprop="datePublished">2019-01-18</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e关于如何在 Weex 上使用 Vanilla 代码写页面, 在前面有一篇文章已经介绍过了:\x3cbr\x3e\x3ca href=\x22https:\/\/hashnode.com\/post\/run-vanilla-javascript-hello-world-in-weex-ciy1dn0sp001s91533k6h8sc7\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/hashnode.com\/post\/run...\x3c\/a\x3e\x3cbr\x3e大致上, 可以参考这个 Demo, 其实就是一些 DOM 操作,\x3cbr\x3e\x3ca href=\x22https:\/\/github.com\/alibaba\/weex\/blob\/dev\/examples\/vanilla\/index.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/alibaba\/we...\x3c\/a\x3e\x3cbr\x3e所以我明确的一个事实是 Weex 确实有一套 DOM API,\x3cbr\x3e而且这套 API 应该说是所有基于 Weex 的框架的基础, 像 Weex, Rax, 甚至如果有 Angular 版本.\x3c\/p\x3e\n\x3cp\x3e在 Weex 仓库里可以看到目前有 4 个框架, 其中 Vanilla 对应没有框架,\x3cbr\x3e\x3ca href=\x22https:\/\/github.com\/apache\/incubator-weex\/blob\/master\/html5\/frameworks\/vanilla\/index.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/apache\/inc...\x3c\/a\x3e\x3cbr\x3e但实际上这个代码已经过时了, 比如后来的 \x3ccode\x3eweex\x3c\/code\x3e 全局变量没有的完成,\x3cbr\x3e所以为了方便我在本地开发, 我自己基于 Vue fork 了一个版本, 用来试验,\x3cbr\x3e\x3ca href=\x22https:\/\/gist.github.com\/jiyinyiyong\/39b8e319b7078dd613f7e5b0c7191369\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/gist.github.com\/jiyin...\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22jiyinyiyong\/39b8e319b7078dd613f7e5b0c7191369\x22 data-typeid=\x221\x22\x3e点击预览\x3c\/button\x3e\x3cbr\x3e试验项目可以从 GitHub 上看, 用单个文件生成的 Todolist:\x3cbr\x3e\x3ca href=\x22https:\/\/github.com\/mvc-works\/helical-weex\/blob\/master\/src\/helical.coffee\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/mvc-works\/...\x3c\/a\x3e\x3cbr\x3e最终的界面:\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22http:\/\/wx2.sinaimg.cn\/mw690\/62752320gy1fdp7sfbllcj20qo1bejsk.jpg\x22 src=\x22https:\/\/static.alili.techhttp:\/\/wx2.sinaimg.cn\/mw690\/62752320gy1fdp7sfbllcj20qo1bejsk.jpg\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在这个 Todolist 当中我实现了基本的增删改功能, 但明显确实一下功能:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e清除已读的任务\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e排序\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e没有做是因为太难实现了, 虽然也不是那么难, 但作为试验项目主要的目的吧,\x3cbr\x3e我主要还是未来试验 Weex 的 DOM API 能不能写出像样的页面,\x3cbr\x3e经过简单的封装, DOM 部分的写法在 CoffeeScript 里挺清晰的,\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\n# DOM tree\n\nmainTree = -\x3e\n  div style: styleBody,\n    div style: styleContainer,\n      div style: styleHeader,\n        input\n          ref: \x27input\x27\n          style: styleInput\n          attr: {value: \x27\x27, placeholder: \x27Some task...\x27}\n          event: {input: onDraft}\n        text\n          style: styleButton\n          attr: {value: \x27Add task\x27}\n          event: {click: onAdd}\n      text\n        ref: \x27raw\x27\n        attr: {value: getRaw()}\n        style: styleContent\n      div\n        ref: \x27content\x27\n        style: styleContent\n\n# mounting document\n\ndoc.documentElement.appendChild (helicalExpandTree mainTree())\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs yaml\x22\x3e\x3ccode class=\x22coffee\x22\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e# DOM tree\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-string\x22\x3emainTree\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e=\x3c\/span\x3e \x3cspan class=\x22hljs-bullet\x22\x3e-\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-string\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3estyleBody,\x3c\/span\x3e\n    \x3cspan class=\x22hljs-string\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3estyleContainer,\x3c\/span\x3e\n      \x3cspan class=\x22hljs-string\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3estyle:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3estyleHeader,\x3c\/span\x3e\n        \x3cspan class=\x22hljs-string\x22\x3einput\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e          ref:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27input\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e          style:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3estyleInput\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e          attr:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{value:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eplaceholder:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Some task...\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e          event:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{input:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eonDraft}\x3c\/span\x3e\n        \x3cspan class=\x22hljs-string\x22\x3etext\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e          style:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3estyleButton\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e          attr:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{value:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Add task\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e          event:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{click:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eonAdd}\x3c\/span\x3e\n      \x3cspan class=\x22hljs-string\x22\x3etext\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        ref:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27raw\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        attr:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{value:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3egetRaw()}\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        style:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3estyleContent\x3c\/span\x3e\n      \x3cspan class=\x22hljs-string\x22\x3ediv\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        ref:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27content\x27\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        style:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3estyleContent\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e# mounting document\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-string\x22\x3edoc.documentElement.appendChild\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e(helicalExpandTree\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3emainTree())\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e熟悉 DOM 操作的应该能脑补出我的代码来:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22helicalExpandTree = (tree) -\x3e\n  # console.log \x27\\n\\nExpanding:\x27, JSON.stringify(tree)\n  [name, props, children] = tree\n  element = doc.createElement name,\n    style: props.style\n    attr: props.attr\n  if props.event\n    for key, value of props.event\n      element.addEvent key, value\n  if children?\n    # console.log \x27CHILDREN:\x27, JSON.stringify(children)\n    for child in children\n      childElement = helicalExpandTree child\n      # console.log \x27\\n\\nChild to append:\x27, JSON.stringify(childElement)\n      element.appendChild childElement\n  if props.ref?\n    domRefs[props.ref] = element\n  element\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs maxima\x22\x3e\x3ccode class=\x22coffee\x22\x3ehelicalExpandTree = (tree) -\x26gt;\n  # console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e \x27\\n\\nExpanding:\x27, JSON.stringify(tree)\n  [name, \x3cspan class=\x22hljs-built_in\x22\x3eprops\x3c\/span\x3e, children] = tree\n  element = doc.createElement name,\n    \x3cspan class=\x22hljs-built_in\x22\x3estyle\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eprops\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3estyle\x3c\/span\x3e\n    attr: \x3cspan class=\x22hljs-built_in\x22\x3eprops\x3c\/span\x3e.attr\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eprops\x3c\/span\x3e.event\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e, value of \x3cspan class=\x22hljs-built_in\x22\x3eprops\x3c\/span\x3e.event\n      element.addEvent \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e, value\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e children?\n    # console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e \x27CHILDREN:\x27, JSON.stringify(children)\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e child \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e children\n      childElement = helicalExpandTree child\n      # console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e \x27\\n\\nChild to \x3cspan class=\x22hljs-built_in\x22\x3eappend\x3c\/span\x3e:\x27, JSON.stringify(childElement)\n      element.appendChild childElement\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eprops\x3c\/span\x3e.ref?\n    domRefs[\x3cspan class=\x22hljs-built_in\x22\x3eprops\x3c\/span\x3e.ref] = element\n  element\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后是事件处理, 这就有点问题了, 实际上有两个地方需要处理, Model 和 View,\x3cbr\x3e熟悉 jQuery 的同学应该就能猜到了, 需要通过 \x3ccode\x3eevent.target\x3c\/code\x3e 做 DOM 操作,\x3cbr\x3e两边都处理, 保证界面上没有出现状态不一致的情况, 当然写起来很啰嗦, 维护性差,\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22onRemove = (taskId) -\x3e (event) -\x3e\n  store.tasks = store.tasks.filter (task) -\x3e task.id isnt taskId\n  # DOM operations\n  taskElement = event.target.parentNode\n  taskElement.parentNode.removeChild taskElement\n  modifyRaw()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livescript\x22\x3e\x3ccode class=\x22coffee\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eonRemove\x3c\/span\x3e = \x3cspan class=\x22hljs-params\x22\x3e(taskId)\x3c\/span\x3e -\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(event)\x3c\/span\x3e -\x26gt;\x3c\/span\x3e\n  store.tasks = store.tasks.filter \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(task)\x3c\/span\x3e -\x26gt;\x3c\/span\x3e task.id \x3cspan class=\x22hljs-keyword\x22\x3eisnt\x3c\/span\x3e taskId\n  \x3cspan class=\x22hljs-comment\x22\x3e# DOM operations\x3c\/span\x3e\n  taskElement = event.target.parentNode\n  taskElement.parentNode.removeChild taskElement\n  modifyRaw()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果页面当中还有 Tab 的话, Tab 页之间的状态管理会让页面变得非常复杂,\x3cbr\x3e当然为了方便使用, 我模仿了 React 的 \x3ccode\x3eref\x3c\/code\x3e 写法用来指定 DOM 的特定引用,\x3cbr\x3e这样在小的页面当中也没有使用 jQuery 选择 DOM 节点的必要了.\x3cbr\x3e所以看上去整个页面还是可以跑通的, 虽然效果实在很奇怪.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nonAdd = (event) -\x3e\n  newTask = id: getId(), done: \x27false\x27, text: store.draft\n  store.draft = \x27\x27\n  store.tasks.unshift newTask\n  # DOM operations\n  console.log \x27DOM operations!!!\x27\n  domRefs.input.setAttr \x27value\x27, \x27\x27\n  newElement = helicalExpandTree (taskTree newTask)\n  console.log \x27\\nnewElement:\x27, newElement\n  domRefs.content.appendChild newElement\n  modifyRaw()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode class=\x22coffee\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\n\x3cspan class=\x22hljs-title\x22\x3eonAdd\x3c\/span\x3e = \x3cspan class=\x22hljs-params\x22\x3e(event)\x3c\/span\x3e -\x26gt;\x3c\/span\x3e\n  newTask = id: getId(), done: \x3cspan class=\x22hljs-string\x22\x3e\x27false\x27\x3c\/span\x3e, text: store.draft\n  store.draft = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n  store.tasks.unshift newTask\n  \x3cspan class=\x22hljs-comment\x22\x3e# DOM operations\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log \x3cspan class=\x22hljs-string\x22\x3e\x27DOM operations!!!\x27\x3c\/span\x3e\n  domRefs.input.setAttr \x3cspan class=\x22hljs-string\x22\x3e\x27value\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n  newElement = helicalExpandTree (taskTree newTask)\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log \x3cspan class=\x22hljs-string\x22\x3e\x27\\nnewElement:\x27\x3c\/span\x3e, newElement\n  domRefs.content.appendChild newElement\n  modifyRaw()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其实可以从这个试验反思一下 Vue React 这些东西在移动端是否合适,\x3cbr\x3e可以用这些框架主要是为了桌面平台的单页面 App 建造起来的,\x3cbr\x3e附带了各种状态管理, 组件化, DSL, 编程风格在里边, 以及各种开发工具,\x3cbr\x3e最主要的是声明式的写法确实提高了开发速度和组件的复用.\x3cbr\x3e不过手机上状态管理的没有桌面端复杂倒是, 未必需要 React 那么强的功能.\x3c\/p\x3e\n\x3cp\x3e手写 DOM 操作的方法基本上都是效率低下, 可维护性极差, 之类的,\x3cbr\x3e除非是为了写几乎静态的页面, 这种方案完全可以被扔进历史的废纸篓...\x3cbr\x3e不过也有一点好处, 就是没有太多抽象, 页面启动非常快, 提交很小.\x3cbr\x3e虽然 Weex 一直运行在一个 js runtime 中, 但初始化组件多多少少有一点开销.\x3cbr\x3e也许说是微乎其微... 但是从理论上而言, 启动过程需要执行的代码总是有区别的.\x3c\/p\x3e\n\x3cp\x3e当然总体上说这样写几乎没什么用, 只是证明 Native DOM API 能正常用:\x3cbr\x3e\x3ca href=\x22http:\/\/weex.apache.org\/references\/native-dom-api.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/weex.apache.org\/refere...\x3c\/a\x3e\x3cbr\x3e没有明确的观点, 只是换着思路想想写 Weex 遇到的一些问题...\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>用 Weex Vanilla 写 Todolist 的尝试</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008726905">https://segmentfault.com/a/1190000008726905</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/b8n0atmlvzh/" target="_blank">https://alili.tech/archive/b8n0atmlvzh/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5x6tenwjeux/">ES6中的异步编程：Generators函数&#43;Promise:最强大的异步处理方式<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/nvtmua2a1hd/">GreenSock (TweenMax) 极简入门指南<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/7kt5s47oysx/">HTML5 中 canvas 的使用总结<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/41pgo3a2iyp/">JavaScript 开发者所需要知道的 V8（一）：V8 In NodeJS<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/krb1zm7x38j/">JavaScript 时间与日期处理实战:你肯定被坑过<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/yh2lq30d0x/">JavaScript中的各种宽高属性<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/eydwczesyv/">Muse UI — 基于 Vue2.0 的 Material Design UI 库<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/y62oejm8cr/">Nodejs基础：路径处理模块path总结<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/06cwh88ankmd/">PhantomJS &amp; NodeJS 在京东网站前端监控平台的最佳实践<aside class="dates">2019-01-31</aside></a></li><li><a href="/archive/z4ymvs0jz2h/">Promise 的链式调用与中止<aside class="dates">2019-01-31</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>