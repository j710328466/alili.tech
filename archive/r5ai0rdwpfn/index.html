<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用 rsync 来备份 Linux 系统"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用 rsync 来备份 Linux 系统 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/r5ai0rdwpfn/",
				"appid": "1613049289050283", 
				"title": "使用 rsync 来备份 Linux 系统 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-23T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/m2tjjkmfg9/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/yvq945u8sz/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f&text=%e4%bd%bf%e7%94%a8%20rsync%20%e6%9d%a5%e5%a4%87%e4%bb%bd%20Linux%20%e7%b3%bb%e7%bb%9f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f&text=%e4%bd%bf%e7%94%a8%20rsync%20%e6%9d%a5%e5%a4%87%e4%bb%bd%20Linux%20%e7%b3%bb%e7%bb%9f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f&title=%e4%bd%bf%e7%94%a8%20rsync%20%e6%9d%a5%e5%a4%87%e4%bb%bd%20Linux%20%e7%b3%bb%e7%bb%9f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f&is_video=false&description=%e4%bd%bf%e7%94%a8%20rsync%20%e6%9d%a5%e5%a4%87%e4%bb%bd%20Linux%20%e7%b3%bb%e7%bb%9f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8%20rsync%20%e6%9d%a5%e5%a4%87%e4%bb%bd%20Linux%20%e7%b3%bb%e7%bb%9f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f&title=%e4%bd%bf%e7%94%a8%20rsync%20%e6%9d%a5%e5%a4%87%e4%bb%bd%20Linux%20%e7%b3%bb%e7%bb%9f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f&title=%e4%bd%bf%e7%94%a8%20rsync%20%e6%9d%a5%e5%a4%87%e4%bb%bd%20Linux%20%e7%b3%bb%e7%bb%9f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f&title=%e4%bd%bf%e7%94%a8%20rsync%20%e6%9d%a5%e5%a4%87%e4%bb%bd%20Linux%20%e7%b3%bb%e7%bb%9f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fr5ai0rdwpfn%2f&title=%e4%bd%bf%e7%94%a8%20rsync%20%e6%9d%a5%e5%a4%87%e4%bb%bd%20Linux%20%e7%b3%bb%e7%bb%9f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用 rsync 来备份 Linux 系统</h1><div class="meta"><div class="postdate"><time datetime="2019-01-23" itemprop="datePublished">2019-01-23</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3ch1\x3e\x3ca href=\x22#使用-rsync-来备份-linux-系统\x22\x3e\x3c\/a\x3e使用 rsync 来备份 Linux 系统\x3c\/h1\x3e\n\x3cblockquote\x3e\n\x3cp\x3e探索 rsync 在备份方案中的作用。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/camo.githubusercontent.com\/020fff079c955bc1b6f77da3d02b9dd9d1a9e0d5\/68747470733a2f2f6f70656e736f757263652e636f6d2f73697465732f64656661756c742f66696c65732f7374796c65732f696d6167652d66756c6c2d73697a652f7075626c69632f696d616765732f6c6966652f686172645f6472697665732e706e673f69746f6b3d795a577961534f36\x22\x3e\x3cimg src=\x22https:\/\/camo.githubusercontent.com\/020fff079c955bc1b6f77da3d02b9dd9d1a9e0d5\/68747470733a2f2f6f70656e736f757263652e636f6d2f73697465732f64656661756c742f66696c65732f7374796c65732f696d6167652d66756c6c2d73697a652f7075626c69632f696d616765732f6c6966652f686172645f6472697665732e706e673f69746f6b3d795a577961534f36\x22 alt=\x22Using rsync to back up your Linux system\x22 title=\x22Using rsync to back up your Linux system\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3eImage credits : \x3ca href=\x22https:\/\/www.flickr.com\/photos\/wwarby\/11644168395\x22\x3eWIlliam\x3c\/a\x3e\x3ca href=\x22https:\/\/www.flickr.com\/photos\/wwarby\/11644168395\x22\x3e Warby\x3c\/a\x3e. Modified by \x3ca href=\x22https:\/\/opensource.com\/users\/jason-baker\x22\x3eJason Baker\x3c\/a\x3e. Creative Commons \x3ca href=\x22https:\/\/creativecommons.org\/licenses\/by\/2.0\/\x22\x3eBY-SA 2.0\x3c\/a\x3e.\x3c\/p\x3e\n\x3cp\x3e在系统管理员的工作中备份无疑是一个重要的部分。当没有完整备份或者良好规划的备份和实施时，就可能或早或晚不可挽回地丢失重要的数据。\x3c\/p\x3e\n\x3cp\x3e所有公司，无论大小，都运营在数据之上。考虑到丢失业务数据造成的经济和业务损失，从最小的个人公司到最大的跨国企业，没有一个公司能在丢失大部分数据以后得以幸存。你的办公室可以通过保险赔偿重建，但是你的数据就不可能再恢复了。\x3c\/p\x3e\n\x3cp\x3e这里提到的丢失是指数据的完全损坏。而不是指数据被偷走，那是另一种灾难。我这里说的是数据被完全摧毁。\x3c\/p\x3e\n\x3cp\x3e即使你只是个人用户而不是一个企业，备份你自己的数据也是非常重要的，我有二十年来的个人财务数据和我现在已经关闭的企业的数据，以及大量的电子发票。也包括近年来我创作的大量不同类型的文档、报告和数据报表。我不想失去任何这些数据。\x3c\/p\x3e\n\x3cp\x3e所以备份是我数据长期安全的必要保障。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#备份软件选择\x22\x3e\x3c\/a\x3e备份软件选择\x3c\/h3\x3e\n\x3cp\x3e有许多软件可以执行备份。大多数 Linux 发行版提供至少一种开源的备份软件。同时也有许多商业备份软件，但是这些都不符合我的需求，所以我决定使用基础的 Linux 工具来进行备份。\x3c\/p\x3e\n\x3cp\x3e在我为 Open Source Yearbook 写的文章， \x3ca href=\x22https:\/\/opensource.com\/business\/15\/12\/best-couple-2015-tar-and-ssh\x22\x3e最佳搭档之 2015：tar 和 ssh\x3c\/a\x3e 中，我说明了昂贵的商业备份软件在设计实施可行的备份计划中并不是必要的。\x3c\/p\x3e\n\x3cp\x3e从去年开始我尝试了另一种选择， \x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Rsync\x22\x3ersync\x3c\/a\x3e 命令，它有许多我已经从中受益的有趣特性。我的主要需求是所创建的备份，用户不需要解压备份压缩包就能定位和恢复文件，以便节约创建备份的时间。\x3c\/p\x3e\n\x3cp\x3e这篇文章的目的只是为了说明 rsync 在我的备份方案中的作用。并不是 rsync 的全部能力或者它的各种适用场景的概览。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#rsync-命令\x22\x3e\x3c\/a\x3ersync 命令\x3c\/h3\x3e\n\x3cp\x3eAndrew Tridgell 和 Paul Mackerras 编写了 rsync ，首次发布于 1996 年。它的目标是向另一台电脑同步文件。你注意到了他们为什么取这个名字了吗（remotely synchronize）？它是大多数发行版都提供的开源软件。\x3c\/p\x3e\n\x3cp\x3ersync 能够用于同步两个目录或目录树，无论它们是在同一个计算机上还是不同的计算机上，而且不仅如此，它还能做到更多。它创建或者更新的目录与源目录完全一样。新的目录不是以 tar 或 zip 等打包存储，而是普通的目录和文件，常见的 Linux 工具都能轻松访问，而这正是我所需要的。\x3c\/p\x3e\n\x3cp\x3ersync 的最重要的特性之一是它处理源目录被修改的已有文件的方式。它使用分块校验来比较源文件和目标文件，而不是从源把整个文件复制过去。如果两个文件所有块的校验和都相同，那么就不用传输数据。否则只有被改变的块被传输。这样节约了远程同步消耗的大量时间和带宽。比如，我第一次使用 rsync 脚本来把我所有的主机备份到一个外接的大型 usb 硬盘上需要三个小时，因为所有的数据都需要传输过去。而接下来的备份需要的时间就只是 3 到 8 分钟，这取决于上次备份以来创建和改变了多少文件。我使用 \x3ccode\x3etime\x3c\/code\x3e 命令来记录实际花费的时间。昨天晚上，我只花了三分钟来从六个远程系统和本地工作站备份大概 750 Gb 数据。实际上只有在白天改变的几百 Mb 数据需要备份。\x3c\/p\x3e\n\x3cp\x3e下面的命令可以用来同步两个目录及其任意子目录的内容。也就是说，在新目录的内容和源目录同步完之后，它们的内容完全一样。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs ebnf\x22\x3e\x3cspan class=\x22hljs-attribute\x22\x3ersync -aH sourcedir targetdir\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ccode\x3e-a\x3c\/code\x3e 选项表示归档模式，它会保持权限、所有关系和符号（软）链接。\x3ccode\x3e-H\x3c\/code\x3e 选项用来保持硬链接。注意源目录和目标目录都可以在远程主机上。\x3c\/p\x3e\n\x3cp\x3e假设昨天我们使用 rsync 同步了两个目录。今天我们想再同步一次，但是我们从源目录删除了一些文件。rsync 默认只复制新的和改变过的文件到新目录里，而不去改变新目录里被我们删除的文件，但是如果你想让那些在源目录里被删除的文件在新目录里也被删除，那么你可以加上 \x3ccode\x3e--delete\x3c\/code\x3e 选项来删除。\x3c\/p\x3e\n\x3cp\x3e另一个有趣的选项，也是我个人最喜欢的选项是 \x3ccode\x3e--link-dest\x3c\/code\x3e，因为它极大地增加了 rsync 的能力和灵活性。\x3ccode\x3e--link-dest\x3c\/code\x3e 使每日备份只花费很少的额外空间和很短的时间。\x3c\/p\x3e\n\x3cp\x3e用这个选项指定前一天的备份目录，以及今天的备份目录，然后 rsync 会创建今天的新备份目录，并将昨天备份目录里的每一个文件在今天的备份目录中创建硬链接。现在我们在今天的备份目录中有一大堆指向昨天备份的硬链接。文件没有被重复创建，而是创建了一些硬链接。对于\x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Hard_link\x22\x3e硬链接\x3c\/a\x3e，在 Wikipedia 中有非常详细的描述。而在用昨天的备份目录文件的硬链接创建了今天的备份之后，rsync 和平常一样进行备份，如果在文件中检测到了变化，就不会做硬链接，而是从昨天的备份目录里做一个文件的副本，再把源文件中变化的部分复制过去。（LCTT 译注：此处疑似原文表述不清，参见 \x3ccode\x3egenerator.c\x3c\/code\x3e 的 \x3ccode\x3etry_dests_reg\x3c\/code\x3e 函数先根据 \x3ccode\x3ematch_level\x3c\/code\x3e 选择复制或者硬链接，而不是创建硬链接后再判断 \x3ccode\x3ematch_level\x3c\/code\x3e）\x3c\/p\x3e\n\x3cp\x3e现在我们的命令类似于下面这样。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3ersync\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eaH\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3edelete\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3elink\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3edest=yesterdaystargetdir\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3esourcedir\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3etodaystargetdir\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e你也可能想要排除一些不想要备份的目录或者文件。那么就可以使用 \x3ccode\x3e--exclude\x3c\/code\x3e 选项。用这个选项加上你想排除文件或目录的模式。你可以用下面的新命令来排除浏览器的缓存。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3ersync\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eaH\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3edelete\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eexclude\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3eCache\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3elink\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3edest=yesterdaystargetdir\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3esourcedir\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3etodaystargetdir\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e注意：你想排除的每一个文件的模式前面都分别需要加上 \x3ccode\x3e--exclude\x3c\/code\x3e 选项。\x3c\/p\x3e\n\x3cp\x3ersync 可以同步远程主机，无论是作为同步源头还是目标。再举一个例子，我们假设想要把名为 remote1 的远程主机的目录同步到本地。因为 ssh 作为与远程主机交换数据的默认协议，我一直使用 ssh 选项。现在命令类似于下面这样。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs brainfuck\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3ersync\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eaH\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3ee\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3essh\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3edelete\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3eexclude\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3eCache\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3elink\x3c\/span\x3e\x3cspan class=\x22hljs-literal\x22\x3e-\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3edest=yesterdaystargetdir\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3eremote1:sourcedir\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3etodaystargetdir\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这就是我的 rsync 备份命令的最终版本。\x3c\/p\x3e\n\x3cp\x3e你可以依靠 rsync 的大量选项来定制你的同步过程。大多数情况而言，我刚刚描述的简单命令就足以胜任我的个人需要。你可以阅读 rsync 丰富的文档来了解它的其他能力。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#部署备份\x22\x3e\x3c\/a\x3e部署备份\x3c\/h3\x3e\n\x3cp\x3e我的备份自动运行因为—“万物皆可自动化”。我写了一个 BASH 脚本使用 rsync 创建每天的备份。包括确保备份介质被挂载，生成每天的备份目录的名字，以及在备份介质中创建合适的目录结构，最后执行真正的备份再卸载备份介质。\x3c\/p\x3e\n\x3cp\x3e我用 cron 每天早晨执行脚本确保我永远不会忘记备份。\x3c\/p\x3e\n\x3cp\x3e我的脚本 rsbu 和配置文件 rsbu.conf 可以在 \x3ca href=\x22https:\/\/github.com\/opensourceway\/rsync-backup-script\x22\x3ehttps:\/\/github.com\/opensourceway\/rsync-backup-script\x3c\/a\x3e 上获取。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#恢复测试\x22\x3e\x3c\/a\x3e恢复测试\x3c\/h3\x3e\n\x3cp\x3e所有没有经过测试的备份计划都不完整的。你可以通过测试恢复某个文件或者整个目录，以确保备份在照常工作并且可以通过它来在数据全部丢失后恢复。我见过太多备份由于种种理由失败，以及由于缺乏测试忽略的问题导致宝贵的数据被丢失。\x3c\/p\x3e\n\x3cp\x3e选择一个文件恢复到比如 \x3ccode\x3e\/tmp\x3c\/code\x3e 的测试目录，这样你就不会覆盖任何备份后被更新的文件。验证文件的内容是否是你预期的。恢复用 rsync 备份的文件仅仅只是找到你的备份文件然后把它复制到你想恢复的地方去那样简单。\x3c\/p\x3e\n\x3cp\x3e我有几次不得不恢复我的个人文件，偶尔是整个目录。大多数是自己意外删除了文件或者目录。有几次是因为硬盘崩溃。这些备份迟早会派上用场。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#最后一步\x22\x3e\x3c\/a\x3e最后一步\x3c\/h3\x3e\n\x3cp\x3e但仅仅创建备份并不能拯救你的业务，你需要定期的地创建备份，使最近的一次备份储存在另一台远程机器上，如果有可能，放在另外一个建筑物中或几英里之外。这样可以确保大规模的灾难不会摧毁你的所有备份。\x3c\/p\x3e\n\x3cp\x3e对于小型企业的一个合理选择是在可移动介质上做每日备份，晚上把最新的备份带回家里，第二天早上把更早的备份带到办公室。你就会有几个轮流的拷贝。甚至可以把最新的备份带到银行并放到你的保管箱里，然后带回之前的备份。\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e作者简介：\x3c\/p\x3e\n\x3cp\x3eDavid Both - 他居住在北卡罗来纳州的罗列，是 Linux 和开源提倡者。他已经从事 IT 行业 40 多年。在 IBM 教授了二十多年 OS\/2。在 IBM 的时候，他在 1981 年为最初的 IBM 个人电脑编写了第一门培训课程。他为红帽教授 RHCE 课程，并曾在世通公司、思科、北卡罗来纳州政府工作。他使用 Linux 和开源软件已经有二十年左右了。\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3evia: \x3ca href=\x22https:\/\/opensource.com\/article\/17\/1\/rsync-backup-linux\x22\x3ehttps:\/\/opensource.com\/article\/17\/1\/rsync-backup-linux\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e作者：\x3ca href=\x22https:\/\/opensource.com\/users\/dboth\x22\x3eDavid Both\x3c\/a\x3e 译者：\x3ca href=\x22https:\/\/github.com\/trnhoe\x22\x3etrnhoe\x3c\/a\x3e 校对：\x3ca href=\x22https:\/\/github.com\/wxy\x22\x3ewxy\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e本文由 \x3ca href=\x22https:\/\/github.com\/LCTT\/TranslateProject\x22\x3eLCTT\x3c\/a\x3e 原创编译，\x3ca href=\x22https:\/\/linux.cn\/\x22\x3eLinux中国\x3c\/a\x3e 荣誉推出\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>使用 rsync 来备份 Linux 系统</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/using-rsync-to-back-up-your-linux-system">https://www.zcfy.cc/article/using-rsync-to-back-up-your-linux-system</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/r5ai0rdwpfn/" target="_blank">https://alili.tech/archive/r5ai0rdwpfn/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5328xogjarn/">IndexedDB--HTML5本地存储<aside class="dates">2019-01-28</aside></a></li><li><a href="/archive/xpccu0hsqbr/">JS学习系列 01 - 编译原理和作用域<aside class="dates">2019-01-28</aside></a></li><li><a href="/archive/shv09bbtbfd/">Vue2 SSR 的优化之旅<aside class="dates">2019-01-28</aside></a></li><li><a href="/archive/5vj1ojfo6h6/">[2016年末巨献] — HTML5可交互地铁线路图（第二季：帝都进阶版）<aside class="dates">2019-01-28</aside></a></li><li><a href="/archive/m02hlm4bzh/">vue2.0开发聊天程序（三）组件的通信<aside class="dates">2019-01-28</aside></a></li><li><a href="/archive/mz5o7n90plg/">《很高兴我没有猝死》- 前端新人的 2016 年总结和感悟<aside class="dates">2019-01-28</aside></a></li><li><a href="/archive/3vhoe2mo09k/">一道颇有难度的JavaScript题<aside class="dates">2019-01-28</aside></a></li><li><a href="/archive/uj12mb7thp/">使用CANVAS实现交互性圆形马赛克效果<aside class="dates">2019-01-28</aside></a></li><li><a href="/archive/ja636h8hcxa/">写于 2016 年末<aside class="dates">2019-01-28</aside></a></li><li><a href="/archive/5uomnoq1kmi/">前端学习资源整理<aside class="dates">2019-01-28</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>