<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="如何在真实世界构建你的Mobx应用程序"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>如何在真实世界构建你的Mobx应用程序 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/7aff5og0w3i/",
				"appid": "1613049289050283", 
				"title": "如何在真实世界构建你的Mobx应用程序 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-25T02:30:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ecs5d93zvxb/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/33bwh8tq75q/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f&text=%e5%a6%82%e4%bd%95%e5%9c%a8%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e6%9e%84%e5%bb%ba%e4%bd%a0%e7%9a%84Mobx%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f&text=%e5%a6%82%e4%bd%95%e5%9c%a8%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e6%9e%84%e5%bb%ba%e4%bd%a0%e7%9a%84Mobx%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e6%9e%84%e5%bb%ba%e4%bd%a0%e7%9a%84Mobx%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f&is_video=false&description=%e5%a6%82%e4%bd%95%e5%9c%a8%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e6%9e%84%e5%bb%ba%e4%bd%a0%e7%9a%84Mobx%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%a6%82%e4%bd%95%e5%9c%a8%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e6%9e%84%e5%bb%ba%e4%bd%a0%e7%9a%84Mobx%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e6%9e%84%e5%bb%ba%e4%bd%a0%e7%9a%84Mobx%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e6%9e%84%e5%bb%ba%e4%bd%a0%e7%9a%84Mobx%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e6%9e%84%e5%bb%ba%e4%bd%a0%e7%9a%84Mobx%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f7aff5og0w3i%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%e7%9c%9f%e5%ae%9e%e4%b8%96%e7%95%8c%e6%9e%84%e5%bb%ba%e4%bd%a0%e7%9a%84Mobx%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">如何在真实世界构建你的Mobx应用程序</h1><div class="meta"><div class="postdate"><time datetime="2019-01-25" itemprop="datePublished">2019-01-25</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3cp\x3e本文是受到\x3ca href=\x22https:\/\/medium.com\/@mweststrate\x22\x3e@mwestrase\x3c\/a\x3e许多文章的启发， 以及经过几个星期将一个大型的Backbone应用程序重构为React \x2b MobX应用程序，是\x3ca href=\x22https:\/\/swizec.com\/blog\/livecoding-25-adding-mobx-vanilla-react-project\/swizec\/7170\x22\x3e将Mobx添加到一个普通的React项目\x3c\/a\x3e的“衣钵传人”。 或许这不是构建Mobx应用程序的_ 最佳方式_ ，但这种方式到目前为止一直在我的项目中很好的运作。\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t0173a460123de2d3b6.jpg\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e设计本架构的目标是：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e样板最小化\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e使应用程序成为一个状态机\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e灵活移动元素\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我们将通过React上下文和MobX的出色的\x3ccode\x3einject\x3c\/code\x3e函数来实现样板最小化。这样的组合使数据集无需进行任何接线和props传递就可以在应用程序的任何地方使用。 如果组件需要访问状态机， 注入到store中。\x3c\/p\x3e\n\x3cp\x3e你的UI设计师大可以根据其想法重新调整页面，而你所要做的只是更改组件的位置。 除非业务逻辑本身改变，否则不需要重新接线业务逻辑。 对我而言，这曾经是React的一个难题。 使用这种方法，你的组件变得真正独立，你可以做任何你想要的。\x3c\/p\x3e\n\x3cp\x3e这非常有趣，我甚至为此早早来上班！ 如果你了解我，你会知道我有多喜欢过属于自己的早晨。\x3c\/p\x3e\n\x3ch2\x3e这是如何完成的\x3c\/h2\x3e\n\x3cp\x3e通过上下文和注入给了我们灵活性，并消除样板。 那么状态机呢？\x3c\/p\x3e\n\x3cp\x3e我们把MobX的store视为应用程序中的唯一真实来源，并且我们将把actions置于其中。通过actions改变状态，并可以在任何地方调用。将它们放在store中以减少样板，并确保所有组件都可以访问它们，这会让你可以把整个状态机看成一个单文件。\x3c\/p\x3e\n\x3cp\x3e这也会使你的应用程序更容易测试。 如果你的状态机工作正常，那么就一切正常。 这是因为：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e在严格模式下MobX保证状态只会在actions中改变\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eReact保证DOM是一个纯粹的状态表达式\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e是的，MobX运作通过可变状态，改变观察者以及所有有趣的东西。 如果在过去几年你一直听言关于不可变状态的函数式编程的倡导，那么这听起来很糟糕。\x3c\/p\x3e\n\x3cp\x3e但是你知道什么才是酷的？ 无论如何，你可以获得所有的好处。 MobX将你的状态变化包装在getter和setter中，但它也可以支持那些具有不可变数据结构的应用程序，并且actions可以为时间旅行调试器建立一个更新日志。\x3c\/p\x3e\n\x3cp\x3e这可能会是一个有趣的项目。 我可以使用MobX的时间旅行调试器？\x3c\/p\x3e\n\x3cp\x3emodel是另一个难题。\x3c\/p\x3e\n\x3cp\x3emodel表示整个数据结构中的特定对象。 MobX的store会关注你的整个应用程序的状态；model是为了说明一个特定的React组件所关注的特定实例。\x3c\/p\x3e\n\x3cp\x3e这听起来model应该在组件状态中，对吧？ 但这是一个糟糕的主意，因为这样会让你的东西更难测试并且会打破状态机的理想状态。\x3c\/p\x3e\n\x3cp\x3emodel也是存放与后端交互的actions的好地方。 诸如保存，获取，更新。\x3c\/p\x3e\n\x3chr\x3e\n\x3ch2\x3e让我们构建一盒柿子\x3c\/h2\x3e\n\x3cp\x3e你可以把它想象成伪代码。\x3c\/p\x3e\n\x3cp\x3e让我们构建一盒 \x3ca href=\x22https:\/\/en.wikipedia.org\/wiki\/Diospyros_kaki\x22 title=\x22日本柿子\x22\x3e柿子\x3c\/a\x3e。 现在我的厨房柜台上就有一盒，因为柿子就长在我女朋友的妈妈的后院。 谁知道？ ¯\x3cem\x3e(ツ)\x3c\/em\x3e\/¯\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t01b696e6e333497c57.jpg\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e盒子可以被打开或关闭。盒子里有柿子时，可以用胶带密封它， 它的状态机看起来像这样：\x3c\/p\x3e\n\x3cp\x3e\x3cimg src=\x22http:\/\/p0.qhimg.com\/t0173a460123de2d3b6.jpg\x22 alt=\x22\x22\x3e\x3c\/p\x3e\n\x3cp\x3e一旦盒子被打开, 只要你想，你可以放入或取出尽可能多的柿子。你可以从任何\x3ccode\x3eN kaki\x3c\/code\x3e状态关闭这个盒子，但你必须通过打开它来放入或取出柿子。 但只有在关闭时才能密封，只有在启封时才能打开。\x3c\/p\x3e\n\x3ch3\x3e盒子，model\x3c\/h3\x3e\n\x3cp\x3e作为MobX的store和model，你的盒子可能像这样：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs kotlin\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ src\/models\/Box.js\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { observable, computed, action, extendObservable } from \x3cspan class=\x22hljs-string\x22\x3e\x27mobx\x27\x3c\/span\x3e;\n\nexport \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eBox\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-meta\x22\x3e@observable\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3esealed\x3c\/span\x3e = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-meta\x22\x3e@observable\x3c\/span\x3e closed = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-meta\x22\x3e@observable\x3c\/span\x3e kakis = [];\n\n    \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(store, initialState) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.store = store;\n        extendObservable(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, initialState);\n    }\n\n    \x3cspan class=\x22hljs-meta\x22\x3e@computed\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e canSeal() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.closed;\n    }\n\n    \x3cspan class=\x22hljs-meta\x22\x3e@computed\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e canOpen() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e !\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3esealed\x3c\/span\x3e;\n    }\n\n    \x3cspan class=\x22hljs-meta\x22\x3e@computed\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e canManipulatekakis() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e !\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.closed;\n    }\n\n    \x3cspan class=\x22hljs-meta\x22\x3e@action\x3c\/span\x3e addkaki() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.kakis.push(new kaki());\n    }\n\n    \x3cspan class=\x22hljs-meta\x22\x3e@action\x3c\/span\x3e takekaki() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.kakis.pop();\n    }\n\n    \x3cspan class=\x22hljs-meta\x22\x3e@action\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eopen\x3c\/span\x3e() {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.canOpen) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.opened = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n        }\n    }\n\n    \x3cspan class=\x22hljs-meta\x22\x3e@action\x3c\/span\x3e close() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.closed = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    }\n\n    \x3cspan class=\x22hljs-meta\x22\x3e@action\x3c\/span\x3e seal() {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.canSeal) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3esealed\x3c\/span\x3e = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n        }\n    }\n\n    \x3cspan class=\x22hljs-meta\x22\x3e@action\x3c\/span\x3e unseal() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3esealed\x3c\/span\x3e = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n    }\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ccode\x3e@ observable\x3c\/code\x3e是一个MobX装饰器，MobX会使得属性可观察。\x3ccode\x3eextendObservable\x3c\/code\x3e是在对象上设置许多可观察值的一种方便的方法。\x3ccode\x3e@ computed\x3c\/code\x3e会标记一些纯粹从状态派生出的属性，MobX可以记忆它们。\x3ccode\x3e@action\x3c\/code\x3e会将方法标记为动作。\x3c\/p\x3e\n\x3cp\x3e看看那张状态机的图片。观察者和计算属性放在一起是圆圈（状态），动作是箭头（状态之间的转换）。\x3c\/p\x3e\n\x3ch3\x3e主应用程序组件\x3c\/h3\x3e\n\x3cp\x3e为了一个盒子做了很多工作吧？ 看看我们把它放在React组件里会发生什么：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ src\/components\/App.js\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { Provider } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27mobx-react\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { Box } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/models\/Box\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ would normally go in src\/stores\/...\x3c\/span\x3e\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eMainStore\x3c\/span\x3e \x3c\/span\x3e{\n    @observable box = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n\n    @action getBoxFromMail() {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.box = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Box({\n            \x3cspan class=\x22hljs-attr\x22\x3esealed\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3eclosed\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3ekakis\x3c\/span\x3e: [\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e kaki(), \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e kaki()]\n        });\n    }\n}\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eApp\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    mainStore = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e MainStore();\n\n    render() {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e mainStore = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.mainStore;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n            \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eProvider\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3emainStore\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{mainStore}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eButton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{mainStore.getBoxFromMail.bind(mainStore)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                        Get Mail\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eButton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n                    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eBox\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eProvider\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n        );\n    }\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e我们建立了一个新的\x3ccode\x3eMainStore\x3c\/code\x3e，它保存了我们应用程序的主要状态。诸如是否从邮箱取出一盒柿子，柜台是否是黑色，冰箱是否在工作之类的。\x3c\/p\x3e\n\x3cp\x3e在render函数中，我们使用\x3ccode\x3eProvider\x3c\/code\x3e将\x3ccode\x3emainStore\x3c\/code\x3e添加到React上下文。 如果需要，\x3ccode\x3eProvider\x3c\/code\x3e中的任何组件都可以访问\x3ccode\x3emainStore\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e将actions与store和model捆绑在一起好处是，你可以在\x3ccode\x3eonClick\x3c\/code\x3e处理程序中使用它们。 这意味着你的大部分组件可以是无状态的功能组件。\x3c\/p\x3e\n\x3ch3\x3e盒子, React组件\x3c\/h3\x3e\n\x3cp\x3e我来给你展示。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ src\/components\/Box.js\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { inject, observer } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27mobx-react\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SealedOrOpened = observer(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e{ box }\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e (\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (box.sealed) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Sealed and Closed\x27\x3c\/span\x3e;\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!box.sealed \x26amp;\x26amp; !box.opened) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27You should open the box\x27\x3c\/span\x3e;\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27Take some kakis!\x27\x3c\/span\x3e;\n    }\n));\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ this helper normally goes somewhere else\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e If = \x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e{ cond, children }\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e cond ? children : \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e Box = inject(\x3cspan class=\x22hljs-string\x22\x3e\x27mainStore\x27\x3c\/span\x3e)(observer(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3e{ mainStore }\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e box = mainStore.box;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n    \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eSealedOrOpened\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ebox\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{box}\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eIf\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3econd\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{box.canOpen}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eButton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{box.open.bind(box)}\x3c\/span\x3e\x26gt;\x3c\/span\x3eOpen box\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eButton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eIf\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eIf\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3econd\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{box.opened}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                {box.kakis.map(kaki =\x26gt; \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ekaki\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e)}\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eButton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{box.takekaki.bind(box)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                Take a kaki\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eButton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eIf\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    );\n));\n\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这就是本质上的\x3ccode\x3eBox\x3c\/code\x3e组件。它会渲染一些文本，告诉你如何处理这个盒子，并给你一个打开它的按钮。是的，我知道应该有一个按钮来取下胶带。\x3c\/p\x3e\n\x3cp\x3e一旦你打开盒子，就会出现一个柿子列表和一个按钮，来把它们一个接一个地取出来。\x3c\/p\x3e\n\x3cp\x3e请注意，\x3ccode\x3eBox\x3c\/code\x3e是一个函数式无状态的组件。 你可以这样做，因为所有的状态和所有的操作都在\x3ccode\x3eBox\x3c\/code\x3e，即MobX的model中。 没有必要在本地建立点击处理程序。\x3c\/p\x3e\n\x3cp\x3e您可能还会注意到，我们已经将\x3ccode\x3einject(\x27mainStore\x27)\x3c\/code\x3e注入到Box组件中。这使得我们可以将组件移动到\x3ccode\x3eProvider\x3c\/code\x3e内的DOM树中的任何位置，并且它将继续工作。不需要任何的修改。\x3c\/p\x3e\n\x3ch3\x3e❤️ 总结\x3c\/h3\x3e\n\x3cp\x3e你的UI设计师会喜欢这种灵活性，你的PM会决定你的速度超乎想象。\x3c\/p\x3e\n\x3cp\x3e哦，那个\x3ccode\x3eobserver\x3c\/code\x3e呢？ 它可以确保你的组件在状态更改时重新渲染。\x3c\/p\x3e\n\x3cp\x3e下周，我要写一篇关于将这些更改保留到某种后端的文章。 我仍在努力如何使这部分省事且整洁。\x3c\/p\x3e\n\x3cp\x3e也许我应该写一本关于React和MobX构建Web应用程序的书？ 如果你感兴趣，\x3ca href=\x22mailto:hi@swizec.com\x22\x3e请告诉我\x3c\/a\x3e.\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>如何在真实世界构建你的Mobx应用程序</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/how-to-structure-your-mobx-app-for-the-real-world">https://www.zcfy.cc/article/how-to-structure-your-mobx-app-for-the-real-world</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/7aff5og0w3i/" target="_blank">https://alili.tech/archive/7aff5og0w3i/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/z09muaar7j/">2年前端应该会哪些技能<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/ke982v6qrfg/">CSS 性能优化笔记<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/if1i2hs28ah/">H5打造3d场景不完全攻略（二）: Amazing CSS3D<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/s4apghsr7o/">JS原生一步步实现前端路由和单页面应用<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/hjgkntbgqek/">JavaScript 中对大量数据的多重过滤<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/h1hfvr2a2nj/">JavaScript 中的错误处理机制<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/a0ukpm125gm/">JavaScript 数组分组的实现<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/fwosouhbhmj/">JavaScript 类型转换深度学习<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/z193p9xv2p/">JavaScript设计模式之发布-订阅模式（观察者模式）-Part1<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/6i7sr0vgkxm/">Javascript中的时间<aside class="dates">2019-02-01</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>