<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="「Android」 详细全面的基于vue2.0Weex接入过程（Android视角）"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>「Android」 详细全面的基于vue2.0Weex接入过程（Android视角） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/13mm6u7dsvn/",
				"appid": "1613049289050283", 
				"title": "「Android」 详细全面的基于vue2.0Weex接入过程（Android视角） | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-19T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/smaveyss8/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/h64oeqws778/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f&text=%e3%80%8cAndroid%e3%80%8d%20%e8%af%a6%e7%bb%86%e5%85%a8%e9%9d%a2%e7%9a%84%e5%9f%ba%e4%ba%8evue2.0Weex%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b%ef%bc%88Android%e8%a7%86%e8%a7%92%ef%bc%89"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f&text=%e3%80%8cAndroid%e3%80%8d%20%e8%af%a6%e7%bb%86%e5%85%a8%e9%9d%a2%e7%9a%84%e5%9f%ba%e4%ba%8evue2.0Weex%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b%ef%bc%88Android%e8%a7%86%e8%a7%92%ef%bc%89"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f&title=%e3%80%8cAndroid%e3%80%8d%20%e8%af%a6%e7%bb%86%e5%85%a8%e9%9d%a2%e7%9a%84%e5%9f%ba%e4%ba%8evue2.0Weex%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b%ef%bc%88Android%e8%a7%86%e8%a7%92%ef%bc%89"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f&is_video=false&description=%e3%80%8cAndroid%e3%80%8d%20%e8%af%a6%e7%bb%86%e5%85%a8%e9%9d%a2%e7%9a%84%e5%9f%ba%e4%ba%8evue2.0Weex%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b%ef%bc%88Android%e8%a7%86%e8%a7%92%ef%bc%89"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%8cAndroid%e3%80%8d%20%e8%af%a6%e7%bb%86%e5%85%a8%e9%9d%a2%e7%9a%84%e5%9f%ba%e4%ba%8evue2.0Weex%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b%ef%bc%88Android%e8%a7%86%e8%a7%92%ef%bc%89&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f&title=%e3%80%8cAndroid%e3%80%8d%20%e8%af%a6%e7%bb%86%e5%85%a8%e9%9d%a2%e7%9a%84%e5%9f%ba%e4%ba%8evue2.0Weex%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b%ef%bc%88Android%e8%a7%86%e8%a7%92%ef%bc%89"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f&title=%e3%80%8cAndroid%e3%80%8d%20%e8%af%a6%e7%bb%86%e5%85%a8%e9%9d%a2%e7%9a%84%e5%9f%ba%e4%ba%8evue2.0Weex%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b%ef%bc%88Android%e8%a7%86%e8%a7%92%ef%bc%89"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f&title=%e3%80%8cAndroid%e3%80%8d%20%e8%af%a6%e7%bb%86%e5%85%a8%e9%9d%a2%e7%9a%84%e5%9f%ba%e4%ba%8evue2.0Weex%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b%ef%bc%88Android%e8%a7%86%e8%a7%92%ef%bc%89"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f13mm6u7dsvn%2f&title=%e3%80%8cAndroid%e3%80%8d%20%e8%af%a6%e7%bb%86%e5%85%a8%e9%9d%a2%e7%9a%84%e5%9f%ba%e4%ba%8evue2.0Weex%e6%8e%a5%e5%85%a5%e8%bf%87%e7%a8%8b%ef%bc%88Android%e8%a7%86%e8%a7%92%ef%bc%89"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">「Android」 详细全面的基于vue2.0Weex接入过程（Android视角）</h1><div class="meta"><div class="postdate"><time datetime="2019-01-19" itemprop="datePublished">2019-01-19</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e本文来自尚妆Android团队\x3ca href=\x22https:\/\/github.com\/or0fun\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e路飞\x3c\/a\x3e\x3cbr\x3e发表于\x3ca href=\x22https:\/\/github.com\/ShowJoy-com\/showjoy-blog\/issues\/25\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e尚妆github博客\x3c\/a\x3e，欢迎订阅！\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e一、说在前面的话\x3c\/h1\x3e\n\x3cp\x3e目前weex已在尚妆旗下的达人店app上线了一个常用的订单管理页面，截止目前Android上未发现问题，渲染时间在100-300ms之间。\x3c\/p\x3e\n\x3cp\x3e作为Android开发，此文首先会从Android的角度为主来记录接入的过程，希望给未接入的同学更方便省时地接入weex提供一点帮助。其中会涉及到\x3ccode\x3e预加载\x3c\/code\x3e，\x3ccode\x3e降级\x3c\/code\x3e，\x3ccode\x3e热更新\x3c\/code\x3e，\x3ccode\x3e埋点\x3c\/code\x3e以及在app不更新的情况下\x3ccode\x3e动态配置新页面\x3c\/code\x3e等问题，这些Android和iOS都是统一的逻辑，希望和大家一起交流。前端方面可以参考我同事写的\x3ca href=\x22https:\/\/github.com\/ShowJoy-com\/showjoy-blog\/issues\/8\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e《weex入门实践（前端视角）》\x3c\/a\x3e，iOS可以参考我同事写的\x3ca href=\x22https:\/\/juejin.im\/entry\/586c6a768d6d810058aba6c5\/detail\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eweex 实践（iOS 视角）\x3c\/a\x3e\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e二、Android接入过程\x3c\/h1\x3e\n\x3cp\x3e其实对于module、component的定义，以及IWXImgLoaderAdapter、IWXHttpAdapter等adapter的重写，在playgroud和weexteam里都已经有很好的例子了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e1、gradle依赖\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22compile \x27com.taobao.android:weex_sdk:0.10.0’\n\ncompile \x27com.android.support:support-v4:24.0.0\x27\ncompile \x27com.android.support:appcompat-v7:24.0.0\x27\ncompile \x27com.android.support:recyclerview-v7:24.0.0\x27\n\ncompile \x27com.squareup.okhttp:okhttp:2.3.0\x27\ncompile \x27com.squareup.okhttp:okhttp-ws:2.3.0\x27\n\ncompile \x27com.alibaba:fastjson:1.2.8\x27\n\n\/\/（可选）支持调试的依赖，参考https:\/\/github.com\/weexteam\/weex-devtools-android\/blob\/master\/README-zh.md  \ncompile \x27com.taobao.android:weex_inspector:0.0.8.5\x27\ncompile \x27com.google.code.findbugs:jsr305:2.0.1\x27\ncompile \x27com.taobao.android:weex_inspector:0.0.8.5\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22gradle hljs\x22\x3e\x3ccode class=\x22gradle\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ecompile\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27com.taobao.android:weex_sdk:0.10.0’\n\ncompile \x27\x3c\/span\x3ecom.android.support:support-v4:\x3cspan class=\x22hljs-number\x22\x3e24.0\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27\ncompile \x27\x3c\/span\x3ecom.android.support:appcompat-v7:\x3cspan class=\x22hljs-number\x22\x3e24.0\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27\ncompile \x27\x3c\/span\x3ecom.android.support:recyclerview-v7:\x3cspan class=\x22hljs-number\x22\x3e24.0\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27\n\ncompile \x27\x3c\/span\x3ecom.squareup.okhttp:okhttp:\x3cspan class=\x22hljs-number\x22\x3e2.3\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27\ncompile \x27\x3c\/span\x3ecom.squareup.okhttp:okhttp-ws:\x3cspan class=\x22hljs-number\x22\x3e2.3\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27\n\ncompile \x27\x3c\/span\x3ecom.alibaba:fastjson:\x3cspan class=\x22hljs-number\x22\x3e1.2\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27\n\n\/\/（可选）支持调试的依赖，参考https:\/\/github.com\/weexteam\/weex-devtools-android\/blob\/master\/README-zh.md  \ncompile \x27\x3c\/span\x3ecom.taobao.android:weex_inspector:\x3cspan class=\x22hljs-number\x22\x3e0.0\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e8.5\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27\ncompile \x27\x3c\/span\x3ecom.google.code.findbugs:jsr305:\x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27\ncompile \x27\x3c\/span\x3ecom.taobao.android:weex_inspector:\x3cspan class=\x22hljs-number\x22\x3e0.0\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e8.5\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e2、新建weex module\x3c\/h3\x3e\n\x3cp\x3e在原来的project上，新建单独的 weex module。代码结构如下：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008641801?w=445\x26amp;h=590\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008641801?w=445\x26amp;h=590\x22 alt=\x22Alt text\x22 title=\x22Alt text\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e3、初始化weex\x3c\/h3\x3e\n\x3cp\x3e通过类WeexManager来统一管理weex相关的配置，以下是WeexManager里的init函数的主要内容，在application的onCreate里调用：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22public void init(Application application, IWeexService weexService) {\n\n        \/\/通过在线参数控制是否使用weex,ConfigManager是尚妆的在线参数模块，以后有机会再简单介绍一下\n        if (!ConfigManager.getBoolean(CONFIG_WEEX_ENABLE, true)) {\n            return;\n        }\n\n        context = application.getApplicationContext();\n        weexDir = context.getDir(WEEX_MODULE, Context.MODE_PRIVATE);\n\n        \/\/根据需要注册图片、网络、存储等adapter\n        WXSDKEngine.initialize(application,\n                new InitConfig.Builder()\n                        .setImgAdapter(new FrescoImageAdapter())\n                        .setUtAdapter(new UserTrackAdapter())\n                        .setStorageAdapter(new StorageAdapter())\n                        .setHttpAdapter(new OkHttpAdapter())\n                        .setURIAdapter(new CustomURIAdapter())\n                        .build());\n\n        this.weexService = weexService;\n\n        \/\/获取本地缓存的weex js配置\n        configList = WXJsonUtils.getList(SHStorageManager.get(WEEX_MODULE, WEEX_CONFIG, \x26quot;\x26quot;), WeexConfig.class);\n        update();\n\n        try {\n            \/\/页面通用的一些接口\n            WXSDKEngine.registerModule(\x26quot;shopBase\x26quot;, ShopModule.class);\n            \/\/主要是a标签的跳转\n            WXSDKEngine.registerModule(\x26quot;event\x26quot;, WXEventModule.class);\n            \/\/模态对话框\n            WXSDKEngine.registerModule(\x26quot;shopModal\x26quot;, ModalModule.class);\n            \/\/用fresco重写图片组件\n            WXSDKEngine.registerComponent(\x26quot;image\x26quot;, FrescoImageComponent.class);\n        } catch (WXException e) {\n            LogUtils.e(e);\n        }\n\n        SHEventBus.register(ModuleName.WEEX, \x26quot;weexDebugHost\x26quot;, new ISHEventBusCallback\x3cString\x3e() {\n            @Override\n            public void handle(String debugHost, String s) {\n                if (!TextUtils.isEmpty(s)) {\n                    LogUtils.e(s);\n                    return;\n                }\n                if (TextUtils.isEmpty(debugHost)) {\n                    WXEnvironment.sRemoteDebugMode = false;\n                } else {\n                    WXEnvironment.sRemoteDebugMode = true;\n                    WXEnvironment.sRemoteDebugProxyUrl = \x26quot;ws:\/\/\x26quot; \x2b debugHost \x2b \x26quot;\/debugProxy\/native\x26quot;;\n                }\n                WXSDKEngine.reload();\n            }\n        });\n\n        SHEventBus.register(ModuleName.WEEX, \x26quot;netChanged\x26quot;, new ISHEventBusCallback\x3cBoolean\x3e() {\n            @Override\n            public void handle(Boolean result, String s) {\n                if (!TextUtils.isEmpty(s)) {\n                    LogUtils.e(s);\n                } else {\n                    if (result.booleanValue()) {\n                        update();\n                    }\n                }\n            }\n        });\n\n        \/\/获取weex配置，更新js文件\n        weexConfigRequest.setCallBack(new IRequestCallBack\x3cSHResponse\x3cList\x3cWeexConfig\x3e\x3e\x3e() {\n            @Override\n            public void onResponseSuccess(SHResponse\x3cList\x3cWeexConfig\x3e\x3e response) {\n                if (response.isSuccess \x26amp;\x26amp; null != response.data) {\n                    SHStorageManager.putToDisk(WEEX_MODULE, WEEX_CONFIG, JsonUtils.toJson(response.data));\n                    configList = response.data;\n                    update();\n                }\n            }\n\n            @Override\n            public void onResponseError(int i) {\n\n            }\n        });\n        weexConfigRequest.start();\n\n    }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22java hljs\x22\x3e\x3ccode class=\x22java\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3einit\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(Application application, IWeexService weexService)\x3c\/span\x3e \x3c\/span\x3e{\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/通过在线参数控制是否使用weex,ConfigManager是尚妆的在线参数模块，以后有机会再简单介绍一下\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!ConfigManager.getBoolean(CONFIG_WEEX_ENABLE, \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e)) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n        }\n\n        context = application.getApplicationContext();\n        weexDir = context.getDir(WEEX_MODULE, Context.MODE_PRIVATE);\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/根据需要注册图片、网络、存储等adapter\x3c\/span\x3e\n        WXSDKEngine.initialize(application,\n                \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e InitConfig.Builder()\n                        .setImgAdapter(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FrescoImageAdapter())\n                        .setUtAdapter(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e UserTrackAdapter())\n                        .setStorageAdapter(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e StorageAdapter())\n                        .setHttpAdapter(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e OkHttpAdapter())\n                        .setURIAdapter(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e CustomURIAdapter())\n                        .build());\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.weexService = weexService;\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取本地缓存的weex js配置\x3c\/span\x3e\n        configList = WXJsonUtils.getList(SHStorageManager.get(WEEX_MODULE, WEEX_CONFIG, \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e), WeexConfig.class);\n        update();\n\n        \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/页面通用的一些接口\x3c\/span\x3e\n            WXSDKEngine.registerModule(\x3cspan class=\x22hljs-string\x22\x3e\x22shopBase\x22\x3c\/span\x3e, ShopModule.class);\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/主要是a标签的跳转\x3c\/span\x3e\n            WXSDKEngine.registerModule(\x3cspan class=\x22hljs-string\x22\x3e\x22event\x22\x3c\/span\x3e, WXEventModule.class);\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/模态对话框\x3c\/span\x3e\n            WXSDKEngine.registerModule(\x3cspan class=\x22hljs-string\x22\x3e\x22shopModal\x22\x3c\/span\x3e, ModalModule.class);\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/用fresco重写图片组件\x3c\/span\x3e\n            WXSDKEngine.registerComponent(\x3cspan class=\x22hljs-string\x22\x3e\x22image\x22\x3c\/span\x3e, FrescoImageComponent.class);\n        } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (WXException e) {\n            LogUtils.e(e);\n        }\n\n        SHEventBus.register(ModuleName.WEEX, \x3cspan class=\x22hljs-string\x22\x3e\x22weexDebugHost\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ISHEventBusCallback\x26lt;String\x26gt;() {\n            \x3cspan class=\x22hljs-meta\x22\x3e@Override\x3c\/span\x3e\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehandle\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(String debugHost, String s)\x3c\/span\x3e \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!TextUtils.isEmpty(s)) {\n                    LogUtils.e(s);\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n                }\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (TextUtils.isEmpty(debugHost)) {\n                    WXEnvironment.sRemoteDebugMode = \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e;\n                } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                    WXEnvironment.sRemoteDebugMode = \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e;\n                    WXEnvironment.sRemoteDebugProxyUrl = \x3cspan class=\x22hljs-string\x22\x3e\x22ws:\/\/\x22\x3c\/span\x3e \x2b debugHost \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\/debugProxy\/native\x22\x3c\/span\x3e;\n                }\n                WXSDKEngine.reload();\n            }\n        });\n\n        SHEventBus.register(ModuleName.WEEX, \x3cspan class=\x22hljs-string\x22\x3e\x22netChanged\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e ISHEventBusCallback\x26lt;Boolean\x26gt;() {\n            \x3cspan class=\x22hljs-meta\x22\x3e@Override\x3c\/span\x3e\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ehandle\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(Boolean result, String s)\x3c\/span\x3e \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!TextUtils.isEmpty(s)) {\n                    LogUtils.e(s);\n                } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (result.booleanValue()) {\n                        update();\n                    }\n                }\n            }\n        });\n\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取weex配置，更新js文件\x3c\/span\x3e\n        weexConfigRequest.setCallBack(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e IRequestCallBack\x26lt;SHResponse\x26lt;List\x26lt;WeexConfig\x26gt;\x26gt;\x26gt;() {\n            \x3cspan class=\x22hljs-meta\x22\x3e@Override\x3c\/span\x3e\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonResponseSuccess\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(SHResponse\x26lt;List\x26lt;WeexConfig\x26gt;\x26gt; response)\x3c\/span\x3e \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (response.isSuccess \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e != response.data) {\n                    SHStorageManager.putToDisk(WEEX_MODULE, WEEX_CONFIG, JsonUtils.toJson(response.data));\n                    configList = response.data;\n                    update();\n                }\n            }\n\n            \x3cspan class=\x22hljs-meta\x22\x3e@Override\x3c\/span\x3e\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonResponseError\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e i)\x3c\/span\x3e \x3c\/span\x3e{\n\n            }\n        });\n        weexConfigRequest.start();\n\n    }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e1）考虑到第一次接入weex，有点担心兼容问题，万一引起崩溃等不确定因素，所以这里做了一个开关。其实每接入一个新的sdk都最好有个\x3ccode\x3e控制开关\x3c\/code\x3e，以避免因为不确定因素导致不稳定。\x3c\/p\x3e\n\x3cp\x3e2）weexDir是js的下载存储路径，为了加快页面打开时间，会对js进行\x3ccode\x3e预加载到本地\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e3） sdk对a标签的处理只调用了\x22event\x22的openURL接口，但是却没有注册\x3ccode\x3e\x22event\x22\x3c\/code\x3e。所以需要自己实现WXEventModule，并注册。\x3c\/p\x3e\n\x3cp\x3e4）模态对话框\x3ccode\x3eModalModule\x3c\/code\x3e的实现参考sdk里的WXModalUIModule\x3c\/p\x3e\n\x3cp\x3e5）\x3ccode\x3eFrescoImageAdapter\x3c\/code\x3e和\x3ccode\x3eFrescoImageComponent\x3c\/code\x3e的实现依赖我们开源的\x3ca href=\x22https:\/\/github.com\/ShowJoy-com\/SHImageView\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSHImageView\x3c\/a\x3e支持webp，支持压缩，支持没有协议的链接（忽略协议可以让浏览器根据页面时http或者https自动选择使用的协议，从而避免了网站改为https的情况下仍然访问http资源而无法访问的问题。）\x3c\/p\x3e\n\x3cp\x3e6）OkHttpAdapter的实现参考github上zjutkz同学的实现 OkHttpAdapter，感谢，经过改写，支持没有协议的链接，支持cookie\x3c\/p\x3e\n\x3cp\x3e7）ShopModule是自定义的Module，定义通用的一些接口，比如设置title bar是否显示，以及title bar的title；关闭当前页面，分享，错误日志收集等。\x3c\/p\x3e\n\x3cp\x3e8）UserTrackAdapter用于埋点，另外可以在ShopModule里自定义接口收集埋点、错误信息等。\x3c\/p\x3e\n\x3cp\x3e9）CustomURIAdapter用于支持相对地址，具体实现参见以下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22public class CustomURIAdapter implements URIAdapter {\n    @NonNull\n    @Override\n    public Uri rewrite(WXSDKInstance instance, String type, Uri uri) {\n        if (null == uri) {\n            return null;\n        }\n        String url = uri.toString();\n        if (url.startsWith(\x26quot;http\x26quot;)) {\n            return uri;\n        }else if (url.startsWith(\x26quot;\/\/\x26quot;)) {\n            if (SHStorageManager.get(\x26quot;APP\x26quot;, \x26quot;https\x26quot;, true)) {\n                url = \x26quot;https:\x26quot; \x2b url;\n            }else {\n                url = \x26quot;http:\x26quot; \x2b url;\n            }\n        }else {\n            url = SHHost.getMobileHost() \x2b url;\n        }\n        return Uri.parse(url);\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3epublic \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eCustomURIAdapter\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eimplements\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eURIAdapter\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-meta\x22\x3e@NonNull\x3c\/span\x3e\n    \x3cspan class=\x22hljs-meta\x22\x3e@Override\x3c\/span\x3e\n    public \x3cspan class=\x22hljs-built_in\x22\x3eUri\x3c\/span\x3e rewrite(WXSDKInstance instance, \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e type, \x3cspan class=\x22hljs-built_in\x22\x3eUri\x3c\/span\x3e uri) {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e == uri) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e url = uri.toString();\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (url.startsWith(\x3cspan class=\x22hljs-string\x22\x3e\x22http\x22\x3c\/span\x3e)) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e uri;\n        }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (url.startsWith(\x3cspan class=\x22hljs-string\x22\x3e\x22\/\/\x22\x3c\/span\x3e)) {\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (SHStorageManager.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22APP\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22https\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e)) {\n                url = \x3cspan class=\x22hljs-string\x22\x3e\x22https:\x22\x3c\/span\x3e \x2b url;\n            }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                url = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\x22\x3c\/span\x3e \x2b url;\n            }\n        }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            url = SHHost.getMobileHost() \x2b url;\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eUri\x3c\/span\x3e.parse(url);\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e4、新建统一的weex页面\x3c\/h3\x3e\n\x3cp\x3e这边考虑到以后页面有可能嵌入到其他activity，所以把weex的渲染放入新建的\x3ccode\x3eWeexFragment\x3c\/code\x3e。然后新建WeexActivity来引用该WeexFragment 。所有的单独页面的weex渲染都使用这个\x3ccode\x3eWeexActivity\x3c\/code\x3e，非单独页面的使用\x3ccode\x3eweexFragment\x3c\/code\x3e，这样新加页面时，无需重新注册activity。weex处理逻辑统一，方便管理，方便动态配置。\x3ccode\x3e通过统一跳转协议跳转到WeexActivity，通过intent传入两个参数url和h5\x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22showjoyshop:\/\/page.sh\/weex\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-symbol\x22\x3eshowjoyshop:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/page.sh\/weex\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eintent参数：\x3cbr\x3e\x3ccode\x3eurl\x3c\/code\x3e：js链接，可以是本地的存储地址\/sdcard\/com.showjoy.shop\/weex\/order.js，也可以是线上链接 \x3ca href=\x22https:\/\/xxxxx\/0.4.3\/order.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/xxxxx\/0.4.3\/order.js\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eh5\x3c\/code\x3e：用来降级的h5页面链接，当渲染失败时，会跳转到该h5页面\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e5、开始渲染js，失败后降级到h5\x3c\/h3\x3e\n\x3cp\x3e首先实例化WXSDKInstance\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22wxInstance = new WXSDKInstance(activity);\nwxInstance.registerRenderListener(this);\nwxInstance.onActivityCreate();\nregisterBroadcastReceiver();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs abnf\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-attribute\x22\x3ewxInstance\x3c\/span\x3e = new WXSDKInstance(activity)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nwxInstance.registerRenderListener(this)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nwxInstance.onActivityCreate()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nregisterBroadcastReceiver()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e1）当前类实现接口IWXRenderListener，可以参考weexteam里的AbsWeexActivity实现\x3c\/p\x3e\n\x3cp\x3e2）注册的广播是DefaultBroadcastReceiver，可以可以参考weexteam里的AbsWeexActivity实现\x3c\/p\x3e\n\x3cp\x3e然后讲一下渲染，支持本地js以及线上js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (url.startsWith(\x26quot;http\x26quot;)) {\n    wxInstance.renderByUrl(\n            getPageName(),\n            url,\n            options,\n            jsonInitData,\n            CommonUtils.getDisplayWidth(activity),\n            CommonUtils.getDisplayHeight(activity),\n            WXRenderStrategy.APPEND_ASYNC);\n\n}else {\n    new Thread(new Runnable() {\n        @Override\n        public void run() {\n            String file = WeexUtils.readFile(url);\n            handler.sendMessage(handler.obtainMessage(LOAD_LOCAL_FILE, file));\n        }\n    }).start();\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs aspectj\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (url.startsWith(\x3cspan class=\x22hljs-string\x22\x3e\x22http\x22\x3c\/span\x3e)) {\n    wxInstance.renderByUrl(\n            getPageName(),\n            url,\n            options,\n            jsonInitData,\n            CommonUtils.getDisplayWidth(activity),\n            CommonUtils.getDisplayHeight(activity),\n            WXRenderStrategy.APPEND_ASYNC);\n\n}\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Thread(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Runnable() {\n        \x3cspan class=\x22hljs-meta\x22\x3e@Override\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n            String file = WeexUtils.readFile(url);\n            \x3cspan class=\x22hljs-keyword\x22\x3ehandler\x3c\/span\x3e.sendMessage(\x3cspan class=\x22hljs-keyword\x22\x3ehandler\x3c\/span\x3e.obtainMessage(LOAD_LOCAL_FILE, file));\n        }\n    }).start();\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其中，getPageName()自定义即可，getDisplayWidth和getDisplayHeight获取屏幕宽高。\x3c\/p\x3e\n\x3cp\x3e传入本地的存储地址时，先读取文件，然后同个Handler在UI线程渲染，如下：\x3c\/p\x3e\n\x3cp\x3e接收LOAD_LOCAL_FILE后handler里的实现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22case LOAD_LOCAL_FILE:\n                    if (activity.getLifeState() != LifeState.DESTORY ) {\n                        if (wxInstance != null) {\n                            String content = (String) msg.obj;\n                            if (TextUtils.isEmpty(content)) {\n                                SHJump.openUrl(activity, h5Url);\n                                finishActivity();\n                            }else {\n                                wxInstance.render((String) msg.obj, null, null);\n                            }\n                        }\n                    }\n                    break;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autoit\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e LOAD_LOCAL_FILE:\n                    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (activity.getLifeState() != LifeState.DESTORY ) {\n                        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (wxInstance != \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e) {\n                            \x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e content = (\x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e) msg.obj\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n                            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (TextUtils.isEmpty(content)) {\n                                SHJump.openUrl(activity, h5Url)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n                                finishActivity()\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n                            }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n                                wxInstance.render((\x3cspan class=\x22hljs-built_in\x22\x3eString\x3c\/span\x3e) msg.obj, \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n                            }\n                        }\n                    }\n                    \x3cspan class=\x22hljs-built_in\x22\x3ebreak\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里getLifeState()是我们自己BaseActivity的实现，可以自行判断。SHJump和finishActivity都是自己的实现，大家自己实现即可。\x3c\/p\x3e\n\x3cp\x3e渲染回调的实现，按需要处理即可，渲染成功后隐藏loading，view创建后添加view。\x3ccode\x3e渲染异常时降级跳转到h5\x3c\/code\x3e。如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Override\npublic void onViewCreated(WXSDKInstance instance, View view) {\n    \/\/viewMap.put(weexJsUrl, view);\n    addWeexView(view);\n}\n@Override\npublic void onRenderSuccess(WXSDKInstance instance, int width, int height) {\n    toHideLoading();\n}\n@Override\npublic void onRefreshSuccess(WXSDKInstance instance, int width, int height) {\n    toHideLoading();\n}\n@Override\npublic void onException(WXSDKInstance instance, String errCode, String msg) {\n    LogUtils.e(\x26quot;weex exception:\x26quot;, errCode, msg);\n    SHJump.openUrlForce(activity, h5Url);\n    finishActivity();\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs aspectj\x22\x3e\x3ccode\x3eOverride\n\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonViewCreated\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(WXSDKInstance instance, View view)\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/viewMap.put(weexJsUrl, view);\x3c\/span\x3e\n    addWeexView(view);\n}\n\x3cspan class=\x22hljs-meta\x22\x3e@Override\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonRenderSuccess\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(WXSDKInstance instance, \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e width, \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e height)\x3c\/span\x3e \x3c\/span\x3e{\n    toHideLoading();\n}\n\x3cspan class=\x22hljs-meta\x22\x3e@Override\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonRefreshSuccess\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(WXSDKInstance instance, \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e width, \x3cspan class=\x22hljs-keyword\x22\x3eint\x3c\/span\x3e height)\x3c\/span\x3e \x3c\/span\x3e{\n    toHideLoading();\n}\n\x3cspan class=\x22hljs-meta\x22\x3e@Override\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3epublic\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evoid\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eonException\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(WXSDKInstance instance, String errCode, String msg)\x3c\/span\x3e \x3c\/span\x3e{\n    LogUtils.e(\x3cspan class=\x22hljs-string\x22\x3e\x22weex exception:\x22\x3c\/span\x3e, errCode, msg);\n    SHJump.openUrlForce(activity, h5Url);\n    finishActivity();\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e6、多个js在同个页面渲染\x3c\/h3\x3e\n\x3cp\x3e为了实现如图的tab，一开始在.vue文件里使用tabbar组件，后来发现在Android机型适配上不够好。于是后来就将两个tab做成两个页面，生成两个js文件。首先渲染“我的订单.js”，生成如下的界面。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008641802?w=359\x26amp;h=637\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008641802?w=359\x26amp;h=637\x22 alt=\x22Alt text\x22 title=\x22Alt text\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e然后点击“本店订单”时，调用自定义module里的接口\x3ccode\x3eloadPage\x3c\/code\x3e，参数为h5的链接。\x3ccode\x3e三端实现接口loadPage，h5直接跳转，而iOS和Android通过h5链接从weex跳转配置里找到对应的js，重新渲染显示\x3c\/code\x3e。下面具体做几点说明：\x3c\/p\x3e\n\x3cp\x3e1）定义Map\x26lt;String, WXSDKInstance\x26gt; wxsdkInstanceMap;来存储不同js的WXSDKInstance，定义Map\x26lt;String, View\x26gt; viewMap来存储不同js渲染后的View。之所以要存储多个WXSDKInstance，是因为WXSDKInstance不能重复渲染，而且当WXSDKInstance destory后，之前渲染的view里的内容也会被清空。注意在在页面destory时，记得把所有WXSDKInstance都destory就好了。\x3c\/p\x3e\n\x3cp\x3e2）viewMap里的key对应页面的js。点击tab切换页面时，如对应的js已渲染，则直接取出view来显示。\x3c\/p\x3e\n\x3cp\x3e3）上文提到的\x3ccode\x3eweex跳转配置\x3c\/code\x3e，在以下的跳转规则里一同介绍。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader8\x22\x3e二、App的跳转规则的weex支持方案设计\x3c\/h1\x3e\n\x3cp\x3e跳转规则如下图，如果看不清，可以到新页面放大查看。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008641803?w=940\x26amp;h=767\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008641803?w=940\x26amp;h=767\x22 alt=\x22App跳转框架\x22 title=\x22App跳转框架\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e主要介绍一下两个配置参数：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e在参数weexPages配置所有的weex页面。\x3cbr\x3e示例如下：\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22[\n   {\n       \x26quot;page\x26quot;:\x26quot;order\x26quot;,\n       \x26quot;url\x26quot;:\x26quot;https:\/\/dshdjshjbx.js\x26quot;,\n       \x26quot;md5\x26quot;:\x26quot;323827382huwhdjshdjs\x26quot;,\n       \x26quot;h5\x26quot;:\x26quot;http:\/\/dsds.html\x26quot;\n       \x26quot;v\x26quot;:\x26quot;1.5.0\x26quot;\n    },\n    {\n       \x26quot;page\x26quot;:\x26quot;detail\x26quot;,\n       \x26quot;url\x26quot;:\x26quot;https:\/\/dsdsds.js\x26quot;,\n       \x26quot;md5\x26quot;:\x26quot;323827382huwhdjshdjs\x26quot;,\n       \x26quot;h5\x26quot;:\x26quot;http:\/\/dsds.html\x26quot;\n       \x26quot;v\x26quot;:\x26quot;1.5.0\x26quot;\n    }\n]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs json\x22\x3e\x3ccode\x3e[\n   {\n       \x3cspan class=\x22hljs-attr\x22\x3e\x22page\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22order\x22\x3c\/span\x3e,\n       \x3cspan class=\x22hljs-attr\x22\x3e\x22url\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/dshdjshjbx.js\x22\x3c\/span\x3e,\n       \x3cspan class=\x22hljs-attr\x22\x3e\x22md5\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22323827382huwhdjshdjs\x22\x3c\/span\x3e,\n       \x3cspan class=\x22hljs-attr\x22\x3e\x22h5\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/dsds.html\x22\x3c\/span\x3e\n       \x3cspan class=\x22hljs-string\x22\x3e\x22v\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x221.5.0\x22\x3c\/span\x3e\n    },\n    {\n       \x3cspan class=\x22hljs-attr\x22\x3e\x22page\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22detail\x22\x3c\/span\x3e,\n       \x3cspan class=\x22hljs-attr\x22\x3e\x22url\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/dsdsds.js\x22\x3c\/span\x3e,\n       \x3cspan class=\x22hljs-attr\x22\x3e\x22md5\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22323827382huwhdjshdjs\x22\x3c\/span\x3e,\n       \x3cspan class=\x22hljs-attr\x22\x3e\x22h5\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/dsds.html\x22\x3c\/span\x3e\n       \x3cspan class=\x22hljs-string\x22\x3e\x22v\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x221.5.0\x22\x3c\/span\x3e\n    }\n]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3epage\x3c\/code\x3e: 对应统一跳转的 path\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eurl\x3c\/code\x3e: 需要渲染的js，\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3emd5\x3c\/code\x3e: js文件的md5值用于校验，\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3eh5\x3c\/code\x3e: 渲染失败后的降级方案,\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ev\x3c\/code\x3e: 最低支持的版本号\x3c\/p\x3e\n\x3cp\x3e在页面访问h5页面时，拿url跟weexPages里的url进行对比，如果一致就采用weex打开。这里的对比，目前还比较简单粗暴，后续会进行优化，最终目标是\x3ccode\x3e只对比\x3c\/code\x3e?\x3ccode\x3e之前的一部分，后面的参数通过intent传入到weex页面，参与weex的渲染。\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e这样就达到了动态拦截，动态上线weex的目的。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader9\x22\x3e三、js预加载方案\x3c\/h1\x3e\n\x3cp\x3e前面讲到为了加快weex打开时间，会预加载js，这里就介绍一下js预加载的实现。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e1）每次更新完配置文件，遍历，查看是否存在md5一致的page_xxx.js文件，如果不存在则更新.\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e2）下载完成后，保存格式为xxx.js，校验md5\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e相同的话，记录文件的最后修改时间；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e不同的话，删除已下载文件，重新下载，重复校验流程。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e3）支持统一跳转协议，page对应目前app端的统一跳转协议里的page，有必要的时候可以替换原来的native页面，解决native页面错误不能及时修复的问题。加载失败的话，打开h5页面。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e4）每次打开指定页面的时候，先检查本地是否有对应page文件，再检验最后修改时间是否跟记录的一致\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e一致就加载\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e不一致就用线上url。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch1 id=\x22articleHeader10\x22\x3e四、遇到的问题以及解决方法\x3c\/h1\x3e\n\x3cp\x3e\x3cstrong\x3e问题一：上线后，发现在一些机型渲染失败，public void onException(WXSDKInstance instance, String errCode, String msg)回调里，errCode返回wx_create_instance_error，msg返回createInstance fail!\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e解决办法\x3c\/strong\x3e：将apk解压出来后，发现编译出了支持5种abi的包。然而libweexv8.so只在armeabi和x86里有，缺少对其它三种abi的支持，那么如果应用运行于arm64-v8a，x86_64，armeabi-v7a为首选abi的设备上时，就会加载失败了。其实arm64-v8a,armeabi-v7a，x86_64这三个abi，应用并不是必须要做支持，手机一般都会提供自动兼容。所以我们只要把对x86, arm64-v8a,x86_64的支持去掉就可以。如下在主模块的build.gradle的android里的defaultConfig内添加如下内容:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22defaultConfig {  \n    ndk {  \n        abiFilters \x26quot;armeabi\x26quot;, \x26quot;x86\x26quot;  \n    }  \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs nginx\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-section\x22\x3edefaultConfig\x3c\/span\x3e {  \n    \x3cspan class=\x22hljs-section\x22\x3endk\x3c\/span\x3e {  \n        \x3cspan class=\x22hljs-attribute\x22\x3eabiFilters\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22armeabi\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22x86\x22\x3c\/span\x3e  \n    }  \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000008641804?w=1360\x26amp;h=458\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000008641804?w=1360\x26amp;h=458\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e问题二：OkHttpAdapter里调用onHttpFinish出现解析异常\x3c\/strong\x3e，日志如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22com.alibaba.fastjson.JSONException: syntax error, pos 2\n    at com.alibaba.fastjson.parser.DefaultJSONParser.parse(DefaultJSONParser.java:1300)\n    at com.alibaba.fastjson.parser.DefaultJSONParser.parse(DefaultJSONParser.java:1210)\n    at com.alibaba.fastjson.JSON.parse(JSON.java:109)\n    at com.alibaba.fastjson.JSON.parse(JSON.java:100)\n    at com.taobao.weex.http.WXStreamModule.parseJson(WXStreamModule.java:378)\n    at com.taobao.weex.http.WXStreamModule$2.onResponse(WXStreamModule.java:365)\n    at com.taobao.weex.http.WXStreamModule$StreamHttpListener.onHttpFinish(WXStreamModule.java:523)\n    at com.showjoy.weex.commons.adapter.OkHttpAdapter$6.onResponse(OkHttpAdapter.java:161)\n    at okhttp3.RealCall$AsyncCall.execute(RealCall.java:133)\n    at okhttp3.internal.NamedRunnable.run(NamedRunnable.java:32)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1113)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:588)\n    at java.lang.Thread.run(Thread.java:818) \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3ecom\x3cspan class=\x22hljs-selector-class\x22\x3e.alibaba\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.fastjson\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.JSONException\x3c\/span\x3e: syntax error, pos \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n    at com\x3cspan class=\x22hljs-selector-class\x22\x3e.alibaba\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.fastjson\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.parser\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DefaultJSONParser\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.parse\x3c\/span\x3e(DefaultJSONParser\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1300\x3c\/span\x3e)\n    at com\x3cspan class=\x22hljs-selector-class\x22\x3e.alibaba\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.fastjson\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.parser\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.DefaultJSONParser\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.parse\x3c\/span\x3e(DefaultJSONParser\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1210\x3c\/span\x3e)\n    at com\x3cspan class=\x22hljs-selector-class\x22\x3e.alibaba\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.fastjson\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.JSON\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.parse\x3c\/span\x3e(JSON\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e109\x3c\/span\x3e)\n    at com\x3cspan class=\x22hljs-selector-class\x22\x3e.alibaba\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.fastjson\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.JSON\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.parse\x3c\/span\x3e(JSON\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e)\n    at com\x3cspan class=\x22hljs-selector-class\x22\x3e.taobao\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.weex\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.http\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.WXStreamModule\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.parseJson\x3c\/span\x3e(WXStreamModule\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e378\x3c\/span\x3e)\n    at com\x3cspan class=\x22hljs-selector-class\x22\x3e.taobao\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.weex\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.http\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.WXStreamModule\x3c\/span\x3e$\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e.onResponse(WXStreamModule\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e365\x3c\/span\x3e)\n    at com\x3cspan class=\x22hljs-selector-class\x22\x3e.taobao\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.weex\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.http\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.WXStreamModule\x3c\/span\x3e\x3cspan class=\x22hljs-variable\x22\x3e$StreamHttpListener\x3c\/span\x3e.onHttpFinish(WXStreamModule\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e523\x3c\/span\x3e)\n    at com\x3cspan class=\x22hljs-selector-class\x22\x3e.showjoy\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.weex\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.commons\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.adapter\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.OkHttpAdapter\x3c\/span\x3e$\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e.onResponse(OkHttpAdapter\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e161\x3c\/span\x3e)\n    at okhttp3.RealCall\x3cspan class=\x22hljs-variable\x22\x3e$AsyncCall\x3c\/span\x3e.execute(RealCall\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e133\x3c\/span\x3e)\n    at okhttp3\x3cspan class=\x22hljs-selector-class\x22\x3e.internal\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.NamedRunnable\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.run\x3c\/span\x3e(NamedRunnable\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e32\x3c\/span\x3e)\n    at java\x3cspan class=\x22hljs-selector-class\x22\x3e.util\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.concurrent\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.ThreadPoolExecutor\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.runWorker\x3c\/span\x3e(ThreadPoolExecutor\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e1113\x3c\/span\x3e)\n    at java\x3cspan class=\x22hljs-selector-class\x22\x3e.util\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.concurrent\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.ThreadPoolExecutor\x3c\/span\x3e\x3cspan class=\x22hljs-variable\x22\x3e$Worker\x3c\/span\x3e.run(ThreadPoolExecutor\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e588\x3c\/span\x3e)\n    at java\x3cspan class=\x22hljs-selector-class\x22\x3e.lang\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.Thread\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.run\x3c\/span\x3e(Thread\x3cspan class=\x22hljs-selector-class\x22\x3e.java\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e818\x3c\/span\x3e) \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e解决方法\x3c\/strong\x3e：catch异常\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22try {\n    if (null != listener) {\n        listener.onHttpFinish(wxResponse);\n    }\n} catch (Exception e) {\n    LogUtils.e(e);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e != listener) {\n        listener.onHttpFinish(wxResponse);\n    }\n} \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3eException\x3c\/span\x3e e) {\n    LogUtils.e(e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e问题三：相对地址以及线上线下环境切换问题。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e解决方法\x3c\/strong\x3e：在最新版本已支持相对地址，在.vue文件里链接以及请求地址使用相对地址，h5页面自动选择该页面使用的域名，而在iOS和Android都做拦截处理，根据当前环境添加相应的域名。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eAndroid 实现URIAdapter 注入\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eiOS 实现WXURLRewriteProtocol 注入\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cblockquote\x3e\x3cp\x3e参考链接：\x3cbr\x3e\x3ca href=\x22https:\/\/github.com\/weexteam\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/weexteam\/\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22http:\/\/weex-project.io\/doc\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/weex-project.io\/doc\/\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/github.com\/alibaba\/weex\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/alibaba\/weex\/\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>「Android」 详细全面的基于vue2.0Weex接入过程（Android视角）</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000008641798">https://segmentfault.com/a/1190000008641798</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/13mm6u7dsvn/" target="_blank">https://alili.tech/archive/13mm6u7dsvn/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/dc9tmbt89lc/">CSS3 巧妙实现聊天气泡<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/awfhylei7vr/">Element 一套优雅的 Vue 2 组件库是如何开发的<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/5n6e7oj31zb/">Ionic2入坑基础教程和安装指南<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/k9uktrr2ck/">JavaScript arguments 对象全面介绍<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/d31ygsiurr7/">JavaScript 版俄罗斯方块——重构<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/f1goxj498pc/">JavaScript中this绑定详解<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/fpk9tyls8sb/">Markcook2.0，使用Vue2.0和Vuex2.0进行完全重构升级<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/rnj4z8l02t/">N3-components - 强劲的 Vue UI组件库<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/7njdijhy2um/">Node.js &#43; React Native 毕设：农业物联网监测系统的开发手记<aside class="dates">2019-02-02</aside></a></li><li><a href="/archive/f8zzbybr4tl/">Redux、Flux、Vuex<aside class="dates">2019-02-02</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>