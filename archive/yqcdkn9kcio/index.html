<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="【Vue源码探究二】从 $mount 讲起，一起探究Vue的渲染机制"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>【Vue源码探究二】从 $mount 讲起，一起探究Vue的渲染机制 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/yqcdkn9kcio/",
				"appid": "1613049289050283", 
				"title": "【Vue源码探究二】从 $mount 讲起，一起探究Vue的渲染机制 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-14T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/hgdbkkaeyyg/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/re4beib9ua/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f&text=%e3%80%90Vue%e6%ba%90%e7%a0%81%e6%8e%a2%e7%a9%b6%e4%ba%8c%e3%80%91%e4%bb%8e%20%24mount%20%e8%ae%b2%e8%b5%b7%ef%bc%8c%e4%b8%80%e8%b5%b7%e6%8e%a2%e7%a9%b6Vue%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f&text=%e3%80%90Vue%e6%ba%90%e7%a0%81%e6%8e%a2%e7%a9%b6%e4%ba%8c%e3%80%91%e4%bb%8e%20%24mount%20%e8%ae%b2%e8%b5%b7%ef%bc%8c%e4%b8%80%e8%b5%b7%e6%8e%a2%e7%a9%b6Vue%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f&title=%e3%80%90Vue%e6%ba%90%e7%a0%81%e6%8e%a2%e7%a9%b6%e4%ba%8c%e3%80%91%e4%bb%8e%20%24mount%20%e8%ae%b2%e8%b5%b7%ef%bc%8c%e4%b8%80%e8%b5%b7%e6%8e%a2%e7%a9%b6Vue%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f&is_video=false&description=%e3%80%90Vue%e6%ba%90%e7%a0%81%e6%8e%a2%e7%a9%b6%e4%ba%8c%e3%80%91%e4%bb%8e%20%24mount%20%e8%ae%b2%e8%b5%b7%ef%bc%8c%e4%b8%80%e8%b5%b7%e6%8e%a2%e7%a9%b6Vue%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%90Vue%e6%ba%90%e7%a0%81%e6%8e%a2%e7%a9%b6%e4%ba%8c%e3%80%91%e4%bb%8e%20%24mount%20%e8%ae%b2%e8%b5%b7%ef%bc%8c%e4%b8%80%e8%b5%b7%e6%8e%a2%e7%a9%b6Vue%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f&title=%e3%80%90Vue%e6%ba%90%e7%a0%81%e6%8e%a2%e7%a9%b6%e4%ba%8c%e3%80%91%e4%bb%8e%20%24mount%20%e8%ae%b2%e8%b5%b7%ef%bc%8c%e4%b8%80%e8%b5%b7%e6%8e%a2%e7%a9%b6Vue%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f&title=%e3%80%90Vue%e6%ba%90%e7%a0%81%e6%8e%a2%e7%a9%b6%e4%ba%8c%e3%80%91%e4%bb%8e%20%24mount%20%e8%ae%b2%e8%b5%b7%ef%bc%8c%e4%b8%80%e8%b5%b7%e6%8e%a2%e7%a9%b6Vue%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f&title=%e3%80%90Vue%e6%ba%90%e7%a0%81%e6%8e%a2%e7%a9%b6%e4%ba%8c%e3%80%91%e4%bb%8e%20%24mount%20%e8%ae%b2%e8%b5%b7%ef%bc%8c%e4%b8%80%e8%b5%b7%e6%8e%a2%e7%a9%b6Vue%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyqcdkn9kcio%2f&title=%e3%80%90Vue%e6%ba%90%e7%a0%81%e6%8e%a2%e7%a9%b6%e4%ba%8c%e3%80%91%e4%bb%8e%20%24mount%20%e8%ae%b2%e8%b5%b7%ef%bc%8c%e4%b8%80%e8%b5%b7%e6%8e%a2%e7%a9%b6Vue%e7%9a%84%e6%b8%b2%e6%9f%93%e6%9c%ba%e5%88%b6"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">【Vue源码探究二】从 $mount 讲起，一起探究Vue的渲染机制</h1><div class="meta"><div class="postdate"><time datetime="2019-01-14" itemprop="datePublished">2019-01-14</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3emount， 意思为挂载。可以理解为将vue实例（逻辑应用），挂靠在某个dom元素（载体）上的一个过程。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e一、创建Vue实例时的渲染过程\x3c\/h2\x3e\n\x3cp\x3e上一篇文章我们讲到， 在创建一个vue实例的时候(var vm = new Vue(options))。Vue的构造函数将自动运行 this._init（启动函数）。启动函数的最后一步为initRender(vm)，\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ Vue.prototype._init\n    ...\n    initLifecycle(vm);\n    initEvents(vm);\n    callHook(vm, \x27beforeCreate\x27);\n    initState(vm);\n    callHook(vm, \x27created\x27);\n    initRender(vm);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs less\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Vue.prototype._init\x3c\/span\x3e\n    ...\n    \x3cspan class=\x22hljs-selector-tag\x22\x3einitLifecycle\x3c\/span\x3e(vm);\n    \x3cspan class=\x22hljs-selector-tag\x22\x3einitEvents\x3c\/span\x3e(vm);\n    \x3cspan class=\x22hljs-selector-tag\x22\x3ecallHook\x3c\/span\x3e(vm, \x3cspan class=\x22hljs-string\x22\x3e\x27beforeCreate\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-selector-tag\x22\x3einitState\x3c\/span\x3e(vm);\n    \x3cspan class=\x22hljs-selector-tag\x22\x3ecallHook\x3c\/span\x3e(vm, \x3cspan class=\x22hljs-string\x22\x3e\x27created\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-selector-tag\x22\x3einitRender\x3c\/span\x3e(vm);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3einitRender中调用vm.$mount(vm.$options.el)，将实例挂载到dom上，至此启动函数完成。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/initRender\n  ...\n  if (vm.$options.el) {\n    vm.$mount(vm.$options.el);\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lasso\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/initRender\x3c\/span\x3e\n  \x3cspan class=\x22hljs-params\x22\x3e...\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (vm.$options.el) {\n    vm.$mount(vm.$options.el);\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看出，vm.$mount为vue渲染的主要函数\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e二、Vue的渲染机制\x3c\/h2\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNSij?w=1023\x26amp;h=761\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNSij?w=1023\x26amp;h=761\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e上图，展示的是独立构建时的一个渲染流程图\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e模板字符串\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/模板字符串\n\x3cdiv id = \x26quot;app\x26quot;\x3e\n  \x22{{\x22message\x22}}\x22\n\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs axapta\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/模板字符串\x3c\/span\x3e\n\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e id = \x3cspan class=\x22hljs-string\x22\x3e\x22app\x22\x3c\/span\x3e\x26gt;\n  \x22{{\x22message\x22}}\x22\n\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3erender函数\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/render函数\nfunction anonymous() {\nwith(this){return _h(\x27div\x27,{attrs:{\x26quot;id\x26quot;:\x26quot;app\x26quot;\x22}}\x22,[\x26quot;\\n  \x26quot;\x2b_s(message)\x2b\x26quot;\\n\x26quot;])}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/render函数\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eanonymous\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n\x3cspan class=\x22hljs-keyword\x22\x3ewith\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e){\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e _h(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e,{attrs:{\x3cspan class=\x22hljs-string\x22\x3e\x22id\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22app\x22\x3c\/span\x3e\x22}}\x22,[\x3cspan class=\x22hljs-string\x22\x3e\x22\\n  \x22\x3c\/span\x3e\x2b_s(message)\x2b\x3cspan class=\x22hljs-string\x22\x3e\x22\\n\x22\x3c\/span\x3e])}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3evnode\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNSwj?w=278\x26amp;h=367\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNSwj?w=278\x26amp;h=367\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e真实dom节点($el)\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNSwT?w=146\x26amp;h=56\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNSwT?w=146\x26amp;h=56\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e独立构建 与 运行时构建\x3c\/h3\x3e\n\x3cp\x3e我们先看一下官方文档 \x3ca href=\x22https:\/\/cn.vuejs.org\/v2\/guide\/installation.html#%E7%8B%AC%E7%AB%8B%E6%9E%84%E5%BB%BA-vs-%E8%BF%90%E8%A1%8C%E6%97%B6%E6%9E%84%E5%BB%BA\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e独立构建和运行时构建\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNSxk?w=906\x26amp;h=310\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNSxk?w=906\x26amp;h=310\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这两个概念，我在初学的时候是一头雾水。现在对照着渲染的流程图，我们可以知道\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e独立构建：包含模板编译器\x3c\/strong\x3e\x3cbr\x3e渲染过程:  html字符串 → render函数 → vnode → 真实dom节点\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e运行时构建： 不包含模板编译器\x3c\/strong\x3e\x3cbr\x3e渲染过程:  render函数 → vnode → 真实dom节点\x3c\/p\x3e\n\x3cp\x3e运行时构建通过砍掉模板编译器，让整个包少了30%（官方数据）。我在阅读源码的过程中，发现vue源码7000余行，而和模板编译相关的代码，则约有1000行左右。看起来确实是轻便了。这是在鼓励我们多用render函数吗？\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e三、$mount函数\x3c\/h2\x3e\n\x3cp\x3e上面我们说到，运行时构建的包，会比独立构建少一个模板编译器。在$mount函数上也不同\x3c\/p\x3e\n\x3cp\x3e运行时构建的 $mount函数\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNSz7?w=510\x26amp;h=160\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNSz7?w=510\x26amp;h=160\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e而独立构建的 $mount函数，会先用一个临时变量mount保存上面的$mount方法\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var mount = Vue$2.prototype.$mount;  \/\/此处mount即为运行时版的 $mount\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs awk\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3evar mount = Vue\x3cspan class=\x22hljs-variable\x22\x3e$2\x3c\/span\x3e.prototype.\x3cspan class=\x22hljs-variable\x22\x3e$mount\x3c\/span\x3e;  \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e此处mount即为运行时版的 \x3cspan class=\x22hljs-variable\x22\x3e$mount\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后重写$mount函数，这时，调用$mount就会包括模板编译功能了\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var mount = Vue$2.prototype.$mount;\nVue$2.prototype.$mount = function (el, hydrating) {\n  ...省略代码（里面为模板编译器入口）...\n  return mount.call(this, el, hydrating)\n};\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e mount = Vue$\x3cspan class=\x22hljs-number\x22\x3e2.\x3c\/span\x3eprototype.$mount;\nVue$\x3cspan class=\x22hljs-number\x22\x3e2.\x3c\/span\x3eprototype.$mount = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(el, hydrating)\x3c\/span\x3e \x3c\/span\x3e{\n  ...省略代码（里面为模板编译器入口）...\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e mount.call(this, el, hydrating)\n};\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们可以看到，不管独立构建还是运行时构建，都会调用 vm._mount方法我们来看看源码\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Vue.prototype._mount = function(el, hydrating) {\n    ...一些防止运行时的包，却用了template的报错代码...\n\n\n    callHook(vm, \x27beforeMount\x27);\n\n    vm._watcher = new Watcher(vm, function () {\n      vm._update(vm._render(), hydrating);\n    }, noop);\n    \n    hydrating = false;\n\n    if (vm.$vnode == null) {\n      vm._isMounted = true;\n      callHook(vm, \x27mounted\x27);\n    }\n    return vm    \n    \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3eVue.prototype._mount = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(el, hydrating)\x3c\/span\x3e \x3c\/span\x3e{\n    ...一些防止运行时的包，却用了template的报错代码...\n\n\n    callHook(vm, \x3cspan class=\x22hljs-string\x22\x3e\x27beforeMount\x27\x3c\/span\x3e);\n\n    vm._watcher = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Watcher(vm, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n      vm._update(vm._render(), hydrating);\n    }, noop);\n    \n    hydrating = \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (vm.$vnode == \x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e) {\n      vm._isMounted = \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e;\n      callHook(vm, \x3cspan class=\x22hljs-string\x22\x3e\x27mounted\x27\x3c\/span\x3e);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e vm    \n    \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用过的vue的人，都会很敏锐地发现， 在调用beforeMount生命周期，和mounted生命周期中间的关键代码为\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNSPS?w=447\x26amp;h=112\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNSPS?w=447\x26amp;h=112\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e鉴于大牛已经讲过很多次这里的数据监听了，我们只讲其中渲染部分\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22vm._update(vm._render(), hydrating);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3evm\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e._update\x3c\/span\x3e(\x3cspan class=\x22hljs-selector-tag\x22\x3evm\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e._render\x3c\/span\x3e(), \x3cspan class=\x22hljs-selector-tag\x22\x3ehydrating\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3evm._render函数返回一个vnode作为 vm._update的参数。  hydrating是与服务器渲染(SSR)相关的，浏览器端可以不用管。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3evm._render  (将render函数转化成vnode)\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e最核心代码为\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var render = vm.$options.render\ntry{\n  vnode = render.call(vm._renderProxy, vm.$createElement);\n}catch{\n  ...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mel\x22\x3e\x3ccode\x3evar \x3cspan class=\x22hljs-keyword\x22\x3erender\x3c\/span\x3e = vm.$options.\x3cspan class=\x22hljs-keyword\x22\x3erender\x3c\/span\x3e\ntry{\n  vnode = \x3cspan class=\x22hljs-keyword\x22\x3erender\x3c\/span\x3e.call(vm._renderProxy, vm.$createElement);\n}\x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e{\n  ...\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此处，使用call方法， 将this指向 vm.renderProxy js功底差的同学要去补补知识了。  \x3cbr\x3evm.renderProxy是个代理，代理vm，主要用来报错，如果render函数上使用了vm上没有的属性或方法，就会报错。\x3cbr\x3evm.$createElement 这个是创建vnode的方法，作为第一个参数传入。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVNSVq?w=867\x26amp;h=458\x22 src=\x22https:\/\/static.alili.tech\/img\/bVNSVq?w=867\x26amp;h=458\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/cn.vuejs.org\/v2\/guide\/render-function.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3erender函数\x3c\/a\x3e\x3cbr\x3e这里的h即是， vm.$createElement ，便是在vm._render这个阶段被传入。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3evm._update （将vnode生成真实dom节点）\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e最关键一句话为\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 vm.$el = vm.__patch__(prevVnode, vnode);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autoit\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e vm.$el = vm.__patch__(prevVnode, vnode)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3evm.__patch__也是个大家伙，我之后会再去研究。\x3cbr\x3e里面的方法，将新旧vnode使用 diff算法进行比对，找出要替换的地方，这样更新dom的性能会有较大优化。\x3cbr\x3e最后会返回一个dom节点。\x3cbr\x3e\x3cstrong\x3e这个时候将vm.$el 赋值为这个dom节点，挂载完成！\x3c\/strong\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>【Vue源码探究二】从 $mount 讲起，一起探究Vue的渲染机制</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000009467029">https://segmentfault.com/a/1190000009467029</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/yqcdkn9kcio/" target="_blank">https://alili.tech/archive/yqcdkn9kcio/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5fmk2pl6rab/">2016年前端开发者深度调研，看看别人使用什么技术体系<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/stp6408xnu/">Bootstrap使用模态框modal实现表单提交弹出框<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/fu7a86e9uyh/">CSS水平垂直居中总结<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/r0w29esklr/">JS 里怎么给数组填充默认值<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/i00hiszlr1/">JavaScript - EventEmitter 背后的秘密<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/u2la0cn9do/">JavaScript 精度丢失问题<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/3txhfn3ejcb/">Nodejs进阶：如何玩转子进程（child_process）<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/yr7v8e9fao/">Promise介绍--规范篇<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/9lyxyz4wc6g/">QQ音乐API整理<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/84zzlljmes4/">SegmentFault 技术周刊 Vol.14 - 进阶 Vue 2.0<aside class="dates">2019-01-30</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>