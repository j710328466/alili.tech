<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="对javascript中闭包的理解"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>对javascript中闭包的理解 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/25rnu0grq2e/",
				"appid": "1613049289050283", 
				"title": "对javascript中闭包的理解 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-09T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/518e3202r6v/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/er7ntmx7kip/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f&text=%e5%af%b9javascript%e4%b8%ad%e9%97%ad%e5%8c%85%e7%9a%84%e7%90%86%e8%a7%a3"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f&text=%e5%af%b9javascript%e4%b8%ad%e9%97%ad%e5%8c%85%e7%9a%84%e7%90%86%e8%a7%a3"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f&title=%e5%af%b9javascript%e4%b8%ad%e9%97%ad%e5%8c%85%e7%9a%84%e7%90%86%e8%a7%a3"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f&is_video=false&description=%e5%af%b9javascript%e4%b8%ad%e9%97%ad%e5%8c%85%e7%9a%84%e7%90%86%e8%a7%a3"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%af%b9javascript%e4%b8%ad%e9%97%ad%e5%8c%85%e7%9a%84%e7%90%86%e8%a7%a3&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f&title=%e5%af%b9javascript%e4%b8%ad%e9%97%ad%e5%8c%85%e7%9a%84%e7%90%86%e8%a7%a3"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f&title=%e5%af%b9javascript%e4%b8%ad%e9%97%ad%e5%8c%85%e7%9a%84%e7%90%86%e8%a7%a3"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f&title=%e5%af%b9javascript%e4%b8%ad%e9%97%ad%e5%8c%85%e7%9a%84%e7%90%86%e8%a7%a3"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f25rnu0grq2e%2f&title=%e5%af%b9javascript%e4%b8%ad%e9%97%ad%e5%8c%85%e7%9a%84%e7%90%86%e8%a7%a3"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">对javascript中闭包的理解</h1><div class="meta"><div class="postdate"><time datetime="2019-01-09" itemprop="datePublished">2019-01-09</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e在前端开发中闭包是一个很重要的知识点，是面试中一定会被问到的内容。之前我对闭包的理解主要是\x22通过闭包可以在函数外部能访问到函数内部的变量\x22，对闭包运用的也很少，甚至自己写过闭包自己都不太清楚，只知道这样写可以解决问题。最近在梳理自己的js知识点，发现自己对js闭包理解的很不透彻，于是想全面的分析一下闭包，特别是闭包的形成原因和闭包的使用场景。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e闭包的定义\x3c\/h3\x3e\n\x3cp\x3e闭包是指有权访问另一个函数作用域中的变量的函数  --《JavaScript高级程序设计》\x3c\/p\x3e\n\x3cp\x3e函数对象可以通过作用域关联起来，函数体内的变量都可以保存在函数作用域内，这在计算机科学文献中称为“闭包”,所有的javascirpt函数都是闭包 --《Javascript权威指南》\x3c\/p\x3e\n\x3cp\x3e看完这些专业的定义是不是感觉一头雾水，没关系，我和一样也没明白这些定义说的是啥，咱接着往下分析。  \x3c\/p\x3e\n\x3cp\x3e在认识闭包原理之前我们先必须对作用域、执行上下文、执行上下文堆栈、变量对象、活动对象、作用域链有着全面的认识\x3c\/p\x3e\n\x3ch4\x3e作用域 Scope\x3c\/h4\x3e\n\x3cp\x3e作用域是一套规则，用于确定在何处以及如何查找变量(标识符)  \x3cbr\x3e作用域共有两种主要的工作模型：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e词法作用域：作用域是在编写代码的时候确定的\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e动态作用域：作用域是在代码运行的时候确定的\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我们知道javascript使用的是词法作用域\x3c\/p\x3e\n\x3ch4\x3e执行上下文 Execution Contexts\x3c\/h4\x3e\n\x3cp\x3eJavascript中代码的执行上下文分为以下三种：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e全局级别的代码 – 这个是默认的代码运行环境，一旦代码被载入，引擎最先进入的就是这个环境。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e函数级别的代码 – 当执行一个函数时，运行函数体中的代码。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eEval的代码 – 在Eval函数内运行的代码。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e一个执行的上下文可以抽象的理解为一个对象。每一个执行的上下文都有一系列的属性(变量对象(variable object)，this指针(this value)，作用域链(scope chain) )\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Execution Contexts = {\n    variable object：变量对象;\n    this value: this指针;\n    scope chain：作用域链;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ceylon\x22\x3e\x3ccode\x3eExecution Contexts = {\n    \x3cspan class=\x22hljs-keyword\x22\x3evariable\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eobject\x3c\/span\x3e：变量对象;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e指针;\n    scope chain：作用域链;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e执行上下文堆栈 Execution Contexts Stack\x3c\/h4\x3e\n\x3cp\x3e活动的执行上下文组在逻辑上组成一个堆栈。堆栈底部永远都是全局上下文(globalContext)，而顶部就是当前(活动的)执行上下文。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\nfunction add(num){\n    var sum = 5;\n    return sum \x2b num;\n}\nvar sum = add(4);\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(num)\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sum = \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sum \x2b num;\n}\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sum = add(\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e);\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当add函数被调用时，add函数执行上下文被压入执行上下文堆栈的顶端，此时执行上下文堆栈可表示为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22EC Stack = [\n  \x3cadd\x3e functionContext\n  globalContext\n];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode\x3eEC Stack = [\n  \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3eadd\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e\x26gt; \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3eContext\n\x3c\/span\x3e  globalContext\n];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eadd函数执行完毕后，其执行上下文将会从执行上下文堆栈顶端弹出并被销毁。全局执行上下文只有在浏览器关闭时才会从执行上下文堆栈中销毁\x3c\/p\x3e\n\x3ch4\x3e变量对象 Variable Object\x3c\/h4\x3e\n\x3cp\x3e如果变量与执行上下文相关，那变量自己应该知道它的数据存储在哪里，并且知道如何访问。这种机制称为变量对象(variable object)。  \x3cbr\x3e可以说变量对象是与执行上下文相关的数据作用域(scope of data) 。它是与执行上下文关联的特殊对象，用于存储被定义在执行上下文中的变量(variables)、函数声明(function declarations) 。  \x3cbr\x3e当进入全局上下文时，全局上下文的变量对象可表示为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22VO = {\n    add: \x3creference to function\x3e,\n    sum: undefined,\n    Math: \x3c...\x3e,\n    String: \x3c...\x3e\n    ...\n    window: global \/\/引用自身\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3eVO = {\n\x3cspan class=\x22hljs-symbol\x22\x3e    add:\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e\x26lt;reference to function\x26gt;\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    sum:\x3c\/span\x3e undefined,\n\x3cspan class=\x22hljs-symbol\x22\x3e    Math:\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e\x26lt;...\x26gt;\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    String:\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e\x26lt;...\x26gt;\x3c\/span\x3e\n    ...\n\x3cspan class=\x22hljs-symbol\x22\x3e    window:\x3c\/span\x3e global \x3cspan class=\x22hljs-comment\x22\x3e\/\/引用自身\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e活动对象 Activation Object\x3c\/h4\x3e\n\x3cp\x3e当函数被调用者激活时，这个特殊的活动对象(activation object) 就被创建了。它包含普通参数(formal parameters) 与特殊参数(arguments)对象(具有索引属性的参数映射表)。活动对象在函数上下文中作为变量对象使用。  \x3cbr\x3e当add函数被调用时，add函数执行上下文被压入执行上下文堆栈的顶端，add函数执行上下文中活动对象可表示为\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22AO = {\n    num: 4,\n    sum :5,\n    arguments:{0:4}\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3eAO = {\n\x3cspan class=\x22hljs-symbol\x22\x3e    num:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e,\n    sum :\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    arguments:\x3c\/span\x3e{\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e}\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e作用域链 Scope Chain\x3c\/h4\x3e\n\x3cp\x3e函数上下文的作用域链在函数调用时创建的，包含活动对象AO和这个函数内部的[[scope]]属性。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var x = 10;\nfunction foo() {\n  var y = 20;\n  function bar() {\n    var z = 30;\n    alert(x \x2b  y \x2b z);\n  }\n  bar();\n}\nfoo(); \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e x = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e;\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efoo\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e y = \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebar\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e z = \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e;\n    alert(x \x2b  y \x2b z);\n  }\n  bar();\n}\nfoo(); \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在这段代码中我们看到变量\x22y\x22在函数\x22foo\x22中定义（意味着它在foo上下文的AO中）\x22z\x22在函数\x22bar\x22中定义，但是变量\x22x\x22并未在\x22bar\x22上下文中定义，相应地，它也不会添加到\x22bar\x22的AO中。乍一看，变量\x22x\x22相对于函数\x22bar\x22根本就不存在；  \x3cbr\x3e函数\x22bar\x22如何访问到变量\x22x\x22？理论上函数应该能访问一个更高一层上下文的变量对象。实际上它正是这样，这种机制是通过函数内部的[[scope]]属性来实现的。  \x3cbr\x3e[[scope]]是所有父级变量对象的层级链，处于当前函数上下文之上，在函数创建时存于其中。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e注意: \x3c\/strong\x3e[[scope]]在函数创建时被存储是静态的（不变的），直至函数销毁。即：函数可以永不调用，但[[scope]]属性已经写入，并存储在函数对象中。  \x3cbr\x3e在这里我们逐步分析下     \x3cbr\x3e全局上下文的变量对象是：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22globalContext.VO === Global = {\n  x: 10\n  foo: \x3creference to function\x3e\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs monkey\x22\x3e\x3ccode\x3eglobalContext.VO === \x3cspan class=\x22hljs-keyword\x22\x3eGlobal\x3c\/span\x3e = {\n  x: \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e\n  foo: \x26lt;reference \x3cspan class=\x22hljs-keyword\x22\x3eto\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在\x22foo\x22创建时，\x22foo\x22的[[scope]]属性是：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22foo.[[Scope]] = [\n  globalContext.VO\n];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lua\x22\x3e\x3ccode\x3efoo.\x3cspan class=\x22hljs-string\x22\x3e[[Scope]]\x3c\/span\x3e = [\n  globalContext.VO\n];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在\x22foo\x22激活时（进入上下文），\x22foo\x22上下文的活动对象是：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22fooContext.AO = {\n  y: 20,\n  bar: \x3creference to function\x3e\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3efooContext.AO = {\n\x3cspan class=\x22hljs-symbol\x22\x3e  y:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e  bar:\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e\x26lt;reference to function\x26gt;\x3c\/span\x3e\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x22foo\x22上下文的作用域链为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22fooContext.Scope = [\n  fooContext.AO,\n  globalContext.VO\n];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode\x3efooContext.\x3cspan class=\x22hljs-keyword\x22\x3eScope \x3c\/span\x3e= [\n  fooContext.AO,\n  globalContext.VO\n]\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e内部函数\x22bar\x22创建时，其[[scope]]为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22bar.[[Scope]] = [\n  fooContext.AO,\n  globalContext.VO\n];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lua\x22\x3e\x3ccode\x3ebar.\x3cspan class=\x22hljs-string\x22\x3e[[Scope]]\x3c\/span\x3e = [\n  fooContext.AO,\n  globalContext.VO\n];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在\x22bar\x22激活时，\x22bar\x22上下文的活动对象为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22barContext.AO = {\n  z: 30\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3ebarContext.AO \x3c\/span\x3e= {\n  z: \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e\n}\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x22bar\x22上下文的作用域链为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22bar.Scope= [\n  barContext.AO,\n  fooContext.AO,\n  globalContext.VO\n];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3ebar.Scope= \x3c\/span\x3e[\n  \x3cspan class=\x22hljs-keyword\x22\x3ebarContext.AO,\n\x3c\/span\x3e  fooContext.AO,\n  globalContext.VO\n]\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e介绍了一大堆内容，是不是有点晕忽忽的？坚持一下，下面是重点\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e闭包的原理\x3c\/h3\x3e\n\x3cp\x3e我们通过一个闭包的例子来分析一下闭包的形成原理\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function add(){\n    var sum =5;\n    var func = function () {\n        console.log(sum);\n    }\n    return func;\n}\nvar addFunc = add();\naddFunc(); \/\/5\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eadd\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sum =\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e func = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(sum);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e func;\n}\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e addFunc = add();\naddFunc(); \x3cspan class=\x22hljs-comment\x22\x3e\/\/5\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ejs执行流进入全局执行上下文环境时,全局执行上下文可表示为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22globalContext = {\n    VO: {\n        add: \x3creference to function\x3e,\n        addFunc: undefined\n    },\n    this: window,\n    scope chain: window \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3eglobalContext = {\n\x3cspan class=\x22hljs-symbol\x22\x3e    VO:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e        add:\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e\x26lt;reference to function\x26gt;\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e        addFunc:\x3c\/span\x3e undefined\n    },\n\x3cspan class=\x22hljs-symbol\x22\x3e    this:\x3c\/span\x3e window,\n    scope chain: window \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当add函数被调用时，add函数执行上下文可表示为：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22addContext = {\n    AO: {\n        sum: undefined \/\/代码进入执行阶段时此处被赋值为5\n        func: undefined \/\/代码进入执行阶段时此处被赋值为function (){console.log(sum);}\n    },\n    this: window,\n    scope chain: addContext.AO \x2b globalContext.VO \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3eaddContext = {\n\x3cspan class=\x22hljs-symbol\x22\x3e    AO:\x3c\/span\x3e {\n\x3cspan class=\x22hljs-symbol\x22\x3e        sum:\x3c\/span\x3e undefined \x3cspan class=\x22hljs-comment\x22\x3e\/\/代码进入执行阶段时此处被赋值为5\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e        func:\x3c\/span\x3e undefined \x3cspan class=\x22hljs-comment\x22\x3e\/\/代码进入执行阶段时此处被赋值为function (){console.log(sum);}\x3c\/span\x3e\n    },\n\x3cspan class=\x22hljs-symbol\x22\x3e    this:\x3c\/span\x3e window,\n    scope chain: addContext.AO \x2b globalContext.VO \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eadd函数执行完毕后，js执行流回到全局上下文环境中，将add函数的返回值赋值给addFunc。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e由于addFunc仍保存着func函数的引用，所以add函数执行上下文从执行上下文堆栈顶端弹出后并未被销毁而是保存在内存中。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e当addFunc()执行时，func函数被调用，此时func函数执行上下文可表示为:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22funcContext = {\n    this: window,\n    scope chain: addContext.AO \x2b globalContext.VO \n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3efuncContext = {\n    this: window,\n    scope chain: addContext\x3cspan class=\x22hljs-selector-class\x22\x3e.AO\x3c\/span\x3e \x2b globalContext\x3cspan class=\x22hljs-selector-class\x22\x3e.VO\x3c\/span\x3e \n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当要访问变量sum时，func的活动对象中未能找到，则会沿着作用域链查找，由于js遵循词法作用域，作用域在函数创建阶段就被确定，在add函数的活动对象中找到sum = 5;  \x3c\/p\x3e\n\x3cp\x3e介绍到这里你明白形成闭包的原因了吗？  \x3cbr\x3e\x3cstrong\x3eJavascript允许使用内部函数---即函数定义和函数表达式位于另一个函数的函数体内。而且，这些内部函数可以访问它们所在的外部函数中声明的所有局部变量、参数和声明的其他内部函数。当其中一个这样的内部函数在包含它们的外部函数之外被调用时，就会形成闭包。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e闭包的用途\x3c\/h3\x3e\n\x3cp\x3e闭包可以用在许多地方。它的最大用处有两个，一个是前面提到的可以读取函数内部的变量，另一个就是让这些变量的值始终保持在内存中。\x3c\/p\x3e\n\x3ch4\x3e1. 保护变量的安全实现JS私有属性和私有方法\x3c\/h4\x3e\n\x3cp\x3e利用闭包可以读取函数内部的变量，变量在函数外部不能直接读取到，从而达到保护变量安全的作用。因为私有方法在函数内部都能被访问到，从而实现了私有属性和方法的共享。  \x3cbr\x3e常见的模块模式就是利用闭包的这种特性建立的\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var Counter = (function() {\n  \/\/私有属性\n  var privateCounter = 0; \n  \/\/私有方法\n  function changeBy(val) { \n    privateCounter \x2b= val;\n  }\n  return {\n    increment: function() {\n      changeBy(1);\n    },\n    decrement: function() {\n      changeBy(-1);\n    },\n    value: function() {\n      return privateCounter;\n    }\n  }   \n})();\nconsole.log(privateCounter); \/\/privateCounter is not defined \nconsole.log(Counter.value()); \/\/ 0\nCounter.increment();\nCounter.increment();\nconsole.log(Counter.value()); \/\/ 2\nCounter.decrement();\nconsole.log(Counter.value()); \/\/ 1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e Counter = (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/私有属性\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e privateCounter = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/私有方法\x3c\/span\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3echangeBy\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eval\x3c\/span\x3e) \x3c\/span\x3e{ \n    privateCounter \x2b= val;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3eincrement\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      changeBy(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3edecrement\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      changeBy(\x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e);\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e privateCounter;\n    }\n  }   \n})();\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(privateCounter); \x3cspan class=\x22hljs-comment\x22\x3e\/\/privateCounter is not defined \x3c\/span\x3e\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(Counter.value()); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 0\x3c\/span\x3e\nCounter.increment();\nCounter.increment();\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(Counter.value()); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\nCounter.decrement();\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(Counter.value()); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在jQuery框架的私有方法和变量也是这么设计的\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var $ = jQuery = function(){\n    return jQuery.fn.init();\n}\njQuery.fn = jQuery.prototype = {\n    init:function(){\n        return this;  \/\/this指向jQuery.prototype\n    },\n    length: 1,\n    size: function(){\n        return this.length;\n    }\n}\nconsole.log($().size()); \/\/ 1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e $ = jQuery = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e jQuery.fn.init();\n}\njQuery.fn = jQuery.prototype = {\n    \x3cspan class=\x22hljs-attr\x22\x3einit\x3c\/span\x3e:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/this指向jQuery.prototype\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3elength\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3esize\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.length;\n    }\n}\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log($().size()); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e2. 将处理结果缓存\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var CachedSearchBox = (function(){    \n    var cache = {},count = [];    \n    return {    \n       attachSearchBox : function(dsid){    \n           if(dsid in cache){\/\/如果结果在缓存中    \n              return cache[dsid];\/\/直接返回缓存中的对象    \n           }    \n           var fsb = new uikit.webctrl.SearchBox(dsid);\/\/新建    \n           cache[dsid] = fsb;\/\/更新缓存    \n           if(count.length \x3e 100){\/\/保正缓存的大小\x3c=100    \n              delete cache[count.shift()];    \n           }    \n           return fsb;          \n       }\n    };    \n})();    \n     \nCachedSearchBox.attachSearchBox(\x26quot;input\x26quot;);  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e CachedSearchBox = (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{    \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cache = {},count = [];    \n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {    \n       \x3cspan class=\x22hljs-attr\x22\x3eattachSearchBox\x3c\/span\x3e : \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edsid\x3c\/span\x3e)\x3c\/span\x3e{    \n           \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(dsid \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e cache){\x3cspan class=\x22hljs-comment\x22\x3e\/\/如果结果在缓存中    \x3c\/span\x3e\n              \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e cache[dsid];\x3cspan class=\x22hljs-comment\x22\x3e\/\/直接返回缓存中的对象    \x3c\/span\x3e\n           }    \n           \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e fsb = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e uikit.webctrl.SearchBox(dsid);\x3cspan class=\x22hljs-comment\x22\x3e\/\/新建    \x3c\/span\x3e\n           cache[dsid] = fsb;\x3cspan class=\x22hljs-comment\x22\x3e\/\/更新缓存    \x3c\/span\x3e\n           \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(count.length \x26gt; \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e){\x3cspan class=\x22hljs-comment\x22\x3e\/\/保正缓存的大小\x26lt;=100    \x3c\/span\x3e\n              \x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e cache[count.shift()];    \n           }    \n           \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e fsb;          \n       }\n    };    \n})();    \n     \nCachedSearchBox.attachSearchBox(\x3cspan class=\x22hljs-string\x22\x3e\x22input\x22\x3c\/span\x3e);  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样我们在第二次调用的时候，就会从缓存中读取到该对象。  \x3c\/p\x3e\n\x3cp\x3e理解了闭包的原理我们发现闭包的这些用途都是利用了闭包保存了当前函数的活动对象的特点，这样闭包函数在作用域之外被调用时依然能够访问其创建时的作用域\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e闭包的缺点\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e闭包将函数的活动对象维持在内存中，过度使用闭包会导致内存占用过多，所以在使用完后需要将保存在内存中的活动对象解除引用；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e闭包只能取得外部函数中任何变量的最后一个值，在使用循环且返回的函数中带有循环变量时会得到错误结果；\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e当返回的函数为匿名函数时，注意匿名函数中的this指的是window对象。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e这里仅仅是我对闭包的一些见解，若有错误的地方，还望大家提出，一起交流共同进步！  \x3cbr\x3e\x3cstrong\x3e参考文献\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e《你不知道的JavaScript》上卷\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/TomXu\/archive\/2011\/12\/15\/2288411.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e深入理解JavaScript系列\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>对javascript中闭包的理解</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010107111">https://segmentfault.com/a/1190000010107111</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/25rnu0grq2e/" target="_blank">https://alili.tech/archive/25rnu0grq2e/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5fmk2pl6rab/">2016年前端开发者深度调研，看看别人使用什么技术体系<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/stp6408xnu/">Bootstrap使用模态框modal实现表单提交弹出框<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/fu7a86e9uyh/">CSS水平垂直居中总结<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/r0w29esklr/">JS 里怎么给数组填充默认值<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/i00hiszlr1/">JavaScript - EventEmitter 背后的秘密<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/u2la0cn9do/">JavaScript 精度丢失问题<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/3txhfn3ejcb/">Nodejs进阶：如何玩转子进程（child_process）<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/yr7v8e9fao/">Promise介绍--规范篇<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/9lyxyz4wc6g/">QQ音乐API整理<aside class="dates">2019-01-30</aside></a></li><li><a href="/archive/84zzlljmes4/">SegmentFault 技术周刊 Vol.14 - 进阶 Vue 2.0<aside class="dates">2019-01-30</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>