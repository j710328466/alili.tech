<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="使用react.js制作pixiv插画图片墙"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>使用react.js制作pixiv插画图片墙 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/9ci508i9qye/",
				"appid": "1613049289050283", 
				"title": "使用react.js制作pixiv插画图片墙 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-01T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/v1o2b6buf9f/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/4h4i56jtmvo/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f&text=%e4%bd%bf%e7%94%a8react.js%e5%88%b6%e4%bd%9cpixiv%e6%8f%92%e7%94%bb%e5%9b%be%e7%89%87%e5%a2%99"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f&text=%e4%bd%bf%e7%94%a8react.js%e5%88%b6%e4%bd%9cpixiv%e6%8f%92%e7%94%bb%e5%9b%be%e7%89%87%e5%a2%99"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f&title=%e4%bd%bf%e7%94%a8react.js%e5%88%b6%e4%bd%9cpixiv%e6%8f%92%e7%94%bb%e5%9b%be%e7%89%87%e5%a2%99"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f&is_video=false&description=%e4%bd%bf%e7%94%a8react.js%e5%88%b6%e4%bd%9cpixiv%e6%8f%92%e7%94%bb%e5%9b%be%e7%89%87%e5%a2%99"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%bd%bf%e7%94%a8react.js%e5%88%b6%e4%bd%9cpixiv%e6%8f%92%e7%94%bb%e5%9b%be%e7%89%87%e5%a2%99&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f&title=%e4%bd%bf%e7%94%a8react.js%e5%88%b6%e4%bd%9cpixiv%e6%8f%92%e7%94%bb%e5%9b%be%e7%89%87%e5%a2%99"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f&title=%e4%bd%bf%e7%94%a8react.js%e5%88%b6%e4%bd%9cpixiv%e6%8f%92%e7%94%bb%e5%9b%be%e7%89%87%e5%a2%99"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f&title=%e4%bd%bf%e7%94%a8react.js%e5%88%b6%e4%bd%9cpixiv%e6%8f%92%e7%94%bb%e5%9b%be%e7%89%87%e5%a2%99"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f9ci508i9qye%2f&title=%e4%bd%bf%e7%94%a8react.js%e5%88%b6%e4%bd%9cpixiv%e6%8f%92%e7%94%bb%e5%9b%be%e7%89%87%e5%a2%99"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">使用react.js制作pixiv插画图片墙</h1><div class="meta"><div class="postdate"><time datetime="2019-02-01" itemprop="datePublished">2019-02-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e学习了一段时间的react，完成了一个WebApp。\x3cbr\x3e这是一个\x3ccode\x3epixiv.net\x3c\/code\x3e的插画图片墙，我把它叫做\x3ccode\x3epixivの「ラブライブ」発見\x3c\/code\x3e，意思就是发现\x3ccode\x3epixiv.net\x3c\/code\x3e上有关\x3ccode\x3eラブライブ LoveLive!学园偶像祭\x3c\/code\x3e的作品。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e项目很简单，就是一个瀑布流无限加载的列表，主要用到的技术栈：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3ereact\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3ereact-router\x3c\/strong\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3ereact-mdl\x3c\/strong\x3e google的material design lite框架在react上的组装\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3ereact-masonry-component\x3c\/strong\x3e jquery.masonry瀑布流布局插件在react上的实现\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e关于AJAX请求，有很多选择：\x3ccode\x3efetch\x3c\/code\x3e、\x3ccode\x3esuperagent\x3c\/code\x3e、\x3ccode\x3eaxios\x3c\/code\x3e，甚至是\x27jQuery.ajax\x27。综合比较，符合标准规范的\x3ccode\x3efetch\x3c\/code\x3e无疑是最好的选择。在不支持的浏览器上可以使用\x3ca href=\x22https:\/\/github.com\/github\/fetch\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3efetch-polyfill\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e其他应该没什么好说的，主要是性能问题也花了一段时间。\x3cbr\x3e这个应用中有一个长列表，每一个图片组件上都绑定了一个\x3ccode\x3eonClick\x3c\/code\x3e事件，如果列表数量上来了，性能问题就很明显，解决方案主要有以下两点：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e不要在\x3ccode\x3eonClick\x3c\/code\x3e中进行\x3ccode\x3ebind(this)\x3c\/code\x3e操作，因为这样每次render都会生成一个新的函数，性能影响可想而知。同样的，使用箭头函数\x3ccode\x3e()=\x26gt;{}\x3c\/code\x3e也是一样的道理，它也会自动bind一次。比较好的方案是在\x3ccode\x3econstructor\x3c\/code\x3e中事先bind好，\x3ca href=\x22https:\/\/daveceddia.com\/avoid-bind-when-passing-props\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDon\x27t Use Bind When Passing Props\x3c\/a\x3e 这篇文章提到了共9种解决方案，各有利弊。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e我们都知道，react循环中的列表必须赋予一个\x3ccode\x3ekey\x3c\/code\x3e属性，这个属性不是给用户自己用的，而是给 React 自己用的。你必须为数组中的元素提供唯一的 \x3ccode\x3ekey\x3c\/code\x3e 属性，我们可能会直接使用数组的\x3ccode\x3eindex\x3c\/code\x3e作为\x3ccode\x3ekey\x3c\/code\x3e，这其实是多次一举的，因为你不提供\x3ccode\x3ekey\x3c\/code\x3e的话，react默认采用的正是\x3ccode\x3eindex\x3c\/code\x3e。比较好的方案是使用\x3ca href=\x22https:\/\/www.npmjs.com\/package\/shortid\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eshortid\x3c\/a\x3e这个包来生成，主要参考了\x3ca href=\x22https:\/\/medium.com\/@robinpokorny\/index-as-a-key-is-an-anti-pattern-e0349aece318#.kxj9ttkx4\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eIndex as a key is an anti-pattern\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e其它的一些微小的优化：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e把javascript缓存在localStorage里，版本变动后才会去服务器下载新的js，解决方案来自 \x3ca href=\x22https:\/\/imququ.com\/post\/wpo-of-mobile-web-1.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e移动 WEB 通用优化策略介绍（一）\x3c\/a\x3e。localStorage缓存静态资源，在移动端和高版本的浏览器上还是值得尝试的的。虽然可以通过浏览器缓存静态文件，但在一些情况下（比如f5刷新），还是会发起 cache-control:max-age=0 的请求。出于节约请求的目的，可以改造一下静态资源的请求方式，将所有的静态资源都通过一个请求来加载。这样的话，无论如何，页面都只会发这一个请求，如果静态文件有更新，则服务端返回更新的文件内容，通过js插入到页面中并缓存在localStorage中；如果静态文件没有更新，则直接从localStorage中取出来，插入到页面中就可以了。对于移动端来说，将js和css这些静态文件的请求缩减成一个，还是很有效果的，具体可以参考一下百度移动版，使用的就是这个方案。对于单页面应用来说，使用localStorage储存模板也是个很好的选择。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e把ajax请求也缓存，当数据过期后，再去请求api。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e另外推荐一个react各种问题集合：\x3ca href=\x22https:\/\/github.com\/timarney\/react-faq\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ereact-faq\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e项目地址在这里：\x3cbr\x3e\x3ca href=\x22https:\/\/pixiv.moe\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/pixiv.moe\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/github.com\/LoveLiveSunshine\/pixiv.moe\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/LoveLiveSunshine\/pixiv.moe\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e放一张GIF预览图：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22https:\/\/ws4.sinaimg.cn\/large\/0060lm7Tgw1f9kwxn3unug30ks0cfkjn.gif\x22 src=\x22https:\/\/static.alili.techhttps:\/\/ws4.sinaimg.cn\/large\/0060lm7Tgw1f9kwxn3unug30ks0cfkjn.gif\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>使用react.js制作pixiv插画图片墙</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007421196">https://segmentfault.com/a/1190000007421196</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/9ci508i9qye/" target="_blank">https://alili.tech/archive/9ci508i9qye/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/sj57jxyoook/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（上）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/qsw902j95k/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（下）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/nnpmjlot58j/">IndexedDB使用与出坑指南<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/alvlbas9oai/">JS事件模型<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/u0pzym8k36o/">JS练习实例--编写经典小游戏俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/khwpyk5yz8q/">JavaScript 事件代理和委托<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/kuocl6lc3n/">JavaScript 版俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/n8bk54lyrf/">Promise学习:基础入门<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/7bk7u30qncb/">Redux 入坑进阶 - 源码解析<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/853kqfmqmf7/">Snap.svg 基本知识入门<aside class="dates">2019-02-03</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>