<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="八段代码彻底掌握Promise"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>八段代码彻底掌握Promise | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qu7vzmp3h8g/",
				"appid": "1613049289050283", 
				"title": "八段代码彻底掌握Promise | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-07T02:30:11"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ca0ouhz2l3v/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/xn1fqi6tdm/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f&text=%e5%85%ab%e6%ae%b5%e4%bb%a3%e7%a0%81%e5%bd%bb%e5%ba%95%e6%8e%8c%e6%8f%a1Promise"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f&text=%e5%85%ab%e6%ae%b5%e4%bb%a3%e7%a0%81%e5%bd%bb%e5%ba%95%e6%8e%8c%e6%8f%a1Promise"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f&title=%e5%85%ab%e6%ae%b5%e4%bb%a3%e7%a0%81%e5%bd%bb%e5%ba%95%e6%8e%8c%e6%8f%a1Promise"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f&is_video=false&description=%e5%85%ab%e6%ae%b5%e4%bb%a3%e7%a0%81%e5%bd%bb%e5%ba%95%e6%8e%8c%e6%8f%a1Promise"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%85%ab%e6%ae%b5%e4%bb%a3%e7%a0%81%e5%bd%bb%e5%ba%95%e6%8e%8c%e6%8f%a1Promise&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f&title=%e5%85%ab%e6%ae%b5%e4%bb%a3%e7%a0%81%e5%bd%bb%e5%ba%95%e6%8e%8c%e6%8f%a1Promise"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f&title=%e5%85%ab%e6%ae%b5%e4%bb%a3%e7%a0%81%e5%bd%bb%e5%ba%95%e6%8e%8c%e6%8f%a1Promise"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f&title=%e5%85%ab%e6%ae%b5%e4%bb%a3%e7%a0%81%e5%bd%bb%e5%ba%95%e6%8e%8c%e6%8f%a1Promise"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqu7vzmp3h8g%2f&title=%e5%85%ab%e6%ae%b5%e4%bb%a3%e7%a0%81%e5%bd%bb%e5%ba%95%e6%8e%8c%e6%8f%a1Promise"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">八段代码彻底掌握Promise</h1><div class="meta"><div class="postdate"><time datetime="2019-01-07" itemprop="datePublished">2019-01-07</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch3 id=\x22articleHeader0\x22\x3e1.Promise的立即执行性\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n  console.log(\x26quot;create a promise\x26quot;);\n  resolve(\x26quot;success\x26quot;);\n});\n\nconsole.log(\x26quot;after new Promise\x26quot;);\n\np.then(function(value){\n  console.log(value);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22create a promise\x22\x3c\/span\x3e);\n  resolve(\x3cspan class=\x22hljs-string\x22\x3e\x22success\x22\x3c\/span\x3e);\n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22after new Promise\x22\x3c\/span\x3e);\n\np.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e控制台输出：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;create a promise\x26quot;\n\x26quot;after new Promise\x26quot;\n\x26quot;success\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sql\x22\x3e\x3ccode\x3e\x22\x3cspan class=\x22hljs-keyword\x22\x3ecreate\x3c\/span\x3e a promise\x3cspan class=\x22hljs-string\x22\x3e\x22\n\x22\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3eafter\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Promise\x3cspan class=\x22hljs-string\x22\x3e\x22\n\x22\x3c\/span\x3e\x3cspan class=\x22hljs-keyword\x22\x3esuccess\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ePromise对象表示未来某个将要发生的事件，但在创建（new）Promise时，作为Promise参数传入的函数是会被立即执行的，只是其中执行的代码可以是异步代码。有些同学会认为，当Promise对象调用then方法时，Promise接收的函数才会执行，这是错误的。因此，代码中\x22create a promise\x22先于\x22after new Promise\x22输出。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e2.Promise 三种状态\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p1 = new Promise(function(resolve,reject){\n  resolve(1);\n});\nvar p2 = new Promise(function(resolve,reject){\n  setTimeout(function(){\n    resolve(2);  \n  }, 500);      \n});\nvar p3 = new Promise(function(resolve,reject){\n  setTimeout(function(){\n    reject(3);  \n  }, 500);      \n});\n\nconsole.log(p1);\nconsole.log(p2);\nconsole.log(p3);\nsetTimeout(function(){\n  console.log(p2);\n}, 1000);\nsetTimeout(function(){\n  console.log(p3);\n}, 1000);\n\np1.then(function(value){\n  console.log(value);\n});\np2.then(function(value){\n  console.log(value);\n});\np3.catch(function(err){\n  console.log(err);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve,reject\x3c\/span\x3e)\x3c\/span\x3e{\n  resolve(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n});\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p2 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve,reject\x3c\/span\x3e)\x3c\/span\x3e{\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    resolve(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);  \n  }, \x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e);      \n});\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p3 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve,reject\x3c\/span\x3e)\x3c\/span\x3e{\n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    reject(\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e);  \n  }, \x3cspan class=\x22hljs-number\x22\x3e500\x3c\/span\x3e);      \n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(p1);\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(p2);\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(p3);\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(p2);\n}, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\nsetTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(p3);\n}, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n\np1.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value);\n});\np2.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value);\n});\np3.catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(err);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e控制台输出：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise {[[PromiseStatus]]: \x26quot;resolved\x26quot;, [[PromiseValue]]: 1}\nPromise {[[PromiseStatus]]: \x26quot;pending\x26quot;, [[PromiseValue]]: undefined}\nPromise {[[PromiseStatus]]: \x26quot;pending\x26quot;, [[PromiseValue]]: undefined}\n1\n2\n3\nPromise {[[PromiseStatus]]: \x26quot;resolved\x26quot;, [[PromiseValue]]: 2}\nPromise {[[PromiseStatus]]: \x26quot;rejected\x26quot;, [[PromiseValue]]: 3}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lua\x22\x3e\x3ccode\x3ePromise {\x3cspan class=\x22hljs-string\x22\x3e[[PromiseStatus]]\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22resolved\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e[[PromiseValue]]\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e}\nPromise {\x3cspan class=\x22hljs-string\x22\x3e[[PromiseStatus]]\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22pending\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e[[PromiseValue]]\x3c\/span\x3e: undefined}\nPromise {\x3cspan class=\x22hljs-string\x22\x3e[[PromiseStatus]]\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22pending\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e[[PromiseValue]]\x3c\/span\x3e: undefined}\n\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\nPromise {\x3cspan class=\x22hljs-string\x22\x3e[[PromiseStatus]]\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22resolved\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e[[PromiseValue]]\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e}\nPromise {\x3cspan class=\x22hljs-string\x22\x3e[[PromiseStatus]]\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22rejected\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e[[PromiseValue]]\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ePromise的内部实现是一个状态机。Promise有三种状态：pending，resolved，rejected。当Promise刚创建完成时，处于pending状态；当Promise中的函数参数执行了resolve后，Promise由pending状态变成resolved状态；如果在Promise的函数参数中执行的不是resolve方法，而是reject方法，那么Promise会由pending状态变成rejected状态。\x3c\/p\x3e\n\x3cp\x3ep2、p3刚创建完成时，控制台输出的这两台Promise都处于pending状态，但为什么p1是resolved状态呢？ 这是因为p1 的函数参数中执行的是一段同步代码，Promise刚创建完成，resolve方法就已经被调用了，因而紧跟着的输出显示p1是resolved状态。我们通过两个\x3ccode\x3esetTimeout\x3c\/code\x3e函数，延迟1s后再次输出p2、p3的状态，此时p2、p3已经执行完成，状态分别变成resolved和rejected。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e3.Promise 状态的不可逆性\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p1 = new Promise(function(resolve, reject){\n  resolve(\x26quot;success1\x26quot;);\n  resolve(\x26quot;success2\x26quot;);\n});\n\nvar p2 = new Promise(function(resolve, reject){\n  resolve(\x26quot;success\x26quot;);\n  reject(\x26quot;reject\x26quot;);\n});\n\np1.then(function(value){\n  console.log(value);\n});\n\np2.then(function(value){\n  console.log(value);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  resolve(\x3cspan class=\x22hljs-string\x22\x3e\x22success1\x22\x3c\/span\x3e);\n  resolve(\x3cspan class=\x22hljs-string\x22\x3e\x22success2\x22\x3c\/span\x3e);\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p2 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  resolve(\x3cspan class=\x22hljs-string\x22\x3e\x22success\x22\x3c\/span\x3e);\n  reject(\x3cspan class=\x22hljs-string\x22\x3e\x22reject\x22\x3c\/span\x3e);\n});\n\np1.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value);\n});\n\np2.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e控制台输出：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;success1\x26quot;\n\x26quot;success\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs 1c\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22success1\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e\x22success\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ePromise状态的一旦变成resolved或rejected时，Promise的状态和值就固定下来了，不论你后续再怎么调用resolve或reject方法，都不能改变它的状态和值。因此，p1中\x3ccode\x3eresolve(\x22success2\x22)\x3c\/code\x3e并不能将p1的值更改为\x3ccode\x3esuccess2\x3c\/code\x3e，p2中\x3ccode\x3ereject(\x22reject\x22)\x3c\/code\x3e也不能将p2的状态由resolved改变为rejected.\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e4.链式调用\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n  resolve(1);\n});\np.then(function(value){               \/\/第一个then\n  console.log(value);\n  return value*2;\n}).then(function(value){              \/\/第二个then\n  console.log(value);\n}).then(function(value){              \/\/第三个then\n  console.log(value);\n  return Promise.resolve(\x27resolve\x27); \n}).then(function(value){              \/\/第四个then\n  console.log(value);\n  return Promise.reject(\x27reject\x27);\n}).then(function(value){              \/\/第五个then\n  console.log(\x27resolve: \x27\x2b value);\n}, function(err){\n  console.log(\x27reject: \x27 \x2b err);\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fortran\x22\x3e\x3ccode\x3evar p = new Promise(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(resolve, reject)\x3c\/span\x3e\x3c\/span\x3e{\n  resolve(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n});\np.\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e\x3c\/span\x3e{               \/\/第一个\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e\n  console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e*\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e\x3c\/span\x3e{              \/\/第二个\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e\n  console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e\x3c\/span\x3e{              \/\/第三个\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e\n  console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Promise.resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27resolve\x27\x3c\/span\x3e); \n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e\x3c\/span\x3e{              \/\/第四个\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e\n  console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Promise.reject(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e);\n}).\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(value)\x3c\/span\x3e\x3c\/span\x3e{              \/\/第五个\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e\n  console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27resolve: \x27\x3c\/span\x3e\x2b \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(err)\x3c\/span\x3e\x3c\/span\x3e{\n  console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27reject: \x27\x3c\/span\x3e \x2b err);\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e控制台输出：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221\n2\nundefined\n\x26quot;resolve\x26quot;\n\x26quot;reject: reject\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\nundefined\n\x3cspan class=\x22hljs-string\x22\x3e\x22resolve\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e\x22reject: reject\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ePromise对象的then方法返回一个新的Promise对象，因此可以通过链式调用then方法。then方法接收两个函数作为参数，第一个参数是Promise执行成功时的回调，第二个参数是Promise执行失败时的回调。两个函数只会有一个被调用，函数的返回值将被用作创建then返回的Promise对象。这两个参数的返回值可以是以下三种情况中的一种：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3ereturn\x3c\/code\x3e 一个同步的值 ，或者 \x3ccode\x3eundefined\x3c\/code\x3e（当没有返回一个有效值时，默认返回undefined），\x3ccode\x3ethen\x3c\/code\x3e方法将返回一个resolved状态的Promise对象，Promise对象的值就是这个返回值。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3ereturn\x3c\/code\x3e 另一个 Promise，\x3ccode\x3ethen\x3c\/code\x3e方法将根据这个Promise的状态和值创建一个新的Promise对象返回。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3ethrow\x3c\/code\x3e 一个同步异常，\x3ccode\x3ethen\x3c\/code\x3e方法将返回一个rejected状态的Promise,  值是该异常。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e根据以上分析，代码中第一个\x3ccode\x3ethen\x3c\/code\x3e会返回一个值为2（1*2），状态为resolved的Promise对象，于是第二个\x3ccode\x3ethen\x3c\/code\x3e输出的值是2。第二个\x3ccode\x3ethen\x3c\/code\x3e中没有返回值，因此将返回默认的undefined，于是在第三个\x3ccode\x3ethen\x3c\/code\x3e中输出undefined。第三个\x3ccode\x3ethen\x3c\/code\x3e和第四个\x3ccode\x3ethen\x3c\/code\x3e中分别返回一个状态是resolved的Promise和一个状态是rejected的Promise，依次由第四个\x3ccode\x3ethen\x3c\/code\x3e中成功的回调函数和第五个\x3ccode\x3ethen\x3c\/code\x3e中失败的回调函数处理。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e5.Promise then() 回调异步性\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p = new Promise(function(resolve, reject){\n  resolve(\x26quot;success\x26quot;);\n});\n\np.then(function(value){\n  console.log(value);\n});\n\nconsole.log(\x26quot;which one is called first ?\x26quot;);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  resolve(\x3cspan class=\x22hljs-string\x22\x3e\x22success\x22\x3c\/span\x3e);\n});\n\np.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(value);\n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22which one is called first ?\x22\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e控制台输出：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x26quot;which one is called first ?\x26quot;\n\x26quot;success\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs 1c\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22which one is called first ?\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3e\x22success\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ePromise接收的函数参数是同步执行的，但\x3ccode\x3ethen\x3c\/code\x3e方法中的回调函数执行则是异步的，因此，\x22success\x22会在后面输出。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e6.Promise 中的异常\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p1 = new Promise( function(resolve,reject){\n  foo.bar();\n  resolve( 1 );      \n});\n\np1.then(\n  function(value){\n    console.log(\x27p1 then value: \x27 \x2b value);\n  },\n  function(err){\n    console.log(\x27p1 then err: \x27 \x2b err);\n  }\n).then(\n  function(value){\n    console.log(\x27p1 then then value: \x27\x2bvalue);\n  },\n  function(err){\n    console.log(\x27p1 then then err: \x27 \x2b err);\n  }\n);\n\nvar p2 = new Promise(function(resolve,reject){\n  resolve( 2 );    \n});\n\np2.then(\n  function(value){\n    console.log(\x27p2 then value: \x27 \x2b value);\n    foo.bar();\n  }, \n  function(err){\n    console.log(\x27p2 then err: \x27 \x2b err);\n  }\n).then(\n  function(value){\n    console.log(\x27p2 then then value: \x27 \x2b value);\n  },\n  function(err){\n    console.log(\x27p2 then then err: \x27 \x2b err);\n    return 1;\n  }\n).then(\n  function(value){\n    console.log(\x27p2 then then then value: \x27 \x2b value);\n  },\n  function(err){\n    console.log(\x27p2 then then then err: \x27 \x2b err);\n  }\n);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e( \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve,reject\x3c\/span\x3e)\x3c\/span\x3e{\n  foo.bar();\n  resolve( \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e );      \n});\n\np1.then(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p1 then value: \x27\x3c\/span\x3e \x2b value);\n  },\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p1 then err: \x27\x3c\/span\x3e \x2b err);\n  }\n).then(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p1 then then value: \x27\x3c\/span\x3e\x2bvalue);\n  },\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p1 then then err: \x27\x3c\/span\x3e \x2b err);\n  }\n);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p2 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve,reject\x3c\/span\x3e)\x3c\/span\x3e{\n  resolve( \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e );    \n});\n\np2.then(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p2 then value: \x27\x3c\/span\x3e \x2b value);\n    foo.bar();\n  }, \n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p2 then err: \x27\x3c\/span\x3e \x2b err);\n  }\n).then(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p2 then then value: \x27\x3c\/span\x3e \x2b value);\n  },\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p2 then then err: \x27\x3c\/span\x3e \x2b err);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n  }\n).then(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p2 then then then value: \x27\x3c\/span\x3e \x2b value);\n  },\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p2 then then then err: \x27\x3c\/span\x3e \x2b err);\n  }\n);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e控制台输出：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22p1 then err: ReferenceError: foo is not defined\np2 then value: 2\np1 then then value: undefined\np2 then then err: ReferenceError: foo is not defined\np2 then then then value: 1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vbscript\x22\x3e\x3ccode\x3ep1 \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eerr\x3c\/span\x3e: ReferenceError: foo \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enot\x3c\/span\x3e defined\np2 \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e value: \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\np1 \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e value: undefined\np2 \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eerr\x3c\/span\x3e: ReferenceError: foo \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enot\x3c\/span\x3e defined\np2 \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e value: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ePromise中的异常由\x3ccode\x3ethen\x3c\/code\x3e参数中第二个回调函数（Promise执行失败的回调）处理，异常信息将作为Promise的值。异常一旦得到处理，\x3ccode\x3ethen\x3c\/code\x3e返回的后续Promise对象将恢复正常，并会被Promise执行成功的回调函数处理。另外，需要注意p1、p2 多级\x3ccode\x3ethen\x3c\/code\x3e的回调函数是交替执行的 ，这正是由Promise \x3ccode\x3ethen\x3c\/code\x3e回调的异步性决定的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e7.Promise.resolve()\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p1 = Promise.resolve( 1 );\nvar p2 = Promise.resolve( p1 );\nvar p3 = new Promise(function(resolve, reject){\n  resolve(1);\n});\nvar p4 = new Promise(function(resolve, reject){\n  resolve(p1);\n});\n\nconsole.log(p1 === p2); \nconsole.log(p1 === p3);\nconsole.log(p1 === p4);\nconsole.log(p3 === p4);\n\np4.then(function(value){\n  console.log(\x27p4=\x27 \x2b value);\n});\n\np2.then(function(value){\n  console.log(\x27p2=\x27 \x2b value);\n})\n\np1.then(function(value){\n  console.log(\x27p1=\x27 \x2b value);\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve( \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e );\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p2 = \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve( p1 );\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p3 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  resolve(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n});\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p4 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  resolve(p1);\n});\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(p1 === p2); \n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(p1 === p3);\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(p1 === p4);\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(p3 === p4);\n\np4.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p4=\x27\x3c\/span\x3e \x2b value);\n});\n\np2.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p2=\x27\x3c\/span\x3e \x2b value);\n})\n\np1.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27p1=\x27\x3c\/span\x3e \x2b value);\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e控制台输出：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22true\nfalse\nfalse\nfalse\np2=1\np1=1\np4=1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs yaml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3ep2=1\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3ep1=1\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3ep4=1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3ePromise.resolve(...)\x3c\/code\x3e可以接收一个值或者是一个Promise对象作为参数。当参数是普通值时，它返回一个resolved状态的Promise对象，对象的值就是这个参数；当参数是一个Promise对象时，它直接返回这个Promise参数。因此，p1 === p2。但通过new的方式创建的Promise对象都是一个新的对象，因此后面的三个比较结果都是false。另外，为什么p4的\x3ccode\x3ethen\x3c\/code\x3e最先调用，但在控制台上是最后输出结果的呢？因为p4的\x3ccode\x3eresolve\x3c\/code\x3e中接收的参数是一个Promise对象p1，\x3ccode\x3eresolve\x3c\/code\x3e会对p1”拆箱“，获取p1的状态和值，但这个过程是异步的，可参考下一节。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e8.resolve vs reject\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var p1 = new Promise(function(resolve, reject){\n  resolve(Promise.resolve(\x27resolve\x27));\n});\n\nvar p2 = new Promise(function(resolve, reject){\n  resolve(Promise.reject(\x27reject\x27));\n});\n\nvar p3 = new Promise(function(resolve, reject){\n  reject(Promise.resolve(\x27resolve\x27));\n});\n\np1.then(\n  function fulfilled(value){\n    console.log(\x27fulfilled: \x27 \x2b value);\n  }, \n  function rejected(err){\n    console.log(\x27rejected: \x27 \x2b err);\n  }\n);\n\np2.then(\n  function fulfilled(value){\n    console.log(\x27fulfilled: \x27 \x2b value);\n  }, \n  function rejected(err){\n    console.log(\x27rejected: \x27 \x2b err);\n  }\n);\n\np3.then(\n  function fulfilled(value){\n    console.log(\x27fulfilled: \x27 \x2b value);\n  }, \n  function rejected(err){\n    console.log(\x27rejected: \x27 \x2b err);\n  }\n);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p1 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  resolve(\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27resolve\x27\x3c\/span\x3e));\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p2 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  resolve(\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(\x3cspan class=\x22hljs-string\x22\x3e\x27reject\x27\x3c\/span\x3e));\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e p3 = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e)\x3c\/span\x3e{\n  reject(\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27resolve\x27\x3c\/span\x3e));\n});\n\np1.then(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efulfilled\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfilled: \x27\x3c\/span\x3e \x2b value);\n  }, \n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erejected\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27rejected: \x27\x3c\/span\x3e \x2b err);\n  }\n);\n\np2.then(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efulfilled\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfilled: \x27\x3c\/span\x3e \x2b value);\n  }, \n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erejected\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27rejected: \x27\x3c\/span\x3e \x2b err);\n  }\n);\n\np3.then(\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efulfilled\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3evalue\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27fulfilled: \x27\x3c\/span\x3e \x2b value);\n  }, \n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erejected\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27rejected: \x27\x3c\/span\x3e \x2b err);\n  }\n);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e控制台输出：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22p3 rejected: [object Promise]\np1 fulfilled: resolve\np2 rejected: reject\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3ep3 \x3cspan class=\x22hljs-string\x22\x3erejected:\x3c\/span\x3e [object Promise]\np1 \x3cspan class=\x22hljs-string\x22\x3efulfilled:\x3c\/span\x3e resolve\np2 \x3cspan class=\x22hljs-string\x22\x3erejected:\x3c\/span\x3e reject\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ePromise回调函数中的第一个参数\x3ccode\x3eresolve\x3c\/code\x3e，会对Promise执行\x22拆箱\x22动作。即当\x3ccode\x3eresolve\x3c\/code\x3e的参数是一个Promise对象时，\x3ccode\x3eresolve\x3c\/code\x3e会\x22拆箱\x22获取这个Promise对象的状态和值，但这个过程是异步的。p1\x22拆箱\x22后，获取到Promise对象的状态是resolved，因此\x3ccode\x3efulfilled\x3c\/code\x3e回调被执行；p2\x22拆箱\x22后，获取到Promise对象的状态是rejected，因此\x3ccode\x3erejected\x3c\/code\x3e回调被执行。但Promise回调函数中的第二个参数\x3ccode\x3ereject\x3c\/code\x3e不具备”拆箱“的能力，reject的参数会直接传递给\x3ccode\x3ethen\x3c\/code\x3e方法中的\x3ccode\x3erejected\x3c\/code\x3e回调。因此，即使p3 \x3ccode\x3ereject\x3c\/code\x3e接收了一个resolved状态的Promise，\x3ccode\x3ethen\x3c\/code\x3e方法中被调用的依然是\x3ccode\x3erejected\x3c\/code\x3e，并且参数就是\x3ccode\x3ereject\x3c\/code\x3e接收到的Promise对象。\x3c\/p\x3e\n\x3chr\x3e\n\x3cp\x3e\x3cstrong\x3e欢迎关注我的公众号：老干部的大前端，领取21本大前端精选书籍！\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV4lGT?w=540\x26amp;h=193\x22 src=\x22https:\/\/static.alili.tech\/img\/bV4lGT?w=540\x26amp;h=193\x22 alt=\x223808299627-5a93ba468b59a\x22 title=\x223808299627-5a93ba468b59a\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>八段代码彻底掌握Promise</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000010345031">https://segmentfault.com/a/1190000010345031</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qu7vzmp3h8g/" target="_blank">https://alili.tech/archive/qu7vzmp3h8g/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/z09muaar7j/">2年前端应该会哪些技能<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/ke982v6qrfg/">CSS 性能优化笔记<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/if1i2hs28ah/">H5打造3d场景不完全攻略（二）: Amazing CSS3D<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/s4apghsr7o/">JS原生一步步实现前端路由和单页面应用<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/hjgkntbgqek/">JavaScript 中对大量数据的多重过滤<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/h1hfvr2a2nj/">JavaScript 中的错误处理机制<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/a0ukpm125gm/">JavaScript 数组分组的实现<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/fwosouhbhmj/">JavaScript 类型转换深度学习<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/z193p9xv2p/">JavaScript设计模式之发布-订阅模式（观察者模式）-Part1<aside class="dates">2019-02-01</aside></a></li><li><a href="/archive/6i7sr0vgkxm/">Javascript中的时间<aside class="dates">2019-02-01</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>