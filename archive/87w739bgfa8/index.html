<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="如何在 Ubuntu 上使用 pm2 和 Nginx 部署 Node.js 应用"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>如何在 Ubuntu 上使用 pm2 和 Nginx 部署 Node.js 应用 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/87w739bgfa8/",
				"appid": "1613049289050283", 
				"title": "如何在 Ubuntu 上使用 pm2 和 Nginx 部署 Node.js 应用 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-23T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/s7uyz9tj15c/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/zszjhdgdy8l/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f&text=%e5%a6%82%e4%bd%95%e5%9c%a8%20Ubuntu%20%e4%b8%8a%e4%bd%bf%e7%94%a8%20pm2%20%e5%92%8c%20Nginx%20%e9%83%a8%e7%bd%b2%20Node.js%20%e5%ba%94%e7%94%a8"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f&text=%e5%a6%82%e4%bd%95%e5%9c%a8%20Ubuntu%20%e4%b8%8a%e4%bd%bf%e7%94%a8%20pm2%20%e5%92%8c%20Nginx%20%e9%83%a8%e7%bd%b2%20Node.js%20%e5%ba%94%e7%94%a8"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%20Ubuntu%20%e4%b8%8a%e4%bd%bf%e7%94%a8%20pm2%20%e5%92%8c%20Nginx%20%e9%83%a8%e7%bd%b2%20Node.js%20%e5%ba%94%e7%94%a8"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f&is_video=false&description=%e5%a6%82%e4%bd%95%e5%9c%a8%20Ubuntu%20%e4%b8%8a%e4%bd%bf%e7%94%a8%20pm2%20%e5%92%8c%20Nginx%20%e9%83%a8%e7%bd%b2%20Node.js%20%e5%ba%94%e7%94%a8"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%a6%82%e4%bd%95%e5%9c%a8%20Ubuntu%20%e4%b8%8a%e4%bd%bf%e7%94%a8%20pm2%20%e5%92%8c%20Nginx%20%e9%83%a8%e7%bd%b2%20Node.js%20%e5%ba%94%e7%94%a8&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%20Ubuntu%20%e4%b8%8a%e4%bd%bf%e7%94%a8%20pm2%20%e5%92%8c%20Nginx%20%e9%83%a8%e7%bd%b2%20Node.js%20%e5%ba%94%e7%94%a8"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%20Ubuntu%20%e4%b8%8a%e4%bd%bf%e7%94%a8%20pm2%20%e5%92%8c%20Nginx%20%e9%83%a8%e7%bd%b2%20Node.js%20%e5%ba%94%e7%94%a8"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%20Ubuntu%20%e4%b8%8a%e4%bd%bf%e7%94%a8%20pm2%20%e5%92%8c%20Nginx%20%e9%83%a8%e7%bd%b2%20Node.js%20%e5%ba%94%e7%94%a8"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f87w739bgfa8%2f&title=%e5%a6%82%e4%bd%95%e5%9c%a8%20Ubuntu%20%e4%b8%8a%e4%bd%bf%e7%94%a8%20pm2%20%e5%92%8c%20Nginx%20%e9%83%a8%e7%bd%b2%20Node.js%20%e5%ba%94%e7%94%a8"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">如何在 Ubuntu 上使用 pm2 和 Nginx 部署 Node.js 应用</h1><div class="meta"><div class="postdate"><time datetime="2019-01-23" itemprop="datePublished">2019-01-23</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n            \x3ch1\x3e\x3ca href=\x22#如何在-ubuntu-上使用-pm2-和-nginx-部署-nodejs-应用\x22\x3e\x3c\/a\x3e如何在 Ubuntu 上使用 pm2 和 Nginx 部署 Node.js 应用\x3c\/h1\x3e\n\x3cp\x3epm2 是一个 Node.js 应用的进程管理器，它可以让你的应用程序保持运行，还有一个内建的负载均衡器。它非常简单而且强大，你可以零间断重启或重新加载你的 node 应用，它也允许你为你的 node 应用创建集群。\x3c\/p\x3e\n\x3cp\x3e在这篇博文中，我会向你展示如何安装和配置 pm2 用于这个简单的 \x27Express\x27 应用，然后配置 Nginx 作为运行在 pm2 下的 node 应用的反向代理。\x3c\/p\x3e\n\x3cp\x3e前提：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eUbuntu 16.04 - 64bit\x3c\/li\x3e\n\x3cli\x3eRoot 权限\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3\x3e\x3ca href=\x22#第一步---安装-nodejs-lts\x22\x3e\x3c\/a\x3e第一步 - 安装 Node.js LTS\x3c\/h3\x3e\n\x3cp\x3e在这篇指南中，我们会从零开始我们的实验。首先，我们需要在服务器上安装 Node.js。我会使用 Nodejs LTS 6.x 版本，它能从 nodesource 仓库中安装。\x3c\/p\x3e\n\x3cp\x3e从 Ubuntu 仓库安装 \x3ccode\x3epython-software-properties\x3c\/code\x3e 软件包并添加 “nodesource” Nodejs 仓库。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs vim\x22\x3esudo apt-\x3cspan class=\x22hljs-built_in\x22\x3eget\x3c\/span\x3e install -\x3cspan class=\x22hljs-keyword\x22\x3ey\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3epython\x3c\/span\x3e-software-properties \ncurl -sL http\x3cspan class=\x22hljs-variable\x22\x3es:\x3c\/span\x3e\/\/\x3cspan class=\x22hljs-keyword\x22\x3edeb\x3c\/span\x3e.nodesource.\x3cspan class=\x22hljs-keyword\x22\x3ecom\x3c\/span\x3e\/setup_6.\x3cspan class=\x22hljs-keyword\x22\x3ex\x3c\/span\x3e | sudo -E bash -\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e安装最新版本的 Nodejs LTS：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3esudo apt-\x3cspan class=\x22hljs-builtin-name\x22\x3eget\x3c\/span\x3e install -y nodejs\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e安装完成后，查看 node 和 npm 版本。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs crmsh\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3enode\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3e-v\x3c\/span\x3e\nnpm -v\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/1.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01f2317fb7fe9dd24f.png\x22 alt=\x22检查 node.js 版本\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#第二步---生成-express-示例-app\x22\x3e\x3c\/a\x3e第二步 - 生成 Express 示例 App\x3c\/h3\x3e\n\x3cp\x3e我会使用 \x3ccode\x3eexpress-generator\x3c\/code\x3e 软件包生成的简单 web 应用框架进行示例安装。\x3ccode\x3eexpress-generator\x3c\/code\x3e 可以使用 \x3ccode\x3enpm\x3c\/code\x3e 命令安装。\x3c\/p\x3e\n\x3cp\x3e用 \x3ccode\x3enpm\x3c\/code\x3e安装 \x3ccode\x3eexpress-generator\x3c\/code\x3e：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs cmake\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e express-generator -g\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cul\x3e\n\x3cli\x3e\x3ccode\x3e-g\x3c\/code\x3e ： 在系统内部安装软件包。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我会以普通用户运行应用程序，而不是 root 或者超级用户。我们首先需要创建一个新的用户。\x3c\/p\x3e\n\x3cp\x3e创建一个名为 \x3ccode\x3eyume\x3c\/code\x3e 的用户：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs armasm\x22\x3e\x3cspan class=\x22hljs-symbol\x22\x3euseradd\x3c\/span\x3e -m -s \/\x3cspan class=\x22hljs-keyword\x22\x3ebin\/bash \x3c\/span\x3eyume\n\x3cspan class=\x22hljs-symbol\x22\x3epasswd\x3c\/span\x3e yume\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e使用 \x3ccode\x3esu\x3c\/code\x3e 命令登录到新用户：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs ebnf\x22\x3e\x3cspan class=\x22hljs-attribute\x22\x3esu - yume\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e下一步，用 \x3ccode\x3eexpress\x3c\/code\x3e 命令生成一个新的简单 web 应用程序：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs ebnf\x22\x3e\x3cspan class=\x22hljs-attribute\x22\x3eexpress hakase-app\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e命令会创建新项目目录 \x3ccode\x3ehakase-app\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/2.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01f0d46baa8f7400d3.png\x22 alt=\x22用 express-generator 生成应用框架\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e进入到项目目录并安装应用需要的所有依赖。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stata\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ecd\x3c\/span\x3e hakase-\x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e\nnpm install\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e然后用下面的命令测试并启动一个新的简单应用程序：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs ini\x22\x3e\x3cspan class=\x22hljs-attr\x22\x3eDEBUG\x3c\/span\x3e=myapp:* npm start\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e默认情况下，我们的 express 应用会运行在 \x3ccode\x3e3000\x3c\/code\x3e 端口。现在访问服务器的 IP 地址：192.168.33.10:3000 ：\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/3.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t011ff773f126cf2a7e.png\x22 alt=\x22express nodejs 运行在 3000 端口\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e这个简单 web 应用框架现在以 \x27yume\x27 用户运行在 3000 端口。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#第三步---安装-pm2\x22\x3e\x3c\/a\x3e第三步 - 安装 pm2\x3c\/h3\x3e\n\x3cp\x3epm2 是一个 node 软件包，可以使用 \x3ccode\x3enpm\x3c\/code\x3e 命令安装。（用 root 权限，如果你仍然以 yume 用户登录，那么运行命令 \x3ccode\x3eexit\x3c\/code\x3e 再次成为 root 用户）：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs cmake\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3einstall\x3c\/span\x3e pm2 -g\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在我们可以为我们的 web 应用使用 pm2 了。\x3c\/p\x3e\n\x3cp\x3e进入应用目录 \x3ccode\x3ehakase-app\x3c\/code\x3e：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stata\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3esu\x3c\/span\x3e - yume\n\x3cspan class=\x22hljs-keyword\x22\x3ecd\x3c\/span\x3e ~\/hakase-\x3cspan class=\x22hljs-keyword\x22\x3eapp\x3c\/span\x3e\/\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e这里你可以看到一个名为 \x3ccode\x3epackage.json\x3c\/code\x3e 的文件，用 \x3ccode\x3ecat\x3c\/code\x3e 命令显示它的内容。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs stylus\x22\x3ecat package\x3cspan class=\x22hljs-selector-class\x22\x3e.json\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/4.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01fa60484729c3b080.png\x22 alt=\x22配置 express nodejs 服务\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e你可以看到 \x3ccode\x3estart\x3c\/code\x3e 行有一个 nodejs 用于启动 express 应用的命令。我们会和 pm2 进程管理器一起使用这个命令。\x3c\/p\x3e\n\x3cp\x3e像下面这样使用 \x3ccode\x3epm2\x3c\/code\x3e 命令运行 express 应用：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs sql\x22\x3epm2 \x3cspan class=\x22hljs-keyword\x22\x3estart\x3c\/span\x3e .\/\x3cspan class=\x22hljs-keyword\x22\x3ebin\x3c\/span\x3e\/www\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e现在你可以看到像下面这样的结果：\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/5.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t0174b034612805c7c3.png\x22 alt=\x22使用 pm2 运行 nodejs app\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e我们的 express 应用正在 \x3ccode\x3epm2\x3c\/code\x3e 中运行，名称为 \x3ccode\x3ewww\x3c\/code\x3e，id 为 \x3ccode\x3e0\x3c\/code\x3e。你可以用 show 选项 \x3ccode\x3eshow nodeid|name\x3c\/code\x3e 获取更多 pm2 下运行的应用的信息。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs gauss\x22\x3epm2 \x3cspan class=\x22hljs-keyword\x22\x3eshow\x3c\/span\x3e www\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/6.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t019bc6038e02d869bd.png\x22 alt=\x22pm2 服务状态\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e如果你想看我们应用的日志，你可以使用 logs 选项。它包括访问和错误日志，你还可以看到应用程序的 HTTP 状态。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs gcode\x22\x3ep\x3cspan class=\x22hljs-name\x22\x3em2\x3c\/span\x3e logs www\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/7.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t014b414cf67d7cc5c6.png\x22 alt=\x22pm2 服务日志\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e你可以看到我们的程序正在运行。现在，让我们来让它开机自启动。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs gcode\x22\x3ep\x3cspan class=\x22hljs-name\x22\x3em2\x3c\/span\x3e startup systemd\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cul\x3e\n\x3cli\x3e\x3ccode\x3esystemd\x3c\/code\x3e： Ubuntu 16 使用的是 systemd。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e你会看到要用 root 用户运行命令的信息。使用 \x3ccode\x3eexit\x3c\/code\x3e 命令回到 root 用户然后运行命令。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs crystal\x22\x3esudo env PATH=$\x3cspan class=\x22hljs-symbol\x22\x3ePATH:\x3c\/span\x3e\/usr\/bin \/usr\/\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elib\x3c\/span\x3e\/\x3cspan class=\x22hljs-title\x22\x3enode_modules\x3c\/span\x3e\/\x3cspan class=\x22hljs-title\x22\x3epm2\x3c\/span\x3e\/\x3cspan class=\x22hljs-title\x22\x3ebin\x3c\/span\x3e\/\x3cspan class=\x22hljs-title\x22\x3epm2\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3estartup\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3esystemd\x3c\/span\x3e -\x3cspan class=\x22hljs-title\x22\x3eu\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eyume\x3c\/span\x3e --\x3cspan class=\x22hljs-title\x22\x3ehp\x3c\/span\x3e \/\x3cspan class=\x22hljs-title\x22\x3ehome\x3c\/span\x3e\/\x3cspan class=\x22hljs-title\x22\x3eyume\x3c\/span\x3e\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e它会为启动应用程序生成 systemd 配置文件。当你重启服务器的时候，应用程序就会自动运行。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/8.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01435a85040cbd64bf.png\x22 alt=\x22pm2 添加服务到开机自启动\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#第四步---安装和配置-nginx-作为反向代理\x22\x3e\x3c\/a\x3e第四步 - 安装和配置 Nginx 作为反向代理\x3c\/h3\x3e\n\x3cp\x3e在这篇指南中，我们会使用 Nginx 作为 node 应用的反向代理。Ubuntu 仓库中有 Nginx，用 \x3ccode\x3eapt\x3c\/code\x3e 命令安装它：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3esudo apt-\x3cspan class=\x22hljs-builtin-name\x22\x3eget\x3c\/span\x3e install -y nginx\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e下一步，进入到 \x3ccode\x3esites-available\x3c\/code\x3e 目录并创建新的虚拟主机配置文件。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs awk\x22\x3ecd \x3cspan class=\x22hljs-regexp\x22\x3e\/etc\/\x3c\/span\x3enginx\x3cspan class=\x22hljs-regexp\x22\x3e\/sites-available\/\x3c\/span\x3e\nvim hakase-app\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e粘贴下面的配置：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs nginx\x22\x3e\x3cspan class=\x22hljs-attribute\x22\x3eupstream\x3c\/span\x3e hakase-app {\n    \x3cspan class=\x22hljs-comment\x22\x3e# Nodejs app upstream\x3c\/span\x3e\n    \x3cspan class=\x22hljs-attribute\x22\x3eserver\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e127.0.0.1:3000\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3ekeepalive\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e64\x3c\/span\x3e;\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e# Server on port 80\x3c\/span\x3e\n\x3cspan class=\x22hljs-section\x22\x3eserver\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attribute\x22\x3elisten\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e80\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-attribute\x22\x3eserver_name\x3c\/span\x3e hakase-node.co;\n    \x3cspan class=\x22hljs-attribute\x22\x3eroot\x3c\/span\x3e \/home\/yume\/hakase-app;\n\n    \x3cspan class=\x22hljs-attribute\x22\x3elocation\x3c\/span\x3e \/ {\n        \x3cspan class=\x22hljs-comment\x22\x3e# Proxy_pass configuration\x3c\/span\x3e\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_set_header\x3c\/span\x3e X-Forwarded-For \x3cspan class=\x22hljs-variable\x22\x3e$proxy_add_x_forwarded_for\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_set_header\x3c\/span\x3e Host \x3cspan class=\x22hljs-variable\x22\x3e$http_host\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_set_header\x3c\/span\x3e X-NginX-Proxy \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_http_version\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_set_header\x3c\/span\x3e Upgrade \x3cspan class=\x22hljs-variable\x22\x3e$http_upgrade\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_set_header\x3c\/span\x3e Connection \x3cspan class=\x22hljs-string\x22\x3e\x22upgrade\x22\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_max_temp_file_size\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_pass\x3c\/span\x3e http:\/\/hakase-app\/;\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_redirect\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3eoff\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-attribute\x22\x3eproxy_read_timeout\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e240s\x3c\/span\x3e;\n    }\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e保存文件并退出 vim。\x3c\/p\x3e\n\x3cp\x3e在配置中：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3enode 应用使用域名 \x3ccode\x3ehakase-node.co\x3c\/code\x3e 运行。\x3c\/li\x3e\n\x3cli\x3e所有来自 nginx 的流量都会被转发到运行在 \x3ccode\x3e3000\x3c\/code\x3e 端口的 node app。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e测试 Nginx 配置确保没有错误。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs ebnf\x22\x3e\x3cspan class=\x22hljs-attribute\x22\x3enginx -t\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e启用 Nginx 并使其开机自启动。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs routeros\x22\x3esystemctl start nginx\nsystemctl \x3cspan class=\x22hljs-builtin-name\x22\x3eenable\x3c\/span\x3e nginx\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3ch3\x3e\x3ca href=\x22#第五步---测试\x22\x3e\x3c\/a\x3e第五步 - 测试\x3c\/h3\x3e\n\x3cp\x3e打开你的 web 浏览器并访问域名（我的是）：\x3ca href=\x22http:\/\/hakase-app.co\/\x22\x3ehttp:\/\/hakase-app.co\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e你可以看到 express 应用正在 Nginx web 服务器中运行。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/9.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01ef3d66840cafbbb0.png\x22 alt=\x22Nodejs app 在 pm2 和 Nginx 中运行\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e下一步，重启你的服务器，确保你的 node app 能开机自启动：\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs fortran\x22\x3epm2 \x3cspan class=\x22hljs-keyword\x22\x3esave\x3c\/span\x3e\nsudo reboot\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e如果你再次登录到了你的服务器，检查 node app 进程。以 \x3ccode\x3eyume\x3c\/code\x3e 用户运行下面的命令。\x3c\/p\x3e\n\x3cpre\x3e\x3ccode class=\x22hljs fortran\x22\x3esu - yume\npm2 \x3cspan class=\x22hljs-keyword\x22\x3estatus\x3c\/span\x3e www\n\n\x3c\/code\x3e\x3c\/pre\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.howtoforge.com\/images\/how_to_deploy_nodejs_applications_with_pm2_and_nginx_on_ubuntu\/big\/10.png\x22\x3e\x3cimg src=\x22https:\/\/p0.ssl.qhimg.com\/t01baf42c3b88e8abb2.png\x22 alt=\x22nodejs 在 pm2 下开机自启动\x22\x3e\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3eNode 应用在 pm2 中运行并使用 Nginx 作为反向代理。\x3c\/p\x3e\n\x3ch3\x3e\x3ca href=\x22#链接\x22\x3e\x3c\/a\x3e链接\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/www.ubuntu.com\/\x22\x3eUbuntu\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/nodejs.org\/en\/\x22\x3eNode.js\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/www.nginx.com\/\x22\x3eNginx\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3chr\x3e\n\x3cp\x3evia: \x3ca href=\x22https:\/\/www.howtoforge.com\/tutorial\/how-to-deploy-nodejs-applications-with-pm2-and-nginx-on-ubuntu\/\x22\x3ehttps:\/\/www.howtoforge.com\/tutorial\/how-to-deploy-nodejs-applications-with-pm2-and-nginx-on-ubuntu\/\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e作者：\x3ca href=\x22https:\/\/www.howtoforge.com\/tutorial\/how-to-deploy-nodejs-applications-with-pm2-and-nginx-on-ubuntu\/\x22\x3eMuhammad Arul\x3c\/a\x3e 译者：\x3ca href=\x22https:\/\/github.com\/ictlyh\x22\x3eictlyh\x3c\/a\x3e 校对：\x3ca href=\x22https:\/\/github.com\/wxy\x22\x3ewxy\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e本文由 \x3ca href=\x22https:\/\/github.com\/LCTT\/TranslateProject\x22\x3eLCTT\x3c\/a\x3e 原创编译，\x3ca href=\x22https:\/\/linux.cn\/\x22\x3eLinux中国\x3c\/a\x3e 荣誉推出\x3c\/p\x3e\n\n          \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>如何在 Ubuntu 上使用 pm2 和 Nginx 部署 Node.js 应用</p><h2 id="原文链接">原文链接</h2><p><a href="https://www.zcfy.cc/article/how-to-deploy-node-js-applications-with-pm2-and-nginx-on-ubuntu">https://www.zcfy.cc/article/how-to-deploy-node-js-applications-with-pm2-and-nginx-on-ubuntu</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/87w739bgfa8/" target="_blank">https://alili.tech/archive/87w739bgfa8/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/dgic8s5qnlg/">CSS五种方式实现Footer置底<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/z94br1a9g2o/">React的10种有效的设计模式<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/xe4kfnhxlfo/">Seneca ：NodeJS 微服务框架入门指南<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/ffpl5ftnw2u/">Unable to preventDefault inside passive event listener<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/twqwd2wscy/">Vue源码详细解析:transclude,compile,link,依赖,批处理...一网打尽，全解析!<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/i1zivpsjdl/">chart.js 中文文档 翻译<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/ik09416kg2/">flex-box 速记表<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/ic5ys9tnr1n/">riotjs 2.2.4<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/wd1i4kdw4jq/">vuejs2.0运用原生js实现简单的拖拽元素功能<aside class="dates">2019-01-25</aside></a></li><li><a href="/archive/l7r8ye5804/">一道JS面试题所引发的&#34;血案&#34;，透过现象寻本质，再从本质看现象<aside class="dates">2019-01-25</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>