<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="webpack 构建性能优化策略小结"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>webpack 构建性能优化策略小结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/hs6kypgssw5/",
				"appid": "1613049289050283", 
				"title": "webpack 构建性能优化策略小结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-01-29T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/blox1xln3l/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/3xw5ad0tvku/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f&text=webpack%20%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e5%b0%8f%e7%bb%93"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f&text=webpack%20%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e5%b0%8f%e7%bb%93"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f&title=webpack%20%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e5%b0%8f%e7%bb%93"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f&is_video=false&description=webpack%20%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e5%b0%8f%e7%bb%93"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=webpack%20%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e5%b0%8f%e7%bb%93&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f&title=webpack%20%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e5%b0%8f%e7%bb%93"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f&title=webpack%20%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e5%b0%8f%e7%bb%93"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f&title=webpack%20%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e5%b0%8f%e7%bb%93"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fhs6kypgssw5%2f&title=webpack%20%e6%9e%84%e5%bb%ba%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e7%ad%96%e7%95%a5%e5%b0%8f%e7%bb%93"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">webpack 构建性能优化策略小结</h1><div class="meta"><div class="postdate"><time datetime="2019-01-29" itemprop="datePublished">2019-01-29</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e背景\x3c\/h2\x3e\n\x3cp\x3e如今前端工程化的概念早已经深入人心，选择一款合适的编译和资源管理工具已经成为了所有前端工程中的标配，而在诸多的构建工具中，\x3ca href=\x22https:\/\/webpack.js.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack\x3c\/a\x3e以其丰富的功能和灵活的配置而深受业内吹捧，逐步取代了grunt和gulp成为大多数前端工程实践中的首选，React，Vue，Angular等诸多知名项目也都相继选用其作为官方构建工具，极受业内追捧。但是，随者工程开发的复杂程度和代码规模不断地增加，webpack暴露出来的各种性能问题也愈发明显，极大的影响着开发过程中的体验。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVHgXt?w=1213\x26amp;h=231\x22 src=\x22https:\/\/static.alili.tech\/img\/bVHgXt?w=1213\x26amp;h=231\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e问题归纳\x3c\/h2\x3e\n\x3cp\x3e历经了多个web项目的实战检验，我们对webapck在构建中逐步暴露出来的性能问题归纳主要有如下几个方面：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e代码全量构建速度过慢，即使是很小的改动，也要等待长时间才能查看到更新与编译后的结果（引入HMR热更新后有明显改进）；\x3c\/li\x3e\n\x3cli\x3e随着项目业务的复杂度增加，工程模块的体积也会急剧增大，构建后的模块通常要以M为单位计算；\x3c\/li\x3e\n\x3cli\x3e多个项目之间共用基础资源存在重复打包，基础库代码复用率不高；\x3c\/li\x3e\n\x3cli\x3enode的单进程实现在耗cpu计算型loader中表现不佳；\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e针对以上的问题，我们来看看怎样利用webpack现有的一些机制和第三方扩展插件来逐个击破。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e慢在何处\x3c\/h2\x3e\n\x3cp\x3e作为工程师，我们一直鼓励要理性思考，用数据和事实说话，“我觉得很慢”，“太卡了”，“太大了”之类的表述难免显得太笼统和太抽象，那么我们不妨从如下几个方面来着手进行分析：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV0CM3?w=3304\x26amp;h=2144\x22 src=\x22https:\/\/static.alili.tech\/img\/bV0CM3?w=3304\x26amp;h=2144\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e从项目结构着手，代码组织是否合理，依赖使用是否合理；\x3c\/li\x3e\n\x3cli\x3e从webpack自身提供的优化手段着手，看看哪些api未做优化配置；\x3c\/li\x3e\n\x3cli\x3e从webpack自身的不足着手，做有针对性的扩展优化，进一步提升效率；\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e在这里我们推荐使用一个wepback的可视化资源分析工具：\x3ca href=\x22https:\/\/github.com\/webpack-contrib\/webpack-bundle-analyzer\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack-bundle-analyzer\x3c\/a\x3e，在webpack构建的时候会自动帮你计算出各个模块在你的项目工程中的依赖与分布情况，方便做更精确的资源依赖和引用的分析。\x3c\/p\x3e\n\x3cp\x3e从上图中我们不难发现大多数的工程项目中，依赖库的体积永远是大头，通常体积可以占据整个工程项目的7-9成，而且在每次开发过程中也会重新读取和编译对应的依赖资源，这其实是很大的的资源开销浪费，而且对编译结果影响微乎其微，毕竟在实际业务开发中，我们很少会去主动修改第三方库中的源码，改进方案如下：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e方案一、合理配置 CommonsChunkPlugin\x3c\/h3\x3e\n\x3cp\x3ewebpack的资源入口通常是以entry为单元进行编译提取，那么当多entry共存的时候，CommonsChunkPlugin的作用就会发挥出来，对所有依赖的chunk进行公共部分的提取，但是在这里可能很多人会误认为抽取公共部分指的是能抽取某个代码片段，其实并非如此，它是以module为单位进行提取。\x3c\/p\x3e\n\x3cp\x3e假设我们的页面中存在entry1，entry2，entry3三个入口，这些入口中可能都会引用如utils，loadash，fetch等这些通用模块，那么就可以考虑对这部分的共用部分机提取。通常提取方式有如下四种实现：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e1、传入字符串参数，由chunkplugin自动计算提取\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new webpack.optimize.CommonsChunkPlugin(\x27common.js\x27)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.CommonsChunkPlugin(\x3cspan class=\x22hljs-string\x22\x3e\x27common.js\x27\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这种做法默认会把所有入口节点的公共代码提取出来, 生成一个common.js\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2、有选择的提取公共代码\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new webpack.optimize.CommonsChunkPlugin(\x27common.js\x27,[\x27entry1\x27,\x27entry2\x27]);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.CommonsChunkPlugin(\x3cspan class=\x22hljs-string\x22\x3e\x27common.js\x27\x3c\/span\x3e,[\x3cspan class=\x22hljs-string\x22\x3e\x27entry1\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27entry2\x27\x3c\/span\x3e]);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e只提取entry1节点和entry2中的共用部分模块, 生成一个common.js\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e3、将entry下所有的模块的公共部分（可指定引用次数）提取到一个通用的chunk中\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new webpack.optimize.CommonsChunkPlugin({\n    name: \x27vendors\x27,\n    minChunks: function (module, count) {\n       return (\n          module.resource \x26amp;\x26amp;\n          \/\\.js$\/.test(module.resource) \x26amp;\x26amp;\n          module.resource.indexOf(\n            path.join(__dirname, \x27..\/node_modules\x27)\n          ) === 0\n       )\n    }\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.CommonsChunkPlugin({\n    \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27vendors\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eminChunks\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3emodule, count\x3c\/span\x3e) \x3c\/span\x3e{\n       \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n          \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.resource \x26amp;\x26amp;\n          \x3cspan class=\x22hljs-regexp\x22\x3e\/\\.js$\/\x3c\/span\x3e.test(\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.resource) \x26amp;\x26amp;\n          \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.resource.indexOf(\n            path.join(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27..\/node_modules\x27\x3c\/span\x3e)\n          ) === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n       )\n    }\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e提取所有node_modules中的模块至vendors中，也可以指定minChunks中的最小引用数；\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e4、抽取enry中的一些lib抽取到vendors中\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22entry = {\n    vendors: [\x27fetch\x27, \x27loadash\x27]\n};\nnew webpack.optimize.CommonsChunkPlugin({\n    name: \x26quot;vendors\x26quot;,\n    minChunks: Infinity\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eentry = {\n    \x3cspan class=\x22hljs-attr\x22\x3evendors\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27fetch\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27loadash\x27\x3c\/span\x3e]\n};\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.CommonsChunkPlugin({\n    \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22vendors\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eminChunks\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3eInfinity\x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e添加一个entry名叫为vendors，并把vendors设置为所需要的资源库，CommonsChunk会自动提取指定库至vendors中。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e方案二、通过 externals 配置来提取常用库\x3c\/h3\x3e\n\x3cp\x3e在实际项目开发过程中，我们并不需要实时调试各种库的源码，这时候就可以考虑使用external选项了。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVHgYb?w=654\x26amp;h=607\x22 src=\x22https:\/\/static.alili.tech\/img\/bVHgYb?w=654\x26amp;h=607\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e简单来说external就是把我们的依赖资源声明为一个外部依赖，然后通过script外链脚本引入。这也是我们早期页面开发中资源引入的一种翻版，只是通过配置后可以告知webapck遇到此类变量名时就可以不用解析和编译至模块的内部文件中，而改用从外部变量中读取，这样能极大的提升编译速度，同时也能更好的利用CDN来实现缓存。\x3c\/p\x3e\n\x3cp\x3eexternal的配置相对比较简单，只需要完成如下三步：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e1、在页面中加入需要引入的lib地址\x3c\/strong\x3e，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3chead\x3e\n\x3cscript src=\x26quot;\/\/cdn.bootcss.com\/jquery.min.js\x26quot;\x3e\x3c\/script\x3e\n\x3cscript src=\x26quot;\/\/cdn.bootcss.com\/underscore.min.js\x26quot;\x3e\x3c\/script\x3e\n\x3cscript src=\x26quot;\/static\/common\/react.min.js\x26quot;\x3e\x3c\/script\x3e\n\x3cscript src=\x26quot;\/static\/common\/react-dom.js\x26quot;\x3e\x3c\/script\x3e\n\x3cscript src=\x26quot;\/static\/common\/react-router.js\x26quot;\x3e\x3c\/script\x3e\n\x3cscript src=\x26quot;\/static\/common\/immutable.js\x26quot;\x3e\x3c\/script\x3e\n\x3c\/head\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/\/cdn.bootcss.com\/jquery.min.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/\/cdn.bootcss.com\/underscore.min.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/static\/common\/react.min.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/static\/common\/react-dom.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/static\/common\/react-router.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/static\/common\/immutable.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e2、在webapck.config.js中加入external配置项：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module.export = {\n    externals: {\n        \x27react-router\x27: {\n            amd: \x27react-router\x27,\n            root: \x27ReactRouter\x27,\n            commonjs: \x27react-router\x27,\n            commonjs2: \x27react-router\x27\n        },\n        react: {\n            amd: \x27react\x27,\n            root: \x27React\x27,\n            commonjs: \x27react\x27,\n            commonjs2: \x27react\x27\n        },\n        \x27react-dom\x27: {\n            amd: \x27react-dom\x27,\n            root: \x27ReactDOM\x27,\n            commonjs: \x27react-dom\x27,\n            commonjs2: \x27react-dom\x27\n        }\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs sml\x22\x3e\x3ccode\x3emodule.export = {\n    externals: {\n        \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x3c\/span\x3e-router\x27: {\n            amd: \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x3c\/span\x3e-router\x27,\n            root: \x3cspan class=\x22hljs-symbol\x22\x3e\x27ReactRouter\x27\x3c\/span\x3e,\n            commonjs: \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x3c\/span\x3e-router\x27,\n            commonjs2: \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x3c\/span\x3e-router\x27\n        },\n        react: {\n            amd: \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x27\x3c\/span\x3e,\n            root: \x3cspan class=\x22hljs-symbol\x22\x3e\x27React\x27\x3c\/span\x3e,\n            commonjs: \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x27\x3c\/span\x3e,\n            commonjs2: \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x27\x3c\/span\x3e\n        },\n        \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x3c\/span\x3e-dom\x27: {\n            amd: \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x3c\/span\x3e-dom\x27,\n            root: \x3cspan class=\x22hljs-symbol\x22\x3e\x27ReactDOM\x27\x3c\/span\x3e,\n            commonjs: \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x3c\/span\x3e-dom\x27,\n            commonjs2: \x3cspan class=\x22hljs-symbol\x22\x3e\x27react\x3c\/span\x3e-dom\x27\n        }\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里要提到的一个细节是：此类文件在配置前，构建这些资源包时需要采用amd\/commonjs\/cmd相关的模块化进行兼容封装，即打包好的库已经是umd模式包装过的，如在node_modules\/react-router中我们可以看到umd\/ReactRouter.js之类的文件，只有这样webpack中的require和import * from \x27xxxx\x27才能正确读到该类包的引用，在这类js的头部一般也能看到如下字样：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nif (typeof exports === \x27object\x27 \x26amp;\x26amp; typeof module === \x27object\x27) {\n    module.exports = factory(require(\x26quot;react\x26quot;));\n} else if (typeof define === \x27function\x27 \x26amp;\x26amp; define.amd) {\n    define([\x26quot;react\x26quot;], factory);\n} else if (typeof exports === \x27object\x27) {\n    exports[\x26quot;ReactRouter\x26quot;] = factory(require(\x26quot;react\x26quot;));\n} else {\n    root[\x26quot;ReactRouter\x26quot;] = factory(root[\x26quot;React\x26quot;]);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e exports === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = factory(\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22react\x22\x3c\/span\x3e));\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e define === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e \x26amp;\x26amp; define.amd) {\n    define([\x3cspan class=\x22hljs-string\x22\x3e\x22react\x22\x3c\/span\x3e], factory);\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e exports === \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e) {\n    exports[\x3cspan class=\x22hljs-string\x22\x3e\x22ReactRouter\x22\x3c\/span\x3e] = factory(\x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22react\x22\x3c\/span\x3e));\n} \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    root[\x3cspan class=\x22hljs-string\x22\x3e\x22ReactRouter\x22\x3c\/span\x3e] = factory(root[\x3cspan class=\x22hljs-string\x22\x3e\x22React\x22\x3c\/span\x3e]);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e3、非常重要的是一定要在output选项中加入如下一句话：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22output: {\n  libraryTarget: \x27umd\x27\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eoutput: {\n  \x3cspan class=\x22hljs-attr\x22\x3elibraryTarget\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27umd\x27\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e由于通过external提取过的js模块是不会被记录到webapck的chunk信息中，通过libraryTarget可告知我们构建出来的业务模块，当读到了externals中的key时，需要以umd的方式去获取资源名，否则会有出现找不到module的情况。\x3c\/p\x3e\n\x3cp\x3e通过配置后，我们可以看到对应的资源信息已经可以在浏览器的source map中读到了。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVHgYW?w=693\x26amp;h=338\x22 src=\x22https:\/\/static.alili.tech\/img\/bVHgYW?w=693\x26amp;h=338\x22 alt=\x22externals.png\x22 title=\x22externals.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e对应的资源也可以直接由页面外链载入，有效地减小了资源包的体积。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVHgY0?w=664\x26amp;h=225\x22 src=\x22https:\/\/static.alili.tech\/img\/bVHgY0?w=664\x26amp;h=225\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e方案三、利用 DllPlugin 和 DllReferencePlugin 预编译资源模块\x3c\/h3\x3e\n\x3cp\x3e我们的项目依赖中通常会引用大量的npm包，而这些包在正常的开发过程中并不会进行修改，但是在每一次构建过程中却需要反复的将其解析，如何来规避此类损耗呢？这两个插件就是干这个用的。\x3c\/p\x3e\n\x3cp\x3e简单来说DllPlugin的作用是预先编译一些模块，而DllReferencePlugin则是把这些预先编译好的模块引用起来。这边需要注意的是DllPlugin必须要在DllReferencePlugin执行前先执行一次，dll这个概念应该也是借鉴了windows程序开发中的dll文件的设计理念。\x3c\/p\x3e\n\x3cp\x3e相对于externals，dllPlugin有如下几点优势：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3edll预编译出来的模块可以作为静态资源链接库可被重复使用，尤其适合多个项目之间的资源共享，如同一个站点pc和手机版等；\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3edll资源能有效地解决资源循环依赖的问题，部分依赖库如：react-addons-css-transition-group这种原先从react核心库中抽取的资源包，整个代码只有一句话：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module.exports = require(\x27react\/lib\/ReactCSSTransitionGroup\x27);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27react\/lib\/ReactCSSTransitionGroup\x27\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e却因为重新指向了react\/lib中，这也会导致在通过externals引入的资源只能识别react,寻址解析react\/lib则会出现无法被正确索引的情况。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e由于externals的配置项需要对每个依赖库进行逐个定制，所以每次增加一个组件都需要手动修改，略微繁琐，而通过dllPlugin则能完全通过配置读取，减少维护的成本；\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e1、配置dllPlugin对应资源表并编译文件\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e那么externals该如何使用呢，其实只需要增加一个配置文件：webpack.dll.config.js：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const webpack = require(\x27webpack\x27);\nconst path = require(\x27path\x27);\nconst isDebug = process.env.NODE_ENV === \x27development\x27;\nconst outputPath = isDebug ? path.join(__dirname, \x27..\/common\/debug\x27) : path.join(__dirname, \x27..\/common\/dist\x27);\nconst fileName = \x27[name].js\x27;\n\n\/\/ 资源依赖包，提前编译\nconst lib = [\n  \x27react\x27,\n  \x27react-dom\x27,\n  \x27react-router\x27,\n  \x27history\x27,\n  \x27react-addons-pure-render-mixin\x27,\n  \x27react-addons-css-transition-group\x27,\n  \x27redux\x27,\n  \x27react-redux\x27,\n  \x27react-router-redux\x27,\n  \x27redux-actions\x27,\n  \x27redux-thunk\x27,\n  \x27immutable\x27,\n  \x27whatwg-fetch\x27,\n  \x27byted-people-react-select\x27,\n  \x27byted-people-reqwest\x27\n];\n\nconst plugin = [\n  new webpack.DllPlugin({\n    \/**\n     * path\n     * 定义 manifest 文件生成的位置\n     * [name]的部分由entry的名字替换\n     *\/\n    path: path.join(outputPath, \x27manifest.json\x27),\n    \/**\n     * name\n     * dll bundle 输出到那个全局变量上\n     * 和 output.library 一样即可。\n     *\/\n    name: \x27[name]\x27,\n    context: __dirname\n  }),\n  new webpack.optimize.OccurenceOrderPlugin()\n];\n\nif (!isDebug) {\n  plugin.push(\n    new webpack.DefinePlugin({\n      \x27process.env.NODE_ENV\x27: JSON.stringify(\x27production\x27)\n    }),\n    new webpack.optimize.UglifyJsPlugin({\n      mangle: {\n        except: [\x27$\x27, \x27exports\x27, \x27require\x27]\n      },\n      compress: { warnings: false },\n      output: { comments: false }\n    })\n  )\n}\n\nmodule.exports = {\n  devtool: \x27#source-map\x27,\n  entry: {\n    lib: lib\n  },\n  output: {\n    path: outputPath,\n    filename: fileName,\n    \/**\n     * output.library\n     * 将会定义为 window.${output.library}\n     * 在这次的例子中，将会定义为`window.vendor_library`\n     *\/\n    library: \x27[name]\x27,\n    libraryTarget: \x27umd\x27,\n    umdNamedDefine: true\n  },\n  plugins: plugin\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e webpack = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e path = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27path\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e isDebug = process.env.NODE_ENV === \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e outputPath = isDebug ? path.join(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27..\/common\/debug\x27\x3c\/span\x3e) : path.join(__dirname, \x3cspan class=\x22hljs-string\x22\x3e\x27..\/common\/dist\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e fileName = \x3cspan class=\x22hljs-string\x22\x3e\x27[name].js\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 资源依赖包，提前编译\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e lib = [\n  \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27react-dom\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27react-router\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27history\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27react-addons-pure-render-mixin\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27react-addons-css-transition-group\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27redux\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27react-redux\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27react-router-redux\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27redux-actions\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27redux-thunk\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27immutable\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27whatwg-fetch\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27byted-people-react-select\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27byted-people-reqwest\x27\x3c\/span\x3e\n];\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e plugin = [\n  \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.DllPlugin({\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * path\n     * 定义 manifest 文件生成的位置\n     * [name]的部分由entry的名字替换\n     *\/\x3c\/span\x3e\n    path: path.join(outputPath, \x3cspan class=\x22hljs-string\x22\x3e\x27manifest.json\x27\x3c\/span\x3e),\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * name\n     * dll bundle 输出到那个全局变量上\n     * 和 output.library 一样即可。\n     *\/\x3c\/span\x3e\n    name: \x3cspan class=\x22hljs-string\x22\x3e\x27[name]\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3econtext\x3c\/span\x3e: __dirname\n  }),\n  \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.OccurenceOrderPlugin()\n];\n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!isDebug) {\n  plugin.push(\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.DefinePlugin({\n      \x3cspan class=\x22hljs-string\x22\x3e\x27process.env.NODE_ENV\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(\x3cspan class=\x22hljs-string\x22\x3e\x27production\x27\x3c\/span\x3e)\n    }),\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.UglifyJsPlugin({\n      \x3cspan class=\x22hljs-attr\x22\x3emangle\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3eexcept\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27$\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27exports\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27require\x27\x3c\/span\x3e]\n      },\n      \x3cspan class=\x22hljs-attr\x22\x3ecompress\x3c\/span\x3e: { \x3cspan class=\x22hljs-attr\x22\x3ewarnings\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e },\n      \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: { \x3cspan class=\x22hljs-attr\x22\x3ecomments\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e }\n    })\n  )\n}\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = {\n  \x3cspan class=\x22hljs-attr\x22\x3edevtool\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27#source-map\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eentry\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3elib\x3c\/span\x3e: lib\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-attr\x22\x3epath\x3c\/span\x3e: outputPath,\n    \x3cspan class=\x22hljs-attr\x22\x3efilename\x3c\/span\x3e: fileName,\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * output.library\n     * 将会定义为 window.${output.library}\n     * 在这次的例子中，将会定义为`window.vendor_library`\n     *\/\x3c\/span\x3e\n    library: \x3cspan class=\x22hljs-string\x22\x3e\x27[name]\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3elibraryTarget\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27umd\x27\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eumdNamedDefine\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: plugin\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后执行命令：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 $ NODE_ENV=development webpack --config  webpack.dll.lib.js --progress\n $ NODE_ENV=production webpack --config  webpack.dll.lib.js --progress \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e $ NODE_ENV=development webpack --config  webpack\x3cspan class=\x22hljs-selector-class\x22\x3e.dll\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.lib\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e --progress\n $ NODE_ENV=production webpack --config  webpack\x3cspan class=\x22hljs-selector-class\x22\x3e.dll\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.lib\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e --progress \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e即可分别编译出支持调试版和生产环境中lib静态资源库，在构建出来的文件中我们也可以看到会自动生成如下资源：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22common\n├── debug\n│   ├── lib.js\n│   ├── lib.js.map\n│   └── manifest.json\n└── dist\n    ├── lib.js\n    ├── lib.js.map\n    └── manifest.json\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3ecommon\n├── debug\n│   ├── lib.js\n│   ├── lib.js.map\n│   └── manifest.json\n└── dist\n    ├── lib.js\n    ├── lib.js.map\n    └── manifest.json\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e文件说明：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3elib.js可以作为编译好的静态资源文件直接在页面中通过src链接引入，与externals的资源引入方式一样，生产与开发环境可以通过类似charles之类的代理转发工具来做路由替换；\x3c\/li\x3e\n\x3cli\x3emanifest.json中保存了webpack中的预编译信息，这样等于提前拿到了依赖库中的chunk信息，在实际开发过程中就无需要进行重复编译；\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e2、dllPlugin的静态资源引入\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3elib.js和manifest.json存在一一对应的关系，所以我们在调用的过程也许遵循这个原则，如当前处于开发阶段，对应我们可以引入common\/debug文件夹下的lib.js和manifest.json，切换到生产环境的时候则需要引入common\/dist下的资源进行对应操作，这里考虑到手动切换和维护的成本，我们推荐使用\x3ca href=\x22https:\/\/github.com\/SimenB\/add-asset-html-webpack-plugin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eadd-asset-html-webpack-plugin\x3c\/a\x3e进行依赖资源的注入，可得到如下结果：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3chead\x3e\n\x3cscript src=\x26quot;\/static\/common\/lib.js\x26quot;\x3e\x3c\/script\x3e\n\x3c\/head\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/static\/common\/lib.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在webpack.config.js文件中增加如下代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const isDebug = (process.env.NODE_ENV === \x27development\x27);\nconst libPath = isDebug ? \x27..\/dll\/lib\/manifest.json\x27 : \n\x27..\/dll\/dist\/lib\/manifest.json\x27;\n\n\/\/ 将mainfest.json添加到webpack的构建中\n\nmodule.export = {\n  plugins: [\n       new webpack.DllReferencePlugin({\n       context: __dirname,\n       manifest: require(libPath),\n      })\n  ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e isDebug = (process.env.NODE_ENV === \x3cspan class=\x22hljs-string\x22\x3e\x27development\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e libPath = isDebug ? \x3cspan class=\x22hljs-string\x22\x3e\x27..\/dll\/lib\/manifest.json\x27\x3c\/span\x3e : \n\x3cspan class=\x22hljs-string\x22\x3e\x27..\/dll\/dist\/lib\/manifest.json\x27\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 将mainfest.json添加到webpack的构建中\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.export = {\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\n       \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.DllReferencePlugin({\n       \x3cspan class=\x22hljs-attr\x22\x3econtext\x3c\/span\x3e: __dirname,\n       \x3cspan class=\x22hljs-attr\x22\x3emanifest\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(libPath),\n      })\n  ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e配置完成后我们能发现对应的资源包已经完成了纯业务模块的提取\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVHgZQ?w=954\x26amp;h=207\x22 src=\x22https:\/\/static.alili.tech\/img\/bVHgZQ?w=954\x26amp;h=207\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e多个工程之间如果需要使用共同的lib资源，也只需要引入对应的lib.js和manifest.js即可，plugin配置中也支持多个webpack.DllReferencePlugin同时引入使用，如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module.export = {\n  plugins: [\n     new webpack.DllReferencePlugin({\n        context: __dirname,\n        manifest: require(libPath),\n      }),\n      new webpack.DllReferencePlugin({\n        context: __dirname,\n        manifest: require(ChartsPath),\n      })\n  ]\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.export = {\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e: [\n     \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.DllReferencePlugin({\n        \x3cspan class=\x22hljs-attr\x22\x3econtext\x3c\/span\x3e: __dirname,\n        \x3cspan class=\x22hljs-attr\x22\x3emanifest\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(libPath),\n      }),\n      \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.DllReferencePlugin({\n        \x3cspan class=\x22hljs-attr\x22\x3econtext\x3c\/span\x3e: __dirname,\n        \x3cspan class=\x22hljs-attr\x22\x3emanifest\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(ChartsPath),\n      })\n  ]\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e方案四、使用 Happypack 加速你的代码构建\x3c\/h3\x3e\n\x3cp\x3e以上介绍均为针对webpack中的chunk计算和编译内容的优化与改进，对资源的实际体积改进上也较为明显，那么除此之外，我们能否针对资源的编译过程和速度优化上做些尝试呢？\x3c\/p\x3e\n\x3cp\x3e众所周知，webpack中为了方便各种资源和类型的加载，设计了以loader加载器的形式读取资源，但是受限于node的编程模型影响，所有的loader虽然以async的形式来并发调用，但是还是运行在单个 node的进程以及在同一个事件循环中，这就直接导致了当我们需要同时读取多个loader文件资源时，比如babel-loader需要transform各种jsx，es6的资源文件。在这种同步计算同时需要大量耗费cpu运算的过程中，node的单进程模型就无优势了，那么happypack就针对解决此类问题而生。\x3c\/p\x3e\n\x3ch4\x3e开启happypack的线程池\x3c\/h4\x3e\n\x3cp\x3ehappypack的处理思路是将原有的webpack对loader的执行过程从单一进程的形式扩展多进程模式，原本的流程保持不变，这样可以在不修改原有配置的基础上来完成对编译过程的优化，具体配置如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 const HappyPack = require(\x27happypack\x27);\n const os = require(\x27os\x27)\n const HappyThreadPool = HappyPack.ThreadPool({ size: os.cpus().length}); \/\/ 启动线程池});\n\nmodule:{\n    rules: [\n      {\n        test: \/\\.(js|jsx)$\/,\n        \/\/ use: [\x27babel-loader?cacheDirectory\x27],\n        use: \x27happypack\/loader?id=jsx\x27,\n        exclude: \/^node_modules$\/\n      }\n    ]\n  },\n  plugins:[\n    new HappyPack({\n     id: \x27jsx\x27,\n     cache: true,\n     threadPool: HappyThreadPool,\n     loaders: [\x27babel-loader\x27]\n   })\n  ]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e HappyPack = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27happypack\x27\x3c\/span\x3e);\n \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e os = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27os\x27\x3c\/span\x3e)\n \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e HappyThreadPool = HappyPack.ThreadPool({ \x3cspan class=\x22hljs-attr\x22\x3esize\x3c\/span\x3e: os.cpus().length}); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 启动线程池});\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e:{\n    \x3cspan class=\x22hljs-attr\x22\x3erules\x3c\/span\x3e: [\n      {\n        \x3cspan class=\x22hljs-attr\x22\x3etest\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/\\.(js|jsx)$\/\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ use: [\x27babel-loader?cacheDirectory\x27],\x3c\/span\x3e\n        use: \x3cspan class=\x22hljs-string\x22\x3e\x27happypack\/loader?id=jsx\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3eexclude\x3c\/span\x3e: \x3cspan class=\x22hljs-regexp\x22\x3e\/^node_modules$\/\x3c\/span\x3e\n      }\n    ]\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e:[\n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e HappyPack({\n     \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27jsx\x27\x3c\/span\x3e,\n     \x3cspan class=\x22hljs-attr\x22\x3ecache\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n     \x3cspan class=\x22hljs-attr\x22\x3ethreadPool\x3c\/span\x3e: HappyThreadPool,\n     \x3cspan class=\x22hljs-attr\x22\x3eloaders\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x27babel-loader\x27\x3c\/span\x3e]\n   })\n  ]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们可以看到通过在loader中配置直接指向happypack提供的loader，对于文件实际匹配的处理 loader，则是通过配置在plugin属性来传递说明，这里happypack提供的loader与plugin的衔接匹配，则是通过id=happybabel来完成。配置完成后，laoder的工作模式就转变成了如下所示：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVHg1f?w=1141\x26amp;h=720\x22 src=\x22https:\/\/static.alili.tech\/img\/bVHg1f?w=1141\x26amp;h=720\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3ehappypack在编译过程中除了利用多进程的模式加速编译，还同时开启了cache计算，能充分利用缓存读取构建文件，对构建的速度提升也是非常明显的，经过测试，最终的构建速度提升如下：\x3c\/p\x3e\n\x3cp\x3e优化前：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVHg0C?w=896\x26amp;h=154\x22 src=\x22https:\/\/static.alili.tech\/img\/bVHg0C?w=896\x26amp;h=154\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e优化后：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVHg0D?w=650\x26amp;h=136\x22 src=\x22https:\/\/static.alili.tech\/img\/bVHg0D?w=650\x26amp;h=136\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e关于happyoack的更多介绍可以查看：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3ca href=\x22https:\/\/github.com\/amireh\/happypack\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehappypack\x3c\/a\x3e\x3c\/li\x3e\n\x3cli\x3e\x3ca href=\x22http:\/\/taobaofed.org\/blog\/2016\/12\/08\/happypack-source-code-analysis\/?utm_source=tuicool\x26amp;utm_medium=referral\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehappypack 原理解析\x3c\/a\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e方案五、增强 uglifyPlugin\x3c\/h3\x3e\n\x3cp\x3euglifyJS凭借基于node开发，压缩比例高，使用方便等诸多优点已经成为了js压缩工具中的首选，但是我们在webpack的构建中观察发现，当webpack build进度走到80%前后时，会发生很长一段时间的停滞，经测试对比发现这一过程正是uglfiyJS在对我们的output中的bunlde部分进行压缩耗时过长导致，针对这块我们可以使用\x3ca href=\x22https:\/\/github.com\/tradingview\/webpack-uglify-parallel\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebpack-uglify-parallel\x3c\/a\x3e来提升压缩速度。\x3c\/p\x3e\n\x3cp\x3e从插件源码中可以看到，webpack-uglify-parallel的是实现原理是采用了多核并行压缩的方式来提升我们的压缩速度。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22plugin.nextWorker().send({\n    input: input,\n    inputSourceMap: inputSourceMap,\n    file: file,\n    options: options\n});\n\nplugin._queue_len\x2b\x2b;\n                \nif (!plugin._queue_len) {\n    callback();\n}               \n\nif (this.workers.length \x3c this.maxWorkers) {\n    var worker = fork(__dirname \x2b \x27\/lib\/worker\x27);\n    worker.on(\x27message\x27, this.onWorkerMessage.bind(this));\n    worker.on(\x27error\x27, this.onWorkerError.bind(this));\n    this.workers.push(worker);\n}\n\nthis._next_worker\x2b\x2b;\nreturn this.workers[this._next_worker % this.maxWorkers];\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eplugin.nextWorker().send({\n    \x3cspan class=\x22hljs-attr\x22\x3einput\x3c\/span\x3e: input,\n    \x3cspan class=\x22hljs-attr\x22\x3einputSourceMap\x3c\/span\x3e: inputSourceMap,\n    \x3cspan class=\x22hljs-attr\x22\x3efile\x3c\/span\x3e: file,\n    \x3cspan class=\x22hljs-attr\x22\x3eoptions\x3c\/span\x3e: options\n});\n\nplugin._queue_len\x2b\x2b;\n                \n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!plugin._queue_len) {\n    callback();\n}               \n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.workers.length \x26lt; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.maxWorkers) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e worker = fork(__dirname \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\/lib\/worker\x27\x3c\/span\x3e);\n    worker.on(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onWorkerMessage.bind(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e));\n    worker.on(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onWorkerError.bind(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e));\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.workers.push(worker);\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._next_worker\x2b\x2b;\n\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.workers[\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._next_worker % \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.maxWorkers];\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用配置也非常简单，只需要将我们原来webpack中自带的uglifyPlugin配置：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22new webpack.optimize.UglifyJsPlugin({\n   exclude:\/\\.min\\.js$\/\n   mangle:true,\n   compress: { warnings: false },\n   output: { comments: false }\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.UglifyJsPlugin({\n   \x3cspan class=\x22hljs-attr\x22\x3eexclude\x3c\/span\x3e:\x3cspan class=\x22hljs-regexp\x22\x3e\/\\.min\\.js$\/\x3c\/span\x3e\n   mangle:\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n   \x3cspan class=\x22hljs-attr\x22\x3ecompress\x3c\/span\x3e: { \x3cspan class=\x22hljs-attr\x22\x3ewarnings\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e },\n   \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: { \x3cspan class=\x22hljs-attr\x22\x3ecomments\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e }\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e修改成如下代码即可：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const os = require(\x27os\x27);\n    const UglifyJsParallelPlugin = require(\x27webpack-uglify-parallel\x27);\n    \n    new UglifyJsParallelPlugin({\n      workers: os.cpus().length,\n      mangle: true,\n      compressor: {\n        warnings: false,\n        drop_console: true,\n        drop_debugger: true\n       }\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e os = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27os\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e UglifyJsParallelPlugin = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27webpack-uglify-parallel\x27\x3c\/span\x3e);\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e UglifyJsParallelPlugin({\n      \x3cspan class=\x22hljs-attr\x22\x3eworkers\x3c\/span\x3e: os.cpus().length,\n      \x3cspan class=\x22hljs-attr\x22\x3emangle\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3ecompressor\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-attr\x22\x3ewarnings\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edrop_console\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3edrop_debugger\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n       }\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e目前webpack官方也维护了一个支持多核压缩的UglifyJs插件：\x3ca href=\x22https:\/\/webpack.js.org\/plugins\/uglifyjs-webpack-plugin\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3euglifyjs-webpack-plugin\x3c\/a\x3e,使用方式类似，优势在于完全兼容webpack.optimize.UglifyJsPlugin中的配置，可以通过uglifyOptions写入，因此也做为\x3cstrong\x3e推荐使用\x3c\/strong\x3e，参考配置如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 const UglifyJsPlugin = require(\x27uglifyjs-webpack-plugin\x27);\n  new UglifyJsPlugin({\n    uglifyOptions: {\n      ie8: false,\n      ecma: 8,\n      mangle: true,\n      output: { comments: false },\n      compress: { warnings: false }\n    },\n    sourceMap: false,\n    cache: true,\n    parallel: os.cpus().length * 2\n  })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e UglifyJsPlugin = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27uglifyjs-webpack-plugin\x27\x3c\/span\x3e);\n  \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e UglifyJsPlugin({\n    \x3cspan class=\x22hljs-attr\x22\x3euglifyOptions\x3c\/span\x3e: {\n      \x3cspan class=\x22hljs-attr\x22\x3eie8\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3eecma\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3emangle\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n      \x3cspan class=\x22hljs-attr\x22\x3eoutput\x3c\/span\x3e: { \x3cspan class=\x22hljs-attr\x22\x3ecomments\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e },\n      \x3cspan class=\x22hljs-attr\x22\x3ecompress\x3c\/span\x3e: { \x3cspan class=\x22hljs-attr\x22\x3ewarnings\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e }\n    },\n    \x3cspan class=\x22hljs-attr\x22\x3esourceMap\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3ecache\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3eparallel\x3c\/span\x3e: os.cpus().length * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n  })\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e方案六、Tree-shaking \x26amp; Scope Hoisting\x3c\/h3\x3e\n\x3cp\x3ewepback在2.X和3.X中从rolluo中借鉴了\x3ca href=\x22https:\/\/webpack.js.org\/guides\/tree-shaking\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etree-shaking\x3c\/a\x3e和\x3ca href=\x22https:\/\/webpack.js.org\/plugins\/module-concatenation-plugin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eScope Hoisting\x3c\/a\x3e，利用es6的module特性，利用AST对所有引用的模块和方法做了静态分析，从而能有效地剔除项目中的没有引用到的方法，并将相关方法调用归纳到了独立的webpack_module中，对打包构建的体积优化也较为明显，但是前提是所有的模块写法必须使用ES6 Module进行实现，具体配置参考如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 \/\/ .babelrc: 通过配置减少没有引用到的方法\n  {\n    \x26quot;presets\x26quot;: [\n      [\x26quot;env\x26quot;, {\n        \x26quot;targets\x26quot;: {\n          \x26quot;browsers\x26quot;: [\x26quot;last 2 versions\x26quot;, \x26quot;safari \x3e= 7\x26quot;]\n        }\n      }],\n      \/\/ https:\/\/www.zhihu.com\/question\/41922432\n      [\x26quot;es2015\x26quot;, {\x26quot;modules\x26quot;: false}]  \/\/ tree-shaking\n    ]\n  }\n\n  \/\/ webpack.config: Scope Hoisting\n  {\n    plugins:[\n      \/\/ https:\/\/zhuanlan.zhihu.com\/p\/27980441\n      new webpack.optimize.ModuleConcatenationPlugin()\n    ]\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/ .babelrc: 通过配置减少没有引用到的方法\x3c\/span\x3e\n  {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22presets\x22\x3c\/span\x3e: [\n      [\x3cspan class=\x22hljs-string\x22\x3e\x22env\x22\x3c\/span\x3e, {\n        \x3cspan class=\x22hljs-string\x22\x3e\x22targets\x22\x3c\/span\x3e: {\n          \x3cspan class=\x22hljs-string\x22\x3e\x22browsers\x22\x3c\/span\x3e: [\x3cspan class=\x22hljs-string\x22\x3e\x22last 2 versions\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22safari \x26gt;= 7\x22\x3c\/span\x3e]\n        }\n      }],\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ https:\/\/www.zhihu.com\/question\/41922432\x3c\/span\x3e\n      [\x3cspan class=\x22hljs-string\x22\x3e\x22es2015\x22\x3c\/span\x3e, {\x3cspan class=\x22hljs-string\x22\x3e\x22modules\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e}]  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ tree-shaking\x3c\/span\x3e\n    ]\n  }\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ webpack.config: Scope Hoisting\x3c\/span\x3e\n  {\n    \x3cspan class=\x22hljs-attr\x22\x3eplugins\x3c\/span\x3e:[\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ https:\/\/zhuanlan.zhihu.com\/p\/27980441\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e webpack.optimize.ModuleConcatenationPlugin()\n    ]\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e适用场景\x3c\/h4\x3e\n\x3cp\x3e在实际的开发过程中，可灵活地选择适合自身业务场景的优化手段。\x3c\/p\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth\x3e优化手段\x3c\/th\x3e\n\x3cth\x3e开发环境\x3c\/th\x3e\n\x3cth\x3e生产环境\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd\x3eCommonsChunk\x3c\/td\x3e\n\x3ctd\x3e√\x3c\/td\x3e\n\x3ctd\x3e√\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eexternals\x3c\/td\x3e\n\x3ctd\x3e\x26nbsp;\x3c\/td\x3e\n\x3ctd\x3e√\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eDllPlugin\x3c\/td\x3e\n\x3ctd\x3e√\x3c\/td\x3e\n\x3ctd\x3e√\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3eHappypack\x3c\/td\x3e\n\x3ctd\x3e√\x3c\/td\x3e\n\x3ctd\x3e\x26nbsp;\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd\x3euglify-parallel\x3c\/td\x3e\n\x3ctd\x3e\x26nbsp;\x3c\/td\x3e\n\x3ctd\x3e√\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/taikongfeizhu\/webpack-dll-demo\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e工程演示demo\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e温馨提醒\x3c\/h2\x3e\n\x3cp\x3e本文中的所有例子已经重新优化，支持最新的webpack3特性，并附带有分享ppt地址，可以在线\x3ca href=\x22http:\/\/taikongfeizhu.github.io\/webpack3-in-action\/index.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e点击查看\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e小结\x3c\/h2\x3e\n\x3cp\x3e性能优化无小事，追求快没有止境，在前端工程日益庞大复杂的今天，针对实际项目，持续改进构建工具的性能，对项目开发效率的提升和工具深度理解都是极其有益的。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>webpack 构建性能优化策略小结</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007891318">https://segmentfault.com/a/1190000007891318</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/hs6kypgssw5/" target="_blank">https://alili.tech/archive/hs6kypgssw5/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/t42iv2yle7e/">2016-我的前端之路:工具化与工程化<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/xlhryjzdso/">2016年总结--成长<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/4wvjfeus9ur/">2016年末总结，我的前端之路<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/w7062tmcw3/">3D 视差效果<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/5jt1iw1t77b/">AlloyTouch实战--60行代码搞定QQ看点资料卡<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/kquf0fxkw2j/">ES6，你不得不学！<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/r5b6g4133jh/">Emmet-前端开发神器<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/5dbaikv4emi/">FreeCodeCamp中级算法题答案<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/iuyeljg6lm/">JSONP是什么<aside class="dates">2019-01-29</aside></a></li><li><a href="/archive/23ftsgrtzzc/">JS中的观察者模式(发布订阅)<aside class="dates">2019-01-29</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>