<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="web性能优化之：no-cache与must-revalidate深入探究"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>web性能优化之：no-cache与must-revalidate深入探究 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/0dlm1ud0kewq/",
				"appid": "1613049289050283", 
				"title": "web性能优化之：no-cache与must-revalidate深入探究 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-01T02:30:10"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ef46qk3ioi6/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ch1stq5e90s/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f&text=web%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e4%b9%8b%ef%bc%9ano-cache%e4%b8%8emust-revalidate%e6%b7%b1%e5%85%a5%e6%8e%a2%e7%a9%b6"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f&text=web%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e4%b9%8b%ef%bc%9ano-cache%e4%b8%8emust-revalidate%e6%b7%b1%e5%85%a5%e6%8e%a2%e7%a9%b6"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f&title=web%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e4%b9%8b%ef%bc%9ano-cache%e4%b8%8emust-revalidate%e6%b7%b1%e5%85%a5%e6%8e%a2%e7%a9%b6"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f&is_video=false&description=web%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e4%b9%8b%ef%bc%9ano-cache%e4%b8%8emust-revalidate%e6%b7%b1%e5%85%a5%e6%8e%a2%e7%a9%b6"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=web%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e4%b9%8b%ef%bc%9ano-cache%e4%b8%8emust-revalidate%e6%b7%b1%e5%85%a5%e6%8e%a2%e7%a9%b6&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f&title=web%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e4%b9%8b%ef%bc%9ano-cache%e4%b8%8emust-revalidate%e6%b7%b1%e5%85%a5%e6%8e%a2%e7%a9%b6"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f&title=web%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e4%b9%8b%ef%bc%9ano-cache%e4%b8%8emust-revalidate%e6%b7%b1%e5%85%a5%e6%8e%a2%e7%a9%b6"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f&title=web%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e4%b9%8b%ef%bc%9ano-cache%e4%b8%8emust-revalidate%e6%b7%b1%e5%85%a5%e6%8e%a2%e7%a9%b6"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f0dlm1ud0kewq%2f&title=web%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e4%b9%8b%ef%bc%9ano-cache%e4%b8%8emust-revalidate%e6%b7%b1%e5%85%a5%e6%8e%a2%e7%a9%b6"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">web性能优化之：no-cache与must-revalidate深入探究</h1><div class="meta"><div class="postdate"><time datetime="2019-02-01" itemprop="datePublished">2019-02-01</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e引言\x3c\/h2\x3e\n\x3cp\x3e稍微了解HTTP协议的前端同学，想必对\x3ccode\x3eCache-Control\x3c\/code\x3e不会感到陌生，性能优化时经常都会跟它打交道。\x3c\/p\x3e\n\x3cp\x3e常见的值有有\x3ccode\x3eprivate\x3c\/code\x3e、\x3ccode\x3epublic\x3c\/code\x3e、\x3ccode\x3eno-store\x3c\/code\x3e、\x3ccode\x3eno-cache\x3c\/code\x3e、\x3ccode\x3emust-revalidate\x3c\/code\x3e、\x3ccode\x3emax-age\x3c\/code\x3e等。\x3c\/p\x3e\n\x3cp\x3e各个取值所代表的含义，网上总结挺多的，这里就不打算再进行逐一介绍，感兴趣的可以一起探讨交流。\x3c\/p\x3e\n\x3cp\x3e本文仅挑\x3ccode\x3eno-cache\x3c\/code\x3e、\x3ccode\x3emust-revalidate\x3c\/code\x3e 这两个进行值进行探究对比。在项目实践中，这两个值用的比较多，也比较容易搞混。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eCache-Control: no-cache\x3cbr\x3eCache-Control: max-age=60, must-revalidate\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e传送门：\x3ca href=\x22https:\/\/www.w3.org\/Protocols\/rfc2616\/rfc2616-sec14.html#sec14.9\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRFC2616关于Cache-Control首部的介绍\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3eno-cache、must-revalidate简介\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3eno-cache\x3c\/code\x3e: 告诉浏览器、缓存服务器，不管本地副本是否过期，使用资源副本前，一定要到源服务器进行副本有效性校验。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3emust-revalidate\x3c\/code\x3e：告诉浏览器、缓存服务器，本地副本过期前，可以使用本地副本；本地副本一旦过期，必须去源服务器进行有效性校验。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e上面的介绍涉及三个主体：\x3cstrong\x3e浏览器\x3c\/strong\x3e、\x3cstrong\x3e缓存服务器\x3c\/strong\x3e、\x3cstrong\x3e源服务器\x3c\/strong\x3e。下面小节会简单进行介绍。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e浏览器、缓存服务器、源服务器\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e浏览器：资源请求直接发起方。\x3c\/li\x3e\n\x3cli\x3e源服务器：资源实际提供方。\x3c\/li\x3e\n\x3cli\x3e缓存服务器：在浏览器、源服务器之间架设的中间服务器，由它代替浏览器，向源服务器发起资源请求；\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e缓存服务器作用如下。缓存服务器不是必须的，浏览器可也可与源服务器直接通信。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e加速资源访问速度，降低源服务器的负载。缓存服务器从源服务器获取资源，并返回给浏览器。此外，缓存服务器一般还会在本地保存资源的副本，当有相同的资源请求到来，缓存服务器可返回资源副本，以此提高资源访问速度。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLo?w=1460\x26amp;h=280\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLo?w=1460\x26amp;h=280\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e对比测试场景、环境准备\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e对比测试场景\x3c\/h3\x3e\n\x3cp\x3e下文会通过以下两种场景的对比测试，来探究\x3ccode\x3eno-cache\x3c\/code\x3e、\x3ccode\x3emust-revalidate\x3c\/code\x3e的区别。\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e浏览器 直接访问 源服务器。\x3c\/li\x3e\n\x3cli\x3e浏览器 通过 缓存服务器，间接访问 源服务器。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e环境准备\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e操作系统：OSX 10.11.4\x3c\/li\x3e\n\x3cli\x3e浏览器：Chrome 52.0.2743.116 (64-bit)、Firefox 49.0.2\x3c\/li\x3e\n\x3cli\x3e缓存服务器：Squid 3.6\x3c\/li\x3e\n\x3cli\x3e源服务器：Express 4.14.0\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e1、下载实验代码：可以访问\x3ca href=\x22https:\/\/github.com\/chyingp\/tech-experiment\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egithub主页\x3c\/a\x3e获取，也可通过\x3ccode\x3egit clone\x3c\/code\x3e下载到本地。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22git clone https:\/\/github.com\/chyingp\/tech-experiment.git\ncd tech-experiment\/2016.10.25-cache-control\/\nnpm install\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22powershell hljs\x22\x3e\x3ccode class=\x22powershell\x22\x3egit clone https:\/\/github.com\/chyingp\/tech-experiment.git\ncd tech-experiment\/\x3cspan class=\x22hljs-number\x22\x3e2016.10\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e25\x3c\/span\x3e-cache-control\/\nnpm install\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2、安装Squid，步骤略，\x3ca href=\x22http:\/\/www.squid-cache.org\/Versions\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e下载地址\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e3、可选：启动Squid，并将本地http代理设置为Squid的ip和端口。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e备注：测试场景“通过缓存服务器，间接访问源服务器资源”时，才需要这一步。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLt?w=1370\x26amp;h=1080\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLt?w=1370\x26amp;h=1080\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e4、可选：将本地代理设置为Charles的地址，然后将Charles的代理地址设置为squid的代理地址。（避免浏览器开发者工具对request header的修改，干扰实验结果）\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e场景一：浏览器-\x26gt;源服务器\x3c\/h2\x3e\n\x3cp\x3e首先，通过以下脚本启动本地服务器（源服务器）。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22cd connect-directly \nnode server.js \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22powershell hljs\x22\x3e\x3ccode class=\x22powershell\x22\x3ecd connect-directly \nnode server.js \x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3eCache-Control: no-cache\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e用例1：二次访问，源服务器 上 资源 未发生变化\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e访问地址为：\x3ca href=\x22http:\/\/127.0.0.1:3000\/no-cache\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/no-cache\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e步骤一：第一次访问，返回内容如下。可以看到，返回了\x3ccode\x3eCache-Control: no-cache\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLx?w=1380\x26amp;h=118\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLx?w=1380\x26amp;h=118\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22HTTP\/1.1 200 OK\nX-Powered-By: Express\nCache-Control: no-cache\nContent-Type: text\/html; charset=utf-8\nContent-Length: 11\nETag: W\/\x26quot;b-s0vwqaICscfrawwztfPIiA\x26quot;\nDate: Wed, 26 Oct 2016 07:46:28 GMT\nConnection: keep-alive\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22http hljs\x22\x3e\x3ccode class=\x22http\x22\x3eHTTP\/1.1 \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-attribute\x22\x3eX-Powered-By\x3c\/span\x3e: Express\n\x3cspan class=\x22hljs-attribute\x22\x3eCache-Control\x3c\/span\x3e: no-cache\n\x3cspan class=\x22hljs-attribute\x22\x3eContent-Type\x3c\/span\x3e: text\/html; charset=utf-8\n\x3cspan class=\x22hljs-attribute\x22\x3eContent-Length\x3c\/span\x3e: 11\n\x3cspan class=\x22hljs-attribute\x22\x3eETag\x3c\/span\x3e: W\/\x22b-s0vwqaICscfrawwztfPIiA\x22\n\x3cspan class=\x22hljs-attribute\x22\x3eDate\x3c\/span\x3e: Wed, 26 Oct 2016 07:46:28 GMT\n\x3cspan class=\x22hljs-attribute\x22\x3eConnection\x3c\/span\x3e: keep-alive\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e步骤二：第二次访问，返回内容如下。返回状态码为\x3ccode\x3e304 Not Modified\x3c\/code\x3e，表示经过校验，源服务器上的资源没有变化，浏览器可以采用本地副本。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLE?w=1222\x26amp;h=180\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLE?w=1222\x26amp;h=180\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22HTTP\/1.1 304 Not Modified\nX-Powered-By: Express\nCache-Control: no-cache\nETag: W\/\x26quot;b-s0vwqaICscfrawwztfPIiA\x26quot;\nDate: Wed, 26 Oct 2016 07:47:31 GMT\nConnection: keep-alive\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22http hljs\x22\x3e\x3ccode class=\x22http\x22\x3eHTTP\/1.1 \x3cspan class=\x22hljs-number\x22\x3e304\x3c\/span\x3e Not Modified\n\x3cspan class=\x22hljs-attribute\x22\x3eX-Powered-By\x3c\/span\x3e: Express\n\x3cspan class=\x22hljs-attribute\x22\x3eCache-Control\x3c\/span\x3e: no-cache\n\x3cspan class=\x22hljs-attribute\x22\x3eETag\x3c\/span\x3e: W\/\x22b-s0vwqaICscfrawwztfPIiA\x22\n\x3cspan class=\x22hljs-attribute\x22\x3eDate\x3c\/span\x3e: Wed, 26 Oct 2016 07:47:31 GMT\n\x3cspan class=\x22hljs-attribute\x22\x3eConnection\x3c\/span\x3e: keep-alive\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e用例2：二次访问，源服务器 上 资源 发生变化\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e步骤一：访问地址为：\x3ca href=\x22http:\/\/127.0.0.1:3000\/no-cache?change=1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/no-cach...\x3c\/a\x3e \x3cbr\x3e备注：\x3ccode\x3echange=1\x3c\/code\x3e告诉源服务器，每次访问都返回不同内容\x3c\/p\x3e\n\x3cp\x3e步骤一：第一次访问，内容如下，不赘述。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLG?w=1392\x26amp;h=120\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLG?w=1392\x26amp;h=120\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22HTTP\/1.1 200 OK\nX-Powered-By: Express\nCache-Control: no-cache\nContent-Type: text\/html; charset=utf-8\nContent-Length: 11\nETag: W\/\x26quot;b-8n8r0vUN\x2bmIIQCegzmqpuQ\x26quot;\nDate: Wed, 26 Oct 2016 07:48:01 GMT\nConnection: keep-alive\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22http hljs\x22\x3e\x3ccode class=\x22http\x22\x3eHTTP\/1.1 \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-attribute\x22\x3eX-Powered-By\x3c\/span\x3e: Express\n\x3cspan class=\x22hljs-attribute\x22\x3eCache-Control\x3c\/span\x3e: no-cache\n\x3cspan class=\x22hljs-attribute\x22\x3eContent-Type\x3c\/span\x3e: text\/html; charset=utf-8\n\x3cspan class=\x22hljs-attribute\x22\x3eContent-Length\x3c\/span\x3e: 11\n\x3cspan class=\x22hljs-attribute\x22\x3eETag\x3c\/span\x3e: W\/\x22b-8n8r0vUN\x2bmIIQCegzmqpuQ\x22\n\x3cspan class=\x22hljs-attribute\x22\x3eDate\x3c\/span\x3e: Wed, 26 Oct 2016 07:48:01 GMT\n\x3cspan class=\x22hljs-attribute\x22\x3eConnection\x3c\/span\x3e: keep-alive\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e步骤二：第二次访问，返回内容如下。注意Etag变化了，表示源服务器资源已发生变化。于是状态码为\x3ccode\x3e200 OK\x3c\/code\x3e，源服务器返回新版本的资源给浏览器。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLK?w=1394\x26amp;h=120\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLK?w=1394\x26amp;h=120\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22HTTP\/1.1 200 OK\nX-Powered-By: Express\nCache-Control: no-cache\nContent-Type: text\/html; charset=utf-8\nContent-Length: 11\nETag: W\/\x26quot;b-0DK7Mx61dfZc1vIPJDSNSQ\x26quot;\nDate: Wed, 26 Oct 2016 07:48:38 GMT\nConnection: keep-alive\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22http hljs\x22\x3e\x3ccode class=\x22http\x22\x3eHTTP\/1.1 \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-attribute\x22\x3eX-Powered-By\x3c\/span\x3e: Express\n\x3cspan class=\x22hljs-attribute\x22\x3eCache-Control\x3c\/span\x3e: no-cache\n\x3cspan class=\x22hljs-attribute\x22\x3eContent-Type\x3c\/span\x3e: text\/html; charset=utf-8\n\x3cspan class=\x22hljs-attribute\x22\x3eContent-Length\x3c\/span\x3e: 11\n\x3cspan class=\x22hljs-attribute\x22\x3eETag\x3c\/span\x3e: W\/\x22b-0DK7Mx61dfZc1vIPJDSNSQ\x22\n\x3cspan class=\x22hljs-attribute\x22\x3eDate\x3c\/span\x3e: Wed, 26 Oct 2016 07:48:38 GMT\n\x3cspan class=\x22hljs-attribute\x22\x3eConnection\x3c\/span\x3e: keep-alive\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eCache-Control: must-revalidate\x3c\/h3\x3e\n\x3cp\x3e访问地址：\x3ca href=\x22http:\/\/127.0.0.1:3000\/must-revalidate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/must-re...\x3c\/a\x3e\x3cbr\x3e可选参数说明：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ccode\x3emax-age\x3c\/code\x3e：源站返回的内容，\x3ccode\x3emax-age\x3c\/code\x3e是多少（单位是s）。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3echange\x3c\/code\x3e：源站返回的内容，是否变化，如果是\x3ccode\x3e1\x3c\/code\x3e，则变化。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e用例1：二次访问，浏览器缓存未过期\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e访问地址：\x3ca href=\x22http:\/\/127.0.0.1:3000\/must-revalidate?max-age=10\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/must-re...\x3c\/a\x3e \x3cbr\x3e备注：\x3ccode\x3emax-age=10\x3c\/code\x3e表示，希望资源缓存10s\x3c\/p\x3e\n\x3cp\x3e步骤一：第一次访问，返回内容如下。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLL?w=1382\x26amp;h=120\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLL?w=1382\x26amp;h=120\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22HTTP\/1.1 200 OK\nX-Powered-By: Express\nCache-Control: max-age=10, must-revalidate\nContent-Type: text\/html; charset=utf-8\nContent-Length: 16\nETag: W\/\x26quot;10-dK948plT5cojN3y7Cy717w\x26quot;\nDate: Wed, 26 Oct 2016 08:06:16 GMT\nConnection: keep-alive\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22http hljs\x22\x3e\x3ccode class=\x22http\x22\x3eHTTP\/1.1 \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-attribute\x22\x3eX-Powered-By\x3c\/span\x3e: Express\n\x3cspan class=\x22hljs-attribute\x22\x3eCache-Control\x3c\/span\x3e: max-age=10, must-revalidate\n\x3cspan class=\x22hljs-attribute\x22\x3eContent-Type\x3c\/span\x3e: text\/html; charset=utf-8\n\x3cspan class=\x22hljs-attribute\x22\x3eContent-Length\x3c\/span\x3e: 16\n\x3cspan class=\x22hljs-attribute\x22\x3eETag\x3c\/span\x3e: W\/\x2210-dK948plT5cojN3y7Cy717w\x22\n\x3cspan class=\x22hljs-attribute\x22\x3eDate\x3c\/span\x3e: Wed, 26 Oct 2016 08:06:16 GMT\n\x3cspan class=\x22hljs-attribute\x22\x3eConnection\x3c\/span\x3e: keep-alive\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e步骤二：第二次访问（在10s内），如下截图所示，浏览器直接从本地缓存里读取资源副本，并没有重新发起HTTP请求。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLO?w=1394\x26amp;h=128\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLO?w=1394\x26amp;h=128\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e用例2：二次访问，浏览器缓存已过期，源服务器 资源未变化\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e步骤一：第一次访问略过。第二次访问如下截图所示（10s后），返回\x3ccode\x3e304 Not Modified\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLP?w=1392\x26amp;h=118\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLP?w=1392\x26amp;h=118\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22HTTP\/1.1 304 Not Modified\nX-Powered-By: Express\nCache-Control: max-age=10, must-revalidate\nETag: W\/\x26quot;10-dK948plT5cojN3y7Cy717w\x26quot;\nDate: Wed, 26 Oct 2016 08:09:22 GMT\nConnection: keep-alive\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22http hljs\x22\x3e\x3ccode class=\x22http\x22\x3eHTTP\/1.1 \x3cspan class=\x22hljs-number\x22\x3e304\x3c\/span\x3e Not Modified\n\x3cspan class=\x22hljs-attribute\x22\x3eX-Powered-By\x3c\/span\x3e: Express\n\x3cspan class=\x22hljs-attribute\x22\x3eCache-Control\x3c\/span\x3e: max-age=10, must-revalidate\n\x3cspan class=\x22hljs-attribute\x22\x3eETag\x3c\/span\x3e: W\/\x2210-dK948plT5cojN3y7Cy717w\x22\n\x3cspan class=\x22hljs-attribute\x22\x3eDate\x3c\/span\x3e: Wed, 26 Oct 2016 08:09:22 GMT\n\x3cspan class=\x22hljs-attribute\x22\x3eConnection\x3c\/span\x3e: keep-alive\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e用例3：浏览器缓存已过期，源服务器 资源 已变化\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e访问地址：\x3ca href=\x22http:\/\/127.0.0.1:3000\/must-revalidate?max-age=10\x26amp;change=1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/must-re...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e步骤一：第一次访问，截图如下。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLR?w=1546\x26amp;h=118\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLR?w=1546\x26amp;h=118\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e步骤二：第二次访问（10s后），返回截图如下，可以看到返回了\x3ccode\x3e200\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLW?w=1376\x26amp;h=120\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLW?w=1376\x26amp;h=120\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e场景2：浏览器-\x26gt;缓存服务器-\x26gt;源服务器\x3c\/h2\x3e\n\x3cp\x3e从上面的对比实验已经知道，在不经过缓存服务器的情况下，\x3ccode\x3eno-cache\x3c\/code\x3e、\x3ccode\x3emust-revalidate\x3c\/code\x3e在缓存校验方面的差别。\x3c\/p\x3e\n\x3cp\x3e接下来，我们再看下，引入缓存服务器后，二者表现的差异点。\x3c\/p\x3e\n\x3cp\x3e备注：下文我们会通过查看\x3ccode\x3eSquid\x3c\/code\x3e的访问日志，来确认缓存服务器的行为。这里对日志中的几个关键字先粗略解释下：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eTCP_MISS：没有命中缓存。有可能是缓存服务器不存在资源的副本，也有可能资源副本已过期。\x3c\/li\x3e\n\x3cli\x3eTCP_MEM_HIT：命中了缓存。缓存服务器存在资源的副本，并且副本未过期。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e再次贴上之前的图。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLo?w=1460\x26amp;h=280\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLo?w=1460\x26amp;h=280\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3eCache-Control: no-cache\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e用例1：chrome第一次访问资源\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3echrome访问截图如下：\x3ccode\x3e200 ok\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLX?w=1382\x26amp;h=124\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLX?w=1382\x26amp;h=124\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3esquid日志：TCP_MISS，表示没有命中本地资源副本。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221477501799.573     17 127.0.0.1 TCP_MISS\/200 299 GET http:\/\/127.0.0.1:3000\/no-cache - HIER_DIRECT\/127.0.0.1 text\/html\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22accesslog hljs\x22\x3e\x3ccode class=\x22accesslog\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-number\x22\x3e1477501799\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e573\x3c\/span\x3e     \x3cspan class=\x22hljs-number\x22\x3e17\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e TCP_MISS\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e299\x3c\/span\x3e GET http:\/\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1:3000\x3c\/span\x3e\/no-cache - HIER_DIRECT\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e text\/html\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e用例2：chrome再次访问该资源。且源服务器上，该资源未变化\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e访问地址：\x3ca href=\x22http:\/\/127.0.0.1:3000\/no-cache\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/no-cache\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e第一次访问略。第二次访问，chrome访问截图如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLY?w=1394\x26amp;h=116\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLY?w=1394\x26amp;h=116\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3esquid访问日志如下：TCP_MISS\/304 。表示缓存服务器 联系了 源服务器，发现内容没变化，于是返回304。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221477501987.785      1 127.0.0.1 TCP_MISS\/304 238 GET http:\/\/127.0.0.1:3000\/no-cache - HIER_DIRECT\/127.0.0.1 -\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22accesslog hljs\x22\x3e\x3ccode class=\x22accesslog\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-number\x22\x3e1477501987\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e785\x3c\/span\x3e      \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e TCP_MISS\/\x3cspan class=\x22hljs-number\x22\x3e304\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e238\x3c\/span\x3e GET http:\/\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1:3000\x3c\/span\x3e\/no-cache - HIER_DIRECT\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e -\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e用例3：chrome再次访问该资源。且源服务器上，该资源已变化\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e访问地址：\x3ca href=\x22http:\/\/127.0.0.1:3000\/no-cache?change=1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/no-cach...\x3c\/a\x3e \x3cbr\x3e备注：\x3ccode\x3echange=1\x3c\/code\x3e 表示强制每次访问源服务器，返回的资源都是新的。\x3c\/p\x3e\n\x3cp\x3e第一次访问略。第二次访问，chrome截图如下，状态码为\x3ccode\x3e200\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERLZ?w=1390\x26amp;h=122\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERLZ?w=1390\x26amp;h=122\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e从squid日志来看，缓存服务器 访问 源服务器，并返回\x3ccode\x3e200\x3c\/code\x3e给浏览器。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221477647837.216      1 127.0.0.1 TCP_MISS\/200 299 GET http:\/\/127.0.0.1:3000\/no-cache? - HIER_DIRECT\/127.0.0.1 text\/html\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22accesslog hljs\x22\x3e\x3ccode class=\x22accesslog\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-number\x22\x3e1477647837\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e216\x3c\/span\x3e      \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e TCP_MISS\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e299\x3c\/span\x3e GET http:\/\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1:3000\x3c\/span\x3e\/no-cache? - HIER_DIRECT\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e text\/html\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3eCache-Control: must-revalidate\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e用例1：缓存服务器 已存在 资源副本，且该资源副本 未过期\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e访问地址：\x3ca href=\x22http:\/\/127.0.0.1:3000\/must-revalidate?max-age=900\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/must-re...\x3c\/a\x3e\x3cbr\x3e备注：\x3ccode\x3emax-age=900\x3c\/code\x3e表示资源有效期是900s\x3c\/p\x3e\n\x3cp\x3e步骤一：\x3c\/p\x3e\n\x3cp\x3echrome第一次访问 该资源，缓存服务器上没有该资源副本，于是访问源服务器。最终，缓存服务器给浏览器返回200。此时，缓存服务器squid上有了资源的副本。\x3c\/p\x3e\n\x3cp\x3e步骤二：\x3c\/p\x3e\n\x3cp\x3efirefox第一次访问 该资源（900s内）。缓存服务器上已有该资源副本，且该副本未过期。于是，缓存服务器给firefox返回该资源副本，且状态码为200。（缓存命中）\x3c\/p\x3e\n\x3cp\x3e为了验证步骤二中，缓存服务器 返回的是本地资源的副本，查看squid日志。其中，第二条就是firefox的访问记录，\x3ccode\x3eTCP_MEM_HIT\/200\x3c\/code\x3e表示命中本地缓存。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221477648947.594      5 127.0.0.1 TCP_MISS\/200 325 GET http:\/\/127.0.0.1:3000\/must-revalidate? - HIER_DIRECT\/127.0.0.1 text\/html\n1477649012.625      0 127.0.0.1 TCP_MEM_HIT\/200 333 GET http:\/\/127.0.0.1:3000\/must-revalidate? - HIER_NONE\/- text\/html\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22accesslog hljs\x22\x3e\x3ccode class=\x22accesslog\x22\x3e\x3cspan class=\x22hljs-number\x22\x3e1477648947\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e594\x3c\/span\x3e      \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e TCP_MISS\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e325\x3c\/span\x3e GET http:\/\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1:3000\x3c\/span\x3e\/must-revalidate? - HIER_DIRECT\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e text\/html\n\x3cspan class=\x22hljs-number\x22\x3e1477649012\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e625\x3c\/span\x3e      \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e TCP_MEM_HIT\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e333\x3c\/span\x3e GET http:\/\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1:3000\x3c\/span\x3e\/must-revalidate? - HIER_NONE\/- text\/html\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e用例2：缓存服务器 已存在 资源副本，该资源副本已过期，但源服务器上 资源未改变\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e访问链接：\x3ca href=\x22http:\/\/127.0.0.1:3000\/must-revalidate?max-age=10\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/must-re...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e用chrome先后访问该资源，其间间隔超过10s。第二次访问时，chrome收到响应如下。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERL1?w=1218\x26amp;h=118\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERL1?w=1218\x26amp;h=118\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e查看squid日志。可以看到，状态为\x3ccode\x3eTCP_MISS\/304\x3c\/code\x3e，表示本地副本已过期，跟源服务器进行校验，发现源服务器上资源未改变。于是，给浏览器返回304。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221477649429.105     11 127.0.0.1 TCP_MISS\/304 258 GET http:\/\/127.0.0.1:3000\/must-revalidate? - HIER_DIRECT\/127.0.0.1 -\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22accesslog hljs\x22\x3e\x3ccode class=\x22accesslog\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-number\x22\x3e1477649429\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e105\x3c\/span\x3e     \x3cspan class=\x22hljs-number\x22\x3e11\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e TCP_MISS\/\x3cspan class=\x22hljs-number\x22\x3e304\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e258\x3c\/span\x3e GET http:\/\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1:3000\x3c\/span\x3e\/must-revalidate? - HIER_DIRECT\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e -\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e用例3：缓存服务器 已存在 资源副本，该资源副本 已过期，但源服务器上 资源已改变\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e访问地址：\x3ca href=\x22http:\/\/127.0.0.1:3000\/must-revalidate?max-age=10\x26amp;change=1\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/127.0.0.1:3000\/must-re...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e用chrome先后访问该资源，其间间隔超过10s。第二次访问时，chrome收到响应如下\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVERL2?w=1392\x26amp;h=122\x22 src=\x22https:\/\/static.alili.tech\/img\/bVERL2?w=1392\x26amp;h=122\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3esquid日志如下，状态都是\x3ccode\x3eTCP_MISS\/200\x3c\/code\x3e，表示没有命中缓存。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221477650702.807      8 127.0.0.1 TCP_MISS\/200 325 GET http:\/\/127.0.0.1:3000\/must-revalidate? - HIER_DIRECT\/127.0.0.1 text\/html\n\n1477651020.516      4 127.0.0.1 TCP_MISS\/200 325 GET http:\/\/127.0.0.1:3000\/must-revalidate? - HIER_DIRECT\/127.0.0.1 text\/html\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22accesslog hljs\x22\x3e\x3ccode class=\x22accesslog\x22\x3e\x3cspan class=\x22hljs-number\x22\x3e1477650702\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e807\x3c\/span\x3e      \x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e TCP_MISS\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e325\x3c\/span\x3e GET http:\/\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1:3000\x3c\/span\x3e\/must-revalidate? - HIER_DIRECT\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e text\/html\n\n\x3cspan class=\x22hljs-number\x22\x3e1477651020\x3c\/span\x3e.\x3cspan class=\x22hljs-number\x22\x3e516\x3c\/span\x3e      \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e TCP_MISS\/\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e325\x3c\/span\x3e GET http:\/\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1:3000\x3c\/span\x3e\/must-revalidate? - HIER_DIRECT\/\x3cspan class=\x22hljs-number\x22\x3e127.0.0.1\x3c\/span\x3e text\/html\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3e对比结论\x3c\/h2\x3e\n\x3cp\x3e以下针对的都是浏览器第n次访问资源。（n\x26gt;1）\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e不考虑缓存服务器\x3c\/h3\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth align=\x22left\x22\x3e首部\x3c\/th\x3e\n\x3cth align=\x22center\x22\x3e本地缓存是否过期\x3c\/th\x3e\n\x3cth align=\x22center\x22\x3e源服务器资源是否改变\x3c\/th\x3e\n\x3cth align=\x22center\x22\x3e是否重新校验\x3c\/th\x3e\n\x3cth align=\x22center\x22\x3e状态码\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3eno-cache\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e不确定\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e304\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3eno-cache\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e不确定\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e200\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3emust-revalidate\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\/否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e200(来自浏览器缓存)\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3emust-revalidate\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e304\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3emust-revalidate\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e200\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3e考虑缓存服务器\x3c\/h3\x3e\n\x3ctable\x3e\n\x3cthead\x3e\x3ctr\x3e\n\x3cth align=\x22left\x22\x3e首部\x3c\/th\x3e\n\x3cth align=\x22center\x22\x3e本地缓存是否过期\x3c\/th\x3e\n\x3cth align=\x22center\x22\x3e缓存服务器副本是否过期\x3c\/th\x3e\n\x3cth align=\x22center\x22\x3e源服务器资源是否改变\x3c\/th\x3e\n\x3cth align=\x22center\x22\x3e是否重新校验\x3c\/th\x3e\n\x3cth\x3e状态码\x3c\/th\x3e\n\x3c\/tr\x3e\x3c\/thead\x3e\n\x3ctbody\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3eno-cache\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e不确定\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e不确定\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd\x3e304\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3eno-cache\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e不确定\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e不确定\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd\x3e200\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3emust-revalidate\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\/否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\/否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e否\x3c\/td\x3e\n\x3ctd\x3e200(来自浏览器缓存)\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3emust-revalidate\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\/否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd\x3e304(来自缓存服务器)\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3emust-revalidate\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e否\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd\x3e304\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3ctr\x3e\n\x3ctd align=\x22left\x22\x3emust-revalidate\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd align=\x22center\x22\x3e是\x3c\/td\x3e\n\x3ctd\x3e200\x3c\/td\x3e\n\x3c\/tr\x3e\n\x3c\/tbody\x3e\n\x3c\/table\x3e\n\x3ch2 id=\x22articleHeader15\x22\x3e写在后面\x3c\/h2\x3e\n\x3cp\x3e经过一轮对比测试，发现\x3ccode\x3eno-cache\x3c\/code\x3e、\x3ccode\x3emust-revalidate\x3c\/code\x3e这两个值还是蛮有意思的。实际上，由于篇幅原因，这里还有一些内容尚未进行对比实验。比如：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e当\x3ccode\x3emust-revalidate\x3c\/code\x3e或\x3ccode\x3eno-cache\x3c\/code\x3e跟\x3ccode\x3emax-stale\x3c\/code\x3e一起使用时的表现。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eno-cache\x3c\/code\x3e跟\x3ccode\x3emax-age=0, mustvalidate\x3c\/code\x3e的区别。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eno-chche\x3c\/code\x3e制定具体的字段名时，跟不指明具体字段名时，缓存校验行为上的区别。\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3eproxy-revalidate\x3c\/code\x3e跟\x3ccode\x3emust-revalidate\x3c\/code\x3e的区别。\x3c\/li\x3e\n\x3cli\x3e缓存服务器本身优化算法对实验结果的影响。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e对比实验过程比较枯燥繁琐，如有不严谨或错漏的地方，敬请指出 :)\x3c\/p\x3e\n\x3cp\x3e这里留个经常会碰到的问题，供读者探讨：\x3ccode\x3eno-cache\x3c\/code\x3e跟\x3ccode\x3emax-age=0, mustvalidate\x3c\/code\x3e的区别。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader16\x22\x3e相关链接\x3c\/h2\x3e\n\x3cp\x3eRFC2616 14.9： Cache-Control\x3cbr\x3e\x3ca href=\x22https:\/\/www.w3.org\/Protocols\/rfc2616\/rfc2616-sec14.html#sec14.9\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.w3.org\/Protocols\/...\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>web性能优化之：no-cache与must-revalidate深入探究</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000007317481">https://segmentfault.com/a/1190000007317481</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/0dlm1ud0kewq/" target="_blank">https://alili.tech/archive/0dlm1ud0kewq/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/sj57jxyoook/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（上）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/qsw902j95k/">ES6 &#43; Webpack &#43; React &#43; Babel 如何在低版本浏览器上愉快的玩耍（下）<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/nnpmjlot58j/">IndexedDB使用与出坑指南<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/alvlbas9oai/">JS事件模型<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/u0pzym8k36o/">JS练习实例--编写经典小游戏俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/khwpyk5yz8q/">JavaScript 事件代理和委托<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/kuocl6lc3n/">JavaScript 版俄罗斯方块<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/n8bk54lyrf/">Promise学习:基础入门<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/7bk7u30qncb/">Redux 入坑进阶 - 源码解析<aside class="dates">2019-02-03</aside></a></li><li><a href="/archive/853kqfmqmf7/">Snap.svg 基本知识入门<aside class="dates">2019-02-03</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>